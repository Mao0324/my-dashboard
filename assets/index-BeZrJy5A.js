import{r as e}from"./rolldown-runtime-DGruFWvd.js";import{$ as t,A as n,B as r,C as i,D as a,E as o,F as s,G as c,H as l,I as u,J as d,K as f,L as p,M as m,N as h,O as g,P as _,Q as v,R as y,S as b,T as x,U as S,V as C,W as w,X as T,Y as E,Z as ee,_ as D,a as O,at as k,b as A,c as j,ct as M,d as N,dt as P,et as F,f as I,g as L,h as R,i as te,it as ne,j as re,k as ie,l as z,lt as ae,m as B,n as oe,nt as se,o as ce,ot as le,p as ue,q as de,r as fe,rt as pe,s as V,st as me,t as he,tt as ge,u as H,ut as _e,v as ve,w as ye,x as be,y as xe,z as U}from"./vendor-BcfTvMlS.js";(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var Se=_e(),W=e(P(),1),G=j();const K=({children:e,className:t=``})=>(0,G.jsx)(`div`,{className:`bg-white/80 backdrop-blur-md rounded-2xl shadow-lg border border-white/20 p-6 ${t}`,children:e}),q=({onClick:e,children:t,variant:n=`primary`,className:r=``,disabled:i=!1,type:a=`button`})=>(0,G.jsx)(`button`,{type:a,onClick:e,disabled:i,className:`px-4 py-2 rounded-xl font-medium transition-all duration-200 flex items-center gap-2 active:scale-95 justify-center ${{primary:`bg-blue-600 text-white hover:bg-blue-700 shadow-blue-200 shadow-md`,secondary:`bg-gray-100 text-gray-700 hover:bg-gray-200`,danger:`bg-red-50 text-red-600 hover:bg-red-100`,ghost:`hover:bg-gray-100 text-gray-600`,icon:`p-2 bg-transparent hover:bg-gray-100 text-gray-500 rounded-full`}[n]} ${i?`opacity-50 cursor-not-allowed`:``} ${r}`,children:t});var Ce=({state:e,setState:t,userEmail:n})=>{let[r,a]=(0,W.useState)(!1),[o,s]=(0,W.useState)({name:e.eventName,focus:e.focusDuration,break:e.breakDuration}),c=()=>{t(e=>({...e,isActive:!e.isActive}))},l=(n=e.mode)=>{let r=n===`focus`?e.focusDuration:e.breakDuration;t(e=>({...e,isActive:!1,mode:n,timeLeft:r*60}))},u=e=>{let{name:t,value:n}=e.target;s(e=>({...e,[t]:n}))};return r?(0,G.jsxs)(K,{className:`bg-white border border-gray-200`,children:[(0,G.jsxs)(`div`,{className:`flex justify-between items-center mb-4 border-b border-gray-100 pb-2`,children:[(0,G.jsxs)(`h3`,{className:`font-bold text-gray-700 flex items-center gap-2`,children:[(0,G.jsx)(R,{size:18}),` è®¾ç½®ç•ªèŒ„é’Ÿ`]}),(0,G.jsx)(`button`,{onClick:()=>a(!1),className:`text-gray-400 hover:text-gray-600`,children:(0,G.jsx)(z,{size:18})})]}),(0,G.jsxs)(`div`,{className:`space-y-3`,children:[(0,G.jsxs)(`div`,{children:[(0,G.jsx)(`label`,{className:`text-xs text-gray-500 font-medium block mb-1`,children:`ä»»åŠ¡åç§°`}),(0,G.jsx)(`input`,{type:`text`,name:`name`,value:o.name,onChange:u,className:`w-full p-2 text-sm border rounded-lg bg-gray-50 focus:bg-white focus:ring-2 focus:ring-blue-500 outline-none`})]}),(0,G.jsxs)(`div`,{className:`grid grid-cols-2 gap-3`,children:[(0,G.jsxs)(`div`,{children:[(0,G.jsx)(`label`,{className:`text-xs text-gray-500 font-medium block mb-1`,children:`ä¸“æ³¨ (åˆ†é’Ÿ)`}),(0,G.jsx)(`input`,{type:`number`,name:`focus`,min:`1`,max:`120`,value:o.focus,onChange:u,className:`w-full p-2 text-sm border rounded-lg bg-gray-50 focus:bg-white outline-none`})]}),(0,G.jsxs)(`div`,{children:[(0,G.jsx)(`label`,{className:`text-xs text-gray-500 font-medium block mb-1`,children:`ä¼‘æ¯ (åˆ†é’Ÿ)`}),(0,G.jsx)(`input`,{type:`number`,name:`break`,min:`1`,max:`60`,value:o.break,onChange:u,className:`w-full p-2 text-sm border rounded-lg bg-gray-50 focus:bg-white outline-none`})]})]}),n&&(0,G.jsxs)(`div`,{className:`text-[10px] text-gray-400 mt-2`,children:[`* è®¡æ—¶ç»“æŸå°†å‘é€é€šçŸ¥é‚®ä»¶è‡³ `,n]}),(0,G.jsxs)(q,{onClick:()=>{let e=parseInt(o.focus)||25,n=parseInt(o.break)||5,r=o.name||`æœªå‘½åä»»åŠ¡`;t(t=>({...t,eventName:r,focusDuration:e,breakDuration:n,timeLeft:!t.isActive&&t.mode===`focus`?e*60:!t.isActive&&t.mode===`break`?n*60:t.timeLeft})),a(!1)},className:`w-full mt-2 justify-center text-sm`,children:[`ä¿å­˜é…ç½® `,(0,G.jsx)(L,{size:16})]})]})]}):(0,G.jsxs)(K,{className:`transition-colors duration-500 border-none relative overflow-hidden ${e.mode===`focus`?`bg-gradient-to-br from-orange-400 to-red-500`:`bg-gradient-to-br from-teal-400 to-emerald-500`} text-white`,children:[(0,G.jsxs)(`div`,{className:`flex justify-between items-start mb-4 relative z-10`,children:[(0,G.jsxs)(`div`,{children:[(0,G.jsxs)(`h3`,{className:`text-white/90 font-medium flex items-center gap-2`,children:[e.mode===`focus`?(0,G.jsx)(U,{size:18}):(0,G.jsx)(m,{size:18}),e.eventName]}),(0,G.jsx)(`p`,{className:`text-[10px] text-white/70 mt-0.5`,children:e.mode===`focus`?`ä¸“æ³¨ ${e.focusDuration} åˆ†é’Ÿ`:`ä¼‘æ¯ ${e.breakDuration} åˆ†é’Ÿ`})]}),(0,G.jsx)(`div`,{className:`flex gap-2`,children:(0,G.jsx)(`button`,{onClick:()=>{s({name:e.eventName,focus:e.focusDuration,break:e.breakDuration}),a(!0)},className:`p-1.5 rounded-lg bg-white/20 hover:bg-white/30 text-white transition-colors`,title:`è®¾ç½®`,children:(0,G.jsx)(R,{size:14})})})]}),(0,G.jsx)(`div`,{className:`text-center mb-6 relative z-10`,children:(0,G.jsx)(`div`,{className:`text-6xl font-bold tracking-wider font-mono drop-shadow-sm`,children:(e=>{let t=Math.floor(e/60),n=e%60;return`${t.toString().padStart(2,`0`)}:${n.toString().padStart(2,`0`)}`})(e.timeLeft)})}),(0,G.jsxs)(`div`,{className:`flex justify-center items-center gap-6 relative z-10`,children:[(0,G.jsx)(q,{onClick:c,className:`bg-white hover:bg-gray-50 border-none w-16 h-16 !p-0 rounded-2xl shadow-xl transition-all hover:scale-105 active:scale-95 flex items-center justify-center ${e.mode===`focus`?`!text-orange-500`:`!text-teal-500`}`,children:e.isActive?(0,G.jsx)(i,{fill:`currentColor`,size:28}):(0,G.jsx)(be,{fill:`currentColor`,className:`ml-1`,size:28})}),(0,G.jsxs)(`div`,{className:`flex gap-2 bg-black/20 rounded-2xl p-1.5 backdrop-blur-sm`,children:[(0,G.jsx)(`button`,{onClick:()=>l(`focus`),className:`w-10 h-10 rounded-xl flex items-center justify-center transition-all ${e.mode===`focus`?`bg-white text-orange-500 shadow-sm`:`text-white/70 hover:bg-white/10`}`,title:`åˆ‡æ¢åˆ°ä¸“æ³¨`,children:(0,G.jsx)(U,{size:18})}),(0,G.jsx)(`button`,{onClick:()=>l(`break`),className:`w-10 h-10 rounded-xl flex items-center justify-center transition-all ${e.mode===`break`?`bg-white text-teal-500 shadow-sm`:`text-white/70 hover:bg-white/10`}`,title:`åˆ‡æ¢åˆ°ä¼‘æ¯`,children:(0,G.jsx)(m,{size:18})}),(0,G.jsx)(`button`,{onClick:()=>l(e.mode),className:`w-10 h-10 rounded-xl flex items-center justify-center text-white/70 hover:bg-white/10 hover:text-white transition-colors`,title:`é‡ç½®å½“å‰è®¡æ—¶`,children:(0,G.jsx)(D,{size:18})})]})]}),(0,G.jsx)(`div`,{className:`absolute -bottom-12 -left-12 w-40 h-40 border-4 border-white/10 rounded-full blur-sm`}),(0,G.jsx)(`div`,{className:`absolute top-10 -right-10 w-32 h-32 bg-white/10 rounded-full blur-xl`})]})},we=()=>{let[e,t]=(0,W.useState)({text:`åŠ è½½ä¸­...`,author:``}),[n,r]=(0,W.useState)(!1),i=async()=>{r(!0);try{let e=await(await fetch(`https://v1.hitokoto.cn/?c=d&c=i&c=k`)).json();t({text:e.hitokoto,author:e.from_who||e.from})}catch{t({text:`ç”Ÿæ´»æ˜æœ—ï¼Œä¸‡ç‰©å¯çˆ±ã€‚`,author:`ç½‘ç»œ`})}finally{r(!1)}};return(0,W.useEffect)(()=>{i()},[]),(0,G.jsxs)(K,{className:`bg-gradient-to-r from-indigo-500 to-purple-600 text-white border-none relative overflow-hidden group`,children:[(0,G.jsx)(`div`,{className:`absolute top-0 right-0 p-4 opacity-0 group-hover:opacity-100 transition-opacity`,children:(0,G.jsx)(`button`,{onClick:i,disabled:n,className:`hover:rotate-180 transition-transform duration-500`,children:(0,G.jsx)(ve,{size:18})})}),(0,G.jsxs)(`div`,{className:`relative z-10`,children:[(0,G.jsx)(xe,{size:24,className:`text-indigo-200 mb-2 opacity-50`}),(0,G.jsx)(`p`,{className:`text-lg font-medium leading-relaxed mb-3 font-serif`,children:e.text}),(0,G.jsxs)(`p`,{className:`text-right text-sm text-indigo-200`,children:[`â€”â€” `,e.author||`ä½šå`]})]}),(0,G.jsx)(`div`,{className:`absolute -bottom-10 -right-10 w-32 h-32 bg-white/10 rounded-full blur-2xl`})]})},Te=({count:e=200})=>{let t=(0,W.useRef)(),n=(0,W.useMemo)(()=>{let t=new Float32Array(e*3);for(let n=0;n<e;n++)t[n*3]=(Math.random()-.5)*10,t[n*3+1]=Math.random()*10,t[n*3+2]=(Math.random()-.5)*10;return t},[e]);return V((n,r)=>{if(!t.current)return;let i=t.current.geometry.attributes.position.array;for(let t=0;t<e;t++)i[t*3+1]-=r*8,i[t*3+1]<-2&&(i[t*3+1]=8);t.current.geometry.attributes.position.needsUpdate=!0}),(0,G.jsxs)(`points`,{ref:t,children:[(0,G.jsx)(`bufferGeometry`,{children:(0,G.jsx)(`bufferAttribute`,{attach:`attributes-position`,count:n.length/3,array:n,itemSize:3})}),(0,G.jsx)(`pointsMaterial`,{size:.05,color:`#aaaaff`,transparent:!0,opacity:.6})]})},Ee=({count:e=150})=>{let t=(0,W.useRef)(),n=(0,W.useMemo)(()=>{let t=new Float32Array(e*3);for(let n=0;n<e;n++)t[n*3]=(Math.random()-.5)*10,t[n*3+1]=Math.random()*10,t[n*3+2]=(Math.random()-.5)*10;return t},[e]);return V((n,r)=>{if(!t.current)return;let i=t.current.geometry.attributes.position.array;for(let t=0;t<e;t++)i[t*3+1]-=r*1.5,i[t*3]+=Math.sin(n.clock.elapsedTime+t)*.01,i[t*3+1]<-2&&(i[t*3+1]=8);t.current.geometry.attributes.position.needsUpdate=!0}),(0,G.jsxs)(`points`,{ref:t,children:[(0,G.jsx)(`bufferGeometry`,{children:(0,G.jsx)(`bufferAttribute`,{attach:`attributes-position`,count:n.length/3,array:n,itemSize:3})}),(0,G.jsx)(`pointsMaterial`,{size:.08,color:`#ffffff`,transparent:!0,opacity:.8})]})},De=({isFocus:e,isNight:t})=>{let n=e?`#FFD700`:t?`#333`:`#87CEEB`,r=e?`#FFA500`:`#000000`;return(0,G.jsxs)(`group`,{position:[0,.5,0],children:[(0,G.jsxs)(`mesh`,{position:[0,.5,0],children:[(0,G.jsx)(`boxGeometry`,{args:[1.2,1,1.2]}),(0,G.jsx)(`meshStandardMaterial`,{color:`#f5f5f5`})]}),(0,G.jsxs)(`mesh`,{position:[0,1.3,0],rotation:[0,Math.PI/4,0],children:[(0,G.jsx)(`coneGeometry`,{args:[1,.8,4]}),(0,G.jsx)(`meshStandardMaterial`,{color:`#e74c3c`})]}),(0,G.jsxs)(`mesh`,{position:[0,.6,.61],children:[(0,G.jsx)(`planeGeometry`,{args:[.4,.4]}),(0,G.jsx)(`meshStandardMaterial`,{color:n,emissive:r,emissiveIntensity:e?2:0})]}),(0,G.jsxs)(`mesh`,{position:[.3,.3,.61],children:[(0,G.jsx)(`planeGeometry`,{args:[.3,.6]}),(0,G.jsx)(`meshStandardMaterial`,{color:`#8B4513`})]})]})},J=({position:e})=>(0,G.jsxs)(`group`,{position:e,children:[(0,G.jsxs)(`mesh`,{position:[0,.4,0],children:[(0,G.jsx)(`cylinderGeometry`,{args:[.1,.15,.8]}),(0,G.jsx)(`meshStandardMaterial`,{color:`#8B4513`})]}),(0,G.jsxs)(`mesh`,{position:[0,1,0],children:[(0,G.jsx)(`dodecahedronGeometry`,{args:[.5]}),(0,G.jsx)(`meshStandardMaterial`,{color:`#228B22`})]})]}),Oe=({weatherCode:e,isDay:t,isFocus:n})=>{let r=[51,53,55,61,63,65,80,81,82,95,96,99].includes(e),i=[71,73,75,77,85,86].includes(e),a=[1,2,3,45,48].includes(e)||r||i,o=n?`#1a1a2e`:t?r?`#8899a6`:`#87CEEB`:`#0f172a`,s=n?.2:t?.6:.2,c=n?0:t?1:.2;return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(`color`,{attach:`background`,args:[o]}),(0,G.jsx)(O,{enableZoom:!1,enablePan:!1,autoRotate:!n,autoRotateSpeed:.5,minPolarAngle:Math.PI/4,maxPolarAngle:Math.PI/2.2}),(0,G.jsx)(`ambientLight`,{intensity:s}),(0,G.jsx)(`directionalLight`,{position:[5,10,5],intensity:c,castShadow:!0}),n&&(0,G.jsx)(`spotLight`,{position:[0,5,2],angle:.3,penumbra:.5,intensity:5,castShadow:!0,color:`#ffd700`}),r&&(0,G.jsx)(Te,{}),i&&(0,G.jsx)(Ee,{}),!t&&!n&&(0,G.jsx)(fe,{radius:100,depth:50,count:5e3,factor:4,saturation:0,fade:!0,speed:1}),(0,G.jsx)(te,{speed:2,rotationIntensity:.2,floatIntensity:.5,children:(0,G.jsxs)(`group`,{children:[(0,G.jsxs)(`mesh`,{receiveShadow:!0,position:[0,-.2,0],children:[(0,G.jsx)(`cylinderGeometry`,{args:[4,4,.4,32]}),(0,G.jsx)(`meshStandardMaterial`,{color:i?`#eeeeee`:`#4ade80`})]}),(0,G.jsx)(De,{isFocus:n,isNight:!t}),(0,G.jsx)(J,{position:[-1.5,.2,.5]}),(0,G.jsx)(J,{position:[1.8,.2,-1]}),(0,G.jsx)(J,{position:[-1,.2,-2]}),n&&(0,G.jsx)(he,{count:50,scale:4,size:4,speed:.4,opacity:.5,color:`#FFFF00`})]})}),(a||n)&&(0,G.jsx)(`group`,{position:[0,3,0],children:(0,G.jsx)(oe,{opacity:.5,speed:.4,width:5,depth:1.5,segments:10,color:n?`#333`:`#fff`})})]})},ke=({weather:e,pomoState:t})=>{let n=t.isActive&&t.mode===`focus`,r=e?.current?.weather_code??0;return(0,G.jsxs)(`div`,{className:`w-full h-full min-h-[240px] relative rounded-2xl overflow-hidden shadow-inner bg-gray-900 transition-all duration-1000`,children:[(0,G.jsx)(ce,{shadows:!0,camera:{position:[0,2,7],fov:45},children:(0,G.jsx)(Oe,{weatherCode:r,isDay:e?.current?.is_day===1,isFocus:n})}),(0,G.jsxs)(`div`,{className:`absolute top-4 left-4 z-10 text-white drop-shadow-md pointer-events-none`,children:[(0,G.jsxs)(`h2`,{className:`text-3xl font-bold font-mono`,children:[e?.current?.temperature_2m??`--`,`Â°`]}),(0,G.jsx)(`p`,{className:`text-sm opacity-90`,children:n?`æ­£åœ¨ä¸“æ³¨...`:r===0?`æ™´æœ—`:r>50?`æœ‰é›¨/é›ª`:`å¤šynäº‘`})]}),n&&(0,G.jsx)(`div`,{className:`absolute bottom-4 right-4 z-10 bg-black/30 backdrop-blur-md px-3 py-1 rounded-full text-yellow-300 text-xs border border-yellow-300/30`,children:`ğŸ”¥ Focus Mode Active`})]})},Ae=({weather:e,settings:t,announcements:n,user:r,onDelete:i,onPost:a,newAnnouncement:o,setNewAnnouncement:s,onOpenAuth:c,pomoState:l,setPomoState:u})=>{let d=e=>{if(!e)return 0;let t=new Date(e)-new Date,n=Math.ceil(t/(1e3*60*60*24));return n>0?n:0};return(0,G.jsxs)(`div`,{className:`grid grid-cols-1 lg:grid-cols-3 gap-6 animate-fade-in`,children:[(0,G.jsxs)(`div`,{className:`space-y-6`,children:[(0,G.jsxs)(`div`,{className:`bg-white/80 backdrop-blur-md rounded-2xl shadow-lg border border-white/20 overflow-hidden h-64 lg:h-72`,children:[(0,G.jsx)(ke,{weather:e,pomoState:l}),(0,G.jsxs)(`div`,{className:`absolute top-4 right-4 z-10 bg-black/20 backdrop-blur-sm px-2 py-1 rounded-lg text-white text-xs flex items-center gap-1`,children:[(0,G.jsx)(ye,{size:10}),` `,t.city]})]}),(0,G.jsx)(Ce,{state:l,setState:u,userEmail:t.emailAddress})]}),(0,G.jsxs)(`div`,{className:`space-y-6`,children:[(0,G.jsx)(we,{}),(0,G.jsx)(`div`,{className:`space-y-4`,children:t.events&&t.events.length>0?t.events.map((e,t)=>(0,G.jsx)(K,{className:`bg-white border-l-4 border-purple-500 relative overflow-hidden group hover:shadow-md transition-all py-4`,children:(0,G.jsxs)(`div`,{className:`flex justify-between items-center relative z-10`,children:[(0,G.jsxs)(`div`,{children:[(0,G.jsx)(`h3`,{className:`text-gray-700 font-bold flex items-center gap-2`,children:e.name}),(0,G.jsxs)(`span`,{className:`text-xs text-gray-400`,children:[`ç›®æ ‡æ—¥: `,e.date]})]}),(0,G.jsxs)(`div`,{className:`text-right`,children:[(0,G.jsx)(`span`,{className:`text-2xl font-bold text-purple-600`,children:d(e.date)}),(0,G.jsx)(`span`,{className:`text-xs text-gray-400 ml-1`,children:`å¤©`})]})]})},t)):(0,G.jsxs)(K,{className:`bg-white text-gray-400 border-dashed border-2 flex flex-col items-center justify-center py-8`,children:[(0,G.jsx)(y,{size:32,className:`mb-2 opacity-50`}),(0,G.jsx)(`p`,{children:`æš‚æ— å€’æ•°æ—¥`})]})})]}),(0,G.jsx)(`div`,{className:`lg:col-span-1`,children:(0,G.jsxs)(K,{className:`h-full flex flex-col min-h-[400px]`,children:[(0,G.jsx)(`div`,{className:`flex justify-between items-center mb-4`,children:(0,G.jsxs)(`h2`,{className:`text-xl font-bold text-gray-800 flex items-center gap-2`,children:[(0,G.jsx)(C,{className:`text-blue-500`}),` å…¬å‘Šæ `]})}),(0,G.jsx)(`div`,{className:`flex-1 overflow-y-auto space-y-3 pr-2 max-h-[600px] custom-scrollbar`,children:n.map(e=>(0,G.jsxs)(`div`,{className:`group p-3 rounded-xl bg-gray-50 hover:bg-blue-50 transition-colors border border-gray-100`,children:[(0,G.jsxs)(`div`,{className:`flex justify-between items-start`,children:[(0,G.jsx)(`p`,{className:`text-gray-700 text-sm whitespace-pre-wrap break-words`,children:e.text}),r&&e.uid===r.uid&&(0,G.jsx)(`button`,{onClick:()=>i(e.id),className:`text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity ml-2`,children:(0,G.jsx)(N,{size:14})})]}),(0,G.jsxs)(`div`,{className:`mt-2 flex justify-between items-center`,children:[(0,G.jsx)(`span`,{className:`text-[10px] text-gray-400`,children:e.createdAt?.seconds?new Date(e.createdAt.seconds*1e3).toLocaleDateString():`åˆšåˆš`}),e.author&&(0,G.jsxs)(`span`,{className:`text-[10px] font-medium text-blue-500`,children:[`@`,e.author]})]})]},e.id))}),(0,G.jsx)(`div`,{className:`mt-4 pt-4 border-t border-gray-100`,children:r?(0,G.jsxs)(`div`,{className:`flex gap-2`,children:[(0,G.jsx)(`input`,{type:`text`,value:o,onChange:e=>s(e.target.value),placeholder:`å‘å¸ƒæ–°åŠ¨æ€...`,className:`flex-1 bg-gray-100 border-none rounded-xl px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 outline-none transition-all`,onKeyDown:e=>e.key===`Enter`&&a()}),(0,G.jsx)(q,{onClick:a,className:`!px-3`,children:(0,G.jsx)(A,{size:18})})]}):(0,G.jsx)(q,{variant:`secondary`,onClick:c,className:`w-full justify-center text-sm`,children:`ç™»å½•ä»¥å‘å¸ƒå…¬å‘Š`})})]})})]})},Y=[{name:`åŒ—äº¬ (Beijing)`,value:`Beijing`,lat:39.9042,lon:116.4074},{name:`ä¸Šæµ· (Shanghai)`,value:`Shanghai`,lat:31.2304,lon:121.4737},{name:`å¹¿å· (Guangzhou)`,value:`Guangzhou`,lat:23.1291,lon:113.2644},{name:`æ·±åœ³ (Shenzhen)`,value:`Shenzhen`,lat:22.5431,lon:114.0579},{name:`æ­å· (Hangzhou)`,value:`Hangzhou`,lat:30.2748,lon:120.1551}],je=({user:e,onOpenAuth:t,settings:n,setSettings:r,onSave:i,loading:o})=>{let[s,c]=(0,W.useState)({name:``,date:``}),l=()=>{if(!s.name||!s.date)return;let e=[...n.events||[],s];r({...n,events:e}),c({name:``,date:``})},u=e=>{let t=n.events.filter((t,n)=>n!==e);r({...n,events:t})};return(0,G.jsx)(`div`,{className:`max-w-2xl mx-auto animate-fade-in`,children:(0,G.jsxs)(K,{children:[(0,G.jsxs)(`h2`,{className:`text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2`,children:[(0,G.jsx)(B,{className:`text-blue-500`}),` è‡ªåŠ¨åŒ–è®¾ç½®`]}),e?(0,G.jsxs)(`div`,{className:`space-y-8`,children:[(0,G.jsxs)(`div`,{className:`bg-blue-50 p-4 rounded-xl text-sm text-blue-700 flex gap-2`,children:[(0,G.jsx)(a,{className:`shrink-0`,size:18}),`æ­¤å¤„ä¿å­˜çš„è®¾ç½®å°†ç”¨äº GitHub Actions æ¯æ—¥é‚®ä»¶æ¨é€ã€‚`]}),(0,G.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 gap-6`,children:[(0,G.jsxs)(`div`,{children:[(0,G.jsx)(`label`,{className:`block text-sm font-medium text-gray-700 mb-1`,children:`æ‰€åœ¨åŸå¸‚`}),(0,G.jsx)(`div`,{className:`relative`,children:(0,G.jsx)(`select`,{value:n.city,onChange:e=>{let t=Y.find(t=>t.value===e.target.value);t&&r({...n,city:t.value,latitude:t.lat,longitude:t.lon})},className:`w-full p-2 pl-3 pr-8 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 outline-none appearance-none bg-white`,children:Y.map(e=>(0,G.jsx)(`option`,{value:e.value,children:e.name},e.value))})})]}),(0,G.jsxs)(`div`,{children:[(0,G.jsx)(`label`,{className:`block text-sm font-medium text-gray-700 mb-1`,children:`æ¥æ”¶é‚®ç®±`}),(0,G.jsx)(`input`,{type:`email`,value:n.emailAddress,onChange:e=>r({...n,emailAddress:e.target.value}),className:`w-full p-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 outline-none`})]})]}),(0,G.jsxs)(`div`,{className:`space-y-4 border-t border-gray-100 pt-4`,children:[(0,G.jsxs)(`h3`,{className:`font-medium text-gray-900 flex items-center gap-2`,children:[(0,G.jsx)(y,{size:18}),` å€’æ•°æ—¥äº‹ä»¶ç®¡ç†`]}),(0,G.jsx)(`div`,{className:`space-y-2 mb-4`,children:n.events&&n.events.map((e,t)=>(0,G.jsxs)(`div`,{className:`flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200`,children:[(0,G.jsxs)(`div`,{children:[(0,G.jsx)(`span`,{className:`font-medium text-gray-800`,children:e.name}),(0,G.jsx)(`span`,{className:`mx-2 text-gray-300`,children:`|`}),(0,G.jsx)(`span`,{className:`text-sm text-gray-500`,children:e.date})]}),(0,G.jsx)(`button`,{onClick:()=>u(t),className:`text-gray-400 hover:text-red-500 p-1`,children:(0,G.jsx)(z,{size:16})})]},t))}),(0,G.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-5 gap-2 bg-gray-50 p-3 rounded-xl`,children:[(0,G.jsx)(`div`,{className:`md:col-span-2`,children:(0,G.jsx)(`input`,{type:`text`,placeholder:`äº‹ä»¶åç§°`,value:s.name,onChange:e=>c({...s,name:e.target.value}),className:`w-full p-2 rounded-lg border border-gray-300 text-sm`})}),(0,G.jsx)(`div`,{className:`md:col-span-2`,children:(0,G.jsx)(`input`,{type:`date`,value:s.date,onChange:e=>c({...s,date:e.target.value}),className:`w-full p-2 rounded-lg border border-gray-300 text-sm`})}),(0,G.jsx)(`div`,{className:`md:col-span-1`,children:(0,G.jsx)(q,{onClick:l,variant:`secondary`,className:`w-full h-full`,disabled:!s.name||!s.date,children:`æ·»åŠ `})})]})]}),(0,G.jsx)(`div`,{className:`pt-4`,children:(0,G.jsxs)(q,{onClick:i,disabled:o,className:`w-full justify-center h-12 text-lg`,children:[o?`ä¿å­˜ä¸­...`:`ä¿å­˜æ‰€æœ‰è®¾ç½®`,` `,(0,G.jsx)(L,{size:20})]})})]}):(0,G.jsxs)(`div`,{className:`text-center py-10`,children:[(0,G.jsx)(`p`,{className:`text-gray-500 mb-4`,children:`è¯·å…ˆç™»å½•ä»¥åŒæ­¥æ‚¨çš„åå¥½è®¾ç½®åˆ°äº‘ç«¯ã€‚`}),(0,G.jsx)(q,{onClick:t,className:`mx-auto`,children:`ç«‹å³ç™»å½•`})]})]})})},Me=({isOpen:e,onClose:t,onGoogleLogin:n,auth:r})=>{let[i,a]=(0,W.useState)(!1),[o,s]=(0,W.useState)(``),[c,l]=(0,W.useState)(``),[u,d]=(0,W.useState)(``),[f,p]=(0,W.useState)(``),[m,h]=(0,W.useState)(!1);return e?(0,G.jsx)(`div`,{className:`fixed inset-0 z-[60] flex items-center justify-center bg-black/40 backdrop-blur-sm p-4 animate-fade-in`,children:(0,G.jsxs)(`div`,{className:`bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden`,onClick:e=>e.stopPropagation(),children:[(0,G.jsxs)(`div`,{className:`bg-blue-600 p-6 text-white flex justify-between items-center`,children:[(0,G.jsx)(`div`,{children:(0,G.jsx)(`h2`,{className:`text-2xl font-bold`,children:i?`åˆ›å»ºè´¦æˆ·`:`æ¬¢è¿å›æ¥`})}),(0,G.jsx)(`button`,{onClick:t,className:`text-white/80 hover:text-white`,children:(0,G.jsx)(z,{size:24})})]}),(0,G.jsxs)(`div`,{className:`p-8`,children:[f&&(0,G.jsx)(`div`,{className:`text-red-500 mb-4 text-sm`,children:f}),(0,G.jsxs)(`form`,{onSubmit:async e=>{e.preventDefault(),p(``),h(!0);try{if(!r)throw Error(`Firebase æœªåˆå§‹åŒ–`);i?await M((await se(r,o,c)).user,{displayName:u}):await k(r,o,c),t()}catch(e){console.error(`Auth Error:`,e);let t=`æ“ä½œå¤±è´¥ï¼Œè¯·é‡è¯•`;e.code===`auth/email-already-in-use`?t=`è¯¥é‚®ç®±å·²è¢«æ³¨å†Œ`:e.code===`auth/invalid-email`?t=`é‚®ç®±æ ¼å¼ä¸æ­£ç¡®`:e.code===`auth/user-not-found`||e.code===`auth/invalid-credential`?t=`è´¦å·æˆ–å¯†ç é”™è¯¯`:e.code===`auth/wrong-password`&&(t=`å¯†ç é”™è¯¯`),p(t)}finally{h(!1)}},className:`space-y-4`,children:[i&&(0,G.jsx)(`input`,{type:`text`,placeholder:`æ˜µç§°`,className:`w-full p-2 border rounded-xl`,value:u,onChange:e=>d(e.target.value),required:!0}),(0,G.jsx)(`input`,{type:`email`,placeholder:`é‚®ç®±`,className:`w-full p-2 border rounded-xl`,value:o,onChange:e=>s(e.target.value),required:!0}),(0,G.jsx)(`input`,{type:`password`,placeholder:`å¯†ç `,className:`w-full p-2 border rounded-xl`,value:c,onChange:e=>l(e.target.value),required:!0}),(0,G.jsx)(q,{type:`submit`,className:`w-full h-12`,disabled:m,children:m?`...`:i?`æ³¨å†Œ`:`ç™»å½•`})]}),(0,G.jsx)(q,{variant:`secondary`,onClick:n,className:`w-full mt-4`,children:`Google ç™»å½•`}),(0,G.jsx)(`div`,{className:`text-center mt-4 text-sm`,children:(0,G.jsx)(`button`,{onClick:()=>a(!i),className:`text-blue-600 font-bold`,children:i?`å·²æœ‰è´¦å·ï¼Ÿå»ç™»å½•`:`æ²¡æœ‰è´¦å·ï¼Ÿå»æ³¨å†Œ`})})]})]})}):null},Ne=({onSave:e,onCancel:t,initialData:r=null})=>{let[i,a]=(0,W.useState)(r?.title||``),o=(0,W.useRef)(null),[s,c]=(0,W.useState)(!1),[l,u]=(0,W.useState)(0),[d,f]=(0,W.useState)(!1),[p,m]=(0,W.useState)(!1);(0,W.useEffect)(()=>{r?.content&&o.current?o.current.innerHTML=r.content:o.current&&o.current.innerHTML===``&&(o.current.innerHTML=`<p><br/></p>`)},[r]);let _=()=>{let e=window.getSelection();if(!e.rangeCount)return;let t=e.anchorNode;for(t&&t.nodeType===3&&(t=t.parentNode);t&&t.parentNode&&t.parentNode!==o.current;)t=t.parentNode;if(t&&o.current.contains(t)){let e=t.offsetTop;u(e),m(!0)}else m(!1),f(!1)},v=(e,t=null)=>{o.current&&o.current.focus(),document.execCommand(e,!1,t),_(),f(!1)};return(0,G.jsxs)(`div`,{className:`flex flex-col h-full animate-fade-in relative`,children:[(0,G.jsxs)(`div`,{className:`flex justify-between items-center mb-2 bg-white/80 backdrop-blur-sm p-4 rounded-xl border border-gray-200 sticky top-0 z-30 shadow-sm`,children:[(0,G.jsx)(`input`,{type:`text`,placeholder:`æ— æ ‡é¢˜æ–‡ç« `,className:`text-2xl font-bold bg-transparent border-none focus:ring-0 text-gray-800 placeholder-gray-300 flex-1 min-w-0`,value:i,onChange:e=>a(e.target.value)}),(0,G.jsxs)(`div`,{className:`flex gap-2`,children:[(0,G.jsx)(q,{variant:`secondary`,onClick:t,children:`å–æ¶ˆ`}),(0,G.jsxs)(q,{onClick:()=>{if(!i.trim())return alert(`è¯·è¾“å…¥æ–‡ç« æ ‡é¢˜`);let t=o.current.innerHTML;if(!t.trim())return alert(`è¯·è¾“å…¥æ–‡ç« å†…å®¹`);c(!0),e({title:i,content:t}),c(!1)},disabled:s,children:[s?`å‘å¸ƒä¸­...`:`å‘å¸ƒ`,` `,(0,G.jsx)(L,{size:16})]})]})]}),(0,G.jsxs)(K,{className:`flex-1 flex flex-col min-h-[500px] overflow-hidden !p-0 relative`,children:[(0,G.jsxs)(`div`,{className:`relative flex-1 overflow-y-auto custom-scrollbar`,onClick:e=>{if(e.target===o.current){let t=o.current.lastElementChild;if((!t||t.tagName!==`P`||t.innerText.trim()!==``)&&t){let n=t.getBoundingClientRect();if(e.clientY>n.bottom){let e=document.createElement(`p`);e.innerHTML=`<br/>`,o.current.appendChild(e);let t=document.createRange(),n=window.getSelection();t.setStart(e,0),t.collapse(!0),n.removeAllRanges(),n.addRange(t)}}}_()},children:[p&&(0,G.jsx)(`div`,{className:`absolute left-4 md:left-10 z-20 transition-all duration-100 flex items-center`,style:{top:l+4},children:(0,G.jsxs)(`div`,{className:`relative group`,onMouseEnter:()=>f(!0),onMouseLeave:()=>setTimeout(()=>!document.querySelector(`.floating-menu:hover`)&&f(!1),300),children:[(0,G.jsx)(`button`,{className:`p-1 rounded-md text-gray-400 hover:text-blue-600 hover:bg-blue-50 transition-colors`,title:`æ·»åŠ å†…å®¹`,children:(0,G.jsx)(A,{size:20})}),(d||!1)&&(0,G.jsxs)(`div`,{className:`floating-menu absolute left-8 top-[-10px] bg-white shadow-xl border border-gray-100 rounded-xl p-2 flex gap-1 animate-fade-in z-50 min-w-[320px]`,onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),children:[(0,G.jsx)(X,{onClick:()=>v(`formatBlock`,`H1`),icon:re,label:`å¤§æ ‡é¢˜`}),(0,G.jsx)(X,{onClick:()=>v(`formatBlock`,`H2`),icon:n,label:`ä¸­æ ‡é¢˜`}),(0,G.jsx)(X,{onClick:()=>v(`formatBlock`,`H3`),icon:ie,label:`å°æ ‡é¢˜`}),(0,G.jsx)(`div`,{className:`w-px bg-gray-200 mx-1`}),(0,G.jsx)(X,{onClick:()=>v(`formatBlock`,`P`),icon:b,label:`æ­£æ–‡`}),(0,G.jsx)(X,{onClick:()=>{let e=Date.now();v(`insertHTML`,`
      <div class="my-4 relative group">
        <pre class="bg-gray-100 text-gray-800 p-4 rounded-lg border-l-4 border-blue-500 font-mono text-sm overflow-x-auto shadow-sm"><code>åœ¨æ­¤å¤„è¾“å…¥ä»£ç ...</code></pre>
      </div>
      <p id="cursor-target-${e}"><br/></p> 
    `),setTimeout(()=>{let t=document.getElementById(`cursor-target-${e}`);if(t){let e=document.createRange(),n=window.getSelection();e.setStart(t,0),e.collapse(!0),n.removeAllRanges(),n.addRange(e),t.removeAttribute(`id`)}},10)},icon:h,label:`ä»£ç `}),(0,G.jsx)(X,{onClick:()=>{let e=prompt(`è¯·è¾“å…¥å›¾ç‰‡é“¾æ¥ (URL):`);if(e){let t=prompt(`è¯·è¾“å…¥å›¾ç‰‡å¤‡æ³¨ (å¯é€‰):`)||``;v(`insertHTML`,`
        <div class="my-6 text-center group">
          <img src="${e}" class="max-w-full h-auto rounded-lg shadow-md mx-auto" />
          ${t?`<p class="text-gray-500 text-xs mt-2 italic">${t}</p>`:``}
        </div>
        <p><br/></p>
      `)}},icon:g,label:`å›¾ç‰‡`})]})]})}),(0,G.jsx)(`div`,{ref:o,contentEditable:!0,className:`min-h-[500px] p-8 pl-16 md:pl-24 pr-8 outline-none prose prose-blue max-w-none custom-blog-content`,onKeyUp:_,onMouseUp:_,onClick:_,onInput:_,onKeyDown:e=>{e.key===`Tab`&&(e.preventDefault(),document.execCommand(`insertText`,!1,`    `))}})]}),(0,G.jsx)(`div`,{className:`p-2 text-center text-xs text-gray-400 bg-gray-50 border-t border-gray-100`,children:`æ‚¬åœå·¦ä¾§ â€œ+â€ å·ä»¥åˆ‡æ¢æ ¼å¼ | ç‚¹å‡»åº•éƒ¨ç©ºç™½å¤„å¯æ·»åŠ æ–°è¡Œ`})]})]})},X=({onClick:e,icon:t,label:n})=>(0,G.jsxs)(`button`,{onMouseDown:t=>{t.preventDefault(),e()},className:`flex flex-col items-center justify-center p-2 hover:bg-blue-50 rounded-lg text-gray-600 hover:text-blue-600 transition-colors w-12 h-12`,title:n,children:[(0,G.jsx)(t,{size:18}),(0,G.jsx)(`span`,{className:`text-[10px] mt-1 font-medium`,children:n})]}),Pe=Ne,Z=new Set(`çš„.äº†.åœ¨.æ˜¯.æˆ‘.æœ‰.å’Œ.å°±.ä¸.äºº.éƒ½.ä¸€.ä¸€ä¸ª.ä¸Š.ä¹Ÿ.å¾ˆ.åˆ°.è¯´.è¦.å».ä½ .ä¼š.ç€.æ²¡æœ‰.çœ‹.å¥½.è‡ªå·±.è¿™.the.and.is.of.to.a.in.that.it.for.on.with.as.this.was.at.by.an.be.or.from`.split(`.`)),Fe=[`text-blue-500`,`text-indigo-500`,`text-purple-500`,`text-pink-500`,`text-rose-500`,`text-orange-500`,`text-emerald-500`,`text-teal-500`],Ie=({isOpen:e,onClose:t,posts:n})=>{if(!e)return null;let r=(0,W.useMemo)(()=>{let e=n.map(e=>{let t=document.createElement(`div`);return t.innerHTML=e.content,t.textContent||t.innerText||``}).join(` `),t={};(e.match(/[a-zA-Z]{2,}/g)||[]).forEach(e=>{let n=e.toLowerCase();Z.has(n)||(t[n]=(t[n]||0)+1)});let r=e.replace(/[a-zA-Z0-9\s\p{P}]+/gu,``);for(let e=0;e<r.length-1;e++){let n=r.substr(e,2);!Z.has(n[0])&&!Z.has(n[1])&&(t[n]=(t[n]||0)+1)}let i=Object.entries(t).sort((e,t)=>t[1]-e[1]).slice(0,50);if(i.length===0)return[];let a=i[0][1],o=i[i.length-1][1];return i.map(([e,t])=>{let n=a===o?16:12+(t-o)/(a-o)*24;return{text:e,count:t,fontSize:Math.round(n),color:Fe[Math.floor(Math.random()*Fe.length)],rotation:Math.random()>.8?-10+Math.random()*20:0}})},[n]);return(0,G.jsx)(`div`,{className:`fixed inset-0 z-[70] flex items-center justify-center bg-black/30 backdrop-blur-sm p-4 animate-fade-in`,onClick:t,children:(0,G.jsxs)(`div`,{className:`bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden flex flex-col max-h-[80vh]`,onClick:e=>e.stopPropagation(),children:[(0,G.jsxs)(`div`,{className:`flex justify-between items-center p-6 border-b border-gray-100`,children:[(0,G.jsxs)(`h2`,{className:`text-xl font-bold text-gray-800 flex items-center gap-2`,children:[(0,G.jsx)(_,{className:`text-blue-500`}),` åšå®¢è¯äº‘`]}),(0,G.jsx)(`button`,{onClick:t,className:`text-gray-400 hover:text-gray-600 transition-colors`,children:(0,G.jsx)(z,{size:24})})]}),(0,G.jsx)(`div`,{className:`p-8 overflow-y-auto bg-gray-50 flex-1`,children:r.length>0?(0,G.jsx)(`div`,{className:`flex flex-wrap justify-center items-center content-center gap-4 min-h-[300px]`,children:r.map((e,t)=>(0,G.jsx)(`span`,{className:`${e.color} font-bold cursor-default transition-all duration-300 hover:scale-110 hover:opacity-80`,style:{fontSize:`${e.fontSize}px`,transform:`rotate(${e.rotation}deg)`,padding:`4px`},title:`å‡ºç° ${e.count} æ¬¡`,children:e.text},t))}):(0,G.jsxs)(`div`,{className:`flex flex-col items-center justify-center h-64 text-gray-400`,children:[(0,G.jsx)(_,{size:64,className:`mb-4 opacity-20`}),(0,G.jsx)(`p`,{children:`æ–‡ç« å†…å®¹å¤ªå°‘ï¼Œæš‚æ— æ³•ç”Ÿæˆè¯äº‘`})]})}),(0,G.jsx)(`div`,{className:`bg-gray-50 p-4 text-center text-xs text-gray-400 border-t border-gray-100`,children:`åŸºäºæ–‡ç« å†…å®¹è‡ªåŠ¨ç”Ÿæˆçš„å…³é”®è¯ç»Ÿè®¡`})]})})},Le=({db:e,user:t,onOpenAuth:n})=>{let[i,a]=(0,W.useState)([]),[o,d]=(0,W.useState)(null),[m,h]=(0,W.useState)(`list`),[g,b]=(0,W.useState)({}),[x,C]=(0,W.useState)(!1);(0,W.useEffect)(()=>{if(!e)return;let t=T(v(w(e,`posts`),ee(`createdAt`,`desc`)),e=>{let t=e.docs.map(e=>({id:e.id,...e.data()}));if(a(t),t.length>0){let e=t[0].createdAt?.seconds?new Date(t[0].createdAt.seconds*1e3):new Date;b(t=>({...t,[e.getFullYear()]:!0}))}});return()=>t()},[e]);let E=(0,W.useMemo)(()=>{let e={};return i.forEach(t=>{let n=t.createdAt?.seconds?new Date(t.createdAt.seconds*1e3):new Date,r=n.getFullYear(),i=n.getMonth()+1;e[r]||(e[r]={}),e[r][i]||(e[r][i]=[]),e[r][i].push(t)}),e},[i]),D=e=>{b(t=>({...t,[e]:!t[e]}))},O=e=>{if(!e)return`æš‚æ— å†…å®¹`;let t=document.createElement(`DIV`);t.innerHTML=e;let n=t.textContent||t.innerText||``;return n.slice(0,120)+(n.length>120?`...`:``)},k=e=>{d(e),h(`read`)},j=()=>{d(null),h(`edit`)},M=()=>{d(null),h(`list`)},P=async({title:n,content:r})=>{if(t)try{let i={title:n,content:r,authorId:t.uid,authorName:t.displayName||`åŒ¿å`,updatedAt:new Date};o&&o.id&&m===`edit`&&o.authorId===t.uid?(await F(f(e,`posts`,o.id),i),d({...o,...i})):d({id:(await S(w(e,`posts`),{...i,createdAt:new Date})).id,...i,createdAt:{seconds:Date.now()/1e3}}),h(`read`)}catch(e){console.error(`ä¿å­˜å¤±è´¥:`,e),alert(`ä¿å­˜å¤±è´¥: `+e.message)}},I=async(t,n)=>{if(n?.stopPropagation(),window.confirm(`ç¡®å®šè¦åˆ é™¤è¿™ç¯‡æ–‡ç« å—ï¼Ÿ`))try{await c(f(e,`posts`,t)),o?.id===t&&(d(null),h(`list`))}catch{alert(`åˆ é™¤å¤±è´¥`)}};return(0,G.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-4 gap-6 min-h-[calc(100vh-140px)] animate-fade-in`,children:[(0,G.jsx)(Ie,{isOpen:x,onClose:()=>C(!1),posts:i}),(0,G.jsxs)(K,{className:`md:col-span-1 h-full overflow-y-auto max-h-[calc(100vh-140px)] flex flex-col`,children:[(0,G.jsxs)(`div`,{className:`flex justify-between items-center mb-4 border-b border-gray-100 pb-2`,children:[(0,G.jsxs)(`h3`,{className:`font-bold text-gray-700 flex items-center gap-2 cursor-pointer hover:text-blue-600 transition-colors`,onClick:M,children:[(0,G.jsx)(r,{size:18,className:`text-blue-500`}),` åšå®¢å½’æ¡£`]}),t&&m!==`edit`&&(0,G.jsx)(q,{variant:`icon`,onClick:j,title:`å†™æ–°æ–‡ç« `,children:(0,G.jsx)(A,{size:20,className:`text-blue-600`})})]}),(0,G.jsxs)(`div`,{className:`space-y-2 flex-1 custom-scrollbar`,children:[Object.keys(E).sort((e,t)=>t-e).map(e=>(0,G.jsxs)(`div`,{className:`select-none`,children:[(0,G.jsxs)(`div`,{className:`flex items-center gap-2 font-bold text-gray-500 hover:text-blue-600 cursor-pointer py-1`,onClick:()=>D(e),children:[g[e]?(0,G.jsx)(p,{size:14}):(0,G.jsx)(u,{size:14}),(0,G.jsxs)(`span`,{children:[e,`å¹´`]})]}),g[e]&&(0,G.jsx)(`div`,{className:`ml-2 border-l border-gray-200 pl-2 space-y-2 mt-1 animate-fade-in`,children:Object.keys(E[e]).sort((e,t)=>t-e).map(n=>(0,G.jsxs)(`div`,{children:[(0,G.jsxs)(`div`,{className:`text-xs font-medium text-gray-400 mb-1 ml-2`,children:[n,`æœˆ`]}),(0,G.jsx)(`div`,{className:`space-y-1`,children:E[e][n].map(e=>(0,G.jsxs)(`div`,{onClick:()=>k(e),className:`text-sm py-2 px-3 rounded-lg cursor-pointer transition-colors truncate group flex justify-between items-center ${o?.id===e.id&&m!==`list`?`bg-blue-50 text-blue-700 font-medium`:`text-gray-600 hover:bg-gray-50`}`,children:[(0,G.jsx)(`span`,{className:`truncate`,children:e.title}),t&&t.uid===e.authorId&&(0,G.jsx)(`span`,{onClick:t=>I(e.id,t),className:`opacity-0 group-hover:opacity-100 hover:text-red-500 transition-opacity p-1`,children:(0,G.jsx)(N,{size:12})})]},e.id))})]},n))})]},e)),i.length===0&&(0,G.jsx)(`div`,{className:`text-sm text-gray-400 text-center py-4`,children:`æš‚æ— æ–‡ç« `})]})]}),(0,G.jsxs)(`div`,{className:`md:col-span-3 h-full`,children:[m===`list`&&(0,G.jsxs)(`div`,{className:`space-y-6 animate-fade-in`,children:[(0,G.jsxs)(`div`,{className:`flex justify-between items-center`,children:[(0,G.jsx)(`h2`,{className:`text-2xl font-bold text-gray-800`,children:`æœ€æ–°æ–‡ç« `}),(0,G.jsxs)(`div`,{className:`flex gap-2`,children:[(0,G.jsxs)(q,{variant:`secondary`,onClick:()=>C(!0),className:`text-sm`,children:[(0,G.jsx)(_,{size:16}),` å…³é”®è¯äº‘`]}),t&&(0,G.jsxs)(q,{onClick:j,children:[(0,G.jsx)(A,{size:16}),` å†™æ–‡ç« `]})]})]}),(0,G.jsxs)(`div`,{className:`grid grid-cols-1 gap-4`,children:[i.map(e=>(0,G.jsx)(K,{className:`hover:shadow-md transition-shadow cursor-pointer group border border-transparent hover:border-blue-100`,children:(0,G.jsxs)(`div`,{onClick:()=>k(e),children:[(0,G.jsx)(`h3`,{className:`text-xl font-bold text-gray-800 group-hover:text-blue-600 mb-2 transition-colors`,children:e.title}),(0,G.jsx)(`p`,{className:`text-gray-500 text-sm line-clamp-2 mb-4 font-serif leading-relaxed`,children:O(e.content)}),(0,G.jsxs)(`div`,{className:`flex items-center gap-4 text-xs text-gray-400`,children:[(0,G.jsxs)(`span`,{className:`flex items-center gap-1`,children:[(0,G.jsx)(H,{size:12}),` `,e.authorName]}),(0,G.jsxs)(`span`,{className:`flex items-center gap-1`,children:[(0,G.jsx)(s,{size:12}),e.createdAt?.seconds?new Date(e.createdAt.seconds*1e3).toLocaleDateString():``]})]})]})},e.id)),i.length===0&&(0,G.jsxs)(`div`,{className:`text-center py-20 text-gray-400 bg-white/50 rounded-2xl`,children:[(0,G.jsx)(r,{size:48,className:`mx-auto mb-4 opacity-20`}),(0,G.jsx)(`p`,{children:`è¿˜æ²¡æœ‰äººå‘å¸ƒæ–‡ç« ï¼Œæ¥åšç¬¬ä¸€ä¸ªå§ï¼`})]})]})]}),m===`edit`&&(0,G.jsx)(Pe,{onSave:P,onCancel:()=>h(o?`read`:`list`),initialData:o}),m===`read`&&o&&(0,G.jsxs)(K,{className:`h-full overflow-y-auto max-h-[calc(100vh-140px)] custom-scrollbar animate-fade-in relative`,children:[(0,G.jsx)(`button`,{onClick:M,className:`absolute top-6 left-6 p-2 bg-gray-100 hover:bg-gray-200 rounded-full transition-colors text-gray-600 md:hidden`,children:(0,G.jsx)(l,{size:20})}),(0,G.jsxs)(`div`,{className:`border-b border-gray-100 pb-4 mb-6 mt-2 md:mt-0`,children:[(0,G.jsx)(`h1`,{className:`text-3xl md:text-4xl font-bold text-gray-900 mb-4 leading-tight`,children:o.title}),(0,G.jsxs)(`div`,{className:`flex items-center justify-between text-sm text-gray-500`,children:[(0,G.jsxs)(`div`,{className:`flex items-center gap-4`,children:[(0,G.jsxs)(`span`,{className:`flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-600 rounded-full text-xs font-medium`,children:[(0,G.jsx)(H,{size:12}),` `,o.authorName]}),(0,G.jsxs)(`span`,{className:`flex items-center gap-1`,children:[(0,G.jsx)(y,{size:14}),o.createdAt?.seconds?new Date(o.createdAt.seconds*1e3).toLocaleDateString():``]})]}),t&&t.uid===o.authorId&&(0,G.jsxs)(`div`,{className:`flex gap-2`,children:[(0,G.jsxs)(q,{variant:`ghost`,onClick:()=>h(`edit`),className:`!p-1 text-blue-600`,children:[(0,G.jsx)(ue,{size:16}),` ç¼–è¾‘`]}),(0,G.jsx)(q,{variant:`ghost`,onClick:e=>I(o.id,e),className:`!p-1 text-red-500 hover:bg-red-50`,children:(0,G.jsx)(N,{size:16})})]})]})]}),(0,G.jsx)(`div`,{className:`prose prose-blue prose-lg max-w-none custom-blog-content pb-10`,dangerouslySetInnerHTML:{__html:o.content}})]})]})]})},Re={apiKey:`AIzaSyDkRBknBGFNGZ-QLWKvbPf9nJZy2dxN45I`,authDomain:`my-dashboard-c434c.firebaseapp.com`,projectId:`my-dashboard-c434c`,storageBucket:`my-dashboard-c434c.firebasestorage.app`,messagingSenderId:`183916835818`,appId:`1:183916835818:web:8eeefa146fe87e44a27893`},Q,$;try{let e=ae(Re);Q=pe(e),$=d(e)}catch{console.warn(`Firebase åˆå§‹åŒ–å¤±è´¥`)}var ze=()=>(0,G.jsx)(`div`,{className:`max-w-2xl mx-auto animate-fade-in`,children:(0,G.jsxs)(K,{children:[(0,G.jsx)(`h1`,{className:`text-3xl font-bold text-gray-800 mb-4`,children:`å…³äºæœ¬ç«™`}),(0,G.jsxs)(`div`,{className:`prose text-gray-600 space-y-4`,children:[(0,G.jsxs)(`p`,{children:[`è¿™æ˜¯ä¸€ä¸ªåŸºäº `,(0,G.jsx)(`strong`,{children:`React + Firebase`}),` çš„ä¸ªäººæ™ºèƒ½ä»ªè¡¨ç›˜ã€‚`]}),(0,G.jsxs)(`ul`,{className:`list-disc pl-5 space-y-2`,children:[(0,G.jsx)(`li`,{children:`é›†æˆç•ªèŒ„é’Ÿã€å¤©æ°”é¢„æŠ¥ã€å€’æ•°æ—¥ç®¡ç†ã€‚`}),(0,G.jsxs)(`li`,{children:[(0,G.jsx)(`strong`,{children:`æ–°å¢ï¼š`}),` ä¸ªäººæŠ€æœ¯åšå®¢ï¼ˆå¯Œæ–‡æœ¬ç¼–è¾‘ã€ä»£ç é«˜äº®ã€æ ‘å½¢ç›®å½•ï¼‰ã€‚`]}),(0,G.jsx)(`li`,{children:`æ”¯æŒæ¯æ—¥ä¸€è¨€ä¸å®æ—¶å…¬å‘Šæ ã€‚`}),(0,G.jsx)(`li`,{children:`GitHub Actions æ¯æ—¥è‡ªåŠ¨æ¨é€å¤©æ°”æé†’ã€‚`})]})]})]})});function Be(){let[e,n]=(0,W.useState)(null),[i,s]=(0,W.useState)(`dashboard`),[l,u]=(0,W.useState)(null),[d,p]=(0,W.useState)([]),[m,h]=(0,W.useState)(``),[g,_]=(0,W.useState)(!1),[y,b]=(0,W.useState)(!1),[C,D]=(0,W.useState)(``),[O,k]=(0,W.useState)({timeLeft:1500,isActive:!1,mode:`focus`,eventName:`ä¸“æ³¨ä»»åŠ¡`,focusDuration:25,breakDuration:5}),[A,j]=(0,W.useState)({city:`Beijing`,latitude:39.9042,longitude:116.4074,tempHighThreshold:30,tempLowThreshold:10,emailAlerts:!0,emailAddress:``,events:[{name:`æ–°å¹´`,date:`2025-01-01`}]});(0,W.useEffect)(()=>{if(D(`https://picsum.photos/1920/1080?random=${Date.now()}`),!Q)return;let e=ne(Q,e=>{n(e),e&&L(e.uid)});return()=>e()},[]),(0,W.useEffect)(()=>{if(!$)return;let e=T(v(w($,`announcements`),ee(`createdAt`,`desc`),E(10)),e=>{p(e.docs.map(e=>({id:e.id,...e.data()})))});return()=>e()},[]),(0,W.useEffect)(()=>{let t=null;return O.isActive&&O.timeLeft>0?t=setInterval(()=>{k(e=>({...e,timeLeft:e.timeLeft-1}))},1e3):O.timeLeft===0&&O.isActive&&(async()=>{if(k(e=>({...e,isActive:!1})),Notification.permission===`granted`?new Notification(`${O.mode===`focus`?`ä¸“æ³¨`:`ä¼‘æ¯`}ç»“æŸ`,{body:`ã€${O.eventName}ã€‘æ—¶é—´åˆ°äº†ï¼`}):Notification.permission===`default`&&Notification.requestPermission(),e&&$&&A.emailAddress)try{await S(w($,`mail_queue`),{to:A.emailAddress,subject:`[ç•ªèŒ„é’Ÿ] ${O.eventName} å®Œæˆæé†’`,content:`æ‚¨å¥½ï¼Œæ‚¨çš„ç•ªèŒ„é’Ÿã€${O.eventName}ã€‘(${O.mode===`focus`?`ä¸“æ³¨`:`ä¼‘æ¯`}) å·²äº ${new Date().toLocaleString()} ç»“æŸã€‚è¯·æ³¨æ„ä¼‘æ¯æˆ–å¼€å§‹ä¸‹ä¸€é¡¹å·¥ä½œã€‚`,createdAt:new Date,status:`pending`})}catch(e){console.error(`å†™å…¥é‚®ä»¶é˜Ÿåˆ—å¤±è´¥:`,e)}})(),()=>clearInterval(t)},[O.isActive,O.timeLeft,O.mode,O.eventName,e,A.emailAddress]),(0,W.useEffect)(()=>{(async()=>{let{latitude:e,longitude:t}=A;(!e||!t)&&(e=39.9042,t=116.4074);try{u(await(await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${e}&longitude=${t}&current=temperature_2m,relative_humidity_2m,weather_code,is_day&daily=weather_code,temperature_2m_max,temperature_2m_min&timezone=auto`)).json())}catch(e){console.error(`å¤©æ°”è·å–å¤±è´¥`,e)}})()},[A.city,A.latitude,A.longitude]);let M=async()=>{if(Q)try{await le(Q,new ge),_(!1)}catch(e){console.error(`Google ç™»å½•å¤±è´¥`,e)}},N=()=>Q&&me(Q),P=async()=>{if(!(!m.trim()||!$))try{await S(w($,`announcements`),{text:m,author:e.displayName||e.email.split(`@`)[0],uid:e.uid,createdAt:new Date}),h(``)}catch(e){alert(`å‘å¸ƒå¤±è´¥: `+e.message)}},F=async e=>$&&c(f($,`announcements`,e)),L=async e=>{if(!$)return;let t=await de(f($,`users`,e));if(t.exists()){let e=t.data();!e.events&&e.targetDate&&(e.events=[{name:e.targetName||`ç›®æ ‡æ—¥`,date:e.targetDate}]),j(t=>({...t,...e}))}};return(0,G.jsxs)(`div`,{className:`min-h-screen text-gray-800 font-sans selection:bg-blue-200 bg-cover bg-center bg-fixed transition-all duration-1000`,style:{backgroundImage:`url(${C})`,backgroundColor:`#f3f4f6`},children:[(0,G.jsx)(Me,{isOpen:g,onClose:()=>_(!1),onGoogleLogin:M,auth:Q}),(0,G.jsxs)(`div`,{className:`min-h-screen bg-black/10 backdrop-blur-[2px] overflow-y-auto`,children:[(0,G.jsxs)(`nav`,{className:`sticky top-0 z-50 bg-white/90 backdrop-blur-md border-b border-white/20 px-4 py-3 shadow-sm`,children:[(0,G.jsxs)(`div`,{className:`max-w-6xl mx-auto flex justify-between items-center`,children:[(0,G.jsxs)(`div`,{className:`flex items-center gap-2 font-bold text-xl text-blue-600 cursor-pointer`,onClick:()=>s(`dashboard`),children:[(0,G.jsx)(`div`,{className:`p-2 bg-blue-100 rounded-lg`,children:(0,G.jsx)(I,{size:20,className:`text-blue-600`})}),`MySpace`]}),(0,G.jsx)(`div`,{className:`hidden md:flex gap-1 bg-gray-100/80 p-1 rounded-xl backdrop-blur-sm`,children:[{id:`dashboard`,label:`æ¦‚è§ˆ`,icon:I},{id:`blog`,label:`åšå®¢`,icon:r},{id:`settings`,label:`è®¾ç½®`,icon:B},{id:`about`,label:`å…³äº`,icon:a}].map(e=>(0,G.jsxs)(`button`,{onClick:()=>s(e.id),className:`px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2 transition-all ${i===e.id?`bg-white text-blue-600 shadow-sm`:`text-gray-500 hover:text-gray-700`}`,children:[(0,G.jsx)(e.icon,{size:16}),e.label]},e.id))}),(0,G.jsx)(`div`,{children:e?(0,G.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,G.jsx)(`img`,{src:e.photoURL||`https://api.dicebear.com/7.x/avataaars/svg?seed=User`,alt:`Avatar`,className:`w-8 h-8 rounded-full border border-gray-200 shadow-sm bg-white`}),(0,G.jsx)(q,{variant:`ghost`,onClick:N,className:`!px-2 bg-white/50 hover:bg-white`,children:(0,G.jsx)(x,{size:18})})]}):(0,G.jsxs)(q,{onClick:()=>_(!0),variant:`primary`,className:`text-sm shadow-lg`,children:[(0,G.jsx)(o,{size:16}),` ç™»å½•`]})})]}),(0,G.jsx)(`div`,{className:`md:hidden flex justify-around mt-3 pt-2 border-t border-gray-100`,children:[{id:`dashboard`,label:`æ¦‚è§ˆ`},{id:`blog`,label:`åšå®¢`},{id:`settings`,label:`è®¾ç½®`}].map(e=>(0,G.jsx)(`button`,{onClick:()=>s(e.id),className:`text-sm font-medium ${i===e.id?`text-blue-600`:`text-gray-500`}`,children:e.label},e.id))})]}),(0,G.jsxs)(`main`,{className:`max-w-6xl mx-auto p-4 md:p-6 mt-4 mb-10`,children:[i===`dashboard`&&(0,G.jsx)(Ae,{weather:l,settings:A,announcements:d,user:e,onDelete:F,onPost:P,newAnnouncement:m,setNewAnnouncement:h,onOpenAuth:()=>_(!0),pomoState:O,setPomoState:k}),i===`blog`&&(0,G.jsx)(Le,{db:$,user:e,onOpenAuth:()=>_(!0)}),i===`settings`&&(0,G.jsx)(je,{user:e,onOpenAuth:()=>_(!0),settings:A,setSettings:j,onSave:async()=>{if(!(!e||!$)){b(!0);try{await t(f($,`users`,e.uid),{...A,updatedAt:new Date}),alert(`è®¾ç½®å·²ä¿å­˜ï¼`)}catch(e){alert(`ä¿å­˜å¤±è´¥: `+e.message)}finally{b(!1)}}},loading:y}),i===`about`&&(0,G.jsx)(ze,{})]})]})]})}(0,Se.createRoot)(document.getElementById(`root`)).render((0,G.jsx)(W.StrictMode,{children:(0,G.jsx)(Be,{})}));