import{n as e}from"./rolldown-runtime-y2wrX6ue.js";import{A as t,B as n,C as r,D as i,E as a,F as o,I as s,L as c,M as l,N as u,O as d,P as f,R as p,S as m,T as h,_ as g,a as _,b as v,c as y,d as b,f as x,g as S,h as C,i as w,j as T,k as E,l as D,m as O,n as k,o as A,p as j,r as M,s as N,t as P,u as F,v as I,w as L,x as R,y as z,z as B}from"./vendor-BdJ0POEM.js";(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var V=B(),H=e(n(),1),U=P(),W=[{name:`北京 (Beijing)`,value:`Beijing`,lat:39.9042,lon:116.4074},{name:`上海 (Shanghai)`,value:`Shanghai`,lat:31.2304,lon:121.4737},{name:`广州 (Guangzhou)`,value:`Guangzhou`,lat:23.1291,lon:113.2644},{name:`深圳 (Shenzhen)`,value:`Shenzhen`,lat:22.5431,lon:114.0579},{name:`杭州 (Hangzhou)`,value:`Hangzhou`,lat:30.2748,lon:120.1551},{name:`成都 (Chengdu)`,value:`Chengdu`,lat:30.5728,lon:104.0668},{name:`武汉 (Wuhan)`,value:`Wuhan`,lat:30.5928,lon:114.3055},{name:`西安 (Xi'an)`,value:`Xian`,lat:34.3416,lon:108.9398},{name:`南京 (Nanjing)`,value:`Nanjing`,lat:32.0603,lon:118.7969},{name:`重庆 (Chongqing)`,value:`Chongqing`,lat:29.5628,lon:106.5528},{name:`香港 (Hong Kong)`,value:`HongKong`,lat:22.3193,lon:114.1694},{name:`台北 (Taipei)`,value:`Taipei`,lat:25.033,lon:121.5654},{name:`伦敦 (London)`,value:`London`,lat:51.5074,lon:-.1278},{name:`纽约 (New York)`,value:`NewYork`,lat:40.7128,lon:-74.006},{name:`东京 (Tokyo)`,value:`Tokyo`,lat:35.6762,lon:139.6503}],G={apiKey:`AIzaSyDkRBknBGFNGZ-QLWKvbPf9nJZy2dxN45I`,authDomain:`my-dashboard-c434c.firebaseapp.com`,projectId:`my-dashboard-c434c`,storageBucket:`my-dashboard-c434c.firebasestorage.app`,messagingSenderId:`183916835818`,appId:`1:183916835818:web:8eeefa146fe87e44a27893`},K,q;try{let e=p(G);K=l(e),q=L(e)}catch{console.warn(`Firebase 初始化失败`)}var J=({children:e,className:t=``})=>(0,U.jsx)(`div`,{className:`bg-white/80 backdrop-blur-md rounded-2xl shadow-lg border border-white/20 p-6 ${t}`,children:e}),Y=({onClick:e,children:t,variant:n=`primary`,className:r=``,disabled:i=!1,type:a=`button`})=>(0,U.jsx)(`button`,{type:a,onClick:e,disabled:i,className:`px-4 py-2 rounded-xl font-medium transition-all duration-200 flex items-center gap-2 active:scale-95 justify-center ${{primary:`bg-blue-600 text-white hover:bg-blue-700 shadow-blue-200 shadow-md`,secondary:`bg-gray-100 text-gray-700 hover:bg-gray-200`,danger:`bg-red-50 text-red-600 hover:bg-red-100`,ghost:`hover:bg-gray-100 text-gray-600`,icon:`p-2 bg-transparent hover:bg-gray-100 text-gray-500 rounded-full`}[n]} ${i?`opacity-50 cursor-not-allowed`:``} ${r}`,children:t}),X=({isOpen:e,onClose:t,onGoogleLogin:n})=>{let[r,i]=(0,H.useState)(!1),[a,o]=(0,H.useState)(``),[s,l]=(0,H.useState)(``),[u,d]=(0,H.useState)(``),[p,m]=(0,H.useState)(``),[h,g]=(0,H.useState)(!1);return e?(0,U.jsx)(`div`,{className:`fixed inset-0 z-[60] flex items-center justify-center bg-black/40 backdrop-blur-sm p-4 animate-fade-in`,children:(0,U.jsxs)(`div`,{className:`bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden`,onClick:e=>e.stopPropagation(),children:[(0,U.jsxs)(`div`,{className:`bg-blue-600 p-6 text-white flex justify-between items-center`,children:[(0,U.jsxs)(`div`,{children:[(0,U.jsx)(`h2`,{className:`text-2xl font-bold`,children:r?`创建账户`:`欢迎回来`}),(0,U.jsx)(`p`,{className:`text-blue-100 text-sm mt-1`,children:r?`开始你的个人仪表盘之旅`:`登录以访问你的数据`})]}),(0,U.jsx)(`button`,{onClick:t,className:`text-white/80 hover:text-white transition-colors`,children:(0,U.jsx)(k,{size:24})})]}),(0,U.jsxs)(`div`,{className:`p-8`,children:[p&&(0,U.jsxs)(`div`,{className:`mb-6 bg-red-50 text-red-600 px-4 py-3 rounded-xl text-sm border border-red-100 flex items-center gap-2`,children:[(0,U.jsx)(C,{size:16}),` `,p]}),(0,U.jsxs)(`form`,{onSubmit:async e=>{e.preventDefault(),m(``),g(!0);try{if(!K)throw Error(`Firebase 未配置`);r?await c((await T(K,a,s)).user,{displayName:u}):await f(K,a,s),t()}catch(e){console.error(`Auth Error:`,e);let t=`操作失败，请重试`;e.code===`auth/email-already-in-use`?t=`该邮箱已被注册`:e.code===`auth/invalid-email`?t=`邮箱格式不正确`:e.code===`auth/user-not-found`||e.code===`auth/invalid-credential`?t=`账号或密码错误`:e.code===`auth/wrong-password`?t=`密码错误`:e.code===`auth/weak-password`&&(t=`密码太弱 (至少6位)`),m(t)}finally{g(!1)}},className:`space-y-4`,children:[r&&(0,U.jsxs)(`div`,{children:[(0,U.jsx)(`label`,{className:`block text-sm font-medium text-gray-700 mb-1 ml-1`,children:`昵称`}),(0,U.jsxs)(`div`,{className:`relative`,children:[(0,U.jsx)(M,{className:`absolute left-3 top-1/2 -translate-y-1/2 text-gray-400`,size:18}),(0,U.jsx)(`input`,{type:`text`,required:!0,placeholder:`你的名字`,value:u,onChange:e=>d(e.target.value),className:`w-full pl-10 pr-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all`})]})]}),(0,U.jsxs)(`div`,{children:[(0,U.jsx)(`label`,{className:`block text-sm font-medium text-gray-700 mb-1 ml-1`,children:`邮箱`}),(0,U.jsxs)(`div`,{className:`relative`,children:[(0,U.jsx)(b,{className:`absolute left-3 top-1/2 -translate-y-1/2 text-gray-400`,size:18}),(0,U.jsx)(`input`,{type:`email`,required:!0,placeholder:`name@example.com`,value:a,onChange:e=>o(e.target.value),className:`w-full pl-10 pr-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all`})]})]}),(0,U.jsxs)(`div`,{children:[(0,U.jsx)(`label`,{className:`block text-sm font-medium text-gray-700 mb-1 ml-1`,children:`密码`}),(0,U.jsxs)(`div`,{className:`relative`,children:[(0,U.jsx)(j,{className:`absolute left-3 top-1/2 -translate-y-1/2 text-gray-400`,size:18}),(0,U.jsx)(`input`,{type:`password`,required:!0,placeholder:`••••••••`,value:s,onChange:e=>l(e.target.value),className:`w-full pl-10 pr-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all`})]})]}),(0,U.jsx)(Y,{type:`submit`,className:`w-full justify-center py-3 text-lg mt-2`,disabled:h,children:h?`处理中...`:r?`注册`:`登录`})]}),(0,U.jsxs)(`div`,{className:`relative flex py-6 items-center`,children:[(0,U.jsx)(`div`,{className:`flex-grow border-t border-gray-100`}),(0,U.jsx)(`span`,{className:`flex-shrink-0 mx-4 text-gray-400 text-xs`,children:`或者使用第三方登录`}),(0,U.jsx)(`div`,{className:`flex-grow border-t border-gray-100`})]}),(0,U.jsxs)(Y,{variant:`secondary`,className:`w-full justify-center py-2.5 border border-gray-200 bg-white`,onClick:n,children:[(0,U.jsx)(`img`,{src:`https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg`,className:`w-5 h-5`,alt:`Google`}),(0,U.jsx)(`span`,{className:`text-gray-600`,children:`Google 账号登录`})]}),(0,U.jsxs)(`div`,{className:`text-center text-sm text-gray-500 mt-6`,children:[r?`已有账号？`:`没有账号？`,(0,U.jsx)(`button`,{type:`button`,onClick:()=>{i(!r),m(``)},className:`text-blue-600 font-bold hover:underline ml-1`,children:r?`直接登录`:`立即注册`})]})]})]})}):null},Z=({weather:e,settings:t,announcements:n,user:r,onDelete:i,onPost:a,newAnnouncement:o,setNewAnnouncement:s,onOpenAuth:c})=>{let l=e=>{if(!e)return 0;let t=new Date(e)-new Date,n=Math.ceil(t/(1e3*60*60*24));return n>0?n:0};return(0,U.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-3 gap-6 animate-fade-in`,children:[(0,U.jsxs)(`div`,{className:`space-y-6`,children:[(0,U.jsxs)(J,{className:`bg-gradient-to-br from-blue-500 to-blue-600 text-white border-none`,children:[(0,U.jsxs)(`div`,{className:`flex justify-between items-start`,children:[(0,U.jsxs)(`div`,{children:[(0,U.jsxs)(`h3`,{className:`text-blue-100 font-medium flex items-center gap-2`,children:[(0,U.jsx)(S,{size:18}),` 今日天气`]}),(0,U.jsxs)(`p`,{className:`text-xs text-blue-200 mt-1 flex items-center gap-1`,children:[(0,U.jsx)(F,{size:12}),` `,t.city]})]}),(0,U.jsxs)(`div`,{className:`text-4xl font-bold`,children:[e?Math.round(e.current.temperature_2m):`--`,`°`]})]}),(0,U.jsxs)(`div`,{className:`mt-6 flex justify-between text-sm text-blue-100`,children:[(0,U.jsxs)(`span`,{children:[`最高: `,e?e.daily.temperature_2m_max[0]:`--`,`°`]}),(0,U.jsxs)(`span`,{children:[`最低: `,e?e.daily.temperature_2m_min[0]:`--`,`°`]})]})]}),t.events&&t.events.length>0?t.events.map((e,t)=>(0,U.jsxs)(J,{className:`bg-gradient-to-br from-purple-500 to-pink-600 text-white border-none relative overflow-hidden group transition-transform hover:scale-[1.02]`,children:[(0,U.jsxs)(`div`,{className:`flex justify-between items-center relative z-10`,children:[(0,U.jsxs)(`h3`,{className:`text-purple-100 font-medium flex items-center gap-2`,children:[(0,U.jsx)(g,{size:18}),` `,e.name]}),(0,U.jsx)(`span`,{className:`text-xs bg-white/20 px-2 py-1 rounded text-white`,children:e.date})]}),(0,U.jsxs)(`div`,{className:`mt-4 text-center relative z-10`,children:[(0,U.jsx)(`span`,{className:`text-5xl font-bold`,children:l(e.date)}),(0,U.jsx)(`span`,{className:`ml-2 text-purple-200`,children:`天`})]})]},t)):(0,U.jsxs)(J,{className:`bg-white text-gray-400 border-dashed border-2 flex flex-col items-center justify-center py-8`,children:[(0,U.jsx)(g,{size:32,className:`mb-2 opacity-50`}),(0,U.jsx)(`p`,{children:`暂无倒数日`}),(0,U.jsx)(`p`,{className:`text-xs`,children:`请前往设置添加`})]})]}),(0,U.jsx)(`div`,{className:`md:col-span-2`,children:(0,U.jsxs)(J,{className:`h-full flex flex-col`,children:[(0,U.jsxs)(`div`,{className:`flex justify-between items-center mb-6`,children:[(0,U.jsxs)(`h2`,{className:`text-xl font-bold text-gray-800 flex items-center gap-2`,children:[(0,U.jsx)(I,{className:`text-blue-500`}),` 公告栏`]}),r&&(0,U.jsxs)(`span`,{className:`text-xs text-gray-400`,children:[`作为 `,r.displayName||r.email,` 登录`]})]}),(0,U.jsxs)(`div`,{className:`flex-1 overflow-y-auto space-y-4 pr-2 min-h-[300px] max-h-[500px]`,children:[n.map(e=>(0,U.jsxs)(`div`,{className:`group p-4 rounded-xl bg-gray-50 hover:bg-blue-50 transition-colors border border-gray-100`,children:[(0,U.jsxs)(`div`,{className:`flex justify-between items-start`,children:[(0,U.jsx)(`p`,{className:`text-gray-700 whitespace-pre-wrap break-words`,children:e.text}),r&&e.uid===r.uid&&(0,U.jsx)(`button`,{onClick:()=>i(e.id),className:`text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity ml-2`,children:(0,U.jsx)(w,{size:16})})]}),(0,U.jsxs)(`div`,{className:`mt-2 flex justify-between items-center`,children:[(0,U.jsx)(`span`,{className:`text-xs text-gray-400`,children:e.createdAt?.seconds?new Date(e.createdAt.seconds*1e3).toLocaleDateString():`刚刚`}),e.author&&(0,U.jsxs)(`span`,{className:`text-xs font-medium text-blue-500`,children:[`@`,e.author]})]})]},e.id)),n.length===0&&(0,U.jsx)(`div`,{className:`text-center text-gray-400 py-10`,children:`暂无公告`})]}),r?(0,U.jsx)(`div`,{className:`mt-6 pt-4 border-t border-gray-100`,children:(0,U.jsxs)(`div`,{className:`flex gap-2`,children:[(0,U.jsx)(`input`,{type:`text`,value:o,onChange:e=>s(e.target.value),placeholder:`发布新动态...`,className:`flex-1 bg-gray-100 border-none rounded-xl px-4 py-2 focus:ring-2 focus:ring-blue-500 outline-none transition-all`,onKeyDown:e=>e.key===`Enter`&&a()}),(0,U.jsx)(Y,{onClick:a,children:(0,U.jsx)(D,{size:20})})]})}):(0,U.jsx)(`div`,{className:`mt-6 pt-4 border-t border-gray-100 text-center`,children:(0,U.jsx)(Y,{variant:`secondary`,onClick:c,className:`w-full justify-center`,children:`登录以发布公告`})})]})})]})},Q=({user:e,onOpenAuth:t,settings:n,setSettings:r,onSave:i,loading:a})=>{let[o,s]=(0,H.useState)({name:``,date:``}),c=()=>{if(!o.name||!o.date)return;let e=[...n.events||[],o];r({...n,events:e}),s({name:``,date:``})},l=e=>{let t=n.events.filter((t,n)=>n!==e);r({...n,events:t})};return(0,U.jsx)(`div`,{className:`max-w-2xl mx-auto animate-fade-in`,children:(0,U.jsxs)(J,{children:[(0,U.jsxs)(`h2`,{className:`text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2`,children:[(0,U.jsx)(N,{className:`text-blue-500`}),` 自动化设置`]}),e?(0,U.jsxs)(`div`,{className:`space-y-8`,children:[(0,U.jsxs)(`div`,{className:`bg-blue-50 p-4 rounded-xl text-sm text-blue-700 flex gap-2`,children:[(0,U.jsx)(C,{className:`shrink-0`,size:18}),`此处保存的设置将用于 GitHub Actions 每日邮件推送。`]}),(0,U.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 gap-6`,children:[(0,U.jsxs)(`div`,{children:[(0,U.jsx)(`label`,{className:`block text-sm font-medium text-gray-700 mb-1`,children:`所在城市`}),(0,U.jsxs)(`div`,{className:`relative`,children:[(0,U.jsx)(`select`,{value:n.city,onChange:e=>{let t=W.find(t=>t.value===e.target.value);t&&r({...n,city:t.value,latitude:t.lat,longitude:t.lon})},className:`w-full p-2 pl-3 pr-8 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 outline-none appearance-none bg-white`,children:W.map(e=>(0,U.jsx)(`option`,{value:e.value,children:e.name},e.value))}),(0,U.jsx)(`div`,{className:`absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-gray-400`,children:`▼`})]}),(0,U.jsx)(`p`,{className:`text-xs text-gray-400 mt-1`,children:`这将决定首页显示的天气区域`})]}),(0,U.jsxs)(`div`,{children:[(0,U.jsx)(`label`,{className:`block text-sm font-medium text-gray-700 mb-1`,children:`接收邮箱`}),(0,U.jsx)(`input`,{type:`email`,value:n.emailAddress,placeholder:`example@gmail.com`,onChange:e=>r({...n,emailAddress:e.target.value}),className:`w-full p-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 outline-none`})]})]}),(0,U.jsxs)(`div`,{className:`space-y-4 border-t border-gray-100 pt-4`,children:[(0,U.jsxs)(`h3`,{className:`font-medium text-gray-900 flex items-center gap-2`,children:[(0,U.jsx)(_,{size:18}),` 温度预警阈值`]}),(0,U.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 gap-6`,children:[(0,U.jsxs)(`div`,{children:[(0,U.jsx)(`label`,{className:`block text-sm text-gray-600 mb-1`,children:`高温提醒 (> X°C)`}),(0,U.jsx)(`input`,{type:`number`,value:n.tempHighThreshold,onChange:e=>r({...n,tempHighThreshold:parseInt(e.target.value)||0}),className:`w-full p-2 rounded-lg border border-gray-300`})]}),(0,U.jsxs)(`div`,{children:[(0,U.jsx)(`label`,{className:`block text-sm text-gray-600 mb-1`,children:`低温提醒 (< X°C)`}),(0,U.jsx)(`input`,{type:`number`,value:n.tempLowThreshold,onChange:e=>r({...n,tempLowThreshold:parseInt(e.target.value)||0}),className:`w-full p-2 rounded-lg border border-gray-300`})]})]})]}),(0,U.jsxs)(`div`,{className:`space-y-4 border-t border-gray-100 pt-4`,children:[(0,U.jsxs)(`h3`,{className:`font-medium text-gray-900 flex items-center gap-2`,children:[(0,U.jsx)(g,{size:18}),` 倒数日事件管理`]}),(0,U.jsxs)(`div`,{className:`space-y-2 mb-4`,children:[n.events&&n.events.map((e,t)=>(0,U.jsxs)(`div`,{className:`flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200`,children:[(0,U.jsxs)(`div`,{children:[(0,U.jsx)(`span`,{className:`font-medium text-gray-800`,children:e.name}),(0,U.jsx)(`span`,{className:`mx-2 text-gray-300`,children:`|`}),(0,U.jsx)(`span`,{className:`text-sm text-gray-500`,children:e.date})]}),(0,U.jsx)(`button`,{onClick:()=>l(t),className:`text-gray-400 hover:text-red-500 p-1`,children:(0,U.jsx)(k,{size:16})})]},t)),(!n.events||n.events.length===0)&&(0,U.jsx)(`div`,{className:`text-sm text-gray-400 text-center py-2`,children:`暂无事件，请添加`})]}),(0,U.jsxs)(`div`,{className:`grid grid-cols-1 md:grid-cols-5 gap-2 bg-gray-50 p-3 rounded-xl`,children:[(0,U.jsx)(`div`,{className:`md:col-span-2`,children:(0,U.jsx)(`input`,{type:`text`,placeholder:`事件名称 (如: 新年)`,value:o.name,onChange:e=>s({...o,name:e.target.value}),className:`w-full p-2 rounded-lg border border-gray-300 text-sm`})}),(0,U.jsx)(`div`,{className:`md:col-span-2`,children:(0,U.jsx)(`input`,{type:`date`,value:o.date,onChange:e=>s({...o,date:e.target.value}),className:`w-full p-2 rounded-lg border border-gray-300 text-sm`})}),(0,U.jsx)(`div`,{className:`md:col-span-1`,children:(0,U.jsx)(Y,{onClick:c,variant:`secondary`,className:`w-full h-full`,disabled:!o.name||!o.date,children:`添加`})})]})]}),(0,U.jsx)(`div`,{className:`pt-4`,children:(0,U.jsxs)(Y,{onClick:i,disabled:a,className:`w-full justify-center h-12 text-lg`,children:[a?`保存中...`:`保存所有设置`,` `,(0,U.jsx)(y,{size:20})]})})]}):(0,U.jsxs)(`div`,{className:`text-center py-10`,children:[(0,U.jsx)(`p`,{className:`text-gray-500 mb-4`,children:`请先登录以同步您的偏好设置到云端。`}),(0,U.jsx)(Y,{onClick:t,className:`mx-auto`,children:`立即登录`})]})]})})},$=()=>(0,U.jsx)(`div`,{className:`max-w-2xl mx-auto animate-fade-in`,children:(0,U.jsxs)(J,{children:[(0,U.jsx)(`h1`,{className:`text-3xl font-bold text-gray-800 mb-4`,children:`关于本站`}),(0,U.jsxs)(`div`,{className:`prose text-gray-600 space-y-4`,children:[(0,U.jsxs)(`p`,{children:[`这是一个基于 `,(0,U.jsx)(`strong`,{children:`React + Firebase + GitHub Pages`}),` 构建的个人智能仪表盘。`]}),(0,U.jsxs)(`ul`,{className:`list-disc pl-5 space-y-2`,children:[(0,U.jsx)(`li`,{children:`前端使用 React 构建，界面采用 Tailwind CSS 设计。`}),(0,U.jsx)(`li`,{children:`数据存储在 Google Firebase (Firestore) 中，实现实时同步。`}),(0,U.jsxs)(`li`,{children:[(0,U.jsx)(`strong`,{children:`GitHub Actions 自动化：`}),`后台每天会自动运行脚本，读取你的设置。如果明天气温超过你在设置页面设定的阈值，或者距离倒数日还有3天，系统会自动向你的邮箱发送提醒。`]})]})]})]})});function ee(){let[e,n]=(0,H.useState)(null),[c,l]=(0,H.useState)(`dashboard`),[f,p]=(0,H.useState)(null),[g,_]=(0,H.useState)([]),[y,b]=(0,H.useState)(``),[S,w]=(0,H.useState)(!1),[T,D]=(0,H.useState)({city:`Beijing`,latitude:39.9042,longitude:116.4074,tempHighThreshold:30,tempLowThreshold:10,emailAlerts:!0,emailAddress:``,events:[{name:`新年`,date:`2025-01-01`}]}),[k,j]=(0,H.useState)(!1),[M,P]=(0,H.useState)(``);(0,H.useEffect)(()=>{P(`https://picsum.photos/1920/1080?random=${Date.now()}`)},[]),(0,H.useEffect)(()=>{if(!K)return;let e=u(K,e=>{n(e),e&&V(e.uid)});return()=>e()},[]),(0,H.useEffect)(()=>{if(!q)return;let e=a(d(v(q,`announcements`),i(`createdAt`,`desc`),h(10)),e=>{_(e.docs.map(e=>({id:e.id,...e.data()})))},e=>{_([{id:1,text:`欢迎来到你的个人仪表盘！请配置 Firebase 以启用实时功能。`,createdAt:{seconds:Date.now()/1e3}}])});return()=>e()},[]),(0,H.useEffect)(()=>{(async()=>{let{latitude:e,longitude:t}=T,n=e,r=t;if(!n||!r){let e=W.find(e=>e.value===T.city)||W[0];n=e.lat,r=e.lon}try{p(await(await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${n}&longitude=${r}&current=temperature_2m,relative_humidity_2m,weather_code&daily=weather_code,temperature_2m_max,temperature_2m_min&timezone=auto`)).json())}catch(e){console.error(`天气获取失败`,e)}})()},[T.city,T.latitude,T.longitude]);let F=async()=>{if(!K){alert(`请先在代码中配置 Firebase!`);return}let e=new t;try{await o(K,e),w(!1)}catch(e){console.error(`Google 登录失败`,e)}},I=()=>K&&s(K),L=async()=>{if(!(!y.trim()||!q))try{await z(v(q,`announcements`),{text:y,author:e.displayName||e.email.split(`@`)[0],uid:e.uid,createdAt:new Date}),b(``)}catch(e){alert(`发布失败: `+e.message)}},B=async e=>{if(q)try{await R(m(q,`announcements`,e))}catch(e){console.error(`删除失败`,e)}},V=async e=>{if(q)try{let t=await r(m(q,`users`,e));if(t.exists()){let e=t.data();!e.events&&e.targetDate&&(e.events=[{name:e.targetName||`目标日`,date:e.targetDate}]),D({...T,...e})}}catch(e){console.error(`获取设置失败`,e)}};return(0,U.jsxs)(`div`,{className:`min-h-screen text-gray-800 font-sans selection:bg-blue-200 bg-cover bg-center bg-fixed transition-all duration-1000`,style:{backgroundImage:`url(${M})`,backgroundColor:`#f3f4f6`},children:[(0,U.jsx)(X,{isOpen:S,onClose:()=>w(!1),onGoogleLogin:F}),(0,U.jsxs)(`div`,{className:`min-h-screen bg-black/10 backdrop-blur-[2px] overflow-y-auto`,children:[(0,U.jsxs)(`nav`,{className:`sticky top-0 z-50 bg-white/90 backdrop-blur-md border-b border-white/20 px-4 py-3 shadow-sm`,children:[(0,U.jsxs)(`div`,{className:`max-w-6xl mx-auto flex justify-between items-center`,children:[(0,U.jsxs)(`div`,{className:`flex items-center gap-2 font-bold text-xl text-blue-600`,children:[(0,U.jsx)(`div`,{className:`p-2 bg-blue-100 rounded-lg`,children:(0,U.jsx)(A,{size:20,className:`text-blue-600`})}),`MySpace`]}),(0,U.jsx)(`div`,{className:`hidden md:flex gap-1 bg-gray-100/80 p-1 rounded-xl backdrop-blur-sm`,children:[{id:`dashboard`,label:`概览`,icon:A},{id:`settings`,label:`设置`,icon:N},{id:`about`,label:`关于`,icon:C}].map(e=>(0,U.jsxs)(`button`,{onClick:()=>l(e.id),className:`px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2 transition-all ${c===e.id?`bg-white text-blue-600 shadow-sm`:`text-gray-500 hover:text-gray-700`}`,children:[(0,U.jsx)(e.icon,{size:16}),e.label]},e.id))}),(0,U.jsx)(`div`,{children:e?(0,U.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,U.jsx)(`img`,{src:e.photoURL||`https://api.dicebear.com/7.x/avataaars/svg?seed=Felix`,alt:`Avatar`,className:`w-8 h-8 rounded-full border border-gray-200 shadow-sm bg-white`}),(0,U.jsx)(Y,{variant:`ghost`,onClick:I,className:`!px-2 bg-white/50 hover:bg-white`,children:(0,U.jsx)(x,{size:18})})]}):(0,U.jsxs)(Y,{onClick:()=>w(!0),variant:`primary`,className:`text-sm shadow-lg`,children:[(0,U.jsx)(O,{size:16}),` 登录`]})})]}),(0,U.jsx)(`div`,{className:`md:hidden flex justify-around mt-3 pt-2 border-t border-gray-100`,children:[{id:`dashboard`,label:`概览`},{id:`settings`,label:`设置`},{id:`about`,label:`关于`}].map(e=>(0,U.jsx)(`button`,{onClick:()=>l(e.id),className:`text-sm font-medium ${c===e.id?`text-blue-600`:`text-gray-500`}`,children:e.label},e.id))})]}),(0,U.jsxs)(`main`,{className:`max-w-6xl mx-auto p-4 md:p-6 mt-4 mb-10`,children:[c===`dashboard`&&(0,U.jsx)(Z,{weather:f,settings:T,announcements:g,user:e,onDelete:B,onPost:L,newAnnouncement:y,setNewAnnouncement:b,onOpenAuth:()=>w(!0)}),c===`settings`&&(0,U.jsx)(Q,{user:e,onOpenAuth:()=>w(!0),settings:T,setSettings:D,onSave:async()=>{if(!(!e||!q)){j(!0);try{await E(m(q,`users`,e.uid),{...T,updatedAt:new Date}),alert(`设置已保存！`)}catch(e){alert(`保存失败: `+e.message)}finally{j(!1)}}},loading:k}),c===`about`&&(0,U.jsx)($,{})]})]})]})}(0,V.createRoot)(document.getElementById(`root`)).render((0,U.jsx)(H.StrictMode,{children:(0,U.jsx)(ee,{})}));