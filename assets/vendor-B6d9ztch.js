function SU(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var wb={exports:{}},By={},Tb={exports:{}},qt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pp=Symbol.for("react.element"),EU=Symbol.for("react.portal"),wU=Symbol.for("react.fragment"),TU=Symbol.for("react.strict_mode"),MU=Symbol.for("react.profiler"),AU=Symbol.for("react.provider"),CU=Symbol.for("react.context"),RU=Symbol.for("react.forward_ref"),IU=Symbol.for("react.suspense"),PU=Symbol.for("react.memo"),bU=Symbol.for("react.lazy"),FA=Symbol.iterator;function LU(n){return n===null||typeof n!="object"?null:(n=FA&&n[FA]||n["@@iterator"],typeof n=="function"?n:null)}var Mb={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ab=Object.assign,Cb={};function Kh(n,e,t){this.props=n,this.context=e,this.refs=Cb,this.updater=t||Mb}Kh.prototype.isReactComponent={};Kh.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Kh.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function Rb(){}Rb.prototype=Kh.prototype;function Dw(n,e,t){this.props=n,this.context=e,this.refs=Cb,this.updater=t||Mb}var kw=Dw.prototype=new Rb;kw.constructor=Dw;Ab(kw,Kh.prototype);kw.isPureReactComponent=!0;var VA=Array.isArray,Ib=Object.prototype.hasOwnProperty,Ow={current:null},Pb={key:!0,ref:!0,__self:!0,__source:!0};function bb(n,e,t){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Ib.call(e,i)&&!Pb.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){for(var l=Array(a),h=0;h<a;h++)l[h]=arguments[h+2];r.children=l}if(n&&n.defaultProps)for(i in a=n.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:Pp,type:n,key:s,ref:o,props:r,_owner:Ow.current}}function NU(n,e){return{$$typeof:Pp,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function Uw(n){return typeof n=="object"&&n!==null&&n.$$typeof===Pp}function DU(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var zA=/\/+/g;function q0(n,e){return typeof n=="object"&&n!==null&&n.key!=null?DU(""+n.key):e.toString(36)}function f_(n,e,t,i,r){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case Pp:case EU:o=!0}}if(o)return o=n,r=r(o),n=i===""?"."+q0(o,0):i,VA(r)?(t="",n!=null&&(t=n.replace(zA,"$&/")+"/"),f_(r,e,t,"",function(h){return h})):r!=null&&(Uw(r)&&(r=NU(r,t+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(zA,"$&/")+"/")+n)),e.push(r)),1;if(o=0,i=i===""?".":i+":",VA(n))for(var a=0;a<n.length;a++){s=n[a];var l=i+q0(s,a);o+=f_(s,e,t,l,r)}else if(l=LU(n),typeof l=="function")for(n=l.call(n),a=0;!(s=n.next()).done;)s=s.value,l=i+q0(s,a++),o+=f_(s,e,t,l,r);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Xm(n,e,t){if(n==null)return n;var i=[],r=0;return f_(n,i,"","",function(s){return e.call(t,s,r++)}),i}function kU(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var vr={current:null},d_={transition:null},OU={ReactCurrentDispatcher:vr,ReactCurrentBatchConfig:d_,ReactCurrentOwner:Ow};function Lb(){throw Error("act(...) is not supported in production builds of React.")}qt.Children={map:Xm,forEach:function(n,e,t){Xm(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Xm(n,function(){e++}),e},toArray:function(n){return Xm(n,function(e){return e})||[]},only:function(n){if(!Uw(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};qt.Component=Kh;qt.Fragment=wU;qt.Profiler=MU;qt.PureComponent=Dw;qt.StrictMode=TU;qt.Suspense=IU;qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=OU;qt.act=Lb;qt.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=Ab({},n.props),r=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Ow.current),e.key!==void 0&&(r=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)Ib.call(e,l)&&!Pb.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){a=Array(l);for(var h=0;h<l;h++)a[h]=arguments[h+2];i.children=a}return{$$typeof:Pp,type:n.type,key:r,ref:s,props:i,_owner:o}};qt.createContext=function(n){return n={$$typeof:CU,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:AU,_context:n},n.Consumer=n};qt.createElement=bb;qt.createFactory=function(n){var e=bb.bind(null,n);return e.type=n,e};qt.createRef=function(){return{current:null}};qt.forwardRef=function(n){return{$$typeof:RU,render:n}};qt.isValidElement=Uw;qt.lazy=function(n){return{$$typeof:bU,_payload:{_status:-1,_result:n},_init:kU}};qt.memo=function(n,e){return{$$typeof:PU,type:n,compare:e===void 0?null:e}};qt.startTransition=function(n){var e=d_.transition;d_.transition={};try{n()}finally{d_.transition=e}};qt.unstable_act=Lb;qt.useCallback=function(n,e){return vr.current.useCallback(n,e)};qt.useContext=function(n){return vr.current.useContext(n)};qt.useDebugValue=function(){};qt.useDeferredValue=function(n){return vr.current.useDeferredValue(n)};qt.useEffect=function(n,e){return vr.current.useEffect(n,e)};qt.useId=function(){return vr.current.useId()};qt.useImperativeHandle=function(n,e,t){return vr.current.useImperativeHandle(n,e,t)};qt.useInsertionEffect=function(n,e){return vr.current.useInsertionEffect(n,e)};qt.useLayoutEffect=function(n,e){return vr.current.useLayoutEffect(n,e)};qt.useMemo=function(n,e){return vr.current.useMemo(n,e)};qt.useReducer=function(n,e,t){return vr.current.useReducer(n,e,t)};qt.useRef=function(n){return vr.current.useRef(n)};qt.useState=function(n){return vr.current.useState(n)};qt.useSyncExternalStore=function(n,e,t){return vr.current.useSyncExternalStore(n,e,t)};qt.useTransition=function(){return vr.current.useTransition()};qt.version="18.3.1";Tb.exports=qt;var pe=Tb.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UU=pe,FU=Symbol.for("react.element"),VU=Symbol.for("react.fragment"),zU=Object.prototype.hasOwnProperty,BU=UU.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,HU={key:!0,ref:!0,__self:!0,__source:!0};function Nb(n,e,t){var i,r={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)zU.call(e,i)&&!HU.hasOwnProperty(i)&&(r[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:FU,type:n,key:s,ref:o,props:r,_owner:BU.current}}By.Fragment=VU;By.jsx=Nb;By.jsxs=Nb;wb.exports=By;var Vs=wb.exports,Db={exports:{}},is={},kb={exports:{}},Ob={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(W,K){var Q=W.length;W.push(K);e:for(;0<Q;){var ee=Q-1>>>1,_e=W[ee];if(0<r(_e,K))W[ee]=K,W[Q]=_e,Q=ee;else break e}}function t(W){return W.length===0?null:W[0]}function i(W){if(W.length===0)return null;var K=W[0],Q=W.pop();if(Q!==K){W[0]=Q;e:for(var ee=0,_e=W.length,Ne=_e>>>1;ee<Ne;){var oe=2*(ee+1)-1,xe=W[oe],Le=oe+1,ze=W[Le];if(0>r(xe,Q))Le<_e&&0>r(ze,xe)?(W[ee]=ze,W[Le]=Q,ee=Le):(W[ee]=xe,W[oe]=Q,ee=oe);else if(Le<_e&&0>r(ze,Q))W[ee]=ze,W[Le]=Q,ee=Le;else break e}}return K}function r(W,K){var Q=W.sortIndex-K.sortIndex;return Q!==0?Q:W.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],h=[],f=1,d=null,p=3,_=!1,v=!1,T=!1,x=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(W){for(var K=t(h);K!==null;){if(K.callback===null)i(h);else if(K.startTime<=W)i(h),K.sortIndex=K.expirationTime,e(l,K);else break;K=t(h)}}function I(W){if(T=!1,E(W),!v)if(t(l)!==null)v=!0,se(O);else{var K=t(h);K!==null&&ye(I,K.startTime-W)}}function O(W,K){v=!1,T&&(T=!1,y(b),b=-1),_=!0;var Q=p;try{for(E(K),d=t(l);d!==null&&(!(d.expirationTime>K)||W&&!P());){var ee=d.callback;if(typeof ee=="function"){d.callback=null,p=d.priorityLevel;var _e=ee(d.expirationTime<=K);K=n.unstable_now(),typeof _e=="function"?d.callback=_e:d===t(l)&&i(l),E(K)}else i(l);d=t(l)}if(d!==null)var Ne=!0;else{var oe=t(h);oe!==null&&ye(I,oe.startTime-K),Ne=!1}return Ne}finally{d=null,p=Q,_=!1}}var D=!1,R=null,b=-1,k=5,M=-1;function P(){return!(n.unstable_now()-M<k)}function V(){if(R!==null){var W=n.unstable_now();M=W;var K=!0;try{K=R(!0,W)}finally{K?F():(D=!1,R=null)}}else D=!1}var F;if(typeof w=="function")F=function(){w(V)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,re=Y.port2;Y.port1.onmessage=V,F=function(){re.postMessage(null)}}else F=function(){x(V,0)};function se(W){R=W,D||(D=!0,F())}function ye(W,K){b=x(function(){W(n.unstable_now())},K)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(W){W.callback=null},n.unstable_continueExecution=function(){v||_||(v=!0,se(O))},n.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<W?Math.floor(1e3/W):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(W){switch(p){case 1:case 2:case 3:var K=3;break;default:K=p}var Q=p;p=K;try{return W()}finally{p=Q}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(W,K){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Q=p;p=W;try{return K()}finally{p=Q}},n.unstable_scheduleCallback=function(W,K,Q){var ee=n.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?ee+Q:ee):Q=ee,W){case 1:var _e=-1;break;case 2:_e=250;break;case 5:_e=1073741823;break;case 4:_e=1e4;break;default:_e=5e3}return _e=Q+_e,W={id:f++,callback:K,priorityLevel:W,startTime:Q,expirationTime:_e,sortIndex:-1},Q>ee?(W.sortIndex=Q,e(h,W),t(l)===null&&W===t(h)&&(T?(y(b),b=-1):T=!0,ye(I,Q-ee))):(W.sortIndex=_e,e(l,W),v||_||(v=!0,se(O))),W},n.unstable_shouldYield=P,n.unstable_wrapCallback=function(W){var K=p;return function(){var Q=p;p=K;try{return W.apply(this,arguments)}finally{p=Q}}}})(Ob);kb.exports=Ob;var GU=kb.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WU=pe,ts=GU;function be(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ub=new Set,Od={};function qu(n,e){Ph(n,e),Ph(n+"Capture",e)}function Ph(n,e){for(Od[n]=e,n=0;n<e.length;n++)Ub.add(e[n])}var Qo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wS=Object.prototype.hasOwnProperty,jU=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,BA={},HA={};function qU(n){return wS.call(HA,n)?!0:wS.call(BA,n)?!1:jU.test(n)?HA[n]=!0:(BA[n]=!0,!1)}function XU(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function YU(n,e,t,i){if(e===null||typeof e>"u"||XU(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function xr(n,e,t,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Ni={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Ni[n]=new xr(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Ni[e]=new xr(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Ni[n]=new xr(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Ni[n]=new xr(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Ni[n]=new xr(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Ni[n]=new xr(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Ni[n]=new xr(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Ni[n]=new xr(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Ni[n]=new xr(n,5,!1,n.toLowerCase(),null,!1,!1)});var Fw=/[\-:]([a-z])/g;function Vw(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(Fw,Vw);Ni[e]=new xr(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(Fw,Vw);Ni[e]=new xr(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(Fw,Vw);Ni[e]=new xr(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Ni[n]=new xr(n,1,!1,n.toLowerCase(),null,!1,!1)});Ni.xlinkHref=new xr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Ni[n]=new xr(n,1,!1,n.toLowerCase(),null,!0,!0)});function zw(n,e,t,i){var r=Ni.hasOwnProperty(e)?Ni[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(YU(e,t,r,i)&&(t=null),i||r===null?qU(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):r.mustUseProperty?n[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,i=r.attributeNamespace,t===null?n.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var la=WU.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ym=Symbol.for("react.element"),eh=Symbol.for("react.portal"),th=Symbol.for("react.fragment"),Bw=Symbol.for("react.strict_mode"),TS=Symbol.for("react.profiler"),Fb=Symbol.for("react.provider"),Vb=Symbol.for("react.context"),Hw=Symbol.for("react.forward_ref"),MS=Symbol.for("react.suspense"),AS=Symbol.for("react.suspense_list"),Gw=Symbol.for("react.memo"),Pa=Symbol.for("react.lazy"),zb=Symbol.for("react.offscreen"),GA=Symbol.iterator;function Of(n){return n===null||typeof n!="object"?null:(n=GA&&n[GA]||n["@@iterator"],typeof n=="function"?n:null)}var Vn=Object.assign,X0;function sd(n){if(X0===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);X0=e&&e[1]||""}return`
`+X0+n}var Y0=!1;function $0(n,e){if(!n||Y0)return"";Y0=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var i=h}Reflect.construct(n,[],e)}else{try{e.call()}catch(h){i=h}n.call(e.prototype)}else{try{throw Error()}catch(h){i=h}n()}}catch(h){if(h&&i&&typeof h.stack=="string"){for(var r=h.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{Y0=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?sd(n):""}function $U(n){switch(n.tag){case 5:return sd(n.type);case 16:return sd("Lazy");case 13:return sd("Suspense");case 19:return sd("SuspenseList");case 0:case 2:case 15:return n=$0(n.type,!1),n;case 11:return n=$0(n.type.render,!1),n;case 1:return n=$0(n.type,!0),n;default:return""}}function CS(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case th:return"Fragment";case eh:return"Portal";case TS:return"Profiler";case Bw:return"StrictMode";case MS:return"Suspense";case AS:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case Vb:return(n.displayName||"Context")+".Consumer";case Fb:return(n._context.displayName||"Context")+".Provider";case Hw:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Gw:return e=n.displayName||null,e!==null?e:CS(n.type)||"Memo";case Pa:e=n._payload,n=n._init;try{return CS(n(e))}catch{}}return null}function KU(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return CS(e);case 8:return e===Bw?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ol(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Bb(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function QU(n){var e=Bb(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function $m(n){n._valueTracker||(n._valueTracker=QU(n))}function Hb(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=Bb(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function H_(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function RS(n,e){var t=e.checked;return Vn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function WA(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=ol(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Gb(n,e){e=e.checked,e!=null&&zw(n,"checked",e,!1)}function IS(n,e){Gb(n,e);var t=ol(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?PS(n,e.type,t):e.hasOwnProperty("defaultValue")&&PS(n,e.type,ol(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function jA(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function PS(n,e,t){(e!=="number"||H_(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var od=Array.isArray;function yh(n,e,t,i){if(n=n.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<n.length;t++)r=e.hasOwnProperty("$"+n[t].value),n[t].selected!==r&&(n[t].selected=r),r&&i&&(n[t].defaultSelected=!0)}else{for(t=""+ol(t),e=null,r=0;r<n.length;r++){if(n[r].value===t){n[r].selected=!0,i&&(n[r].defaultSelected=!0);return}e!==null||n[r].disabled||(e=n[r])}e!==null&&(e.selected=!0)}}function bS(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(be(91));return Vn({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function qA(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(be(92));if(od(t)){if(1<t.length)throw Error(be(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:ol(t)}}function Wb(n,e){var t=ol(e.value),i=ol(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function XA(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function jb(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function LS(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?jb(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Km,qb=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,r){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,r)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Km=Km||document.createElement("div"),Km.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Km.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Ud(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var gd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},JU=["Webkit","ms","Moz","O"];Object.keys(gd).forEach(function(n){JU.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),gd[e]=gd[n]})});function Xb(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||gd.hasOwnProperty(n)&&gd[n]?(""+e).trim():e+"px"}function Yb(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,r=Xb(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,r):n[t]=r}}var ZU=Vn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function NS(n,e){if(e){if(ZU[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(be(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(be(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(be(61))}if(e.style!=null&&typeof e.style!="object")throw Error(be(62))}}function DS(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kS=null;function Ww(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var OS=null,vh=null,xh=null;function YA(n){if(n=Np(n)){if(typeof OS!="function")throw Error(be(280));var e=n.stateNode;e&&(e=qy(e),OS(n.stateNode,n.type,e))}}function $b(n){vh?xh?xh.push(n):xh=[n]:vh=n}function Kb(){if(vh){var n=vh,e=xh;if(xh=vh=null,YA(n),e)for(n=0;n<e.length;n++)YA(e[n])}}function Qb(n,e){return n(e)}function Jb(){}var K0=!1;function Zb(n,e,t){if(K0)return n(e,t);K0=!0;try{return Qb(n,e,t)}finally{K0=!1,(vh!==null||xh!==null)&&(Jb(),Kb())}}function Fd(n,e){var t=n.stateNode;if(t===null)return null;var i=qy(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(be(231,e,typeof t));return t}var US=!1;if(Qo)try{var Uf={};Object.defineProperty(Uf,"passive",{get:function(){US=!0}}),window.addEventListener("test",Uf,Uf),window.removeEventListener("test",Uf,Uf)}catch{US=!1}function eF(n,e,t,i,r,s,o,a,l){var h=Array.prototype.slice.call(arguments,3);try{e.apply(t,h)}catch(f){this.onError(f)}}var _d=!1,G_=null,W_=!1,FS=null,tF={onError:function(n){_d=!0,G_=n}};function nF(n,e,t,i,r,s,o,a,l){_d=!1,G_=null,eF.apply(tF,arguments)}function iF(n,e,t,i,r,s,o,a,l){if(nF.apply(this,arguments),_d){if(_d){var h=G_;_d=!1,G_=null}else throw Error(be(198));W_||(W_=!0,FS=h)}}function Xu(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function e2(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function $A(n){if(Xu(n)!==n)throw Error(be(188))}function rF(n){var e=n.alternate;if(!e){if(e=Xu(n),e===null)throw Error(be(188));return e!==n?null:n}for(var t=n,i=e;;){var r=t.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){t=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===t)return $A(r),n;if(s===i)return $A(r),e;s=s.sibling}throw Error(be(188))}if(t.return!==i.return)t=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===t){o=!0,t=r,i=s;break}if(a===i){o=!0,i=r,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,i=r;break}if(a===i){o=!0,i=s,t=r;break}a=a.sibling}if(!o)throw Error(be(189))}}if(t.alternate!==i)throw Error(be(190))}if(t.tag!==3)throw Error(be(188));return t.stateNode.current===t?n:e}function t2(n){return n=rF(n),n!==null?n2(n):null}function n2(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=n2(n);if(e!==null)return e;n=n.sibling}return null}var i2=ts.unstable_scheduleCallback,KA=ts.unstable_cancelCallback,sF=ts.unstable_shouldYield,oF=ts.unstable_requestPaint,ei=ts.unstable_now,aF=ts.unstable_getCurrentPriorityLevel,jw=ts.unstable_ImmediatePriority,r2=ts.unstable_UserBlockingPriority,j_=ts.unstable_NormalPriority,lF=ts.unstable_LowPriority,s2=ts.unstable_IdlePriority,Hy=null,ho=null;function uF(n){if(ho&&typeof ho.onCommitFiberRoot=="function")try{ho.onCommitFiberRoot(Hy,n,void 0,(n.current.flags&128)===128)}catch{}}var Ws=Math.clz32?Math.clz32:fF,cF=Math.log,hF=Math.LN2;function fF(n){return n>>>=0,n===0?32:31-(cF(n)/hF|0)|0}var Qm=64,Jm=4194304;function ad(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function q_(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,r=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~r;a!==0?i=ad(a):(s&=o,s!==0&&(i=ad(s)))}else o=t&~r,o!==0?i=ad(o):s!==0&&(i=ad(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-Ws(e),r=1<<t,i|=n[t],e&=~r;return i}function dF(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pF(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,r=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-Ws(s),a=1<<o,l=r[o];l===-1?(!(a&t)||a&i)&&(r[o]=dF(a,e)):l<=e&&(n.expiredLanes|=a),s&=~a}}function VS(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function o2(){var n=Qm;return Qm<<=1,!(Qm&4194240)&&(Qm=64),n}function Q0(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function bp(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Ws(e),n[e]=t}function mF(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var r=31-Ws(t),s=1<<r;e[r]=0,i[r]=-1,n[r]=-1,t&=~s}}function qw(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-Ws(t),r=1<<i;r&e|n[i]&e&&(n[i]|=e),t&=~r}}var pn=0;function a2(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var l2,Xw,u2,c2,h2,zS=!1,Zm=[],Ha=null,Ga=null,Wa=null,Vd=new Map,zd=new Map,La=[],gF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function QA(n,e){switch(n){case"focusin":case"focusout":Ha=null;break;case"dragenter":case"dragleave":Ga=null;break;case"mouseover":case"mouseout":Wa=null;break;case"pointerover":case"pointerout":Vd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":zd.delete(e.pointerId)}}function Ff(n,e,t,i,r,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=Np(e),e!==null&&Xw(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),n)}function _F(n,e,t,i,r){switch(e){case"focusin":return Ha=Ff(Ha,n,e,t,i,r),!0;case"dragenter":return Ga=Ff(Ga,n,e,t,i,r),!0;case"mouseover":return Wa=Ff(Wa,n,e,t,i,r),!0;case"pointerover":var s=r.pointerId;return Vd.set(s,Ff(Vd.get(s)||null,n,e,t,i,r)),!0;case"gotpointercapture":return s=r.pointerId,zd.set(s,Ff(zd.get(s)||null,n,e,t,i,r)),!0}return!1}function f2(n){var e=du(n.target);if(e!==null){var t=Xu(e);if(t!==null){if(e=t.tag,e===13){if(e=e2(t),e!==null){n.blockedOn=e,h2(n.priority,function(){u2(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function p_(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=BS(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);kS=i,t.target.dispatchEvent(i),kS=null}else return e=Np(t),e!==null&&Xw(e),n.blockedOn=t,!1;e.shift()}return!0}function JA(n,e,t){p_(n)&&t.delete(e)}function yF(){zS=!1,Ha!==null&&p_(Ha)&&(Ha=null),Ga!==null&&p_(Ga)&&(Ga=null),Wa!==null&&p_(Wa)&&(Wa=null),Vd.forEach(JA),zd.forEach(JA)}function Vf(n,e){n.blockedOn===e&&(n.blockedOn=null,zS||(zS=!0,ts.unstable_scheduleCallback(ts.unstable_NormalPriority,yF)))}function Bd(n){function e(r){return Vf(r,n)}if(0<Zm.length){Vf(Zm[0],n);for(var t=1;t<Zm.length;t++){var i=Zm[t];i.blockedOn===n&&(i.blockedOn=null)}}for(Ha!==null&&Vf(Ha,n),Ga!==null&&Vf(Ga,n),Wa!==null&&Vf(Wa,n),Vd.forEach(e),zd.forEach(e),t=0;t<La.length;t++)i=La[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<La.length&&(t=La[0],t.blockedOn===null);)f2(t),t.blockedOn===null&&La.shift()}var Sh=la.ReactCurrentBatchConfig,X_=!0;function vF(n,e,t,i){var r=pn,s=Sh.transition;Sh.transition=null;try{pn=1,Yw(n,e,t,i)}finally{pn=r,Sh.transition=s}}function xF(n,e,t,i){var r=pn,s=Sh.transition;Sh.transition=null;try{pn=4,Yw(n,e,t,i)}finally{pn=r,Sh.transition=s}}function Yw(n,e,t,i){if(X_){var r=BS(n,e,t,i);if(r===null)ax(n,e,i,Y_,t),QA(n,i);else if(_F(r,n,e,t,i))i.stopPropagation();else if(QA(n,i),e&4&&-1<gF.indexOf(n)){for(;r!==null;){var s=Np(r);if(s!==null&&l2(s),s=BS(n,e,t,i),s===null&&ax(n,e,i,Y_,t),s===r)break;r=s}r!==null&&i.stopPropagation()}else ax(n,e,i,null,t)}}var Y_=null;function BS(n,e,t,i){if(Y_=null,n=Ww(i),n=du(n),n!==null)if(e=Xu(n),e===null)n=null;else if(t=e.tag,t===13){if(n=e2(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Y_=n,null}function d2(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(aF()){case jw:return 1;case r2:return 4;case j_:case lF:return 16;case s2:return 536870912;default:return 16}default:return 16}}var Va=null,$w=null,m_=null;function p2(){if(m_)return m_;var n,e=$w,t=e.length,i,r="value"in Va?Va.value:Va.textContent,s=r.length;for(n=0;n<t&&e[n]===r[n];n++);var o=t-n;for(i=1;i<=o&&e[t-i]===r[s-i];i++);return m_=r.slice(n,1<i?1-i:void 0)}function g_(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function eg(){return!0}function ZA(){return!1}function rs(n){function e(t,i,r,s,o){this._reactName=t,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?eg:ZA,this.isPropagationStopped=ZA,this}return Vn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=eg)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=eg)},persist:function(){},isPersistent:eg}),e}var Qh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Kw=rs(Qh),Lp=Vn({},Qh,{view:0,detail:0}),SF=rs(Lp),J0,Z0,zf,Gy=Vn({},Lp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qw,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==zf&&(zf&&n.type==="mousemove"?(J0=n.screenX-zf.screenX,Z0=n.screenY-zf.screenY):Z0=J0=0,zf=n),J0)},movementY:function(n){return"movementY"in n?n.movementY:Z0}}),eC=rs(Gy),EF=Vn({},Gy,{dataTransfer:0}),wF=rs(EF),TF=Vn({},Lp,{relatedTarget:0}),ex=rs(TF),MF=Vn({},Qh,{animationName:0,elapsedTime:0,pseudoElement:0}),AF=rs(MF),CF=Vn({},Qh,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),RF=rs(CF),IF=Vn({},Qh,{data:0}),tC=rs(IF),PF={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bF={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},LF={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function NF(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=LF[n])?!!e[n]:!1}function Qw(){return NF}var DF=Vn({},Lp,{key:function(n){if(n.key){var e=PF[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=g_(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?bF[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qw,charCode:function(n){return n.type==="keypress"?g_(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?g_(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),kF=rs(DF),OF=Vn({},Gy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nC=rs(OF),UF=Vn({},Lp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qw}),FF=rs(UF),VF=Vn({},Qh,{propertyName:0,elapsedTime:0,pseudoElement:0}),zF=rs(VF),BF=Vn({},Gy,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),HF=rs(BF),GF=[9,13,27,32],Jw=Qo&&"CompositionEvent"in window,yd=null;Qo&&"documentMode"in document&&(yd=document.documentMode);var WF=Qo&&"TextEvent"in window&&!yd,m2=Qo&&(!Jw||yd&&8<yd&&11>=yd),iC=" ",rC=!1;function g2(n,e){switch(n){case"keyup":return GF.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _2(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var nh=!1;function jF(n,e){switch(n){case"compositionend":return _2(e);case"keypress":return e.which!==32?null:(rC=!0,iC);case"textInput":return n=e.data,n===iC&&rC?null:n;default:return null}}function qF(n,e){if(nh)return n==="compositionend"||!Jw&&g2(n,e)?(n=p2(),m_=$w=Va=null,nh=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return m2&&e.locale!=="ko"?null:e.data;default:return null}}var XF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sC(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!XF[n.type]:e==="textarea"}function y2(n,e,t,i){$b(i),e=$_(e,"onChange"),0<e.length&&(t=new Kw("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var vd=null,Hd=null;function YF(n){I2(n,0)}function Wy(n){var e=sh(n);if(Hb(e))return n}function $F(n,e){if(n==="change")return e}var v2=!1;if(Qo){var tx;if(Qo){var nx="oninput"in document;if(!nx){var oC=document.createElement("div");oC.setAttribute("oninput","return;"),nx=typeof oC.oninput=="function"}tx=nx}else tx=!1;v2=tx&&(!document.documentMode||9<document.documentMode)}function aC(){vd&&(vd.detachEvent("onpropertychange",x2),Hd=vd=null)}function x2(n){if(n.propertyName==="value"&&Wy(Hd)){var e=[];y2(e,Hd,n,Ww(n)),Zb(YF,e)}}function KF(n,e,t){n==="focusin"?(aC(),vd=e,Hd=t,vd.attachEvent("onpropertychange",x2)):n==="focusout"&&aC()}function QF(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Wy(Hd)}function JF(n,e){if(n==="click")return Wy(e)}function ZF(n,e){if(n==="input"||n==="change")return Wy(e)}function e4(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Xs=typeof Object.is=="function"?Object.is:e4;function Gd(n,e){if(Xs(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var r=t[i];if(!wS.call(e,r)||!Xs(n[r],e[r]))return!1}return!0}function lC(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function uC(n,e){var t=lC(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=lC(t)}}function S2(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?S2(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function E2(){for(var n=window,e=H_();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=H_(n.document)}return e}function Zw(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function t4(n){var e=E2(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&S2(t.ownerDocument.documentElement,t)){if(i!==null&&Zw(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var r=t.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!n.extend&&s>i&&(r=i,i=s,s=r),r=uC(t,s);var o=uC(t,i);r&&o&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),n.removeAllRanges(),s>i?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var n4=Qo&&"documentMode"in document&&11>=document.documentMode,ih=null,HS=null,xd=null,GS=!1;function cC(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;GS||ih==null||ih!==H_(i)||(i=ih,"selectionStart"in i&&Zw(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),xd&&Gd(xd,i)||(xd=i,i=$_(HS,"onSelect"),0<i.length&&(e=new Kw("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=ih)))}function tg(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var rh={animationend:tg("Animation","AnimationEnd"),animationiteration:tg("Animation","AnimationIteration"),animationstart:tg("Animation","AnimationStart"),transitionend:tg("Transition","TransitionEnd")},ix={},w2={};Qo&&(w2=document.createElement("div").style,"AnimationEvent"in window||(delete rh.animationend.animation,delete rh.animationiteration.animation,delete rh.animationstart.animation),"TransitionEvent"in window||delete rh.transitionend.transition);function jy(n){if(ix[n])return ix[n];if(!rh[n])return n;var e=rh[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in w2)return ix[n]=e[t];return n}var T2=jy("animationend"),M2=jy("animationiteration"),A2=jy("animationstart"),C2=jy("transitionend"),R2=new Map,hC="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function yl(n,e){R2.set(n,e),qu(e,[n])}for(var rx=0;rx<hC.length;rx++){var sx=hC[rx],i4=sx.toLowerCase(),r4=sx[0].toUpperCase()+sx.slice(1);yl(i4,"on"+r4)}yl(T2,"onAnimationEnd");yl(M2,"onAnimationIteration");yl(A2,"onAnimationStart");yl("dblclick","onDoubleClick");yl("focusin","onFocus");yl("focusout","onBlur");yl(C2,"onTransitionEnd");Ph("onMouseEnter",["mouseout","mouseover"]);Ph("onMouseLeave",["mouseout","mouseover"]);Ph("onPointerEnter",["pointerout","pointerover"]);Ph("onPointerLeave",["pointerout","pointerover"]);qu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));qu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));qu("onBeforeInput",["compositionend","keypress","textInput","paste"]);qu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));qu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));qu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ld="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),s4=new Set("cancel close invalid load scroll toggle".split(" ").concat(ld));function fC(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,iF(i,e,void 0,n),n.currentTarget=null}function I2(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,h=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;fC(r,a,h),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,h=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;fC(r,a,h),s=l}}}if(W_)throw n=FS,W_=!1,FS=null,n}function En(n,e){var t=e[YS];t===void 0&&(t=e[YS]=new Set);var i=n+"__bubble";t.has(i)||(P2(e,n,2,!1),t.add(i))}function ox(n,e,t){var i=0;e&&(i|=4),P2(t,n,i,e)}var ng="_reactListening"+Math.random().toString(36).slice(2);function Wd(n){if(!n[ng]){n[ng]=!0,Ub.forEach(function(t){t!=="selectionchange"&&(s4.has(t)||ox(t,!1,n),ox(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[ng]||(e[ng]=!0,ox("selectionchange",!1,e))}}function P2(n,e,t,i){switch(d2(e)){case 1:var r=vF;break;case 4:r=xF;break;default:r=Yw}t=r.bind(null,e,t,n),r=void 0,!US||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?n.addEventListener(e,t,{capture:!0,passive:r}):n.addEventListener(e,t,!0):r!==void 0?n.addEventListener(e,t,{passive:r}):n.addEventListener(e,t,!1)}function ax(n,e,t,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=du(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}Zb(function(){var h=s,f=Ww(t),d=[];e:{var p=R2.get(n);if(p!==void 0){var _=Kw,v=n;switch(n){case"keypress":if(g_(t)===0)break e;case"keydown":case"keyup":_=kF;break;case"focusin":v="focus",_=ex;break;case"focusout":v="blur",_=ex;break;case"beforeblur":case"afterblur":_=ex;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=eC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=wF;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=FF;break;case T2:case M2:case A2:_=AF;break;case C2:_=zF;break;case"scroll":_=SF;break;case"wheel":_=HF;break;case"copy":case"cut":case"paste":_=RF;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=nC}var T=(e&4)!==0,x=!T&&n==="scroll",y=T?p!==null?p+"Capture":null:p;T=[];for(var w=h,E;w!==null;){E=w;var I=E.stateNode;if(E.tag===5&&I!==null&&(E=I,y!==null&&(I=Fd(w,y),I!=null&&T.push(jd(w,I,E)))),x)break;w=w.return}0<T.length&&(p=new _(p,v,null,t,f),d.push({event:p,listeners:T}))}}if(!(e&7)){e:{if(p=n==="mouseover"||n==="pointerover",_=n==="mouseout"||n==="pointerout",p&&t!==kS&&(v=t.relatedTarget||t.fromElement)&&(du(v)||v[Jo]))break e;if((_||p)&&(p=f.window===f?f:(p=f.ownerDocument)?p.defaultView||p.parentWindow:window,_?(v=t.relatedTarget||t.toElement,_=h,v=v?du(v):null,v!==null&&(x=Xu(v),v!==x||v.tag!==5&&v.tag!==6)&&(v=null)):(_=null,v=h),_!==v)){if(T=eC,I="onMouseLeave",y="onMouseEnter",w="mouse",(n==="pointerout"||n==="pointerover")&&(T=nC,I="onPointerLeave",y="onPointerEnter",w="pointer"),x=_==null?p:sh(_),E=v==null?p:sh(v),p=new T(I,w+"leave",_,t,f),p.target=x,p.relatedTarget=E,I=null,du(f)===h&&(T=new T(y,w+"enter",v,t,f),T.target=E,T.relatedTarget=x,I=T),x=I,_&&v)t:{for(T=_,y=v,w=0,E=T;E;E=Mc(E))w++;for(E=0,I=y;I;I=Mc(I))E++;for(;0<w-E;)T=Mc(T),w--;for(;0<E-w;)y=Mc(y),E--;for(;w--;){if(T===y||y!==null&&T===y.alternate)break t;T=Mc(T),y=Mc(y)}T=null}else T=null;_!==null&&dC(d,p,_,T,!1),v!==null&&x!==null&&dC(d,x,v,T,!0)}}e:{if(p=h?sh(h):window,_=p.nodeName&&p.nodeName.toLowerCase(),_==="select"||_==="input"&&p.type==="file")var O=$F;else if(sC(p))if(v2)O=ZF;else{O=QF;var D=KF}else(_=p.nodeName)&&_.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(O=JF);if(O&&(O=O(n,h))){y2(d,O,t,f);break e}D&&D(n,p,h),n==="focusout"&&(D=p._wrapperState)&&D.controlled&&p.type==="number"&&PS(p,"number",p.value)}switch(D=h?sh(h):window,n){case"focusin":(sC(D)||D.contentEditable==="true")&&(ih=D,HS=h,xd=null);break;case"focusout":xd=HS=ih=null;break;case"mousedown":GS=!0;break;case"contextmenu":case"mouseup":case"dragend":GS=!1,cC(d,t,f);break;case"selectionchange":if(n4)break;case"keydown":case"keyup":cC(d,t,f)}var R;if(Jw)e:{switch(n){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else nh?g2(n,t)&&(b="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(b="onCompositionStart");b&&(m2&&t.locale!=="ko"&&(nh||b!=="onCompositionStart"?b==="onCompositionEnd"&&nh&&(R=p2()):(Va=f,$w="value"in Va?Va.value:Va.textContent,nh=!0)),D=$_(h,b),0<D.length&&(b=new tC(b,n,null,t,f),d.push({event:b,listeners:D}),R?b.data=R:(R=_2(t),R!==null&&(b.data=R)))),(R=WF?jF(n,t):qF(n,t))&&(h=$_(h,"onBeforeInput"),0<h.length&&(f=new tC("onBeforeInput","beforeinput",null,t,f),d.push({event:f,listeners:h}),f.data=R))}I2(d,e)})}function jd(n,e,t){return{instance:n,listener:e,currentTarget:t}}function $_(n,e){for(var t=e+"Capture",i=[];n!==null;){var r=n,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=Fd(n,t),s!=null&&i.unshift(jd(n,s,r)),s=Fd(n,e),s!=null&&i.push(jd(n,s,r))),n=n.return}return i}function Mc(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function dC(n,e,t,i,r){for(var s=e._reactName,o=[];t!==null&&t!==i;){var a=t,l=a.alternate,h=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&h!==null&&(a=h,r?(l=Fd(t,s),l!=null&&o.unshift(jd(t,l,a))):r||(l=Fd(t,s),l!=null&&o.push(jd(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var o4=/\r\n?/g,a4=/\u0000|\uFFFD/g;function pC(n){return(typeof n=="string"?n:""+n).replace(o4,`
`).replace(a4,"")}function ig(n,e,t){if(e=pC(e),pC(n)!==e&&t)throw Error(be(425))}function K_(){}var WS=null,jS=null;function qS(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var XS=typeof setTimeout=="function"?setTimeout:void 0,l4=typeof clearTimeout=="function"?clearTimeout:void 0,mC=typeof Promise=="function"?Promise:void 0,u4=typeof queueMicrotask=="function"?queueMicrotask:typeof mC<"u"?function(n){return mC.resolve(null).then(n).catch(c4)}:XS;function c4(n){setTimeout(function(){throw n})}function lx(n,e){var t=e,i=0;do{var r=t.nextSibling;if(n.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(i===0){n.removeChild(r),Bd(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=r}while(t);Bd(e)}function ja(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function gC(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Jh=Math.random().toString(36).slice(2),ao="__reactFiber$"+Jh,qd="__reactProps$"+Jh,Jo="__reactContainer$"+Jh,YS="__reactEvents$"+Jh,h4="__reactListeners$"+Jh,f4="__reactHandles$"+Jh;function du(n){var e=n[ao];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Jo]||t[ao]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=gC(n);n!==null;){if(t=n[ao])return t;n=gC(n)}return e}n=t,t=n.parentNode}return null}function Np(n){return n=n[ao]||n[Jo],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function sh(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(be(33))}function qy(n){return n[qd]||null}var $S=[],oh=-1;function vl(n){return{current:n}}function Tn(n){0>oh||(n.current=$S[oh],$S[oh]=null,oh--)}function Sn(n,e){oh++,$S[oh]=n.current,n.current=e}var al={},tr=vl(al),Lr=vl(!1),Lu=al;function bh(n,e){var t=n.type.contextTypes;if(!t)return al;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in t)r[s]=e[s];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=r),r}function Nr(n){return n=n.childContextTypes,n!=null}function Q_(){Tn(Lr),Tn(tr)}function _C(n,e,t){if(tr.current!==al)throw Error(be(168));Sn(tr,e),Sn(Lr,t)}function b2(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(be(108,KU(n)||"Unknown",r));return Vn({},t,i)}function J_(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||al,Lu=tr.current,Sn(tr,n),Sn(Lr,Lr.current),!0}function yC(n,e,t){var i=n.stateNode;if(!i)throw Error(be(169));t?(n=b2(n,e,Lu),i.__reactInternalMemoizedMergedChildContext=n,Tn(Lr),Tn(tr),Sn(tr,n)):Tn(Lr),Sn(Lr,t)}var Vo=null,Xy=!1,ux=!1;function L2(n){Vo===null?Vo=[n]:Vo.push(n)}function d4(n){Xy=!0,L2(n)}function xl(){if(!ux&&Vo!==null){ux=!0;var n=0,e=pn;try{var t=Vo;for(pn=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}Vo=null,Xy=!1}catch(r){throw Vo!==null&&(Vo=Vo.slice(n+1)),i2(jw,xl),r}finally{pn=e,ux=!1}}return null}var ah=[],lh=0,Z_=null,ey=0,ys=[],vs=0,Nu=null,Ho=1,Go="";function iu(n,e){ah[lh++]=ey,ah[lh++]=Z_,Z_=n,ey=e}function N2(n,e,t){ys[vs++]=Ho,ys[vs++]=Go,ys[vs++]=Nu,Nu=n;var i=Ho;n=Go;var r=32-Ws(i)-1;i&=~(1<<r),t+=1;var s=32-Ws(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,Ho=1<<32-Ws(e)+r|t<<r|i,Go=s+n}else Ho=1<<s|t<<r|i,Go=n}function e1(n){n.return!==null&&(iu(n,1),N2(n,1,0))}function t1(n){for(;n===Z_;)Z_=ah[--lh],ah[lh]=null,ey=ah[--lh],ah[lh]=null;for(;n===Nu;)Nu=ys[--vs],ys[vs]=null,Go=ys[--vs],ys[vs]=null,Ho=ys[--vs],ys[vs]=null}var Zr=null,Qr=null,In=!1,Bs=null;function D2(n,e){var t=Es(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function vC(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Zr=n,Qr=ja(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Zr=n,Qr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Nu!==null?{id:Ho,overflow:Go}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Es(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Zr=n,Qr=null,!0):!1;default:return!1}}function KS(n){return(n.mode&1)!==0&&(n.flags&128)===0}function QS(n){if(In){var e=Qr;if(e){var t=e;if(!vC(n,e)){if(KS(n))throw Error(be(418));e=ja(t.nextSibling);var i=Zr;e&&vC(n,e)?D2(i,t):(n.flags=n.flags&-4097|2,In=!1,Zr=n)}}else{if(KS(n))throw Error(be(418));n.flags=n.flags&-4097|2,In=!1,Zr=n}}}function xC(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Zr=n}function rg(n){if(n!==Zr)return!1;if(!In)return xC(n),In=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!qS(n.type,n.memoizedProps)),e&&(e=Qr)){if(KS(n))throw k2(),Error(be(418));for(;e;)D2(n,e),e=ja(e.nextSibling)}if(xC(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(be(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Qr=ja(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Qr=null}}else Qr=Zr?ja(n.stateNode.nextSibling):null;return!0}function k2(){for(var n=Qr;n;)n=ja(n.nextSibling)}function Lh(){Qr=Zr=null,In=!1}function n1(n){Bs===null?Bs=[n]:Bs.push(n)}var p4=la.ReactCurrentBatchConfig;function Bf(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(be(309));var i=t.stateNode}if(!i)throw Error(be(147,n));var r=i,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(be(284));if(!t._owner)throw Error(be(290,n))}return n}function sg(n,e){throw n=Object.prototype.toString.call(e),Error(be(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function SC(n){var e=n._init;return e(n._payload)}function O2(n){function e(y,w){if(n){var E=y.deletions;E===null?(y.deletions=[w],y.flags|=16):E.push(w)}}function t(y,w){if(!n)return null;for(;w!==null;)e(y,w),w=w.sibling;return null}function i(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function r(y,w){return y=$a(y,w),y.index=0,y.sibling=null,y}function s(y,w,E){return y.index=E,n?(E=y.alternate,E!==null?(E=E.index,E<w?(y.flags|=2,w):E):(y.flags|=2,w)):(y.flags|=1048576,w)}function o(y){return n&&y.alternate===null&&(y.flags|=2),y}function a(y,w,E,I){return w===null||w.tag!==6?(w=gx(E,y.mode,I),w.return=y,w):(w=r(w,E),w.return=y,w)}function l(y,w,E,I){var O=E.type;return O===th?f(y,w,E.props.children,I,E.key):w!==null&&(w.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Pa&&SC(O)===w.type)?(I=r(w,E.props),I.ref=Bf(y,w,E),I.return=y,I):(I=w_(E.type,E.key,E.props,null,y.mode,I),I.ref=Bf(y,w,E),I.return=y,I)}function h(y,w,E,I){return w===null||w.tag!==4||w.stateNode.containerInfo!==E.containerInfo||w.stateNode.implementation!==E.implementation?(w=_x(E,y.mode,I),w.return=y,w):(w=r(w,E.children||[]),w.return=y,w)}function f(y,w,E,I,O){return w===null||w.tag!==7?(w=Tu(E,y.mode,I,O),w.return=y,w):(w=r(w,E),w.return=y,w)}function d(y,w,E){if(typeof w=="string"&&w!==""||typeof w=="number")return w=gx(""+w,y.mode,E),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ym:return E=w_(w.type,w.key,w.props,null,y.mode,E),E.ref=Bf(y,null,w),E.return=y,E;case eh:return w=_x(w,y.mode,E),w.return=y,w;case Pa:var I=w._init;return d(y,I(w._payload),E)}if(od(w)||Of(w))return w=Tu(w,y.mode,E,null),w.return=y,w;sg(y,w)}return null}function p(y,w,E,I){var O=w!==null?w.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return O!==null?null:a(y,w,""+E,I);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Ym:return E.key===O?l(y,w,E,I):null;case eh:return E.key===O?h(y,w,E,I):null;case Pa:return O=E._init,p(y,w,O(E._payload),I)}if(od(E)||Of(E))return O!==null?null:f(y,w,E,I,null);sg(y,E)}return null}function _(y,w,E,I,O){if(typeof I=="string"&&I!==""||typeof I=="number")return y=y.get(E)||null,a(w,y,""+I,O);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Ym:return y=y.get(I.key===null?E:I.key)||null,l(w,y,I,O);case eh:return y=y.get(I.key===null?E:I.key)||null,h(w,y,I,O);case Pa:var D=I._init;return _(y,w,E,D(I._payload),O)}if(od(I)||Of(I))return y=y.get(E)||null,f(w,y,I,O,null);sg(w,I)}return null}function v(y,w,E,I){for(var O=null,D=null,R=w,b=w=0,k=null;R!==null&&b<E.length;b++){R.index>b?(k=R,R=null):k=R.sibling;var M=p(y,R,E[b],I);if(M===null){R===null&&(R=k);break}n&&R&&M.alternate===null&&e(y,R),w=s(M,w,b),D===null?O=M:D.sibling=M,D=M,R=k}if(b===E.length)return t(y,R),In&&iu(y,b),O;if(R===null){for(;b<E.length;b++)R=d(y,E[b],I),R!==null&&(w=s(R,w,b),D===null?O=R:D.sibling=R,D=R);return In&&iu(y,b),O}for(R=i(y,R);b<E.length;b++)k=_(R,y,b,E[b],I),k!==null&&(n&&k.alternate!==null&&R.delete(k.key===null?b:k.key),w=s(k,w,b),D===null?O=k:D.sibling=k,D=k);return n&&R.forEach(function(P){return e(y,P)}),In&&iu(y,b),O}function T(y,w,E,I){var O=Of(E);if(typeof O!="function")throw Error(be(150));if(E=O.call(E),E==null)throw Error(be(151));for(var D=O=null,R=w,b=w=0,k=null,M=E.next();R!==null&&!M.done;b++,M=E.next()){R.index>b?(k=R,R=null):k=R.sibling;var P=p(y,R,M.value,I);if(P===null){R===null&&(R=k);break}n&&R&&P.alternate===null&&e(y,R),w=s(P,w,b),D===null?O=P:D.sibling=P,D=P,R=k}if(M.done)return t(y,R),In&&iu(y,b),O;if(R===null){for(;!M.done;b++,M=E.next())M=d(y,M.value,I),M!==null&&(w=s(M,w,b),D===null?O=M:D.sibling=M,D=M);return In&&iu(y,b),O}for(R=i(y,R);!M.done;b++,M=E.next())M=_(R,y,b,M.value,I),M!==null&&(n&&M.alternate!==null&&R.delete(M.key===null?b:M.key),w=s(M,w,b),D===null?O=M:D.sibling=M,D=M);return n&&R.forEach(function(V){return e(y,V)}),In&&iu(y,b),O}function x(y,w,E,I){if(typeof E=="object"&&E!==null&&E.type===th&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case Ym:e:{for(var O=E.key,D=w;D!==null;){if(D.key===O){if(O=E.type,O===th){if(D.tag===7){t(y,D.sibling),w=r(D,E.props.children),w.return=y,y=w;break e}}else if(D.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Pa&&SC(O)===D.type){t(y,D.sibling),w=r(D,E.props),w.ref=Bf(y,D,E),w.return=y,y=w;break e}t(y,D);break}else e(y,D);D=D.sibling}E.type===th?(w=Tu(E.props.children,y.mode,I,E.key),w.return=y,y=w):(I=w_(E.type,E.key,E.props,null,y.mode,I),I.ref=Bf(y,w,E),I.return=y,y=I)}return o(y);case eh:e:{for(D=E.key;w!==null;){if(w.key===D)if(w.tag===4&&w.stateNode.containerInfo===E.containerInfo&&w.stateNode.implementation===E.implementation){t(y,w.sibling),w=r(w,E.children||[]),w.return=y,y=w;break e}else{t(y,w);break}else e(y,w);w=w.sibling}w=_x(E,y.mode,I),w.return=y,y=w}return o(y);case Pa:return D=E._init,x(y,w,D(E._payload),I)}if(od(E))return v(y,w,E,I);if(Of(E))return T(y,w,E,I);sg(y,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,w!==null&&w.tag===6?(t(y,w.sibling),w=r(w,E),w.return=y,y=w):(t(y,w),w=gx(E,y.mode,I),w.return=y,y=w),o(y)):t(y,w)}return x}var Nh=O2(!0),U2=O2(!1),ty=vl(null),ny=null,uh=null,i1=null;function r1(){i1=uh=ny=null}function s1(n){var e=ty.current;Tn(ty),n._currentValue=e}function JS(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function Eh(n,e){ny=n,i1=uh=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(br=!0),n.firstContext=null)}function As(n){var e=n._currentValue;if(i1!==n)if(n={context:n,memoizedValue:e,next:null},uh===null){if(ny===null)throw Error(be(308));uh=n,ny.dependencies={lanes:0,firstContext:n}}else uh=uh.next=n;return e}var pu=null;function o1(n){pu===null?pu=[n]:pu.push(n)}function F2(n,e,t,i){var r=e.interleaved;return r===null?(t.next=t,o1(e)):(t.next=r.next,r.next=t),e.interleaved=t,Zo(n,i)}function Zo(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var ba=!1;function a1(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function V2(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Yo(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function qa(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,rn&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Zo(n,t)}return r=i.interleaved,r===null?(e.next=e,o1(i)):(e.next=r.next,r.next=e),i.interleaved=e,Zo(n,t)}function __(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,qw(n,t)}}function EC(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var r=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?r=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?r=s=e:s=s.next=e}else r=s=e;t={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function iy(n,e,t,i){var r=n.updateQueue;ba=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,h=l.next;l.next=null,o===null?s=h:o.next=h,o=l;var f=n.alternate;f!==null&&(f=f.updateQueue,a=f.lastBaseUpdate,a!==o&&(a===null?f.firstBaseUpdate=h:a.next=h,f.lastBaseUpdate=l))}if(s!==null){var d=r.baseState;o=0,f=h=l=null,a=s;do{var p=a.lane,_=a.eventTime;if((i&p)===p){f!==null&&(f=f.next={eventTime:_,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var v=n,T=a;switch(p=e,_=t,T.tag){case 1:if(v=T.payload,typeof v=="function"){d=v.call(_,d,p);break e}d=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=T.payload,p=typeof v=="function"?v.call(_,d,p):v,p==null)break e;d=Vn({},d,p);break e;case 2:ba=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,p=r.effects,p===null?r.effects=[a]:p.push(a))}else _={eventTime:_,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},f===null?(h=f=_,l=d):f=f.next=_,o|=p;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;p=a,a=p.next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}while(!0);if(f===null&&(l=d),r.baseState=l,r.firstBaseUpdate=h,r.lastBaseUpdate=f,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);ku|=o,n.lanes=o,n.memoizedState=d}}function wC(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],r=i.callback;if(r!==null){if(i.callback=null,i=t,typeof r!="function")throw Error(be(191,r));r.call(i)}}}var Dp={},fo=vl(Dp),Xd=vl(Dp),Yd=vl(Dp);function mu(n){if(n===Dp)throw Error(be(174));return n}function l1(n,e){switch(Sn(Yd,e),Sn(Xd,n),Sn(fo,Dp),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:LS(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=LS(e,n)}Tn(fo),Sn(fo,e)}function Dh(){Tn(fo),Tn(Xd),Tn(Yd)}function z2(n){mu(Yd.current);var e=mu(fo.current),t=LS(e,n.type);e!==t&&(Sn(Xd,n),Sn(fo,t))}function u1(n){Xd.current===n&&(Tn(fo),Tn(Xd))}var kn=vl(0);function ry(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var cx=[];function c1(){for(var n=0;n<cx.length;n++)cx[n]._workInProgressVersionPrimary=null;cx.length=0}var y_=la.ReactCurrentDispatcher,hx=la.ReactCurrentBatchConfig,Du=0,Fn=null,fi=null,Ai=null,sy=!1,Sd=!1,$d=0,m4=0;function Wi(){throw Error(be(321))}function h1(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Xs(n[t],e[t]))return!1;return!0}function f1(n,e,t,i,r,s){if(Du=s,Fn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,y_.current=n===null||n.memoizedState===null?v4:x4,n=t(i,r),Sd){s=0;do{if(Sd=!1,$d=0,25<=s)throw Error(be(301));s+=1,Ai=fi=null,e.updateQueue=null,y_.current=S4,n=t(i,r)}while(Sd)}if(y_.current=oy,e=fi!==null&&fi.next!==null,Du=0,Ai=fi=Fn=null,sy=!1,e)throw Error(be(300));return n}function d1(){var n=$d!==0;return $d=0,n}function ro(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ai===null?Fn.memoizedState=Ai=n:Ai=Ai.next=n,Ai}function Cs(){if(fi===null){var n=Fn.alternate;n=n!==null?n.memoizedState:null}else n=fi.next;var e=Ai===null?Fn.memoizedState:Ai.next;if(e!==null)Ai=e,fi=n;else{if(n===null)throw Error(be(310));fi=n,n={memoizedState:fi.memoizedState,baseState:fi.baseState,baseQueue:fi.baseQueue,queue:fi.queue,next:null},Ai===null?Fn.memoizedState=Ai=n:Ai=Ai.next=n}return Ai}function Kd(n,e){return typeof e=="function"?e(n):e}function fx(n){var e=Cs(),t=e.queue;if(t===null)throw Error(be(311));t.lastRenderedReducer=n;var i=fi,r=i.baseQueue,s=t.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,t.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,l=null,h=s;do{var f=h.lane;if((Du&f)===f)l!==null&&(l=l.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),i=h.hasEagerState?h.eagerState:n(i,h.action);else{var d={lane:f,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};l===null?(a=l=d,o=i):l=l.next=d,Fn.lanes|=f,ku|=f}h=h.next}while(h!==null&&h!==s);l===null?o=i:l.next=a,Xs(i,e.memoizedState)||(br=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,t.lastRenderedState=i}if(n=t.interleaved,n!==null){r=n;do s=r.lane,Fn.lanes|=s,ku|=s,r=r.next;while(r!==n)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function dx(n){var e=Cs(),t=e.queue;if(t===null)throw Error(be(311));t.lastRenderedReducer=n;var i=t.dispatch,r=t.pending,s=e.memoizedState;if(r!==null){t.pending=null;var o=r=r.next;do s=n(s,o.action),o=o.next;while(o!==r);Xs(s,e.memoizedState)||(br=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,i]}function B2(){}function H2(n,e){var t=Fn,i=Cs(),r=e(),s=!Xs(i.memoizedState,r);if(s&&(i.memoizedState=r,br=!0),i=i.queue,p1(j2.bind(null,t,i,n),[n]),i.getSnapshot!==e||s||Ai!==null&&Ai.memoizedState.tag&1){if(t.flags|=2048,Qd(9,W2.bind(null,t,i,r,e),void 0,null),Ci===null)throw Error(be(349));Du&30||G2(t,e,r)}return r}function G2(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Fn.updateQueue,e===null?(e={lastEffect:null,stores:null},Fn.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function W2(n,e,t,i){e.value=t,e.getSnapshot=i,q2(e)&&X2(n)}function j2(n,e,t){return t(function(){q2(e)&&X2(n)})}function q2(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Xs(n,t)}catch{return!0}}function X2(n){var e=Zo(n,1);e!==null&&js(e,n,1,-1)}function TC(n){var e=ro();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Kd,lastRenderedState:n},e.queue=n,n=n.dispatch=y4.bind(null,Fn,n),[e.memoizedState,n]}function Qd(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=Fn.updateQueue,e===null?(e={lastEffect:null,stores:null},Fn.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function Y2(){return Cs().memoizedState}function v_(n,e,t,i){var r=ro();Fn.flags|=n,r.memoizedState=Qd(1|e,t,void 0,i===void 0?null:i)}function Yy(n,e,t,i){var r=Cs();i=i===void 0?null:i;var s=void 0;if(fi!==null){var o=fi.memoizedState;if(s=o.destroy,i!==null&&h1(i,o.deps)){r.memoizedState=Qd(e,t,s,i);return}}Fn.flags|=n,r.memoizedState=Qd(1|e,t,s,i)}function MC(n,e){return v_(8390656,8,n,e)}function p1(n,e){return Yy(2048,8,n,e)}function $2(n,e){return Yy(4,2,n,e)}function K2(n,e){return Yy(4,4,n,e)}function Q2(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function J2(n,e,t){return t=t!=null?t.concat([n]):null,Yy(4,4,Q2.bind(null,e,n),t)}function m1(){}function Z2(n,e){var t=Cs();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&h1(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function eL(n,e){var t=Cs();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&h1(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function tL(n,e,t){return Du&21?(Xs(t,e)||(t=o2(),Fn.lanes|=t,ku|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,br=!0),n.memoizedState=t)}function g4(n,e){var t=pn;pn=t!==0&&4>t?t:4,n(!0);var i=hx.transition;hx.transition={};try{n(!1),e()}finally{pn=t,hx.transition=i}}function nL(){return Cs().memoizedState}function _4(n,e,t){var i=Ya(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},iL(n))rL(e,t);else if(t=F2(n,e,t,i),t!==null){var r=gr();js(t,n,i,r),sL(t,e,i)}}function y4(n,e,t){var i=Ya(n),r={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(iL(n))rL(e,r);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(r.hasEagerState=!0,r.eagerState=a,Xs(a,o)){var l=e.interleaved;l===null?(r.next=r,o1(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}t=F2(n,e,r,i),t!==null&&(r=gr(),js(t,n,i,r),sL(t,e,i))}}function iL(n){var e=n.alternate;return n===Fn||e!==null&&e===Fn}function rL(n,e){Sd=sy=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function sL(n,e,t){if(t&4194240){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,qw(n,t)}}var oy={readContext:As,useCallback:Wi,useContext:Wi,useEffect:Wi,useImperativeHandle:Wi,useInsertionEffect:Wi,useLayoutEffect:Wi,useMemo:Wi,useReducer:Wi,useRef:Wi,useState:Wi,useDebugValue:Wi,useDeferredValue:Wi,useTransition:Wi,useMutableSource:Wi,useSyncExternalStore:Wi,useId:Wi,unstable_isNewReconciler:!1},v4={readContext:As,useCallback:function(n,e){return ro().memoizedState=[n,e===void 0?null:e],n},useContext:As,useEffect:MC,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,v_(4194308,4,Q2.bind(null,e,n),t)},useLayoutEffect:function(n,e){return v_(4194308,4,n,e)},useInsertionEffect:function(n,e){return v_(4,2,n,e)},useMemo:function(n,e){var t=ro();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=ro();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=_4.bind(null,Fn,n),[i.memoizedState,n]},useRef:function(n){var e=ro();return n={current:n},e.memoizedState=n},useState:TC,useDebugValue:m1,useDeferredValue:function(n){return ro().memoizedState=n},useTransition:function(){var n=TC(!1),e=n[0];return n=g4.bind(null,n[1]),ro().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=Fn,r=ro();if(In){if(t===void 0)throw Error(be(407));t=t()}else{if(t=e(),Ci===null)throw Error(be(349));Du&30||G2(i,e,t)}r.memoizedState=t;var s={value:t,getSnapshot:e};return r.queue=s,MC(j2.bind(null,i,s,n),[n]),i.flags|=2048,Qd(9,W2.bind(null,i,s,t,e),void 0,null),t},useId:function(){var n=ro(),e=Ci.identifierPrefix;if(In){var t=Go,i=Ho;t=(i&~(1<<32-Ws(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=$d++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=m4++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},x4={readContext:As,useCallback:Z2,useContext:As,useEffect:p1,useImperativeHandle:J2,useInsertionEffect:$2,useLayoutEffect:K2,useMemo:eL,useReducer:fx,useRef:Y2,useState:function(){return fx(Kd)},useDebugValue:m1,useDeferredValue:function(n){var e=Cs();return tL(e,fi.memoizedState,n)},useTransition:function(){var n=fx(Kd)[0],e=Cs().memoizedState;return[n,e]},useMutableSource:B2,useSyncExternalStore:H2,useId:nL,unstable_isNewReconciler:!1},S4={readContext:As,useCallback:Z2,useContext:As,useEffect:p1,useImperativeHandle:J2,useInsertionEffect:$2,useLayoutEffect:K2,useMemo:eL,useReducer:dx,useRef:Y2,useState:function(){return dx(Kd)},useDebugValue:m1,useDeferredValue:function(n){var e=Cs();return fi===null?e.memoizedState=n:tL(e,fi.memoizedState,n)},useTransition:function(){var n=dx(Kd)[0],e=Cs().memoizedState;return[n,e]},useMutableSource:B2,useSyncExternalStore:H2,useId:nL,unstable_isNewReconciler:!1};function Us(n,e){if(n&&n.defaultProps){e=Vn({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function ZS(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:Vn({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var $y={isMounted:function(n){return(n=n._reactInternals)?Xu(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=gr(),r=Ya(n),s=Yo(i,r);s.payload=e,t!=null&&(s.callback=t),e=qa(n,s,r),e!==null&&(js(e,n,r,i),__(e,n,r))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=gr(),r=Ya(n),s=Yo(i,r);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=qa(n,s,r),e!==null&&(js(e,n,r,i),__(e,n,r))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=gr(),i=Ya(n),r=Yo(t,i);r.tag=2,e!=null&&(r.callback=e),e=qa(n,r,i),e!==null&&(js(e,n,i,t),__(e,n,i))}};function AC(n,e,t,i,r,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!Gd(t,i)||!Gd(r,s):!0}function oL(n,e,t){var i=!1,r=al,s=e.contextType;return typeof s=="object"&&s!==null?s=As(s):(r=Nr(e)?Lu:tr.current,i=e.contextTypes,s=(i=i!=null)?bh(n,r):al),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=$y,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=s),e}function CC(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&$y.enqueueReplaceState(e,e.state,null)}function eE(n,e,t,i){var r=n.stateNode;r.props=t,r.state=n.memoizedState,r.refs={},a1(n);var s=e.contextType;typeof s=="object"&&s!==null?r.context=As(s):(s=Nr(e)?Lu:tr.current,r.context=bh(n,s)),r.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(ZS(n,e,s,t),r.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&$y.enqueueReplaceState(r,r.state,null),iy(n,t,r,i),r.state=n.memoizedState),typeof r.componentDidMount=="function"&&(n.flags|=4194308)}function kh(n,e){try{var t="",i=e;do t+=$U(i),i=i.return;while(i);var r=t}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:r,digest:null}}function px(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function tE(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var E4=typeof WeakMap=="function"?WeakMap:Map;function aL(n,e,t){t=Yo(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){ly||(ly=!0,hE=i),tE(n,e)},t}function lL(n,e,t){t=Yo(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;t.payload=function(){return i(r)},t.callback=function(){tE(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){tE(n,e),typeof i!="function"&&(Xa===null?Xa=new Set([this]):Xa.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function RC(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new E4;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(t)||(r.add(t),n=O4.bind(null,n,e,t),e.then(n,n))}function IC(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function PC(n,e,t,i,r){return n.mode&1?(n.flags|=65536,n.lanes=r,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Yo(-1,1),e.tag=2,qa(t,e,1))),t.lanes|=1),n)}var w4=la.ReactCurrentOwner,br=!1;function dr(n,e,t,i){e.child=n===null?U2(e,null,t,i):Nh(e,n.child,t,i)}function bC(n,e,t,i,r){t=t.render;var s=e.ref;return Eh(e,r),i=f1(n,e,t,i,s,r),t=d1(),n!==null&&!br?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,ea(n,e,r)):(In&&t&&e1(e),e.flags|=1,dr(n,e,i,r),e.child)}function LC(n,e,t,i,r){if(n===null){var s=t.type;return typeof s=="function"&&!w1(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,uL(n,e,s,i,r)):(n=w_(t.type,null,i,e,e.mode,r),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&r)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:Gd,t(o,i)&&n.ref===e.ref)return ea(n,e,r)}return e.flags|=1,n=$a(s,i),n.ref=e.ref,n.return=e,e.child=n}function uL(n,e,t,i,r){if(n!==null){var s=n.memoizedProps;if(Gd(s,i)&&n.ref===e.ref)if(br=!1,e.pendingProps=i=s,(n.lanes&r)!==0)n.flags&131072&&(br=!0);else return e.lanes=n.lanes,ea(n,e,r)}return nE(n,e,t,i,r)}function cL(n,e,t){var i=e.pendingProps,r=i.children,s=n!==null?n.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Sn(hh,Xr),Xr|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Sn(hh,Xr),Xr|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:t,Sn(hh,Xr),Xr|=i}else s!==null?(i=s.baseLanes|t,e.memoizedState=null):i=t,Sn(hh,Xr),Xr|=i;return dr(n,e,r,t),e.child}function hL(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function nE(n,e,t,i,r){var s=Nr(t)?Lu:tr.current;return s=bh(e,s),Eh(e,r),t=f1(n,e,t,i,s,r),i=d1(),n!==null&&!br?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,ea(n,e,r)):(In&&i&&e1(e),e.flags|=1,dr(n,e,t,r),e.child)}function NC(n,e,t,i,r){if(Nr(t)){var s=!0;J_(e)}else s=!1;if(Eh(e,r),e.stateNode===null)x_(n,e),oL(e,t,i),eE(e,t,i,r),i=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,h=t.contextType;typeof h=="object"&&h!==null?h=As(h):(h=Nr(t)?Lu:tr.current,h=bh(e,h));var f=t.getDerivedStateFromProps,d=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==h)&&CC(e,o,i,h),ba=!1;var p=e.memoizedState;o.state=p,iy(e,i,o,r),l=e.memoizedState,a!==i||p!==l||Lr.current||ba?(typeof f=="function"&&(ZS(e,t,f,i),l=e.memoizedState),(a=ba||AC(e,t,a,i,p,l,h))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=h,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,V2(n,e),a=e.memoizedProps,h=e.type===e.elementType?a:Us(e.type,a),o.props=h,d=e.pendingProps,p=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=As(l):(l=Nr(t)?Lu:tr.current,l=bh(e,l));var _=t.getDerivedStateFromProps;(f=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||p!==l)&&CC(e,o,i,l),ba=!1,p=e.memoizedState,o.state=p,iy(e,i,o,r);var v=e.memoizedState;a!==d||p!==v||Lr.current||ba?(typeof _=="function"&&(ZS(e,t,_,i),v=e.memoizedState),(h=ba||AC(e,t,h,i,p,v,l)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,v,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,v,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=v),o.props=i,o.state=v,o.context=l,i=h):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),i=!1)}return iE(n,e,t,i,s,r)}function iE(n,e,t,i,r,s){hL(n,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&yC(e,t,!1),ea(n,e,s);i=e.stateNode,w4.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&o?(e.child=Nh(e,n.child,null,s),e.child=Nh(e,null,a,s)):dr(n,e,a,s),e.memoizedState=i.state,r&&yC(e,t,!0),e.child}function fL(n){var e=n.stateNode;e.pendingContext?_C(n,e.pendingContext,e.pendingContext!==e.context):e.context&&_C(n,e.context,!1),l1(n,e.containerInfo)}function DC(n,e,t,i,r){return Lh(),n1(r),e.flags|=256,dr(n,e,t,i),e.child}var rE={dehydrated:null,treeContext:null,retryLane:0};function sE(n){return{baseLanes:n,cachePool:null,transitions:null}}function dL(n,e,t){var i=e.pendingProps,r=kn.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(r|=1),Sn(kn,r&1),n===null)return QS(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,n=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Jy(o,i,0,null),n=Tu(n,i,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=sE(t),e.memoizedState=rE,n):g1(e,o));if(r=n.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return T4(n,e,o,i,a,r,t);if(s){s=i.fallback,o=e.mode,r=n.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=$a(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=$a(a,s):(s=Tu(s,o,t,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=n.child.memoizedState,o=o===null?sE(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=rE,i}return s=n.child,n=s.sibling,i=$a(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function g1(n,e){return e=Jy({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function og(n,e,t,i){return i!==null&&n1(i),Nh(e,n.child,null,t),n=g1(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function T4(n,e,t,i,r,s,o){if(t)return e.flags&256?(e.flags&=-257,i=px(Error(be(422))),og(n,e,o,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=Jy({mode:"visible",children:i.children},r,0,null),s=Tu(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&Nh(e,n.child,null,o),e.child.memoizedState=sE(o),e.memoizedState=rE,s);if(!(e.mode&1))return og(n,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(be(419)),i=px(s,i,void 0),og(n,e,o,i)}if(a=(o&n.childLanes)!==0,br||a){if(i=Ci,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Zo(n,r),js(i,n,r,-1))}return E1(),i=px(Error(be(421))),og(n,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=n.child,e=U4.bind(null,n),r._reactRetry=e,null):(n=s.treeContext,Qr=ja(r.nextSibling),Zr=e,In=!0,Bs=null,n!==null&&(ys[vs++]=Ho,ys[vs++]=Go,ys[vs++]=Nu,Ho=n.id,Go=n.overflow,Nu=e),e=g1(e,i.children),e.flags|=4096,e)}function kC(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),JS(n.return,e,t)}function mx(n,e,t,i,r){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=t,s.tailMode=r)}function pL(n,e,t){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(dr(n,e,i.children,t),i=kn.current,i&2)i=i&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&kC(n,t,e);else if(n.tag===19)kC(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(Sn(kn,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)n=t.alternate,n!==null&&ry(n)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),mx(e,!1,r,t,s);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(n=r.alternate,n!==null&&ry(n)===null){e.child=r;break}n=r.sibling,r.sibling=t,t=r,r=n}mx(e,!0,t,null,s);break;case"together":mx(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function x_(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function ea(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),ku|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(be(153));if(e.child!==null){for(n=e.child,t=$a(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=$a(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function M4(n,e,t){switch(e.tag){case 3:fL(e),Lh();break;case 5:z2(e);break;case 1:Nr(e.type)&&J_(e);break;case 4:l1(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Sn(ty,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Sn(kn,kn.current&1),e.flags|=128,null):t&e.child.childLanes?dL(n,e,t):(Sn(kn,kn.current&1),n=ea(n,e,t),n!==null?n.sibling:null);Sn(kn,kn.current&1);break;case 19:if(i=(t&e.childLanes)!==0,n.flags&128){if(i)return pL(n,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Sn(kn,kn.current),i)break;return null;case 22:case 23:return e.lanes=0,cL(n,e,t)}return ea(n,e,t)}var mL,oE,gL,_L;mL=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};oE=function(){};gL=function(n,e,t,i){var r=n.memoizedProps;if(r!==i){n=e.stateNode,mu(fo.current);var s=null;switch(t){case"input":r=RS(n,r),i=RS(n,i),s=[];break;case"select":r=Vn({},r,{value:void 0}),i=Vn({},i,{value:void 0}),s=[];break;case"textarea":r=bS(n,r),i=bS(n,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=K_)}NS(t,i);var o;t=null;for(h in r)if(!i.hasOwnProperty(h)&&r.hasOwnProperty(h)&&r[h]!=null)if(h==="style"){var a=r[h];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(Od.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in i){var l=i[h];if(a=r!=null?r[h]:void 0,i.hasOwnProperty(h)&&l!==a&&(l!=null||a!=null))if(h==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(s||(s=[]),s.push(h,t)),t=l;else h==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(h,l)):h==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(h,""+l):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(Od.hasOwnProperty(h)?(l!=null&&h==="onScroll"&&En("scroll",n),s||a===l||(s=[])):(s=s||[]).push(h,l))}t&&(s=s||[]).push("style",t);var h=s;(e.updateQueue=h)&&(e.flags|=4)}};_L=function(n,e,t,i){t!==i&&(e.flags|=4)};function Hf(n,e){if(!In)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function ji(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=n,r=r.sibling;else for(r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=n,r=r.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function A4(n,e,t){var i=e.pendingProps;switch(t1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ji(e),null;case 1:return Nr(e.type)&&Q_(),ji(e),null;case 3:return i=e.stateNode,Dh(),Tn(Lr),Tn(tr),c1(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(rg(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Bs!==null&&(pE(Bs),Bs=null))),oE(n,e),ji(e),null;case 5:u1(e);var r=mu(Yd.current);if(t=e.type,n!==null&&e.stateNode!=null)gL(n,e,t,i,r),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(be(166));return ji(e),null}if(n=mu(fo.current),rg(e)){i=e.stateNode,t=e.type;var s=e.memoizedProps;switch(i[ao]=e,i[qd]=s,n=(e.mode&1)!==0,t){case"dialog":En("cancel",i),En("close",i);break;case"iframe":case"object":case"embed":En("load",i);break;case"video":case"audio":for(r=0;r<ld.length;r++)En(ld[r],i);break;case"source":En("error",i);break;case"img":case"image":case"link":En("error",i),En("load",i);break;case"details":En("toggle",i);break;case"input":WA(i,s),En("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},En("invalid",i);break;case"textarea":qA(i,s),En("invalid",i)}NS(t,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&ig(i.textContent,a,n),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&ig(i.textContent,a,n),r=["children",""+a]):Od.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&En("scroll",i)}switch(t){case"input":$m(i),jA(i,s,!0);break;case"textarea":$m(i),XA(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=K_)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=jb(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=o.createElement(t,{is:i.is}):(n=o.createElement(t),t==="select"&&(o=n,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):n=o.createElementNS(n,t),n[ao]=e,n[qd]=i,mL(n,e,!1,!1),e.stateNode=n;e:{switch(o=DS(t,i),t){case"dialog":En("cancel",n),En("close",n),r=i;break;case"iframe":case"object":case"embed":En("load",n),r=i;break;case"video":case"audio":for(r=0;r<ld.length;r++)En(ld[r],n);r=i;break;case"source":En("error",n),r=i;break;case"img":case"image":case"link":En("error",n),En("load",n),r=i;break;case"details":En("toggle",n),r=i;break;case"input":WA(n,i),r=RS(n,i),En("invalid",n);break;case"option":r=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},r=Vn({},i,{value:void 0}),En("invalid",n);break;case"textarea":qA(n,i),r=bS(n,i),En("invalid",n);break;default:r=i}NS(t,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Yb(n,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&qb(n,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Ud(n,l):typeof l=="number"&&Ud(n,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Od.hasOwnProperty(s)?l!=null&&s==="onScroll"&&En("scroll",n):l!=null&&zw(n,s,l,o))}switch(t){case"input":$m(n),jA(n,i,!1);break;case"textarea":$m(n),XA(n);break;case"option":i.value!=null&&n.setAttribute("value",""+ol(i.value));break;case"select":n.multiple=!!i.multiple,s=i.value,s!=null?yh(n,!!i.multiple,s,!1):i.defaultValue!=null&&yh(n,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(n.onclick=K_)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ji(e),null;case 6:if(n&&e.stateNode!=null)_L(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(be(166));if(t=mu(Yd.current),mu(fo.current),rg(e)){if(i=e.stateNode,t=e.memoizedProps,i[ao]=e,(s=i.nodeValue!==t)&&(n=Zr,n!==null))switch(n.tag){case 3:ig(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&ig(i.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[ao]=e,e.stateNode=i}return ji(e),null;case 13:if(Tn(kn),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(In&&Qr!==null&&e.mode&1&&!(e.flags&128))k2(),Lh(),e.flags|=98560,s=!1;else if(s=rg(e),i!==null&&i.dehydrated!==null){if(n===null){if(!s)throw Error(be(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(be(317));s[ao]=e}else Lh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ji(e),s=!1}else Bs!==null&&(pE(Bs),Bs=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(n===null||kn.current&1?pi===0&&(pi=3):E1())),e.updateQueue!==null&&(e.flags|=4),ji(e),null);case 4:return Dh(),oE(n,e),n===null&&Wd(e.stateNode.containerInfo),ji(e),null;case 10:return s1(e.type._context),ji(e),null;case 17:return Nr(e.type)&&Q_(),ji(e),null;case 19:if(Tn(kn),s=e.memoizedState,s===null)return ji(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)Hf(s,!1);else{if(pi!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=ry(n),o!==null){for(e.flags|=128,Hf(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)s=t,n=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Sn(kn,kn.current&1|2),e.child}n=n.sibling}s.tail!==null&&ei()>Oh&&(e.flags|=128,i=!0,Hf(s,!1),e.lanes=4194304)}else{if(!i)if(n=ry(o),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Hf(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!In)return ji(e),null}else 2*ei()-s.renderingStartTime>Oh&&t!==1073741824&&(e.flags|=128,i=!0,Hf(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ei(),e.sibling=null,t=kn.current,Sn(kn,i?t&1|2:t&1),e):(ji(e),null);case 22:case 23:return S1(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Xr&1073741824&&(ji(e),e.subtreeFlags&6&&(e.flags|=8192)):ji(e),null;case 24:return null;case 25:return null}throw Error(be(156,e.tag))}function C4(n,e){switch(t1(e),e.tag){case 1:return Nr(e.type)&&Q_(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Dh(),Tn(Lr),Tn(tr),c1(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return u1(e),null;case 13:if(Tn(kn),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(be(340));Lh()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Tn(kn),null;case 4:return Dh(),null;case 10:return s1(e.type._context),null;case 22:case 23:return S1(),null;case 24:return null;default:return null}}var ag=!1,Qi=!1,R4=typeof WeakSet=="function"?WeakSet:Set,it=null;function ch(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){jn(n,e,i)}else t.current=null}function aE(n,e,t){try{t()}catch(i){jn(n,e,i)}}var OC=!1;function I4(n,e){if(WS=X_,n=E2(),Zw(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,h=0,f=0,d=n,p=null;t:for(;;){for(var _;d!==t||r!==0&&d.nodeType!==3||(a=o+r),d!==s||i!==0&&d.nodeType!==3||(l=o+i),d.nodeType===3&&(o+=d.nodeValue.length),(_=d.firstChild)!==null;)p=d,d=_;for(;;){if(d===n)break t;if(p===t&&++h===r&&(a=o),p===s&&++f===i&&(l=o),(_=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=_}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(jS={focusedElem:n,selectionRange:t},X_=!1,it=e;it!==null;)if(e=it,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,it=n;else for(;it!==null;){e=it;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var T=v.memoizedProps,x=v.memoizedState,y=e.stateNode,w=y.getSnapshotBeforeUpdate(e.elementType===e.type?T:Us(e.type,T),x);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(be(163))}}catch(I){jn(e,e.return,I)}if(n=e.sibling,n!==null){n.return=e.return,it=n;break}it=e.return}return v=OC,OC=!1,v}function Ed(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&n)===n){var s=r.destroy;r.destroy=void 0,s!==void 0&&aE(e,t,s)}r=r.next}while(r!==i)}}function Ky(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function lE(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function yL(n){var e=n.alternate;e!==null&&(n.alternate=null,yL(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[ao],delete e[qd],delete e[YS],delete e[h4],delete e[f4])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function vL(n){return n.tag===5||n.tag===3||n.tag===4}function UC(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||vL(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function uE(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=K_));else if(i!==4&&(n=n.child,n!==null))for(uE(n,e,t),n=n.sibling;n!==null;)uE(n,e,t),n=n.sibling}function cE(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(cE(n,e,t),n=n.sibling;n!==null;)cE(n,e,t),n=n.sibling}var Ii=null,zs=!1;function xa(n,e,t){for(t=t.child;t!==null;)xL(n,e,t),t=t.sibling}function xL(n,e,t){if(ho&&typeof ho.onCommitFiberUnmount=="function")try{ho.onCommitFiberUnmount(Hy,t)}catch{}switch(t.tag){case 5:Qi||ch(t,e);case 6:var i=Ii,r=zs;Ii=null,xa(n,e,t),Ii=i,zs=r,Ii!==null&&(zs?(n=Ii,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Ii.removeChild(t.stateNode));break;case 18:Ii!==null&&(zs?(n=Ii,t=t.stateNode,n.nodeType===8?lx(n.parentNode,t):n.nodeType===1&&lx(n,t),Bd(n)):lx(Ii,t.stateNode));break;case 4:i=Ii,r=zs,Ii=t.stateNode.containerInfo,zs=!0,xa(n,e,t),Ii=i,zs=r;break;case 0:case 11:case 14:case 15:if(!Qi&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&aE(t,e,o),r=r.next}while(r!==i)}xa(n,e,t);break;case 1:if(!Qi&&(ch(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(a){jn(t,e,a)}xa(n,e,t);break;case 21:xa(n,e,t);break;case 22:t.mode&1?(Qi=(i=Qi)||t.memoizedState!==null,xa(n,e,t),Qi=i):xa(n,e,t);break;default:xa(n,e,t)}}function FC(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new R4),e.forEach(function(i){var r=F4.bind(null,n,i);t.has(i)||(t.add(i),i.then(r,r))})}}function Ns(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var r=t[i];try{var s=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ii=a.stateNode,zs=!1;break e;case 3:Ii=a.stateNode.containerInfo,zs=!0;break e;case 4:Ii=a.stateNode.containerInfo,zs=!0;break e}a=a.return}if(Ii===null)throw Error(be(160));xL(s,o,r),Ii=null,zs=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(h){jn(r,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)SL(e,n),e=e.sibling}function SL(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Ns(e,n),io(n),i&4){try{Ed(3,n,n.return),Ky(3,n)}catch(T){jn(n,n.return,T)}try{Ed(5,n,n.return)}catch(T){jn(n,n.return,T)}}break;case 1:Ns(e,n),io(n),i&512&&t!==null&&ch(t,t.return);break;case 5:if(Ns(e,n),io(n),i&512&&t!==null&&ch(t,t.return),n.flags&32){var r=n.stateNode;try{Ud(r,"")}catch(T){jn(n,n.return,T)}}if(i&4&&(r=n.stateNode,r!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Gb(r,s),DS(a,o);var h=DS(a,s);for(o=0;o<l.length;o+=2){var f=l[o],d=l[o+1];f==="style"?Yb(r,d):f==="dangerouslySetInnerHTML"?qb(r,d):f==="children"?Ud(r,d):zw(r,f,d,h)}switch(a){case"input":IS(r,s);break;case"textarea":Wb(r,s);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var _=s.value;_!=null?yh(r,!!s.multiple,_,!1):p!==!!s.multiple&&(s.defaultValue!=null?yh(r,!!s.multiple,s.defaultValue,!0):yh(r,!!s.multiple,s.multiple?[]:"",!1))}r[qd]=s}catch(T){jn(n,n.return,T)}}break;case 6:if(Ns(e,n),io(n),i&4){if(n.stateNode===null)throw Error(be(162));r=n.stateNode,s=n.memoizedProps;try{r.nodeValue=s}catch(T){jn(n,n.return,T)}}break;case 3:if(Ns(e,n),io(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{Bd(e.containerInfo)}catch(T){jn(n,n.return,T)}break;case 4:Ns(e,n),io(n);break;case 13:Ns(e,n),io(n),r=n.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(v1=ei())),i&4&&FC(n);break;case 22:if(f=t!==null&&t.memoizedState!==null,n.mode&1?(Qi=(h=Qi)||f,Ns(e,n),Qi=h):Ns(e,n),io(n),i&8192){if(h=n.memoizedState!==null,(n.stateNode.isHidden=h)&&!f&&n.mode&1)for(it=n,f=n.child;f!==null;){for(d=it=f;it!==null;){switch(p=it,_=p.child,p.tag){case 0:case 11:case 14:case 15:Ed(4,p,p.return);break;case 1:ch(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){i=p,t=p.return;try{e=i,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(T){jn(i,t,T)}}break;case 5:ch(p,p.return);break;case 22:if(p.memoizedState!==null){zC(d);continue}}_!==null?(_.return=p,it=_):zC(d)}f=f.sibling}e:for(f=null,d=n;;){if(d.tag===5){if(f===null){f=d;try{r=d.stateNode,h?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Xb("display",o))}catch(T){jn(n,n.return,T)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=h?"":d.memoizedProps}catch(T){jn(n,n.return,T)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===n)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Ns(e,n),io(n),i&4&&FC(n);break;case 21:break;default:Ns(e,n),io(n)}}function io(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(vL(t)){var i=t;break e}t=t.return}throw Error(be(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Ud(r,""),i.flags&=-33);var s=UC(n);cE(n,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=UC(n);uE(n,a,o);break;default:throw Error(be(161))}}catch(l){jn(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function P4(n,e,t){it=n,EL(n)}function EL(n,e,t){for(var i=(n.mode&1)!==0;it!==null;){var r=it,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||ag;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Qi;a=ag;var h=Qi;if(ag=o,(Qi=l)&&!h)for(it=r;it!==null;)o=it,l=o.child,o.tag===22&&o.memoizedState!==null?BC(r):l!==null?(l.return=o,it=l):BC(r);for(;s!==null;)it=s,EL(s),s=s.sibling;it=r,ag=a,Qi=h}VC(n)}else r.subtreeFlags&8772&&s!==null?(s.return=r,it=s):VC(n)}}function VC(n){for(;it!==null;){var e=it;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Qi||Ky(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Qi)if(t===null)i.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:Us(e.type,t.memoizedProps);i.componentDidUpdate(r,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&wC(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}wC(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var f=h.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&Bd(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(be(163))}Qi||e.flags&512&&lE(e)}catch(p){jn(e,e.return,p)}}if(e===n){it=null;break}if(t=e.sibling,t!==null){t.return=e.return,it=t;break}it=e.return}}function zC(n){for(;it!==null;){var e=it;if(e===n){it=null;break}var t=e.sibling;if(t!==null){t.return=e.return,it=t;break}it=e.return}}function BC(n){for(;it!==null;){var e=it;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Ky(4,e)}catch(l){jn(e,t,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){jn(e,r,l)}}var s=e.return;try{lE(e)}catch(l){jn(e,s,l)}break;case 5:var o=e.return;try{lE(e)}catch(l){jn(e,o,l)}}}catch(l){jn(e,e.return,l)}if(e===n){it=null;break}var a=e.sibling;if(a!==null){a.return=e.return,it=a;break}it=e.return}}var b4=Math.ceil,ay=la.ReactCurrentDispatcher,_1=la.ReactCurrentOwner,ws=la.ReactCurrentBatchConfig,rn=0,Ci=null,oi=null,Li=0,Xr=0,hh=vl(0),pi=0,Jd=null,ku=0,Qy=0,y1=0,wd=null,Ir=null,v1=0,Oh=1/0,Fo=null,ly=!1,hE=null,Xa=null,lg=!1,za=null,uy=0,Td=0,fE=null,S_=-1,E_=0;function gr(){return rn&6?ei():S_!==-1?S_:S_=ei()}function Ya(n){return n.mode&1?rn&2&&Li!==0?Li&-Li:p4.transition!==null?(E_===0&&(E_=o2()),E_):(n=pn,n!==0||(n=window.event,n=n===void 0?16:d2(n.type)),n):1}function js(n,e,t,i){if(50<Td)throw Td=0,fE=null,Error(be(185));bp(n,t,i),(!(rn&2)||n!==Ci)&&(n===Ci&&(!(rn&2)&&(Qy|=t),pi===4&&Na(n,Li)),Dr(n,i),t===1&&rn===0&&!(e.mode&1)&&(Oh=ei()+500,Xy&&xl()))}function Dr(n,e){var t=n.callbackNode;pF(n,e);var i=q_(n,n===Ci?Li:0);if(i===0)t!==null&&KA(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&KA(t),e===1)n.tag===0?d4(HC.bind(null,n)):L2(HC.bind(null,n)),u4(function(){!(rn&6)&&xl()}),t=null;else{switch(a2(i)){case 1:t=jw;break;case 4:t=r2;break;case 16:t=j_;break;case 536870912:t=s2;break;default:t=j_}t=PL(t,wL.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function wL(n,e){if(S_=-1,E_=0,rn&6)throw Error(be(327));var t=n.callbackNode;if(wh()&&n.callbackNode!==t)return null;var i=q_(n,n===Ci?Li:0);if(i===0)return null;if(i&30||i&n.expiredLanes||e)e=cy(n,i);else{e=i;var r=rn;rn|=2;var s=ML();(Ci!==n||Li!==e)&&(Fo=null,Oh=ei()+500,wu(n,e));do try{D4();break}catch(a){TL(n,a)}while(!0);r1(),ay.current=s,rn=r,oi!==null?e=0:(Ci=null,Li=0,e=pi)}if(e!==0){if(e===2&&(r=VS(n),r!==0&&(i=r,e=dE(n,r))),e===1)throw t=Jd,wu(n,0),Na(n,i),Dr(n,ei()),t;if(e===6)Na(n,i);else{if(r=n.current.alternate,!(i&30)&&!L4(r)&&(e=cy(n,i),e===2&&(s=VS(n),s!==0&&(i=s,e=dE(n,s))),e===1))throw t=Jd,wu(n,0),Na(n,i),Dr(n,ei()),t;switch(n.finishedWork=r,n.finishedLanes=i,e){case 0:case 1:throw Error(be(345));case 2:ru(n,Ir,Fo);break;case 3:if(Na(n,i),(i&130023424)===i&&(e=v1+500-ei(),10<e)){if(q_(n,0)!==0)break;if(r=n.suspendedLanes,(r&i)!==i){gr(),n.pingedLanes|=n.suspendedLanes&r;break}n.timeoutHandle=XS(ru.bind(null,n,Ir,Fo),e);break}ru(n,Ir,Fo);break;case 4:if(Na(n,i),(i&4194240)===i)break;for(e=n.eventTimes,r=-1;0<i;){var o=31-Ws(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=ei()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*b4(i/1960))-i,10<i){n.timeoutHandle=XS(ru.bind(null,n,Ir,Fo),i);break}ru(n,Ir,Fo);break;case 5:ru(n,Ir,Fo);break;default:throw Error(be(329))}}}return Dr(n,ei()),n.callbackNode===t?wL.bind(null,n):null}function dE(n,e){var t=wd;return n.current.memoizedState.isDehydrated&&(wu(n,e).flags|=256),n=cy(n,e),n!==2&&(e=Ir,Ir=t,e!==null&&pE(e)),n}function pE(n){Ir===null?Ir=n:Ir.push.apply(Ir,n)}function L4(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var r=t[i],s=r.getSnapshot;r=r.value;try{if(!Xs(s(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Na(n,e){for(e&=~y1,e&=~Qy,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Ws(e),i=1<<t;n[t]=-1,e&=~i}}function HC(n){if(rn&6)throw Error(be(327));wh();var e=q_(n,0);if(!(e&1))return Dr(n,ei()),null;var t=cy(n,e);if(n.tag!==0&&t===2){var i=VS(n);i!==0&&(e=i,t=dE(n,i))}if(t===1)throw t=Jd,wu(n,0),Na(n,e),Dr(n,ei()),t;if(t===6)throw Error(be(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,ru(n,Ir,Fo),Dr(n,ei()),null}function x1(n,e){var t=rn;rn|=1;try{return n(e)}finally{rn=t,rn===0&&(Oh=ei()+500,Xy&&xl())}}function Ou(n){za!==null&&za.tag===0&&!(rn&6)&&wh();var e=rn;rn|=1;var t=ws.transition,i=pn;try{if(ws.transition=null,pn=1,n)return n()}finally{pn=i,ws.transition=t,rn=e,!(rn&6)&&xl()}}function S1(){Xr=hh.current,Tn(hh)}function wu(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,l4(t)),oi!==null)for(t=oi.return;t!==null;){var i=t;switch(t1(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Q_();break;case 3:Dh(),Tn(Lr),Tn(tr),c1();break;case 5:u1(i);break;case 4:Dh();break;case 13:Tn(kn);break;case 19:Tn(kn);break;case 10:s1(i.type._context);break;case 22:case 23:S1()}t=t.return}if(Ci=n,oi=n=$a(n.current,null),Li=Xr=e,pi=0,Jd=null,y1=Qy=ku=0,Ir=wd=null,pu!==null){for(e=0;e<pu.length;e++)if(t=pu[e],i=t.interleaved,i!==null){t.interleaved=null;var r=i.next,s=t.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}t.pending=i}pu=null}return n}function TL(n,e){do{var t=oi;try{if(r1(),y_.current=oy,sy){for(var i=Fn.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}sy=!1}if(Du=0,Ai=fi=Fn=null,Sd=!1,$d=0,_1.current=null,t===null||t.return===null){pi=1,Jd=e,oi=null;break}e:{var s=n,o=t.return,a=t,l=e;if(e=Li,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var h=l,f=a,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var _=IC(o);if(_!==null){_.flags&=-257,PC(_,o,a,s,e),_.mode&1&&RC(s,h,e),e=_,l=h;var v=e.updateQueue;if(v===null){var T=new Set;T.add(l),e.updateQueue=T}else v.add(l);break e}else{if(!(e&1)){RC(s,h,e),E1();break e}l=Error(be(426))}}else if(In&&a.mode&1){var x=IC(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),PC(x,o,a,s,e),n1(kh(l,a));break e}}s=l=kh(l,a),pi!==4&&(pi=2),wd===null?wd=[s]:wd.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=aL(s,l,e);EC(s,y);break e;case 1:a=l;var w=s.type,E=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Xa===null||!Xa.has(E)))){s.flags|=65536,e&=-e,s.lanes|=e;var I=lL(s,a,e);EC(s,I);break e}}s=s.return}while(s!==null)}CL(t)}catch(O){e=O,oi===t&&t!==null&&(oi=t=t.return);continue}break}while(!0)}function ML(){var n=ay.current;return ay.current=oy,n===null?oy:n}function E1(){(pi===0||pi===3||pi===2)&&(pi=4),Ci===null||!(ku&268435455)&&!(Qy&268435455)||Na(Ci,Li)}function cy(n,e){var t=rn;rn|=2;var i=ML();(Ci!==n||Li!==e)&&(Fo=null,wu(n,e));do try{N4();break}catch(r){TL(n,r)}while(!0);if(r1(),rn=t,ay.current=i,oi!==null)throw Error(be(261));return Ci=null,Li=0,pi}function N4(){for(;oi!==null;)AL(oi)}function D4(){for(;oi!==null&&!sF();)AL(oi)}function AL(n){var e=IL(n.alternate,n,Xr);n.memoizedProps=n.pendingProps,e===null?CL(n):oi=e,_1.current=null}function CL(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=C4(t,e),t!==null){t.flags&=32767,oi=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{pi=6,oi=null;return}}else if(t=A4(t,e,Xr),t!==null){oi=t;return}if(e=e.sibling,e!==null){oi=e;return}oi=e=n}while(e!==null);pi===0&&(pi=5)}function ru(n,e,t){var i=pn,r=ws.transition;try{ws.transition=null,pn=1,k4(n,e,t,i)}finally{ws.transition=r,pn=i}return null}function k4(n,e,t,i){do wh();while(za!==null);if(rn&6)throw Error(be(327));t=n.finishedWork;var r=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(be(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(mF(n,s),n===Ci&&(oi=Ci=null,Li=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||lg||(lg=!0,PL(j_,function(){return wh(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=ws.transition,ws.transition=null;var o=pn;pn=1;var a=rn;rn|=4,_1.current=null,I4(n,t),SL(t,n),t4(jS),X_=!!WS,jS=WS=null,n.current=t,P4(t),oF(),rn=a,pn=o,ws.transition=s}else n.current=t;if(lg&&(lg=!1,za=n,uy=r),s=n.pendingLanes,s===0&&(Xa=null),uF(t.stateNode),Dr(n,ei()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)r=e[t],i(r.value,{componentStack:r.stack,digest:r.digest});if(ly)throw ly=!1,n=hE,hE=null,n;return uy&1&&n.tag!==0&&wh(),s=n.pendingLanes,s&1?n===fE?Td++:(Td=0,fE=n):Td=0,xl(),null}function wh(){if(za!==null){var n=a2(uy),e=ws.transition,t=pn;try{if(ws.transition=null,pn=16>n?16:n,za===null)var i=!1;else{if(n=za,za=null,uy=0,rn&6)throw Error(be(331));var r=rn;for(rn|=4,it=n.current;it!==null;){var s=it,o=s.child;if(it.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var h=a[l];for(it=h;it!==null;){var f=it;switch(f.tag){case 0:case 11:case 15:Ed(8,f,s)}var d=f.child;if(d!==null)d.return=f,it=d;else for(;it!==null;){f=it;var p=f.sibling,_=f.return;if(yL(f),f===h){it=null;break}if(p!==null){p.return=_,it=p;break}it=_}}}var v=s.alternate;if(v!==null){var T=v.child;if(T!==null){v.child=null;do{var x=T.sibling;T.sibling=null,T=x}while(T!==null)}}it=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,it=o;else e:for(;it!==null;){if(s=it,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ed(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,it=y;break e}it=s.return}}var w=n.current;for(it=w;it!==null;){o=it;var E=o.child;if(o.subtreeFlags&2064&&E!==null)E.return=o,it=E;else e:for(o=w;it!==null;){if(a=it,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Ky(9,a)}}catch(O){jn(a,a.return,O)}if(a===o){it=null;break e}var I=a.sibling;if(I!==null){I.return=a.return,it=I;break e}it=a.return}}if(rn=r,xl(),ho&&typeof ho.onPostCommitFiberRoot=="function")try{ho.onPostCommitFiberRoot(Hy,n)}catch{}i=!0}return i}finally{pn=t,ws.transition=e}}return!1}function GC(n,e,t){e=kh(t,e),e=aL(n,e,1),n=qa(n,e,1),e=gr(),n!==null&&(bp(n,1,e),Dr(n,e))}function jn(n,e,t){if(n.tag===3)GC(n,n,t);else for(;e!==null;){if(e.tag===3){GC(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Xa===null||!Xa.has(i))){n=kh(t,n),n=lL(e,n,1),e=qa(e,n,1),n=gr(),e!==null&&(bp(e,1,n),Dr(e,n));break}}e=e.return}}function O4(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=gr(),n.pingedLanes|=n.suspendedLanes&t,Ci===n&&(Li&t)===t&&(pi===4||pi===3&&(Li&130023424)===Li&&500>ei()-v1?wu(n,0):y1|=t),Dr(n,e)}function RL(n,e){e===0&&(n.mode&1?(e=Jm,Jm<<=1,!(Jm&130023424)&&(Jm=4194304)):e=1);var t=gr();n=Zo(n,e),n!==null&&(bp(n,e,t),Dr(n,t))}function U4(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),RL(n,t)}function F4(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,r=n.memoizedState;r!==null&&(t=r.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(be(314))}i!==null&&i.delete(e),RL(n,t)}var IL;IL=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Lr.current)br=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return br=!1,M4(n,e,t);br=!!(n.flags&131072)}else br=!1,In&&e.flags&1048576&&N2(e,ey,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;x_(n,e),n=e.pendingProps;var r=bh(e,tr.current);Eh(e,t),r=f1(null,e,i,n,r,t);var s=d1();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Nr(i)?(s=!0,J_(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,a1(e),r.updater=$y,e.stateNode=r,r._reactInternals=e,eE(e,i,n,t),e=iE(null,e,i,!0,s,t)):(e.tag=0,In&&s&&e1(e),dr(null,e,r,t),e=e.child),e;case 16:i=e.elementType;e:{switch(x_(n,e),n=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=z4(i),n=Us(i,n),r){case 0:e=nE(null,e,i,n,t);break e;case 1:e=NC(null,e,i,n,t);break e;case 11:e=bC(null,e,i,n,t);break e;case 14:e=LC(null,e,i,Us(i.type,n),t);break e}throw Error(be(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Us(i,r),nE(n,e,i,r,t);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Us(i,r),NC(n,e,i,r,t);case 3:e:{if(fL(e),n===null)throw Error(be(387));i=e.pendingProps,s=e.memoizedState,r=s.element,V2(n,e),iy(e,i,null,t);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=kh(Error(be(423)),e),e=DC(n,e,i,t,r);break e}else if(i!==r){r=kh(Error(be(424)),e),e=DC(n,e,i,t,r);break e}else for(Qr=ja(e.stateNode.containerInfo.firstChild),Zr=e,In=!0,Bs=null,t=U2(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Lh(),i===r){e=ea(n,e,t);break e}dr(n,e,i,t)}e=e.child}return e;case 5:return z2(e),n===null&&QS(e),i=e.type,r=e.pendingProps,s=n!==null?n.memoizedProps:null,o=r.children,qS(i,r)?o=null:s!==null&&qS(i,s)&&(e.flags|=32),hL(n,e),dr(n,e,o,t),e.child;case 6:return n===null&&QS(e),null;case 13:return dL(n,e,t);case 4:return l1(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=Nh(e,null,i,t):dr(n,e,i,t),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Us(i,r),bC(n,e,i,r,t);case 7:return dr(n,e,e.pendingProps,t),e.child;case 8:return dr(n,e,e.pendingProps.children,t),e.child;case 12:return dr(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,Sn(ty,i._currentValue),i._currentValue=o,s!==null)if(Xs(s.value,o)){if(s.children===r.children&&!Lr.current){e=ea(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=Yo(-1,t&-t),l.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var f=h.pending;f===null?l.next=l:(l.next=f.next,f.next=l),h.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),JS(s.return,t,e),a.lanes|=t;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(be(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),JS(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}dr(n,e,r.children,t),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,Eh(e,t),r=As(r),i=i(r),e.flags|=1,dr(n,e,i,t),e.child;case 14:return i=e.type,r=Us(i,e.pendingProps),r=Us(i.type,r),LC(n,e,i,r,t);case 15:return uL(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Us(i,r),x_(n,e),e.tag=1,Nr(i)?(n=!0,J_(e)):n=!1,Eh(e,t),oL(e,i,r),eE(e,i,r,t),iE(null,e,i,!0,n,t);case 19:return pL(n,e,t);case 22:return cL(n,e,t)}throw Error(be(156,e.tag))};function PL(n,e){return i2(n,e)}function V4(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Es(n,e,t,i){return new V4(n,e,t,i)}function w1(n){return n=n.prototype,!(!n||!n.isReactComponent)}function z4(n){if(typeof n=="function")return w1(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Hw)return 11;if(n===Gw)return 14}return 2}function $a(n,e){var t=n.alternate;return t===null?(t=Es(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function w_(n,e,t,i,r,s){var o=2;if(i=n,typeof n=="function")w1(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case th:return Tu(t.children,r,s,e);case Bw:o=8,r|=8;break;case TS:return n=Es(12,t,e,r|2),n.elementType=TS,n.lanes=s,n;case MS:return n=Es(13,t,e,r),n.elementType=MS,n.lanes=s,n;case AS:return n=Es(19,t,e,r),n.elementType=AS,n.lanes=s,n;case zb:return Jy(t,r,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Fb:o=10;break e;case Vb:o=9;break e;case Hw:o=11;break e;case Gw:o=14;break e;case Pa:o=16,i=null;break e}throw Error(be(130,n==null?n:typeof n,""))}return e=Es(o,t,e,r),e.elementType=n,e.type=i,e.lanes=s,e}function Tu(n,e,t,i){return n=Es(7,n,i,e),n.lanes=t,n}function Jy(n,e,t,i){return n=Es(22,n,i,e),n.elementType=zb,n.lanes=t,n.stateNode={isHidden:!1},n}function gx(n,e,t){return n=Es(6,n,null,e),n.lanes=t,n}function _x(n,e,t){return e=Es(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function B4(n,e,t,i,r){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Q0(0),this.expirationTimes=Q0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Q0(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function T1(n,e,t,i,r,s,o,a,l){return n=new B4(n,e,t,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Es(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},a1(s),n}function H4(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:eh,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function bL(n){if(!n)return al;n=n._reactInternals;e:{if(Xu(n)!==n||n.tag!==1)throw Error(be(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Nr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(be(171))}if(n.tag===1){var t=n.type;if(Nr(t))return b2(n,t,e)}return e}function LL(n,e,t,i,r,s,o,a,l){return n=T1(t,i,!0,n,r,s,o,a,l),n.context=bL(null),t=n.current,i=gr(),r=Ya(t),s=Yo(i,r),s.callback=e??null,qa(t,s,r),n.current.lanes=r,bp(n,r,i),Dr(n,i),n}function Zy(n,e,t,i){var r=e.current,s=gr(),o=Ya(r);return t=bL(t),e.context===null?e.context=t:e.pendingContext=t,e=Yo(s,o),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=qa(r,e,o),n!==null&&(js(n,r,o,s),__(n,r,o)),o}function hy(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function WC(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function M1(n,e){WC(n,e),(n=n.alternate)&&WC(n,e)}function G4(){return null}var NL=typeof reportError=="function"?reportError:function(n){console.error(n)};function A1(n){this._internalRoot=n}ev.prototype.render=A1.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(be(409));Zy(n,e,null,null)};ev.prototype.unmount=A1.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Ou(function(){Zy(null,n,null,null)}),e[Jo]=null}};function ev(n){this._internalRoot=n}ev.prototype.unstable_scheduleHydration=function(n){if(n){var e=c2();n={blockedOn:null,target:n,priority:e};for(var t=0;t<La.length&&e!==0&&e<La[t].priority;t++);La.splice(t,0,n),t===0&&f2(n)}};function C1(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function tv(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function jC(){}function W4(n,e,t,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var h=hy(o);s.call(h)}}var o=LL(e,i,n,0,null,!1,!1,"",jC);return n._reactRootContainer=o,n[Jo]=o.current,Wd(n.nodeType===8?n.parentNode:n),Ou(),o}for(;r=n.lastChild;)n.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var h=hy(l);a.call(h)}}var l=T1(n,0,!1,null,null,!1,!1,"",jC);return n._reactRootContainer=l,n[Jo]=l.current,Wd(n.nodeType===8?n.parentNode:n),Ou(function(){Zy(e,l,t,i)}),l}function nv(n,e,t,i,r){var s=t._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=hy(o);a.call(l)}}Zy(e,o,n,r)}else o=W4(t,e,n,r,i);return hy(o)}l2=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=ad(e.pendingLanes);t!==0&&(qw(e,t|1),Dr(e,ei()),!(rn&6)&&(Oh=ei()+500,xl()))}break;case 13:Ou(function(){var i=Zo(n,1);if(i!==null){var r=gr();js(i,n,1,r)}}),M1(n,1)}};Xw=function(n){if(n.tag===13){var e=Zo(n,134217728);if(e!==null){var t=gr();js(e,n,134217728,t)}M1(n,134217728)}};u2=function(n){if(n.tag===13){var e=Ya(n),t=Zo(n,e);if(t!==null){var i=gr();js(t,n,e,i)}M1(n,e)}};c2=function(){return pn};h2=function(n,e){var t=pn;try{return pn=n,e()}finally{pn=t}};OS=function(n,e,t){switch(e){case"input":if(IS(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var r=qy(i);if(!r)throw Error(be(90));Hb(i),IS(i,r)}}}break;case"textarea":Wb(n,t);break;case"select":e=t.value,e!=null&&yh(n,!!t.multiple,e,!1)}};Qb=x1;Jb=Ou;var j4={usingClientEntryPoint:!1,Events:[Np,sh,qy,$b,Kb,x1]},Gf={findFiberByHostInstance:du,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},q4={bundleType:Gf.bundleType,version:Gf.version,rendererPackageName:Gf.rendererPackageName,rendererConfig:Gf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:la.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=t2(n),n===null?null:n.stateNode},findFiberByHostInstance:Gf.findFiberByHostInstance||G4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ug=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ug.isDisabled&&ug.supportsFiber)try{Hy=ug.inject(q4),ho=ug}catch{}}is.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j4;is.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!C1(e))throw Error(be(200));return H4(n,e,null,t)};is.createRoot=function(n,e){if(!C1(n))throw Error(be(299));var t=!1,i="",r=NL;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=T1(n,1,!1,null,null,t,!1,i,r),n[Jo]=e.current,Wd(n.nodeType===8?n.parentNode:n),new A1(e)};is.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(be(188)):(n=Object.keys(n).join(","),Error(be(268,n)));return n=t2(e),n=n===null?null:n.stateNode,n};is.flushSync=function(n){return Ou(n)};is.hydrate=function(n,e,t){if(!tv(e))throw Error(be(200));return nv(null,n,e,!0,t)};is.hydrateRoot=function(n,e,t){if(!C1(n))throw Error(be(405));var i=t!=null&&t.hydratedSources||null,r=!1,s="",o=NL;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=LL(e,null,n,1,t??null,r,!1,s,o),n[Jo]=e.current,Wd(n),i)for(n=0;n<i.length;n++)t=i[n],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new ev(e)};is.render=function(n,e,t){if(!tv(e))throw Error(be(200));return nv(null,n,e,!1,t)};is.unmountComponentAtNode=function(n){if(!tv(n))throw Error(be(40));return n._reactRootContainer?(Ou(function(){nv(null,null,n,!1,function(){n._reactRootContainer=null,n[Jo]=null})}),!0):!1};is.unstable_batchedUpdates=x1;is.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!tv(t))throw Error(be(200));if(n==null||n._reactInternals===void 0)throw Error(be(38));return nv(n,e,t,!1,i)};is.version="18.3.1-next-f1338f8080-20240426";function DL(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(DL)}catch(n){console.error(n)}}DL(),Db.exports=is;var X4=Db.exports,Y4,qC=X4;Y4=qC.createRoot,qC.hydrateRoot;const $4=()=>{};var XC={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kL=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},K4=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],a=n[t++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},OL={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,a=o?n[r+1]:0,l=r+2<n.length,h=l?n[r+2]:0,f=s>>2,d=(s&3)<<4|a>>4;let p=(a&15)<<2|h>>6,_=h&63;l||(_=64,o||(p=64)),i.push(t[f],t[d],t[p],t[_])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(kL(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):K4(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const d=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||a==null||h==null||d==null)throw new Q4;const p=s<<2|a>>4;if(i.push(p),h!==64){const _=a<<4&240|h>>2;if(i.push(_),d!==64){const v=h<<6&192|d;i.push(v)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Q4 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const J4=function(n){const e=kL(n);return OL.encodeByteArray(e,!0)},fy=function(n){return J4(n).replace(/\./g,"")},UL=function(n){try{return OL.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z4(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eV=()=>Z4().__FIREBASE_DEFAULTS__,tV=()=>{if(typeof process>"u"||typeof XC>"u")return;const n=XC.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},nV=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&UL(n[1]);return e&&JSON.parse(e)},iv=()=>{try{return $4()||eV()||tV()||nV()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},FL=n=>{var e,t;return(t=(e=iv())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},iV=n=>{const e=FL(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},VL=()=>{var n;return(n=iv())==null?void 0:n.config},zL=n=>{var e;return(e=iv())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zh(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function BL(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sV(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[fy(JSON.stringify(t)),fy(JSON.stringify(o)),""].join(".")}const Md={};function oV(){const n={prod:[],emulator:[]};for(const e of Object.keys(Md))Md[e]?n.emulator.push(e):n.prod.push(e);return n}function aV(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let YC=!1;function HL(n,e){if(typeof window>"u"||typeof document>"u"||!Zh(window.location.host)||Md[n]===e||Md[n]||YC)return;Md[n]=e;function t(p){return`__firebase__banner__${p}`}const i="__firebase__banner",s=oV().prod.length>0;function o(){const p=document.getElementById(i);p&&p.remove()}function a(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function l(p,_){p.setAttribute("width","24"),p.setAttribute("id",_),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function h(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{YC=!0,o()},p}function f(p,_){p.setAttribute("id",_),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function d(){const p=aV(i),_=t("text"),v=document.getElementById(_)||document.createElement("span"),T=t("learnmore"),x=document.getElementById(T)||document.createElement("a"),y=t("preprendIcon"),w=document.getElementById(y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const E=p.element;a(E),f(x,T);const I=h();l(w,y),E.append(w,v,x,I),document.body.appendChild(E)}s?(v.innerText="Preview backend disconnected.",w.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(w.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function lV(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(nr())}function uV(){var e;const n=(e=iv())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function cV(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function hV(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function fV(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function dV(){const n=nr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function pV(){return!uV()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function mV(){try{return typeof indexedDB=="object"}catch{return!1}}function gV(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e(((s=r.error)==null?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _V="FirebaseError";class ua extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=_V,Object.setPrototypeOf(this,ua.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,kp.prototype.create)}}class kp{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?yV(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new ua(r,a,i)}}function yV(n,e){return n.replace(vV,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const vV=/\{\$([^}]+)}/g;function xV(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Uu(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if($C(s)&&$C(o)){if(!Uu(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function $C(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Op(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function ud(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[r,s]=i.split("=");e[decodeURIComponent(r)]=decodeURIComponent(s)}}),e}function cd(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function SV(n,e){const t=new EV(n,e);return t.subscribe.bind(t)}class EV{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");wV(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=yx),r.error===void 0&&(r.error=yx),r.complete===void 0&&(r.complete=yx);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function wV(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function yx(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ci(n){return n&&n._delegate?n._delegate:n}class Fu{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const su="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TV=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new rV;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(AV(e))try{this.getOrInitializeService({instanceIdentifier:su})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=su){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=su){return this.instances.has(e)}getOptions(e=su){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&e(s,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:MV(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=su){return this.component?this.component.multipleInstances?e:su:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function MV(n){return n===su?void 0:n}function AV(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CV{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new TV(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Xt||(Xt={}));const RV={debug:Xt.DEBUG,verbose:Xt.VERBOSE,info:Xt.INFO,warn:Xt.WARN,error:Xt.ERROR,silent:Xt.SILENT},IV=Xt.INFO,PV={[Xt.DEBUG]:"log",[Xt.VERBOSE]:"log",[Xt.INFO]:"info",[Xt.WARN]:"warn",[Xt.ERROR]:"error"},bV=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=PV[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class R1{constructor(e){this.name=e,this._logLevel=IV,this._logHandler=bV,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Xt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?RV[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Xt.DEBUG,...e),this._logHandler(this,Xt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Xt.VERBOSE,...e),this._logHandler(this,Xt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Xt.INFO,...e),this._logHandler(this,Xt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Xt.WARN,...e),this._logHandler(this,Xt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Xt.ERROR,...e),this._logHandler(this,Xt.ERROR,...e)}}const LV=(n,e)=>e.some(t=>n instanceof t);let KC,QC;function NV(){return KC||(KC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function DV(){return QC||(QC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const GL=new WeakMap,mE=new WeakMap,WL=new WeakMap,vx=new WeakMap,I1=new WeakMap;function kV(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Ka(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&GL.set(t,n)}).catch(()=>{}),I1.set(e,n),e}function OV(n){if(mE.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});mE.set(n,e)}let gE={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return mE.get(n);if(e==="objectStoreNames")return n.objectStoreNames||WL.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ka(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function UV(n){gE=n(gE)}function FV(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(xx(this),e,...t);return WL.set(i,e.sort?e.sort():[e]),Ka(i)}:DV().includes(n)?function(...e){return n.apply(xx(this),e),Ka(GL.get(this))}:function(...e){return Ka(n.apply(xx(this),e))}}function VV(n){return typeof n=="function"?FV(n):(n instanceof IDBTransaction&&OV(n),LV(n,NV())?new Proxy(n,gE):n)}function Ka(n){if(n instanceof IDBRequest)return kV(n);if(vx.has(n))return vx.get(n);const e=VV(n);return e!==n&&(vx.set(n,e),I1.set(e,n)),e}const xx=n=>I1.get(n);function zV(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),a=Ka(o);return i&&o.addEventListener("upgradeneeded",l=>{i(Ka(o.result),l.oldVersion,l.newVersion,Ka(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),a}const BV=["get","getKey","getAll","getAllKeys","count"],HV=["put","add","delete","clear"],Sx=new Map;function JC(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Sx.get(e))return Sx.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=HV.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||BV.includes(t)))return;const s=async function(o,...a){const l=this.transaction(o,r?"readwrite":"readonly");let h=l.store;return i&&(h=h.index(a.shift())),(await Promise.all([h[t](...a),r&&l.done]))[0]};return Sx.set(e,s),s}UV(n=>({...n,get:(e,t,i)=>JC(e,t)||n.get(e,t,i),has:(e,t)=>!!JC(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(WV(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function WV(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const _E="@firebase/app",ZC="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ta=new R1("@firebase/app"),jV="@firebase/app-compat",qV="@firebase/analytics-compat",XV="@firebase/analytics",YV="@firebase/app-check-compat",$V="@firebase/app-check",KV="@firebase/auth",QV="@firebase/auth-compat",JV="@firebase/database",ZV="@firebase/data-connect",ez="@firebase/database-compat",tz="@firebase/functions",nz="@firebase/functions-compat",iz="@firebase/installations",rz="@firebase/installations-compat",sz="@firebase/messaging",oz="@firebase/messaging-compat",az="@firebase/performance",lz="@firebase/performance-compat",uz="@firebase/remote-config",cz="@firebase/remote-config-compat",hz="@firebase/storage",fz="@firebase/storage-compat",dz="@firebase/firestore",pz="@firebase/ai",mz="@firebase/firestore-compat",gz="firebase",_z="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yE="[DEFAULT]",yz={[_E]:"fire-core",[jV]:"fire-core-compat",[XV]:"fire-analytics",[qV]:"fire-analytics-compat",[$V]:"fire-app-check",[YV]:"fire-app-check-compat",[KV]:"fire-auth",[QV]:"fire-auth-compat",[JV]:"fire-rtdb",[ZV]:"fire-data-connect",[ez]:"fire-rtdb-compat",[tz]:"fire-fn",[nz]:"fire-fn-compat",[iz]:"fire-iid",[rz]:"fire-iid-compat",[sz]:"fire-fcm",[oz]:"fire-fcm-compat",[az]:"fire-perf",[lz]:"fire-perf-compat",[uz]:"fire-rc",[cz]:"fire-rc-compat",[hz]:"fire-gcs",[fz]:"fire-gcs-compat",[dz]:"fire-fst",[mz]:"fire-fst-compat",[pz]:"fire-vertex","fire-js":"fire-js",[gz]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dy=new Map,vz=new Map,vE=new Map;function eR(n,e){try{n.container.addComponent(e)}catch(t){ta.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Uh(n){const e=n.name;if(vE.has(e))return ta.debug(`There were multiple attempts to register component ${e}.`),!1;vE.set(e,n);for(const t of dy.values())eR(t,n);for(const t of vz.values())eR(t,n);return!0}function P1(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Yr(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xz={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qa=new kp("app","Firebase",xz);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sz{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Fu("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ef=_z;function Ez(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:yE,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw Qa.create("bad-app-name",{appName:String(r)});if(t||(t=VL()),!t)throw Qa.create("no-options");const s=dy.get(r);if(s){if(Uu(t,s.options)&&Uu(i,s.config))return s;throw Qa.create("duplicate-app",{appName:r})}const o=new CV(r);for(const l of vE.values())o.addComponent(l);const a=new Sz(t,i,o);return dy.set(r,a),a}function jL(n=yE){const e=dy.get(n);if(!e&&n===yE&&VL())return Ez();if(!e)throw Qa.create("no-app",{appName:n});return e}function Ja(n,e,t){let i=yz[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),s=e.match(/\s|\//);if(r||s){const o=[`Unable to register library "${i}" with version "${e}":`];r&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ta.warn(o.join(" "));return}Uh(new Fu(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wz="firebase-heartbeat-database",Tz=1,Zd="firebase-heartbeat-store";let Ex=null;function qL(){return Ex||(Ex=zV(wz,Tz,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Zd)}catch(t){console.warn(t)}}}}).catch(n=>{throw Qa.create("idb-open",{originalErrorMessage:n.message})})),Ex}async function Mz(n){try{const t=(await qL()).transaction(Zd),i=await t.objectStore(Zd).get(XL(n));return await t.done,i}catch(e){if(e instanceof ua)ta.warn(e.message);else{const t=Qa.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ta.warn(t.message)}}}async function tR(n,e){try{const i=(await qL()).transaction(Zd,"readwrite");await i.objectStore(Zd).put(e,XL(n)),await i.done}catch(t){if(t instanceof ua)ta.warn(t.message);else{const i=Qa.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ta.warn(i.message)}}}function XL(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Az=1024,Cz=30;class Rz{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Pz(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=nR();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats.length>Cz){const o=bz(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){ta.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=nR(),{heartbeatsToSend:i,unsentEntries:r}=Iz(this._heartbeatsCache.heartbeats),s=fy(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return ta.warn(t),""}}}function nR(){return new Date().toISOString().substring(0,10)}function Iz(n,e=Az){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),iR(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),iR(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class Pz{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return mV()?gV().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Mz(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return tR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return tR(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function iR(n){return fy(JSON.stringify({version:2,heartbeats:n})).length}function bz(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lz(n){Uh(new Fu("platform-logger",e=>new GV(e),"PRIVATE")),Uh(new Fu("heartbeat",e=>new Rz(e),"PRIVATE")),Ja(_E,ZC,n),Ja(_E,ZC,"esm2020"),Ja("fire-js","")}Lz("");var Nz="firebase",Dz="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ja(Nz,Dz,"app");function YL(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const kz=YL,$L=new kp("auth","Firebase",YL());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const py=new R1("@firebase/auth");function Oz(n,...e){py.logLevel<=Xt.WARN&&py.warn(`Auth (${ef}): ${n}`,...e)}function T_(n,...e){py.logLevel<=Xt.ERROR&&py.error(`Auth (${ef}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rs(n,...e){throw L1(n,...e)}function qs(n,...e){return L1(n,...e)}function b1(n,e,t){const i={...kz(),[e]:t};return new kp("auth","Firebase",i).create(e,{appName:n.name})}function $o(n){return b1(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Uz(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&Rs(n,"argument-error"),b1(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function L1(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return $L.create(n,...e)}function wt(n,e,...t){if(!n)throw L1(e,...t)}function Wo(n){const e="INTERNAL ASSERTION FAILED: "+n;throw T_(e),new Error(e)}function na(n,e){n||Wo(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xE(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function Fz(){return rR()==="http:"||rR()==="https:"}function rR(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vz(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Fz()||hV()||"connection"in navigator)?navigator.onLine:!0}function zz(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up{constructor(e,t){this.shortDelay=e,this.longDelay=t,na(t>e,"Short delay should be less than long delay!"),this.isMobile=lV()||fV()}get(){return Vz()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N1(n,e){na(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KL{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Wo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Wo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Wo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bz={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hz=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Gz=new Up(3e4,6e4);function Sl(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function ca(n,e,t,i,r={}){return QL(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const a=Op({key:n.config.apiKey,...o}).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:l,...s};return cV()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Zh(n.emulatorConfig.host)&&(h.credentials="include"),KL.fetch()(await JL(n,n.config.apiHost,t,a),h)})}async function QL(n,e,t){n._canInitEmulator=!1;const i={...Bz,...e};try{const r=new jz(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw cg(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,h]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw cg(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw cg(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw cg(n,"user-disabled",o);const f=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw b1(n,f,h);Rs(n,f)}}catch(r){if(r instanceof ua)throw r;Rs(n,"network-request-failed",{message:String(r)})}}async function Fp(n,e,t,i,r={}){const s=await ca(n,e,t,i,r);return"mfaPendingCredential"in s&&Rs(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function JL(n,e,t,i){const r=`${e}${t}?${i}`,s=n,o=s.config.emulator?N1(n.config,r):`${n.config.apiScheme}://${r}`;return Hz.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function Wz(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class jz{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(qs(this.auth,"network-request-failed")),Gz.get())})}}function cg(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=qs(n,e,i);return r.customData._tokenResponse=t,r}function sR(n){return n!==void 0&&n.enterprise!==void 0}class qz{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Wz(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Xz(n,e){return ca(n,"GET","/v2/recaptchaConfig",Sl(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yz(n,e){return ca(n,"POST","/v1/accounts:delete",e)}async function my(n,e){return ca(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ad(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function $z(n,e=!1){const t=ci(n),i=await t.getIdToken(e),r=D1(i);wt(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:Ad(wx(r.auth_time)),issuedAtTime:Ad(wx(r.iat)),expirationTime:Ad(wx(r.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function wx(n){return Number(n)*1e3}function D1(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return T_("JWT malformed, contained fewer than 3 sections"),null;try{const r=UL(t);return r?JSON.parse(r):(T_("Failed to decode base64 JWT payload"),null)}catch(r){return T_("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function oR(n){const e=D1(n);return wt(e,"internal-error"),wt(typeof e.exp<"u","internal-error"),wt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fh(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof ua&&Kz(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function Kz({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qz{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ad(this.lastLoginAt),this.creationTime=Ad(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gy(n){var d;const e=n.auth,t=await n.getIdToken(),i=await Fh(n,my(e,{idToken:t}));wt(i==null?void 0:i.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const s=(d=r.providerUserInfo)!=null&&d.length?ZL(r.providerUserInfo):[],o=Zz(n.providerData,s),a=n.isAnonymous,l=!(n.email&&r.passwordHash)&&!(o!=null&&o.length),h=a?l:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new SE(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function Jz(n){const e=ci(n);await gy(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Zz(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function ZL(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eB(n,e){const t=await QL(n,{},async()=>{const i=Op({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=await JL(n,r,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:i};return n.emulatorConfig&&Zh(n.emulatorConfig.host)&&(l.credentials="include"),KL.fetch()(o,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function tB(n,e){return ca(n,"POST","/v2/accounts:revokeToken",Sl(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){wt(e.idToken,"internal-error"),wt(typeof e.idToken<"u","internal-error"),wt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):oR(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){wt(e.length!==0,"internal-error");const t=oR(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(wt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await eB(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new Th;return i&&(wt(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(wt(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(wt(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Th,this.toJSON())}_performRefresh(){return Wo("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sa(n,e){wt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Gs{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new Qz(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new SE(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Fh(this,this.stsTokenManager.getToken(this.auth,e));return wt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return $z(this,e)}reload(){return Jz(this)}_assign(e){this!==e&&(wt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Gs({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){wt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await gy(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Yr(this.auth.app))return Promise.reject($o(this.auth));const e=await this.getIdToken();return await Fh(this,Yz(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,a=t.tenantId??void 0,l=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:d,emailVerified:p,isAnonymous:_,providerData:v,stsTokenManager:T}=t;wt(d&&T,e,"internal-error");const x=Th.fromJSON(this.name,T);wt(typeof d=="string",e,"internal-error"),Sa(i,e.name),Sa(r,e.name),wt(typeof p=="boolean",e,"internal-error"),wt(typeof _=="boolean",e,"internal-error"),Sa(s,e.name),Sa(o,e.name),Sa(a,e.name),Sa(l,e.name),Sa(h,e.name),Sa(f,e.name);const y=new Gs({uid:d,auth:e,email:r,emailVerified:p,displayName:i,isAnonymous:_,photoURL:o,phoneNumber:s,tenantId:a,stsTokenManager:x,createdAt:h,lastLoginAt:f});return v&&Array.isArray(v)&&(y.providerData=v.map(w=>({...w}))),l&&(y._redirectEventId=l),y}static async _fromIdTokenResponse(e,t,i=!1){const r=new Th;r.updateFromServerResponse(t);const s=new Gs({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await gy(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];wt(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?ZL(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(s!=null&&s.length),a=new Th;a.updateFromIdToken(i);const l=new Gs({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new SE(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,h),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aR=new Map;function jo(n){na(n instanceof Function,"Expected a class definition");let e=aR.get(n);return e?(na(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,aR.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}eN.type="NONE";const lR=eN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M_(n,e,t){return`firebase:${n}:${e}:${t}`}class Mh{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=M_(this.userKey,r.apiKey,s),this.fullPersistenceKey=M_("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await my(this.auth,{idToken:e}).catch(()=>{});return t?Gs._fromGetAccountInfoResponse(this.auth,t,e):null}return Gs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Mh(jo(lR),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||jo(lR);const o=M_(i,e.config.apiKey,e.name);let a=null;for(const h of t)try{const f=await h._get(o);if(f){let d;if(typeof f=="string"){const p=await my(e,{idToken:f}).catch(()=>{});if(!p)break;d=await Gs._fromGetAccountInfoResponse(e,p,f)}else d=Gs._fromJSON(e,f);h!==s&&(a=d),s=h;break}}catch{}const l=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Mh(s,e,i):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new Mh(s,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uR(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(rN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(tN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(oN(e))return"Blackberry";if(aN(e))return"Webos";if(nN(e))return"Safari";if((e.includes("chrome/")||iN(e))&&!e.includes("edge/"))return"Chrome";if(sN(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function tN(n=nr()){return/firefox\//i.test(n)}function nN(n=nr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function iN(n=nr()){return/crios\//i.test(n)}function rN(n=nr()){return/iemobile/i.test(n)}function sN(n=nr()){return/android/i.test(n)}function oN(n=nr()){return/blackberry/i.test(n)}function aN(n=nr()){return/webos/i.test(n)}function k1(n=nr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function nB(n=nr()){var e;return k1(n)&&!!((e=window.navigator)!=null&&e.standalone)}function iB(){return dV()&&document.documentMode===10}function lN(n=nr()){return k1(n)||sN(n)||aN(n)||oN(n)||/windows phone/i.test(n)||rN(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uN(n,e=[]){let t;switch(n){case"Browser":t=uR(nr());break;case"Worker":t=`${uR(nr())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ef}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rB{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sB(n,e={}){return ca(n,"GET","/v2/passwordPolicy",Sl(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oB=6;class aB{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??oB,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lB{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cR(this),this.idTokenSubscription=new cR(this),this.beforeStateQueue=new rB(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=$L,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=jo(t)),this._initializationPromise=this.queue(async()=>{var i,r,s;if(!this._deleted&&(this.persistenceManager=await Mh.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((r=this._popupRedirectResolver)!=null&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)==null?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await my(this,{idToken:e}),i=await Gs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var s;if(Yr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(s=this.redirectUser)==null?void 0:s._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(i=l.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return wt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await gy(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=zz()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Yr(this.app))return Promise.reject($o(this));const t=e?ci(e):null;return t&&wt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&wt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Yr(this.app)?Promise.reject($o(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Yr(this.app)?Promise.reject($o(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(jo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await sB(this),t=new aB(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new kp("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await tB(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&jo(e)||this._popupRedirectResolver;wt(t,this,"argument-error"),this.redirectPersistenceManager=await Mh.create(this,[jo(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(wt(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,i,r);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return wt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=uN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var r;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((r=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(Yr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&Oz(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function El(n){return ci(n)}class cR{constructor(e){this.auth=e,this.observer=null,this.addObserver=SV(t=>this.observer=t)}get next(){return wt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function uB(n){rv=n}function cN(n){return rv.loadJS(n)}function cB(){return rv.recaptchaEnterpriseScript}function hB(){return rv.gapiScript}function fB(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class dB{constructor(){this.enterprise=new pB}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class pB{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const mB="recaptcha-enterprise",hN="NO_RECAPTCHA";class gB{constructor(e){this.type=mB,this.auth=El(e)}async verify(e="verify",t=!1){async function i(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{Xz(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const h=new qz(l);return s.tenantId==null?s._agentRecaptchaConfig=h:s._tenantRecaptchaConfigs[s.tenantId]=h,o(h.siteKey)}}).catch(l=>{a(l)})})}function r(s,o,a){const l=window.grecaptcha;sR(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(h=>{o(h)}).catch(()=>{o(hN)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new dB().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{i(this.auth).then(a=>{if(!t&&sR(window.grecaptcha))r(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=cB();l.length!==0&&(l+=a),cN(l).then(()=>{r(a,s,o)}).catch(h=>{o(h)})}}).catch(a=>{o(a)})})}}async function hR(n,e,t,i=!1,r=!1){const s=new gB(n);let o;if(r)o=hN;else try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}const a={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,h=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:h,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return i?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function EE(n,e,t,i,r){var s;if((s=n._getRecaptchaConfig())!=null&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await hR(n,e,t,t==="getOobCode");return i(n,o)}else return i(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await hR(n,e,t,t==="getOobCode");return i(n,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _B(n,e){const t=P1(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(Uu(s,e??{}))return r;Rs(r,"already-initialized")}return t.initialize({options:e})}function yB(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(jo);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function vB(n,e,t){const i=El(n);wt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=fN(e),{host:o,port:a}=xB(e),l=a===null?"":`:${a}`,h={url:`${s}//${o}${l}/`},f=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){wt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),wt(Uu(h,i.config.emulator)&&Uu(f,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=f,i.settings.appVerificationDisabledForTesting=!0,Zh(o)?(BL(`${s}//${o}${l}`),HL("Auth",!0)):SB()}function fN(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function xB(n){const e=fN(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:fR(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:fR(o)}}}function fR(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function SB(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Wo("not implemented")}_getIdTokenResponse(e){return Wo("not implemented")}_linkToIdToken(e,t){return Wo("not implemented")}_getReauthenticationResolver(e){return Wo("not implemented")}}async function EB(n,e){return ca(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wB(n,e){return Fp(n,"POST","/v1/accounts:signInWithPassword",Sl(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TB(n,e){return Fp(n,"POST","/v1/accounts:signInWithEmailLink",Sl(n,e))}async function MB(n,e){return Fp(n,"POST","/v1/accounts:signInWithEmailLink",Sl(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ep extends O1{constructor(e,t,i,r=null){super("password",i),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new ep(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new ep(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return EE(e,t,"signInWithPassword",wB);case"emailLink":return TB(e,{email:this._email,oobCode:this._password});default:Rs(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return EE(e,i,"signUpPassword",EB);case"emailLink":return MB(e,{idToken:t,email:this._email,oobCode:this._password});default:Rs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ah(n,e){return Fp(n,"POST","/v1/accounts:signInWithIdp",Sl(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AB="http://localhost";class Vu extends O1{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Vu(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Rs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...s}=t;if(!i||!r)return null;const o=new Vu(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Ah(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Ah(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ah(e,t)}buildRequest(){const e={requestUri:AB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Op(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CB(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function RB(n){const e=ud(cd(n)).link,t=e?ud(cd(e)).deep_link_id:null,i=ud(cd(n)).deep_link_id;return(i?ud(cd(i)).link:null)||i||t||e||n}class U1{constructor(e){const t=ud(cd(e)),i=t.apiKey??null,r=t.oobCode??null,s=CB(t.mode??null);wt(i&&r&&s,"argument-error"),this.apiKey=i,this.operation=s,this.code=r,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=RB(e);try{return new U1(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(){this.providerId=tf.PROVIDER_ID}static credential(e,t){return ep._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=U1.parseLink(t);return wt(i,"argument-error"),ep._fromEmailAndCode(e,i.code,i.tenantId)}}tf.PROVIDER_ID="password";tf.EMAIL_PASSWORD_SIGN_IN_METHOD="password";tf.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vp extends F1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da extends Vp{constructor(){super("facebook.com")}static credential(e){return Vu._fromParams({providerId:Da.PROVIDER_ID,signInMethod:Da.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Da.credentialFromTaggedObject(e)}static credentialFromError(e){return Da.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Da.credential(e.oauthAccessToken)}catch{return null}}}Da.FACEBOOK_SIGN_IN_METHOD="facebook.com";Da.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka extends Vp{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Vu._fromParams({providerId:ka.PROVIDER_ID,signInMethod:ka.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ka.credentialFromTaggedObject(e)}static credentialFromError(e){return ka.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return ka.credential(t,i)}catch{return null}}}ka.GOOGLE_SIGN_IN_METHOD="google.com";ka.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa extends Vp{constructor(){super("github.com")}static credential(e){return Vu._fromParams({providerId:Oa.PROVIDER_ID,signInMethod:Oa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Oa.credentialFromTaggedObject(e)}static credentialFromError(e){return Oa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Oa.credential(e.oauthAccessToken)}catch{return null}}}Oa.GITHUB_SIGN_IN_METHOD="github.com";Oa.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua extends Vp{constructor(){super("twitter.com")}static credential(e,t){return Vu._fromParams({providerId:Ua.PROVIDER_ID,signInMethod:Ua.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ua.credentialFromTaggedObject(e)}static credentialFromError(e){return Ua.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Ua.credential(t,i)}catch{return null}}}Ua.TWITTER_SIGN_IN_METHOD="twitter.com";Ua.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IB(n,e){return Fp(n,"POST","/v1/accounts:signUp",Sl(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await Gs._fromIdTokenResponse(e,i,r),o=dR(i);return new zu({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=dR(i);return new zu({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function dR(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y extends ua{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,_y.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new _y(e,t,i,r)}}function dN(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?_y._fromErrorAndOperation(n,s,e,i):s})}async function PB(n,e,t=!1){const i=await Fh(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return zu._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bB(n,e,t=!1){const{auth:i}=n;if(Yr(i.app))return Promise.reject($o(i));const r="reauthenticate";try{const s=await Fh(n,dN(i,r,e,n),t);wt(s.idToken,i,"internal-error");const o=D1(s.idToken);wt(o,i,"internal-error");const{sub:a}=o;return wt(n.uid===a,i,"user-mismatch"),zu._forOperation(n,r,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Rs(i,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pN(n,e,t=!1){if(Yr(n.app))return Promise.reject($o(n));const i="signIn",r=await dN(n,i,e),s=await zu._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}async function LB(n,e){return pN(El(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mN(n){const e=El(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function UK(n,e,t){if(Yr(n.app))return Promise.reject($o(n));const i=El(n),o=await EE(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",IB).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&mN(n),l}),a=await zu._fromIdTokenResponse(i,"signIn",o);return await i._updateCurrentUser(a.user),a}function FK(n,e,t){return Yr(n.app)?Promise.reject($o(n)):LB(ci(n),tf.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&mN(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NB(n,e){return ca(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VK(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=ci(n),s={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await Fh(i,NB(i.auth,s));i.displayName=o.displayName||null,i.photoURL=o.photoUrl||null;const a=i.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=i.displayName,a.photoURL=i.photoURL),await i._updateTokensIfNecessary(o)}function DB(n,e,t,i){return ci(n).onIdTokenChanged(e,t,i)}function kB(n,e,t){return ci(n).beforeAuthStateChanged(e,t)}function zK(n,e,t,i){return ci(n).onAuthStateChanged(e,t,i)}function BK(n){return ci(n).signOut()}const yy="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gN{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(yy,"1"),this.storage.removeItem(yy),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OB=1e3,UB=10;class _N extends gN{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=lN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);iB()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,UB):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},OB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}_N.type="LOCAL";const FB=_N;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yN extends gN{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}yN.type="SESSION";const vN=yN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VB(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new sv(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const a=Array.from(o).map(async h=>h(t.origin,s)),l=await VB(a);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}sv.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V1(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const h=V1("",20);r.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(d){const p=d;if(p.data.eventId===h)switch(p.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(p.data.response);break;default:clearTimeout(f),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function po(){return window}function BB(n){po().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xN(){return typeof po().WorkerGlobalScope<"u"&&typeof po().importScripts=="function"}async function HB(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function GB(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function WB(){return xN()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SN="firebaseLocalStorageDb",jB=1,vy="firebaseLocalStorage",EN="fbase_key";class zp{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ov(n,e){return n.transaction([vy],e?"readwrite":"readonly").objectStore(vy)}function qB(){const n=indexedDB.deleteDatabase(SN);return new zp(n).toPromise()}function wE(){const n=indexedDB.open(SN,jB);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(vy,{keyPath:EN})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(vy)?e(i):(i.close(),await qB(),e(await wE()))})})}async function pR(n,e,t){const i=ov(n,!0).put({[EN]:e,value:t});return new zp(i).toPromise()}async function XB(n,e){const t=ov(n,!1).get(e),i=await new zp(t).toPromise();return i===void 0?null:i.value}function mR(n,e){const t=ov(n,!0).delete(e);return new zp(t).toPromise()}const YB=800,$B=3;class wN{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await wE(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>$B)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return xN()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=sv._getInstance(WB()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await HB(),!this.activeServiceWorker)return;this.sender=new zB(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||GB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await wE();return await pR(e,yy,"1"),await mR(e,yy),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>pR(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>XB(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>mR(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=ov(r,!1).getAll();return new zp(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),YB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}wN.type="LOCAL";const KB=wN;new Up(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TN(n,e){return e?jo(e):(wt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1 extends O1{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ah(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ah(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ah(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function QB(n){return pN(n.auth,new z1(n),n.bypassAuthState)}function JB(n){const{auth:e,user:t}=n;return wt(t,e,"internal-error"),bB(t,new z1(n),n.bypassAuthState)}async function ZB(n){const{auth:e,user:t}=n;return wt(t,e,"internal-error"),PB(t,new z1(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MN{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return QB;case"linkViaPopup":case"linkViaRedirect":return ZB;case"reauthViaPopup":case"reauthViaRedirect":return JB;default:Rs(this.auth,"internal-error")}}resolve(e){na(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){na(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e5=new Up(2e3,1e4);async function HK(n,e,t){if(Yr(n.app))return Promise.reject(qs(n,"operation-not-supported-in-this-environment"));const i=El(n);Uz(n,e,F1);const r=TN(i,t);return new gu(i,"signInViaPopup",e,r).executeNotNull()}class gu extends MN{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,gu.currentPopupAction&&gu.currentPopupAction.cancel(),gu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return wt(e,this.auth,"internal-error"),e}async onExecution(){na(this.filter.length===1,"Popup operations only handle one event");const e=V1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(qs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(qs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,gu.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(qs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,e5.get())};e()}}gu.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t5="pendingRedirect",A_=new Map;class n5 extends MN{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=A_.get(this.auth._key());if(!e){try{const i=await i5(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}A_.set(this.auth._key(),e)}return this.bypassAuthState||A_.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function i5(n,e){const t=o5(e),i=s5(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function r5(n,e){A_.set(n._key(),e)}function s5(n){return jo(n._redirectPersistence)}function o5(n){return M_(t5,n.config.apiKey,n.name)}async function a5(n,e,t=!1){if(Yr(n.app))return Promise.reject($o(n));const i=El(n),r=TN(i,e),o=await new n5(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l5=10*60*1e3;class u5{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!c5(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!AN(e)){const r=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(qs(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=l5&&this.cachedEventUids.clear(),this.cachedEventUids.has(gR(e))}saveEventToCache(e){this.cachedEventUids.add(gR(e)),this.lastProcessedEventTime=Date.now()}}function gR(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function AN({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function c5(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return AN(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function h5(n,e={}){return ca(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f5=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,d5=/^https?/;async function p5(n){if(n.config.emulator)return;const{authorizedDomains:e}=await h5(n);for(const t of e)try{if(m5(t))return}catch{}Rs(n,"unauthorized-domain")}function m5(n){const e=xE(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!d5.test(t))return!1;if(f5.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g5=new Up(3e4,6e4);function _R(){const n=po().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function _5(n){return new Promise((e,t)=>{var r,s,o;function i(){_R(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{_R(),t(qs(n,"network-request-failed"))},timeout:g5.get()})}if((s=(r=po().gapi)==null?void 0:r.iframes)!=null&&s.Iframe)e(gapi.iframes.getContext());else if((o=po().gapi)!=null&&o.load)i();else{const a=fB("iframefcb");return po()[a]=()=>{gapi.load?i():t(qs(n,"network-request-failed"))},cN(`${hB()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw C_=null,e})}let C_=null;function y5(n){return C_=C_||_5(n),C_}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v5=new Up(5e3,15e3),x5="__/auth/iframe",S5="emulator/auth/iframe",E5={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},w5=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function T5(n){const e=n.config;wt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?N1(e,S5):`https://${n.config.authDomain}/${x5}`,i={apiKey:e.apiKey,appName:n.name,v:ef},r=w5.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${Op(i).slice(1)}`}async function M5(n){const e=await y5(n),t=po().gapi;return wt(t,n,"internal-error"),e.open({where:document.body,url:T5(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:E5,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=qs(n,"network-request-failed"),a=po().setTimeout(()=>{s(o)},v5.get());function l(){po().clearTimeout(a),r(i)}i.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A5={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},C5=500,R5=600,I5="_blank",P5="http://localhost";class yR{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function b5(n,e,t,i=C5,r=R5){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const l={...A5,width:i.toString(),height:r.toString(),top:s,left:o},h=nr().toLowerCase();t&&(a=iN(h)?I5:t),tN(h)&&(e=e||P5,l.scrollbars="yes");const f=Object.entries(l).reduce((p,[_,v])=>`${p}${_}=${v},`,"");if(nB(h)&&a!=="_self")return L5(e||"",a),new yR(null);const d=window.open(e||"",a,f);wt(d,n,"popup-blocked");try{d.focus()}catch{}return new yR(d)}function L5(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N5="__/auth/handler",D5="emulator/auth/handler",k5=encodeURIComponent("fac");async function vR(n,e,t,i,r,s){wt(n.config.authDomain,n,"auth-domain-config-required"),wt(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:ef,eventId:r};if(e instanceof F1){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",xV(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,d]of Object.entries({}))o[f]=d}if(e instanceof Vp){const f=e.getScopes().filter(d=>d!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const f of Object.keys(a))a[f]===void 0&&delete a[f];const l=await n._getAppCheckToken(),h=l?`#${k5}=${encodeURIComponent(l)}`:"";return`${O5(n)}?${Op(a).slice(1)}${h}`}function O5({config:n}){return n.emulator?N1(n,D5):`https://${n.authDomain}/${N5}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tx="webStorageSupport";class U5{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vN,this._completeRedirectFn=a5,this._overrideRedirectResult=r5}async _openPopup(e,t,i,r){var o;na((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await vR(e,t,i,xE(),r);return b5(e,s,V1())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await vR(e,t,i,xE(),r);return BB(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(na(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await M5(e),i=new u5(e);return t.register("authEvent",r=>(wt(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Tx,{type:Tx},r=>{var o;const s=(o=r==null?void 0:r[0])==null?void 0:o[Tx];s!==void 0&&t(!!s),Rs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=p5(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return lN()||nN()||k1()}}const F5=U5;var xR="@firebase/auth",SR="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V5{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){wt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z5(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function B5(n){Uh(new Fu("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;wt(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:uN(n)},h=new lB(i,r,s,l);return yB(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Uh(new Fu("auth-internal",e=>{const t=El(e.getProvider("auth").getImmediate());return(i=>new V5(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ja(xR,SR,z5(n)),Ja(xR,SR,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H5=5*60,G5=zL("authIdTokenMaxAge")||H5;let ER=null;const W5=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>G5)return;const r=t==null?void 0:t.token;ER!==r&&(ER=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function GK(n=jL()){const e=P1(n,"auth");if(e.isInitialized())return e.getImmediate();const t=_B(n,{popupRedirectResolver:F5,persistence:[KB,FB,vN]}),i=zL("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=W5(s.toString());kB(t,o,()=>o(t.currentUser)),DB(t,a=>o(a))}}const r=FL("auth");return r&&vB(t,`http://${r}`),t}function j5(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}uB({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=qs("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",j5().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});B5("Browser");var wR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Za,CN;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(R,b){function k(){}k.prototype=b.prototype,R.F=b.prototype,R.prototype=new k,R.prototype.constructor=R,R.D=function(M,P,V){for(var F=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)F[Y-2]=arguments[Y];return b.prototype[P].apply(M,F)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(R,b,k){k||(k=0);const M=Array(16);if(typeof b=="string")for(var P=0;P<16;++P)M[P]=b.charCodeAt(k++)|b.charCodeAt(k++)<<8|b.charCodeAt(k++)<<16|b.charCodeAt(k++)<<24;else for(P=0;P<16;++P)M[P]=b[k++]|b[k++]<<8|b[k++]<<16|b[k++]<<24;b=R.g[0],k=R.g[1],P=R.g[2];let V=R.g[3],F;F=b+(V^k&(P^V))+M[0]+3614090360&4294967295,b=k+(F<<7&4294967295|F>>>25),F=V+(P^b&(k^P))+M[1]+3905402710&4294967295,V=b+(F<<12&4294967295|F>>>20),F=P+(k^V&(b^k))+M[2]+606105819&4294967295,P=V+(F<<17&4294967295|F>>>15),F=k+(b^P&(V^b))+M[3]+3250441966&4294967295,k=P+(F<<22&4294967295|F>>>10),F=b+(V^k&(P^V))+M[4]+4118548399&4294967295,b=k+(F<<7&4294967295|F>>>25),F=V+(P^b&(k^P))+M[5]+1200080426&4294967295,V=b+(F<<12&4294967295|F>>>20),F=P+(k^V&(b^k))+M[6]+2821735955&4294967295,P=V+(F<<17&4294967295|F>>>15),F=k+(b^P&(V^b))+M[7]+4249261313&4294967295,k=P+(F<<22&4294967295|F>>>10),F=b+(V^k&(P^V))+M[8]+1770035416&4294967295,b=k+(F<<7&4294967295|F>>>25),F=V+(P^b&(k^P))+M[9]+2336552879&4294967295,V=b+(F<<12&4294967295|F>>>20),F=P+(k^V&(b^k))+M[10]+4294925233&4294967295,P=V+(F<<17&4294967295|F>>>15),F=k+(b^P&(V^b))+M[11]+2304563134&4294967295,k=P+(F<<22&4294967295|F>>>10),F=b+(V^k&(P^V))+M[12]+1804603682&4294967295,b=k+(F<<7&4294967295|F>>>25),F=V+(P^b&(k^P))+M[13]+4254626195&4294967295,V=b+(F<<12&4294967295|F>>>20),F=P+(k^V&(b^k))+M[14]+2792965006&4294967295,P=V+(F<<17&4294967295|F>>>15),F=k+(b^P&(V^b))+M[15]+1236535329&4294967295,k=P+(F<<22&4294967295|F>>>10),F=b+(P^V&(k^P))+M[1]+4129170786&4294967295,b=k+(F<<5&4294967295|F>>>27),F=V+(k^P&(b^k))+M[6]+3225465664&4294967295,V=b+(F<<9&4294967295|F>>>23),F=P+(b^k&(V^b))+M[11]+643717713&4294967295,P=V+(F<<14&4294967295|F>>>18),F=k+(V^b&(P^V))+M[0]+3921069994&4294967295,k=P+(F<<20&4294967295|F>>>12),F=b+(P^V&(k^P))+M[5]+3593408605&4294967295,b=k+(F<<5&4294967295|F>>>27),F=V+(k^P&(b^k))+M[10]+38016083&4294967295,V=b+(F<<9&4294967295|F>>>23),F=P+(b^k&(V^b))+M[15]+3634488961&4294967295,P=V+(F<<14&4294967295|F>>>18),F=k+(V^b&(P^V))+M[4]+3889429448&4294967295,k=P+(F<<20&4294967295|F>>>12),F=b+(P^V&(k^P))+M[9]+568446438&4294967295,b=k+(F<<5&4294967295|F>>>27),F=V+(k^P&(b^k))+M[14]+3275163606&4294967295,V=b+(F<<9&4294967295|F>>>23),F=P+(b^k&(V^b))+M[3]+4107603335&4294967295,P=V+(F<<14&4294967295|F>>>18),F=k+(V^b&(P^V))+M[8]+1163531501&4294967295,k=P+(F<<20&4294967295|F>>>12),F=b+(P^V&(k^P))+M[13]+2850285829&4294967295,b=k+(F<<5&4294967295|F>>>27),F=V+(k^P&(b^k))+M[2]+4243563512&4294967295,V=b+(F<<9&4294967295|F>>>23),F=P+(b^k&(V^b))+M[7]+1735328473&4294967295,P=V+(F<<14&4294967295|F>>>18),F=k+(V^b&(P^V))+M[12]+2368359562&4294967295,k=P+(F<<20&4294967295|F>>>12),F=b+(k^P^V)+M[5]+4294588738&4294967295,b=k+(F<<4&4294967295|F>>>28),F=V+(b^k^P)+M[8]+2272392833&4294967295,V=b+(F<<11&4294967295|F>>>21),F=P+(V^b^k)+M[11]+1839030562&4294967295,P=V+(F<<16&4294967295|F>>>16),F=k+(P^V^b)+M[14]+4259657740&4294967295,k=P+(F<<23&4294967295|F>>>9),F=b+(k^P^V)+M[1]+2763975236&4294967295,b=k+(F<<4&4294967295|F>>>28),F=V+(b^k^P)+M[4]+1272893353&4294967295,V=b+(F<<11&4294967295|F>>>21),F=P+(V^b^k)+M[7]+4139469664&4294967295,P=V+(F<<16&4294967295|F>>>16),F=k+(P^V^b)+M[10]+3200236656&4294967295,k=P+(F<<23&4294967295|F>>>9),F=b+(k^P^V)+M[13]+681279174&4294967295,b=k+(F<<4&4294967295|F>>>28),F=V+(b^k^P)+M[0]+3936430074&4294967295,V=b+(F<<11&4294967295|F>>>21),F=P+(V^b^k)+M[3]+3572445317&4294967295,P=V+(F<<16&4294967295|F>>>16),F=k+(P^V^b)+M[6]+76029189&4294967295,k=P+(F<<23&4294967295|F>>>9),F=b+(k^P^V)+M[9]+3654602809&4294967295,b=k+(F<<4&4294967295|F>>>28),F=V+(b^k^P)+M[12]+3873151461&4294967295,V=b+(F<<11&4294967295|F>>>21),F=P+(V^b^k)+M[15]+530742520&4294967295,P=V+(F<<16&4294967295|F>>>16),F=k+(P^V^b)+M[2]+3299628645&4294967295,k=P+(F<<23&4294967295|F>>>9),F=b+(P^(k|~V))+M[0]+4096336452&4294967295,b=k+(F<<6&4294967295|F>>>26),F=V+(k^(b|~P))+M[7]+1126891415&4294967295,V=b+(F<<10&4294967295|F>>>22),F=P+(b^(V|~k))+M[14]+2878612391&4294967295,P=V+(F<<15&4294967295|F>>>17),F=k+(V^(P|~b))+M[5]+4237533241&4294967295,k=P+(F<<21&4294967295|F>>>11),F=b+(P^(k|~V))+M[12]+1700485571&4294967295,b=k+(F<<6&4294967295|F>>>26),F=V+(k^(b|~P))+M[3]+2399980690&4294967295,V=b+(F<<10&4294967295|F>>>22),F=P+(b^(V|~k))+M[10]+4293915773&4294967295,P=V+(F<<15&4294967295|F>>>17),F=k+(V^(P|~b))+M[1]+2240044497&4294967295,k=P+(F<<21&4294967295|F>>>11),F=b+(P^(k|~V))+M[8]+1873313359&4294967295,b=k+(F<<6&4294967295|F>>>26),F=V+(k^(b|~P))+M[15]+4264355552&4294967295,V=b+(F<<10&4294967295|F>>>22),F=P+(b^(V|~k))+M[6]+2734768916&4294967295,P=V+(F<<15&4294967295|F>>>17),F=k+(V^(P|~b))+M[13]+1309151649&4294967295,k=P+(F<<21&4294967295|F>>>11),F=b+(P^(k|~V))+M[4]+4149444226&4294967295,b=k+(F<<6&4294967295|F>>>26),F=V+(k^(b|~P))+M[11]+3174756917&4294967295,V=b+(F<<10&4294967295|F>>>22),F=P+(b^(V|~k))+M[2]+718787259&4294967295,P=V+(F<<15&4294967295|F>>>17),F=k+(V^(P|~b))+M[9]+3951481745&4294967295,R.g[0]=R.g[0]+b&4294967295,R.g[1]=R.g[1]+(P+(F<<21&4294967295|F>>>11))&4294967295,R.g[2]=R.g[2]+P&4294967295,R.g[3]=R.g[3]+V&4294967295}i.prototype.v=function(R,b){b===void 0&&(b=R.length);const k=b-this.blockSize,M=this.C;let P=this.h,V=0;for(;V<b;){if(P==0)for(;V<=k;)r(this,R,V),V+=this.blockSize;if(typeof R=="string"){for(;V<b;)if(M[P++]=R.charCodeAt(V++),P==this.blockSize){r(this,M),P=0;break}}else for(;V<b;)if(M[P++]=R[V++],P==this.blockSize){r(this,M),P=0;break}}this.h=P,this.o+=b},i.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var b=1;b<R.length-8;++b)R[b]=0;b=this.o*8;for(var k=R.length-8;k<R.length;++k)R[k]=b&255,b/=256;for(this.v(R),R=Array(16),b=0,k=0;k<4;++k)for(let M=0;M<32;M+=8)R[b++]=this.g[k]>>>M&255;return R};function s(R,b){var k=a;return Object.prototype.hasOwnProperty.call(k,R)?k[R]:k[R]=b(R)}function o(R,b){this.h=b;const k=[];let M=!0;for(let P=R.length-1;P>=0;P--){const V=R[P]|0;M&&V==b||(k[P]=V,M=!1)}this.g=k}var a={};function l(R){return-128<=R&&R<128?s(R,function(b){return new o([b|0],b<0?-1:0)}):new o([R|0],R<0?-1:0)}function h(R){if(isNaN(R)||!isFinite(R))return d;if(R<0)return x(h(-R));const b=[];let k=1;for(let M=0;R>=k;M++)b[M]=R/k|0,k*=4294967296;return new o(b,0)}function f(R,b){if(R.length==0)throw Error("number format error: empty string");if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(R.charAt(0)=="-")return x(f(R.substring(1),b));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=h(Math.pow(b,8));let M=d;for(let V=0;V<R.length;V+=8){var P=Math.min(8,R.length-V);const F=parseInt(R.substring(V,V+P),b);P<8?(P=h(Math.pow(b,P)),M=M.j(P).add(h(F))):(M=M.j(k),M=M.add(h(F)))}return M}var d=l(0),p=l(1),_=l(16777216);n=o.prototype,n.m=function(){if(T(this))return-x(this).m();let R=0,b=1;for(let k=0;k<this.g.length;k++){const M=this.i(k);R+=(M>=0?M:4294967296+M)*b,b*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(v(this))return"0";if(T(this))return"-"+x(this).toString(R);const b=h(Math.pow(R,6));var k=this;let M="";for(;;){const P=I(k,b).g;k=y(k,P.j(b));let V=((k.g.length>0?k.g[0]:k.h)>>>0).toString(R);if(k=P,v(k))return V+M;for(;V.length<6;)V="0"+V;M=V+M}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function v(R){if(R.h!=0)return!1;for(let b=0;b<R.g.length;b++)if(R.g[b]!=0)return!1;return!0}function T(R){return R.h==-1}n.l=function(R){return R=y(this,R),T(R)?-1:v(R)?0:1};function x(R){const b=R.g.length,k=[];for(let M=0;M<b;M++)k[M]=~R.g[M];return new o(k,~R.h).add(p)}n.abs=function(){return T(this)?x(this):this},n.add=function(R){const b=Math.max(this.g.length,R.g.length),k=[];let M=0;for(let P=0;P<=b;P++){let V=M+(this.i(P)&65535)+(R.i(P)&65535),F=(V>>>16)+(this.i(P)>>>16)+(R.i(P)>>>16);M=F>>>16,V&=65535,F&=65535,k[P]=F<<16|V}return new o(k,k[k.length-1]&-2147483648?-1:0)};function y(R,b){return R.add(x(b))}n.j=function(R){if(v(this)||v(R))return d;if(T(this))return T(R)?x(this).j(x(R)):x(x(this).j(R));if(T(R))return x(this.j(x(R)));if(this.l(_)<0&&R.l(_)<0)return h(this.m()*R.m());const b=this.g.length+R.g.length,k=[];for(var M=0;M<2*b;M++)k[M]=0;for(M=0;M<this.g.length;M++)for(let P=0;P<R.g.length;P++){const V=this.i(M)>>>16,F=this.i(M)&65535,Y=R.i(P)>>>16,re=R.i(P)&65535;k[2*M+2*P]+=F*re,w(k,2*M+2*P),k[2*M+2*P+1]+=V*re,w(k,2*M+2*P+1),k[2*M+2*P+1]+=F*Y,w(k,2*M+2*P+1),k[2*M+2*P+2]+=V*Y,w(k,2*M+2*P+2)}for(R=0;R<b;R++)k[R]=k[2*R+1]<<16|k[2*R];for(R=b;R<2*b;R++)k[R]=0;return new o(k,0)};function w(R,b){for(;(R[b]&65535)!=R[b];)R[b+1]+=R[b]>>>16,R[b]&=65535,b++}function E(R,b){this.g=R,this.h=b}function I(R,b){if(v(b))throw Error("division by zero");if(v(R))return new E(d,d);if(T(R))return b=I(x(R),b),new E(x(b.g),x(b.h));if(T(b))return b=I(R,x(b)),new E(x(b.g),b.h);if(R.g.length>30){if(T(R)||T(b))throw Error("slowDivide_ only works with positive integers.");for(var k=p,M=b;M.l(R)<=0;)k=O(k),M=O(M);var P=D(k,1),V=D(M,1);for(M=D(M,2),k=D(k,2);!v(M);){var F=V.add(M);F.l(R)<=0&&(P=P.add(k),V=F),M=D(M,1),k=D(k,1)}return b=y(R,P.j(b)),new E(P,b)}for(P=d;R.l(b)>=0;){for(k=Math.max(1,Math.floor(R.m()/b.m())),M=Math.ceil(Math.log(k)/Math.LN2),M=M<=48?1:Math.pow(2,M-48),V=h(k),F=V.j(b);T(F)||F.l(R)>0;)k-=M,V=h(k),F=V.j(b);v(V)&&(V=p),P=P.add(V),R=y(R,F)}return new E(P,R)}n.B=function(R){return I(this,R).h},n.and=function(R){const b=Math.max(this.g.length,R.g.length),k=[];for(let M=0;M<b;M++)k[M]=this.i(M)&R.i(M);return new o(k,this.h&R.h)},n.or=function(R){const b=Math.max(this.g.length,R.g.length),k=[];for(let M=0;M<b;M++)k[M]=this.i(M)|R.i(M);return new o(k,this.h|R.h)},n.xor=function(R){const b=Math.max(this.g.length,R.g.length),k=[];for(let M=0;M<b;M++)k[M]=this.i(M)^R.i(M);return new o(k,this.h^R.h)};function O(R){const b=R.g.length+1,k=[];for(let M=0;M<b;M++)k[M]=R.i(M)<<1|R.i(M-1)>>>31;return new o(k,R.h)}function D(R,b){const k=b>>5;b%=32;const M=R.g.length-k,P=[];for(let V=0;V<M;V++)P[V]=b>0?R.i(V+k)>>>b|R.i(V+k+1)<<32-b:R.i(V+k);return new o(P,R.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,CN=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,Za=o}).apply(typeof wR<"u"?wR:typeof self<"u"?self:typeof window<"u"?window:{});var hg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var RN,hd,IN,R_,TE,PN,bN,LN;(function(){var n,e=Object.defineProperty;function t(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof hg=="object"&&hg];for(var C=0;C<m.length;++C){var N=m[C];if(N&&N.Math==Math)return N}throw Error("Cannot find global object")}var i=t(this);function r(m,C){if(C)e:{var N=i;m=m.split(".");for(var B=0;B<m.length-1;B++){var ie=m[B];if(!(ie in N))break e;N=N[ie]}m=m[m.length-1],B=N[m],C=C(B),C!=B&&C!=null&&e(N,m,{configurable:!0,writable:!0,value:C})}}r("Symbol.dispose",function(m){return m||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(m){return m||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(m){return m||function(C){var N=[],B;for(B in C)Object.prototype.hasOwnProperty.call(C,B)&&N.push([B,C[B]]);return N}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function a(m){var C=typeof m;return C=="object"&&m!=null||C=="function"}function l(m,C,N){return m.call.apply(m.bind,arguments)}function h(m,C,N){return h=l,h.apply(null,arguments)}function f(m,C){var N=Array.prototype.slice.call(arguments,1);return function(){var B=N.slice();return B.push.apply(B,arguments),m.apply(this,B)}}function d(m,C){function N(){}N.prototype=C.prototype,m.Z=C.prototype,m.prototype=new N,m.prototype.constructor=m,m.Ob=function(B,ie,ue){for(var ke=Array(arguments.length-2),bt=2;bt<arguments.length;bt++)ke[bt-2]=arguments[bt];return C.prototype[ie].apply(B,ke)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?m=>m&&AsyncContext.Snapshot.wrap(m):m=>m;function _(m){const C=m.length;if(C>0){const N=Array(C);for(let B=0;B<C;B++)N[B]=m[B];return N}return[]}function v(m,C){for(let B=1;B<arguments.length;B++){const ie=arguments[B];var N=typeof ie;if(N=N!="object"?N:ie?Array.isArray(ie)?"array":N:"null",N=="array"||N=="object"&&typeof ie.length=="number"){N=m.length||0;const ue=ie.length||0;m.length=N+ue;for(let ke=0;ke<ue;ke++)m[N+ke]=ie[ke]}else m.push(ie)}}class T{constructor(C,N){this.i=C,this.j=N,this.h=0,this.g=null}get(){let C;return this.h>0?(this.h--,C=this.g,this.g=C.next,C.next=null):C=this.i(),C}}function x(m){o.setTimeout(()=>{throw m},0)}function y(){var m=R;let C=null;return m.g&&(C=m.g,m.g=m.g.next,m.g||(m.h=null),C.next=null),C}class w{constructor(){this.h=this.g=null}add(C,N){const B=E.get();B.set(C,N),this.h?this.h.next=B:this.g=B,this.h=B}}var E=new T(()=>new I,m=>m.reset());class I{constructor(){this.next=this.g=this.h=null}set(C,N){this.h=C,this.g=N,this.next=null}reset(){this.next=this.g=this.h=null}}let O,D=!1,R=new w,b=()=>{const m=Promise.resolve(void 0);O=()=>{m.then(k)}};function k(){for(var m;m=y();){try{m.h.call(m.g)}catch(N){x(N)}var C=E;C.j(m),C.h<100&&(C.h++,m.next=C.g,C.g=m)}D=!1}function M(){this.u=this.u,this.C=this.C}M.prototype.u=!1,M.prototype.dispose=function(){this.u||(this.u=!0,this.N())},M.prototype[Symbol.dispose]=function(){this.dispose()},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function P(m,C){this.type=m,this.g=this.target=C,this.defaultPrevented=!1}P.prototype.h=function(){this.defaultPrevented=!0};var V=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var m=!1,C=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const N=()=>{};o.addEventListener("test",N,C),o.removeEventListener("test",N,C)}catch{}return m}();function F(m){return/^[\s\xa0]*$/.test(m)}function Y(m,C){P.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m&&this.init(m,C)}d(Y,P),Y.prototype.init=function(m,C){const N=this.type=m.type,B=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;this.target=m.target||m.srcElement,this.g=C,C=m.relatedTarget,C||(N=="mouseover"?C=m.fromElement:N=="mouseout"&&(C=m.toElement)),this.relatedTarget=C,B?(this.clientX=B.clientX!==void 0?B.clientX:B.pageX,this.clientY=B.clientY!==void 0?B.clientY:B.pageY,this.screenX=B.screenX||0,this.screenY=B.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=m.pointerType,this.state=m.state,this.i=m,m.defaultPrevented&&Y.Z.h.call(this)},Y.prototype.h=function(){Y.Z.h.call(this);const m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var re="closure_listenable_"+(Math.random()*1e6|0),se=0;function ye(m,C,N,B,ie){this.listener=m,this.proxy=null,this.src=C,this.type=N,this.capture=!!B,this.ha=ie,this.key=++se,this.da=this.fa=!1}function W(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function K(m,C,N){for(const B in m)C.call(N,m[B],B,m)}function Q(m,C){for(const N in m)C.call(void 0,m[N],N,m)}function ee(m){const C={};for(const N in m)C[N]=m[N];return C}const _e="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ne(m,C){let N,B;for(let ie=1;ie<arguments.length;ie++){B=arguments[ie];for(N in B)m[N]=B[N];for(let ue=0;ue<_e.length;ue++)N=_e[ue],Object.prototype.hasOwnProperty.call(B,N)&&(m[N]=B[N])}}function oe(m){this.src=m,this.g={},this.h=0}oe.prototype.add=function(m,C,N,B,ie){const ue=m.toString();m=this.g[ue],m||(m=this.g[ue]=[],this.h++);const ke=Le(m,C,B,ie);return ke>-1?(C=m[ke],N||(C.fa=!1)):(C=new ye(C,this.src,ue,!!B,ie),C.fa=N,m.push(C)),C};function xe(m,C){const N=C.type;if(N in m.g){var B=m.g[N],ie=Array.prototype.indexOf.call(B,C,void 0),ue;(ue=ie>=0)&&Array.prototype.splice.call(B,ie,1),ue&&(W(C),m.g[N].length==0&&(delete m.g[N],m.h--))}}function Le(m,C,N,B){for(let ie=0;ie<m.length;++ie){const ue=m[ie];if(!ue.da&&ue.listener==C&&ue.capture==!!N&&ue.ha==B)return ie}return-1}var ze="closure_lm_"+(Math.random()*1e6|0),at={};function Ze(m,C,N,B,ie){if(Array.isArray(C)){for(let ue=0;ue<C.length;ue++)Ze(m,C[ue],N,B,ie);return null}return N=Be(N),m&&m[re]?m.J(C,N,a(B)?!!B.capture:!1,ie):St(m,C,N,!1,B,ie)}function St(m,C,N,B,ie,ue){if(!C)throw Error("Invalid event type");const ke=a(ie)?!!ie.capture:!!ie;let bt=ve(m);if(bt||(m[ze]=bt=new oe(m)),N=bt.add(C,N,B,ke,ue),N.proxy)return N;if(B=nt(),N.proxy=B,B.src=m,B.listener=N,m.addEventListener)V||(ie=ke),ie===void 0&&(ie=!1),m.addEventListener(C.toString(),B,ie);else if(m.attachEvent)m.attachEvent(me(C.toString()),B);else if(m.addListener&&m.removeListener)m.addListener(B);else throw Error("addEventListener and attachEvent are unavailable.");return N}function nt(){function m(N){return C.call(m.src,m.listener,N)}const C=Pe;return m}function X(m,C,N,B,ie){if(Array.isArray(C))for(var ue=0;ue<C.length;ue++)X(m,C[ue],N,B,ie);else B=a(B)?!!B.capture:!!B,N=Be(N),m&&m[re]?(m=m.i,ue=String(C).toString(),ue in m.g&&(C=m.g[ue],N=Le(C,N,B,ie),N>-1&&(W(C[N]),Array.prototype.splice.call(C,N,1),C.length==0&&(delete m.g[ue],m.h--)))):m&&(m=ve(m))&&(C=m.g[C.toString()],m=-1,C&&(m=Le(C,N,B,ie)),(N=m>-1?C[m]:null)&&Ce(N))}function Ce(m){if(typeof m!="number"&&m&&!m.da){var C=m.src;if(C&&C[re])xe(C.i,m);else{var N=m.type,B=m.proxy;C.removeEventListener?C.removeEventListener(N,B,m.capture):C.detachEvent?C.detachEvent(me(N),B):C.addListener&&C.removeListener&&C.removeListener(B),(N=ve(C))?(xe(N,m),N.h==0&&(N.src=null,C[ze]=null)):W(m)}}}function me(m){return m in at?at[m]:at[m]="on"+m}function Pe(m,C){if(m.da)m=!0;else{C=new Y(C,this);const N=m.listener,B=m.ha||m.src;m.fa&&Ce(m),m=N.call(B,C)}return m}function ve(m){return m=m[ze],m instanceof oe?m:null}var st="__closure_events_fn_"+(Math.random()*1e9>>>0);function Be(m){return typeof m=="function"?m:(m[st]||(m[st]=function(C){return m.handleEvent(C)}),m[st])}function z(){M.call(this),this.i=new oe(this),this.M=this,this.G=null}d(z,M),z.prototype[re]=!0,z.prototype.removeEventListener=function(m,C,N,B){X(this,m,C,N,B)};function U(m,C){var N,B=m.G;if(B)for(N=[];B;B=B.G)N.push(B);if(m=m.M,B=C.type||C,typeof C=="string")C=new P(C,m);else if(C instanceof P)C.target=C.target||m;else{var ie=C;C=new P(B,m),Ne(C,ie)}ie=!0;let ue,ke;if(N)for(ke=N.length-1;ke>=0;ke--)ue=C.g=N[ke],ie=te(ue,B,!0,C)&&ie;if(ue=C.g=m,ie=te(ue,B,!0,C)&&ie,ie=te(ue,B,!1,C)&&ie,N)for(ke=0;ke<N.length;ke++)ue=C.g=N[ke],ie=te(ue,B,!1,C)&&ie}z.prototype.N=function(){if(z.Z.N.call(this),this.i){var m=this.i;for(const C in m.g){const N=m.g[C];for(let B=0;B<N.length;B++)W(N[B]);delete m.g[C],m.h--}}this.G=null},z.prototype.J=function(m,C,N,B){return this.i.add(String(m),C,!1,N,B)},z.prototype.K=function(m,C,N,B){return this.i.add(String(m),C,!0,N,B)};function te(m,C,N,B){if(C=m.i.g[String(C)],!C)return!0;C=C.concat();let ie=!0;for(let ue=0;ue<C.length;++ue){const ke=C[ue];if(ke&&!ke.da&&ke.capture==N){const bt=ke.listener,Cn=ke.ha||ke.src;ke.fa&&xe(m.i,ke),ie=bt.call(Cn,B)!==!1&&ie}}return ie&&!B.defaultPrevented}function Ie(m,C){if(typeof m!="function")if(m&&typeof m.handleEvent=="function")m=h(m.handleEvent,m);else throw Error("Invalid listener argument");return Number(C)>2147483647?-1:o.setTimeout(m,C||0)}function Ae(m){m.g=Ie(()=>{m.g=null,m.i&&(m.i=!1,Ae(m))},m.l);const C=m.h;m.h=null,m.m.apply(null,C)}class Ee extends M{constructor(C,N){super(),this.m=C,this.l=N,this.h=null,this.i=!1,this.g=null}j(C){this.h=arguments,this.g?this.i=!0:Ae(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ke(m){M.call(this),this.h=m,this.g={}}d(Ke,M);var Ue=[];function je(m){K(m.g,function(C,N){this.g.hasOwnProperty(N)&&Ce(C)},m),m.g={}}Ke.prototype.N=function(){Ke.Z.N.call(this),je(this)},Ke.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ct=o.JSON.stringify,Rt=o.JSON.parse,Re=class{stringify(m){return o.JSON.stringify(m,void 0)}parse(m){return o.JSON.parse(m,void 0)}};function Gt(){}function Nt(){}var gt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ut(){P.call(this,"d")}d(ut,P);function $e(){P.call(this,"c")}d($e,P);var $={},we=null;function Ve(){return we=we||new z}$.Ia="serverreachability";function Ge(m){P.call(this,$.Ia,m)}d(Ge,P);function mt(m){const C=Ve();U(C,new Ge(C))}$.STAT_EVENT="statevent";function q(m,C){P.call(this,$.STAT_EVENT,m),this.stat=C}d(q,P);function Me(m){const C=Ve();U(C,new q(C,m))}$.Ja="timingevent";function De(m,C){P.call(this,$.Ja,m),this.size=C}d(De,P);function Qe(m,C){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){m()},C)}function Je(){this.g=!0}Je.prototype.ua=function(){this.g=!1};function kt(m,C,N,B,ie,ue){m.info(function(){if(m.g)if(ue){var ke="",bt=ue.split("&");for(let sn=0;sn<bt.length;sn++){var Cn=bt[sn].split("=");if(Cn.length>1){const un=Cn[0];Cn=Cn[1];const Nn=un.split("_");ke=Nn.length>=2&&Nn[1]=="type"?ke+(un+"="+Cn+"&"):ke+(un+"=redacted&")}}}else ke=null;else ke=ue;return"XMLHTTP REQ ("+B+") [attempt "+ie+"]: "+C+`
`+N+`
`+ke})}function jt(m,C,N,B,ie,ue,ke){m.info(function(){return"XMLHTTP RESP ("+B+") [ attempt "+ie+"]: "+C+`
`+N+`
`+ue+" "+ke})}function en(m,C,N,B){m.info(function(){return"XMLHTTP TEXT ("+C+"): "+Kt(m,N)+(B?" "+B:"")})}function bn(m,C){m.info(function(){return"TIMEOUT: "+C})}Je.prototype.info=function(){};function Kt(m,C){if(!m.g)return C;if(!C)return null;try{const ue=JSON.parse(C);if(ue){for(m=0;m<ue.length;m++)if(Array.isArray(ue[m])){var N=ue[m];if(!(N.length<2)){var B=N[1];if(Array.isArray(B)&&!(B.length<1)){var ie=B[0];if(ie!="noop"&&ie!="stop"&&ie!="close")for(let ke=1;ke<B.length;ke++)B[ke]=""}}}}return ct(ue)}catch{return C}}var Bn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},rr={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},fa;function Mo(){}d(Mo,Gt),Mo.prototype.g=function(){return new XMLHttpRequest},fa=new Mo;function ss(m){return encodeURIComponent(String(m))}function Js(m){var C=1;m=m.split(":");const N=[];for(;C>0&&m.length;)N.push(m.shift()),C--;return m.length&&N.push(m.join(":")),N}function sr(m,C,N,B){this.j=m,this.i=C,this.l=N,this.S=B||1,this.V=new Ke(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Pl}function Pl(){this.i=null,this.g="",this.h=!1}var bl={},Ll={};function Nl(m,C,N){m.M=1,m.A=or(tn(C)),m.u=N,m.R=!0,tc(m,null)}function tc(m,C){m.F=Date.now(),he(m),m.B=tn(m.A);var N=m.B,B=m.S;Array.isArray(B)||(B=[String(B)]),rc(N.i,"t",B),m.C=0,N=m.j.L,m.h=new Pl,m.g=cs(m.j,N?C:null,!m.u),m.P>0&&(m.O=new Ee(h(m.Y,m,m.g),m.P)),C=m.V,N=m.g,B=m.ba;var ie="readystatechange";Array.isArray(ie)||(ie&&(Ue[0]=ie.toString()),ie=Ue);for(let ue=0;ue<ie.length;ue++){const ke=Ze(N,ie[ue],B||C.handleEvent,!1,C.h||C);if(!ke)break;C.g[ke.key]=ke}C=m.J?ee(m.J):{},m.u?(m.v||(m.v="POST"),C["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.B,m.v,m.u,C)):(m.v="GET",m.g.ea(m.B,m.v,null,C)),mt(),kt(m.i,m.v,m.B,m.l,m.S,m.u)}sr.prototype.ba=function(m){m=m.target;const C=this.O;C&&Fr(m)==3?C.j():this.Y(m)},sr.prototype.Y=function(m){try{if(m==this.g)e:{const bt=Fr(this.g),Cn=this.g.ya(),sn=this.g.ca();if(!(bt<3)&&(bt!=3||this.g&&(this.h.h||this.g.la()||uc(this.g)))){this.K||bt!=4||Cn==7||(Cn==8||sn<=0?mt(3):mt(2)),We(this);var C=this.g.ca();this.X=C;var N=H(this);if(this.o=C==200,jt(this.i,this.v,this.B,this.l,this.S,bt,C),this.o){if(this.U&&!this.L){t:{if(this.g){var B,ie=this.g;if((B=ie.g?ie.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!F(B)){var ue=B;break t}}ue=null}if(m=ue)en(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,_t(this,m);else{this.o=!1,this.m=3,Me(12),ht(this),ot(this);break e}}if(this.R){m=!0;let un;for(;!this.K&&this.C<N.length;)if(un=ce(this,N),un==Ll){bt==4&&(this.m=4,Me(14),m=!1),en(this.i,this.l,null,"[Incomplete Response]");break}else if(un==bl){this.m=4,Me(15),en(this.i,this.l,N,"[Invalid Chunk]"),m=!1;break}else en(this.i,this.l,un,null),_t(this,un);if(ne(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),bt!=4||N.length!=0||this.h.h||(this.m=1,Me(16),m=!1),this.o=this.o&&m,!m)en(this.i,this.l,N,"[Invalid Chunked Response]"),ht(this),ot(this);else if(N.length>0&&!this.W){this.W=!0;var ke=this.j;ke.g==this&&ke.aa&&!ke.P&&(ke.j.info("Great, no buffering proxy detected. Bytes received: "+N.length),Fl(ke),ke.P=!0,Me(11))}}else en(this.i,this.l,N,null),_t(this,N);bt==4&&ht(this),this.o&&!this.K&&(bt==4?ar(this.j,this):(this.o=!1,he(this)))}else fm(this.g),C==400&&N.indexOf("Unknown SID")>0?(this.m=3,Me(12)):(this.m=0,Me(13)),ht(this),ot(this)}}}catch{}finally{}};function H(m){if(!ne(m))return m.g.la();const C=uc(m.g);if(C==="")return"";let N="";const B=C.length,ie=Fr(m.g)==4;if(!m.h.i){if(typeof TextDecoder>"u")return ht(m),ot(m),"";m.h.i=new o.TextDecoder}for(let ue=0;ue<B;ue++)m.h.h=!0,N+=m.h.i.decode(C[ue],{stream:!(ie&&ue==B-1)});return C.length=0,m.h.g+=N,m.C=0,m.h.g}function ne(m){return m.g?m.v=="GET"&&m.M!=2&&m.j.Aa:!1}function ce(m,C){var N=m.C,B=C.indexOf(`
`,N);return B==-1?Ll:(N=Number(C.substring(N,B)),isNaN(N)?bl:(B+=1,B+N>C.length?Ll:(C=C.slice(B,B+N),m.C=B+N,C)))}sr.prototype.cancel=function(){this.K=!0,ht(this)};function he(m){m.T=Date.now()+m.H,le(m,m.H)}function le(m,C){if(m.D!=null)throw Error("WatchDog timer not null");m.D=Qe(h(m.aa,m),C)}function We(m){m.D&&(o.clearTimeout(m.D),m.D=null)}sr.prototype.aa=function(){this.D=null;const m=Date.now();m-this.T>=0?(bn(this.i,this.B),this.M!=2&&(mt(),Me(17)),ht(this),this.m=2,ot(this)):le(this,this.T-m)};function ot(m){m.j.I==0||m.K||ar(m.j,m)}function ht(m){We(m);var C=m.O;C&&typeof C.dispose=="function"&&C.dispose(),m.O=null,je(m.V),m.g&&(C=m.g,m.g=null,C.abort(),C.dispose())}function _t(m,C){try{var N=m.j;if(N.I!=0&&(N.g==m||Yn(N.h,m))){if(!m.L&&Yn(N.h,m)&&N.I==3){try{var B=N.Ba.g.parse(C)}catch{B=null}if(Array.isArray(B)&&B.length==3){var ie=B;if(ie[0]==0){e:if(!N.v){if(N.g)if(N.g.F+3e3<m.F)Ps(N),Co(N);else break e;dc(N),Me(18)}}else N.xa=ie[1],0<N.xa-N.K&&ie[2]<37500&&N.F&&N.A==0&&!N.C&&(N.C=Qe(h(N.Va,N),6e3));_n(N.h)<=1&&N.ta&&(N.ta=void 0)}else Fi(N,11)}else if((m.L||N.g==m)&&Ps(N),!F(C))for(ie=N.Ba.g.parse(C),C=0;C<ie.length;C++){let sn=ie[C];const un=sn[0];if(!(un<=N.K))if(N.K=un,sn=sn[1],N.I==2)if(sn[0]=="c"){N.M=sn[1],N.ba=sn[2];const Nn=sn[3];Nn!=null&&(N.ka=Nn,N.j.info("VER="+N.ka));const lr=sn[4];lr!=null&&(N.za=lr,N.j.info("SVER="+N.za));const xi=sn[5];xi!=null&&typeof xi=="number"&&xi>0&&(B=1.5*xi,N.O=B,N.j.info("backChannelRequestTimeoutMs_="+B)),B=N;const Si=m.g;if(Si){const hs=Si.g?Si.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(hs){var ue=B.h;ue.g||hs.indexOf("spdy")==-1&&hs.indexOf("quic")==-1&&hs.indexOf("h2")==-1||(ue.j=ue.l,ue.g=new Set,ue.h&&(fn(ue,ue.h),ue.h=null))}if(B.G){const gc=Si.g?Si.g.getResponseHeader("X-HTTP-Session-Id"):null;gc&&(B.wa=gc,Pt(B.J,B.G,gc))}}N.I=3,N.l&&N.l.ra(),N.aa&&(N.T=Date.now()-m.F,N.j.info("Handshake RTT: "+N.T+"ms")),B=N;var ke=m;if(B.na=_f(B,B.L?B.ba:null,B.W),ke.L){$n(B.h,ke);var bt=ke,Cn=B.O;Cn&&(bt.H=Cn),bt.D&&(We(bt),he(bt)),B.g=ke}else fc(B);N.i.length>0&&Ui(N)}else sn[0]!="stop"&&sn[0]!="close"||Fi(N,7);else N.I==3&&(sn[0]=="stop"||sn[0]=="close"?sn[0]=="stop"?Fi(N,7):gf(N):sn[0]!="noop"&&N.l&&N.l.qa(sn),N.A=0)}}mt(4)}catch{}}var It=class{constructor(m,C){this.g=m,this.map=C}};function Et(m){this.l=m||10,o.PerformanceNavigationTiming?(m=o.performance.getEntriesByType("navigation"),m=m.length>0&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function At(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function _n(m){return m.h?1:m.g?m.g.size:0}function Yn(m,C){return m.h?m.h==C:m.g?m.g.has(C):!1}function fn(m,C){m.g?m.g.add(C):m.h=C}function $n(m,C){m.h&&m.h==C?m.h=null:m.g&&m.g.has(C)&&m.g.delete(C)}Et.prototype.cancel=function(){if(this.i=yt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function yt(m){if(m.h!=null)return m.i.concat(m.h.G);if(m.g!=null&&m.g.size!==0){let C=m.i;for(const N of m.g.values())C=C.concat(N.G);return C}return _(m.i)}var et=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Er(m,C){if(m){m=m.split("&");for(let N=0;N<m.length;N++){const B=m[N].indexOf("=");let ie,ue=null;B>=0?(ie=m[N].substring(0,B),ue=m[N].substring(B+1)):ie=m[N],C(ie,ue?decodeURIComponent(ue.replace(/\+/g," ")):"")}}}function Ct(m){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let C;m instanceof Ct?(this.l=m.l,ki(this,m.j),this.o=m.o,this.g=m.g,vi(this,m.u),this.h=m.h,Hn(this,sc(m.i)),this.m=m.m):m&&(C=String(m).match(et))?(this.l=!1,ki(this,C[1]||"",!0),this.o=os(C[2]||""),this.g=os(C[3]||"",!0),vi(this,C[4]),this.h=os(C[5]||"",!0),Hn(this,C[6]||"",!0),this.m=os(C[7]||"")):(this.l=!1,this.i=new Zs(null,this.l))}Ct.prototype.toString=function(){const m=[];var C=this.j;C&&m.push(Ln(C,Oi,!0),":");var N=this.g;return(N||C=="file")&&(m.push("//"),(C=this.o)&&m.push(Ln(C,Oi,!0),"@"),m.push(ss(N).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),N=this.u,N!=null&&m.push(":",String(N))),(N=this.h)&&(this.g&&N.charAt(0)!="/"&&m.push("/"),m.push(Ln(N,N.charAt(0)=="/"?Zv:nc,!0))),(N=this.i.toString())&&m.push("?",N),(N=this.m)&&m.push("#",Ln(N,ic)),m.join("")},Ct.prototype.resolve=function(m){const C=tn(this);let N=!!m.j;N?ki(C,m.j):N=!!m.o,N?C.o=m.o:N=!!m.g,N?C.g=m.g:N=m.u!=null;var B=m.h;if(N)vi(C,m.u);else if(N=!!m.h){if(B.charAt(0)!="/")if(this.g&&!this.h)B="/"+B;else{var ie=C.h.lastIndexOf("/");ie!=-1&&(B=C.h.slice(0,ie+1)+B)}if(ie=B,ie==".."||ie==".")B="";else if(ie.indexOf("./")!=-1||ie.indexOf("/.")!=-1){B=ie.lastIndexOf("/",0)==0,ie=ie.split("/");const ue=[];for(let ke=0;ke<ie.length;){const bt=ie[ke++];bt=="."?B&&ke==ie.length&&ue.push(""):bt==".."?((ue.length>1||ue.length==1&&ue[0]!="")&&ue.pop(),B&&ke==ie.length&&ue.push("")):(ue.push(bt),B=!0)}B=ue.join("/")}else B=ie}return N?C.h=B:N=m.i.toString()!=="",N?Hn(C,sc(m.i)):N=!!m.m,N&&(C.m=m.m),C};function tn(m){return new Ct(m)}function ki(m,C,N){m.j=N?os(C,!0):C,m.j&&(m.j=m.j.replace(/:$/,""))}function vi(m,C){if(C){if(C=Number(C),isNaN(C)||C<0)throw Error("Bad port number "+C);m.u=C}else m.u=null}function Hn(m,C,N){C instanceof Zs?(m.i=C,t0(m.i,m.l)):(N||(C=Ln(C,e0)),m.i=new Zs(C,m.l))}function Pt(m,C,N){m.i.set(C,N)}function or(m){return Pt(m,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),m}function os(m,C){return m?C?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function Ln(m,C,N){return typeof m=="string"?(m=encodeURI(m).replace(C,da),N&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function da(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var Oi=/[#\/\?@]/g,nc=/[#\?:]/g,Zv=/[#\?]/g,e0=/[#\?@]/g,ic=/#/g;function Zs(m,C){this.h=this.g=null,this.i=m||null,this.j=!!C}function Or(m){m.g||(m.g=new Map,m.h=0,m.i&&Er(m.i,function(C,N){m.add(decodeURIComponent(C.replace(/\+/g," ")),N)}))}n=Zs.prototype,n.add=function(m,C){Or(this),this.i=null,m=as(this,m);let N=this.g.get(m);return N||this.g.set(m,N=[]),N.push(C),this.h+=1,this};function Dl(m,C){Or(m),C=as(m,C),m.g.has(C)&&(m.i=null,m.h-=m.g.get(C).length,m.g.delete(C))}function om(m,C){return Or(m),C=as(m,C),m.g.has(C)}n.forEach=function(m,C){Or(this),this.g.forEach(function(N,B){N.forEach(function(ie){m.call(C,ie,B,this)},this)},this)};function am(m,C){Or(m);let N=[];if(typeof C=="string")om(m,C)&&(N=N.concat(m.g.get(as(m,C))));else for(m=Array.from(m.g.values()),C=0;C<m.length;C++)N=N.concat(m[C]);return N}n.set=function(m,C){return Or(this),this.i=null,m=as(this,m),om(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[C]),this.h+=1,this},n.get=function(m,C){return m?(m=am(this,m),m.length>0?String(m[0]):C):C};function rc(m,C,N){Dl(m,C),N.length>0&&(m.i=null,m.g.set(as(m,C),_(N)),m.h+=N.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],C=Array.from(this.g.keys());for(let B=0;B<C.length;B++){var N=C[B];const ie=ss(N);N=am(this,N);for(let ue=0;ue<N.length;ue++){let ke=ie;N[ue]!==""&&(ke+="="+ss(N[ue])),m.push(ke)}}return this.i=m.join("&")};function sc(m){const C=new Zs;return C.i=m.i,m.g&&(C.g=new Map(m.g),C.h=m.h),C}function as(m,C){return C=String(C),m.j&&(C=C.toLowerCase()),C}function t0(m,C){C&&!m.j&&(Or(m),m.i=null,m.g.forEach(function(N,B){const ie=B.toLowerCase();B!=ie&&(Dl(this,B),rc(this,ie,N))},m)),m.j=C}function pf(m,C){const N=new Je;if(o.Image){const B=new Image;B.onload=f(Is,N,"TestLoadImage: loaded",!0,C,B),B.onerror=f(Is,N,"TestLoadImage: error",!1,C,B),B.onabort=f(Is,N,"TestLoadImage: abort",!1,C,B),B.ontimeout=f(Is,N,"TestLoadImage: timeout",!1,C,B),o.setTimeout(function(){B.ontimeout&&B.ontimeout()},1e4),B.src=m}else C(!1)}function Qt(m,C){const N=new Je,B=new AbortController,ie=setTimeout(()=>{B.abort(),Is(N,"TestPingServer: timeout",!1,C)},1e4);fetch(m,{signal:B.signal}).then(ue=>{clearTimeout(ie),ue.ok?Is(N,"TestPingServer: ok",!0,C):Is(N,"TestPingServer: server error",!1,C)}).catch(()=>{clearTimeout(ie),Is(N,"TestPingServer: error",!1,C)})}function Is(m,C,N,B,ie){try{ie&&(ie.onload=null,ie.onerror=null,ie.onabort=null,ie.ontimeout=null),B(N)}catch{}}function mf(){this.g=new Re}function oc(m){this.i=m.Sb||null,this.h=m.ab||!1}d(oc,Gt),oc.prototype.g=function(){return new ac(this.i,this.h)};function ac(m,C){z.call(this),this.H=m,this.o=C,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}d(ac,z),n=ac.prototype,n.open=function(m,C){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=m,this.D=C,this.readyState=1,Ao(this)},n.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const C={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};m&&(C.body=m),(this.H||o).fetch(new Request(this.D,C)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Mn(this)),this.readyState=0},n.Pa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,Ao(this)),this.g&&(this.readyState=3,Ao(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;lm(this)}else m.text().then(this.Oa.bind(this),this.ga.bind(this))};function lm(m){m.j.read().then(m.Ma.bind(m)).catch(m.ga.bind(m))}n.Ma=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var C=m.value?m.value:new Uint8Array(0);(C=this.B.decode(C,{stream:!m.done}))&&(this.response=this.responseText+=C)}m.done?Mn(this):Ao(this),this.readyState==3&&lm(this)}},n.Oa=function(m){this.g&&(this.response=this.responseText=m,Mn(this))},n.Na=function(m){this.g&&(this.response=m,Mn(this))},n.ga=function(){this.g&&Mn(this)};function Mn(m){m.readyState=4,m.l=null,m.j=null,m.B=null,Ao(m)}n.setRequestHeader=function(m,C){this.A.append(m,C)},n.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],C=this.h.entries();for(var N=C.next();!N.done;)N=N.value,m.push(N[0]+": "+N[1]),N=C.next();return m.join(`\r
`)};function Ao(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(ac.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function um(m){let C="";return K(m,function(N,B){C+=B,C+=":",C+=N,C+=`\r
`}),C}function kl(m,C,N){e:{for(B in N){var B=!1;break e}B=!0}B||(N=um(N),typeof m=="string"?N!=null&&ss(N):Pt(m,C,N))}function An(m){z.call(this),this.headers=new Map,this.L=m||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}d(An,z);var lc=/^https?$/i,ls=["POST","PUT"];n=An.prototype,n.Fa=function(m){this.H=m},n.ea=function(m,C,N,B){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);C=C?C.toUpperCase():"GET",this.D=m,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():fa.g(),this.g.onreadystatechange=p(h(this.Ca,this));try{this.B=!0,this.g.open(C,String(m),!0),this.B=!1}catch(ue){cm(this,ue);return}if(m=N||"",N=new Map(this.headers),B)if(Object.getPrototypeOf(B)===Object.prototype)for(var ie in B)N.set(ie,B[ie]);else if(typeof B.keys=="function"&&typeof B.get=="function")for(const ue of B.keys())N.set(ue,B.get(ue));else throw Error("Unknown input type for opt_headers: "+String(B));B=Array.from(N.keys()).find(ue=>ue.toLowerCase()=="content-type"),ie=o.FormData&&m instanceof o.FormData,!(Array.prototype.indexOf.call(ls,C,void 0)>=0)||B||ie||N.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ue,ke]of N)this.g.setRequestHeader(ue,ke);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(m),this.v=!1}catch(ue){cm(this,ue)}};function cm(m,C){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=C,m.o=5,hm(m),wr(m)}function hm(m){m.A||(m.A=!0,U(m,"complete"),U(m,"error"))}n.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=m||7,U(this,"complete"),U(this,"abort"),wr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),wr(this,!0)),An.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Ur(this):this.Xa())},n.Xa=function(){Ur(this)};function Ur(m){if(m.h&&typeof s<"u"){if(m.v&&Fr(m)==4)setTimeout(m.Ca.bind(m),0);else if(U(m,"readystatechange"),Fr(m)==4){m.h=!1;try{const ue=m.ca();e:switch(ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var C=!0;break e;default:C=!1}var N;if(!(N=C)){var B;if(B=ue===0){let ke=String(m.D).match(et)[1]||null;!ke&&o.self&&o.self.location&&(ke=o.self.location.protocol.slice(0,-1)),B=!lc.test(ke?ke.toLowerCase():"")}N=B}if(N)U(m,"complete"),U(m,"success");else{m.o=6;try{var ie=Fr(m)>2?m.g.statusText:""}catch{ie=""}m.l=ie+" ["+m.ca()+"]",hm(m)}}finally{wr(m)}}}}function wr(m,C){if(m.g){m.m&&(clearTimeout(m.m),m.m=null);const N=m.g;m.g=null,C||U(m,"ready");try{N.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Fr(m){return m.g?m.g.readyState:0}n.ca=function(){try{return Fr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(m){if(this.g){var C=this.g.responseText;return m&&C.indexOf(m)==0&&(C=C.substring(m.length)),Rt(C)}};function uc(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.F){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function fm(m){const C={};m=(m.g&&Fr(m)>=2&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let B=0;B<m.length;B++){if(F(m[B]))continue;var N=Js(m[B]);const ie=N[0];if(N=N[1],typeof N!="string")continue;N=N.trim();const ue=C[ie]||[];C[ie]=ue,ue.push(N)}Q(C,function(B){return B.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ol(m,C,N){return N&&N.internalChannelParams&&N.internalChannelParams[m]||C}function Vr(m){this.za=0,this.i=[],this.j=new Je,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ol("failFast",!1,m),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ol("baseRetryDelayMs",5e3,m),this.Za=Ol("retryDelaySeedMs",1e4,m),this.Ta=Ol("forwardChannelMaxRetries",2,m),this.va=Ol("forwardChannelRequestTimeoutMs",2e4,m),this.ma=m&&m.xmlHttpFactory||void 0,this.Ua=m&&m.Rb||void 0,this.Aa=m&&m.useFetchStreams||!1,this.O=void 0,this.L=m&&m.supportsCrossDomainXhr||!1,this.M="",this.h=new Et(m&&m.concurrentRequestLimit),this.Ba=new mf,this.S=m&&m.fastHandshake||!1,this.R=m&&m.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=m&&m.Pb||!1,m&&m.ua&&this.j.ua(),m&&m.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&m&&m.detectBufferingProxy||!1,this.ia=void 0,m&&m.longPollingTimeout&&m.longPollingTimeout>0&&(this.ia=m.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Vr.prototype,n.ka=8,n.I=1,n.connect=function(m,C,N,B){Me(0),this.W=m,this.H=C||{},N&&B!==void 0&&(this.H.OSID=N,this.H.OAID=B),this.F=this.X,this.J=_f(this,null,this.W),Ui(this)};function gf(m){if(dm(m),m.I==3){var C=m.V++,N=tn(m.J);if(Pt(N,"SID",m.M),Pt(N,"RID",C),Pt(N,"TYPE","terminate"),us(m,N),C=new sr(m,m.j,C),C.M=2,C.A=or(tn(N)),N=!1,o.navigator&&o.navigator.sendBeacon)try{N=o.navigator.sendBeacon(C.A.toString(),"")}catch{}!N&&o.Image&&(new Image().src=C.A,N=!0),N||(C.g=cs(C.j,null),C.g.ea(C.A)),C.F=Date.now(),he(C)}mc(m)}function Co(m){m.g&&(Fl(m),m.g.cancel(),m.g=null)}function dm(m){Co(m),m.v&&(o.clearTimeout(m.v),m.v=null),Ps(m),m.h.cancel(),m.m&&(typeof m.m=="number"&&o.clearTimeout(m.m),m.m=null)}function Ui(m){if(!At(m.h)&&!m.m){m.m=!0;var C=m.Ea;O||b(),D||(O(),D=!0),R.add(C,m),m.D=0}}function cc(m,C){return _n(m.h)>=m.h.j-(m.m?1:0)?!1:m.m?(m.i=C.G.concat(m.i),!0):m.I==1||m.I==2||m.D>=(m.Sa?0:m.Ta)?!1:(m.m=Qe(h(m.Ea,m,C),zr(m,m.D)),m.D++,!0)}n.Ea=function(m){if(this.m)if(this.m=null,this.I==1){if(!m){this.V=Math.floor(Math.random()*1e5),m=this.V++;const ie=new sr(this,this.j,m);let ue=this.o;if(this.U&&(ue?(ue=ee(ue),Ne(ue,this.U)):ue=this.U),this.u!==null||this.R||(ie.J=ue,ue=null),this.S)e:{for(var C=0,N=0;N<this.i.length;N++){t:{var B=this.i[N];if("__data__"in B.map&&(B=B.map.__data__,typeof B=="string")){B=B.length;break t}B=void 0}if(B===void 0)break;if(C+=B,C>4096){C=N;break e}if(C===4096||N===this.i.length-1){C=N+1;break e}}C=1e3}else C=1e3;C=hc(this,ie,C),N=tn(this.J),Pt(N,"RID",m),Pt(N,"CVER",22),this.G&&Pt(N,"X-HTTP-Session-Id",this.G),us(this,N),ue&&(this.R?C="headers="+ss(um(ue))+"&"+C:this.u&&kl(N,this.u,ue)),fn(this.h,ie),this.Ra&&Pt(N,"TYPE","init"),this.S?(Pt(N,"$req",C),Pt(N,"SID","null"),ie.U=!0,Nl(ie,N,null)):Nl(ie,N,C),this.I=2}}else this.I==3&&(m?Ul(this,m):this.i.length==0||At(this.h)||Ul(this))};function Ul(m,C){var N;C?N=C.l:N=m.V++;const B=tn(m.J);Pt(B,"SID",m.M),Pt(B,"RID",N),Pt(B,"AID",m.K),us(m,B),m.u&&m.o&&kl(B,m.u,m.o),N=new sr(m,m.j,N,m.D+1),m.u===null&&(N.J=m.o),C&&(m.i=C.G.concat(m.i)),C=hc(m,N,1e3),N.H=Math.round(m.va*.5)+Math.round(m.va*.5*Math.random()),fn(m.h,N),Nl(N,B,C)}function us(m,C){m.H&&K(m.H,function(N,B){Pt(C,B,N)}),m.l&&K({},function(N,B){Pt(C,B,N)})}function hc(m,C,N){N=Math.min(m.i.length,N);const B=m.l?h(m.l.Ka,m.l,m):null;e:{var ie=m.i;let bt=-1;for(;;){const Cn=["count="+N];bt==-1?N>0?(bt=ie[0].g,Cn.push("ofs="+bt)):bt=0:Cn.push("ofs="+bt);let sn=!0;for(let un=0;un<N;un++){var ue=ie[un].g;const Nn=ie[un].map;if(ue-=bt,ue<0)bt=Math.max(0,ie[un].g-100),sn=!1;else try{ue="req"+ue+"_"||"";try{var ke=Nn instanceof Map?Nn:Object.entries(Nn);for(const[lr,xi]of ke){let Si=xi;a(xi)&&(Si=ct(xi)),Cn.push(ue+lr+"="+encodeURIComponent(Si))}}catch(lr){throw Cn.push(ue+"type="+encodeURIComponent("_badmap")),lr}}catch{B&&B(Nn)}}if(sn){ke=Cn.join("&");break e}}ke=void 0}return m=m.i.splice(0,N),C.G=m,ke}function fc(m){if(!m.g&&!m.v){m.Y=1;var C=m.Da;O||b(),D||(O(),D=!0),R.add(C,m),m.A=0}}function dc(m){return m.g||m.v||m.A>=3?!1:(m.Y++,m.v=Qe(h(m.Da,m),zr(m,m.A)),m.A++,!0)}n.Da=function(){if(this.v=null,pc(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var m=4*this.T;this.j.info("BP detection timer enabled: "+m),this.B=Qe(h(this.Wa,this),m)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Me(10),Co(this),pc(this))};function Fl(m){m.B!=null&&(o.clearTimeout(m.B),m.B=null)}function pc(m){m.g=new sr(m,m.j,"rpc",m.Y),m.u===null&&(m.g.J=m.o),m.g.P=0;var C=tn(m.na);Pt(C,"RID","rpc"),Pt(C,"SID",m.M),Pt(C,"AID",m.K),Pt(C,"CI",m.F?"0":"1"),!m.F&&m.ia&&Pt(C,"TO",m.ia),Pt(C,"TYPE","xmlhttp"),us(m,C),m.u&&m.o&&kl(C,m.u,m.o),m.O&&(m.g.H=m.O);var N=m.g;m=m.ba,N.M=1,N.A=or(tn(C)),N.u=null,N.R=!0,tc(N,m)}n.Va=function(){this.C!=null&&(this.C=null,Co(this),dc(this),Me(19))};function Ps(m){m.C!=null&&(o.clearTimeout(m.C),m.C=null)}function ar(m,C){var N=null;if(m.g==C){Ps(m),Fl(m),m.g=null;var B=2}else if(Yn(m.h,C))N=C.G,$n(m.h,C),B=1;else return;if(m.I!=0){if(C.o)if(B==1){N=C.u?C.u.length:0,C=Date.now()-C.F;var ie=m.D;B=Ve(),U(B,new De(B,N)),Ui(m)}else fc(m);else if(ie=C.m,ie==3||ie==0&&C.X>0||!(B==1&&cc(m,C)||B==2&&dc(m)))switch(N&&N.length>0&&(C=m.h,C.i=C.i.concat(N)),ie){case 1:Fi(m,5);break;case 4:Fi(m,10);break;case 3:Fi(m,6);break;default:Fi(m,2)}}}function zr(m,C){let N=m.Qa+Math.floor(Math.random()*m.Za);return m.isActive()||(N*=2),N*C}function Fi(m,C){if(m.j.info("Error code "+C),C==2){var N=h(m.bb,m),B=m.Ua;const ie=!B;B=new Ct(B||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ki(B,"https"),or(B),ie?pf(B.toString(),N):Qt(B.toString(),N)}else Me(2);m.I=0,m.l&&m.l.pa(C),mc(m),dm(m)}n.bb=function(m){m?(this.j.info("Successfully pinged google.com"),Me(2)):(this.j.info("Failed to ping google.com"),Me(1))};function mc(m){if(m.I=0,m.ja=[],m.l){const C=yt(m.h);(C.length!=0||m.i.length!=0)&&(v(m.ja,C),v(m.ja,m.i),m.h.i.length=0,_(m.i),m.i.length=0),m.l.oa()}}function _f(m,C,N){var B=N instanceof Ct?tn(N):new Ct(N);if(B.g!="")C&&(B.g=C+"."+B.g),vi(B,B.u);else{var ie=o.location;B=ie.protocol,C=C?C+"."+ie.hostname:ie.hostname,ie=+ie.port;const ue=new Ct(null);B&&ki(ue,B),C&&(ue.g=C),ie&&vi(ue,ie),N&&(ue.h=N),B=ue}return N=m.G,C=m.wa,N&&C&&Pt(B,N,C),Pt(B,"VER",m.ka),us(m,B),B}function cs(m,C,N){if(C&&!m.L)throw Error("Can't create secondary domain capable XhrIo object.");return C=m.Aa&&!m.ma?new An(new oc({ab:N})):new An(m.ma),C.Fa(m.L),C}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function bs(){}n=bs.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ro(){}Ro.prototype.g=function(m,C){return new Vi(m,C)};function Vi(m,C){z.call(this),this.g=new Vr(C),this.l=m,this.h=C&&C.messageUrlParams||null,m=C&&C.messageHeaders||null,C&&C.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=C&&C.initMessageHeaders||null,C&&C.messageContentType&&(m?m["X-WebChannel-Content-Type"]=C.messageContentType:m={"X-WebChannel-Content-Type":C.messageContentType}),C&&C.sa&&(m?m["X-WebChannel-Client-Profile"]=C.sa:m={"X-WebChannel-Client-Profile":C.sa}),this.g.U=m,(m=C&&C.Qb)&&!F(m)&&(this.g.u=m),this.A=C&&C.supportsCrossDomainXhr||!1,this.v=C&&C.sendRawJson||!1,(C=C&&C.httpSessionIdParam)&&!F(C)&&(this.g.G=C,m=this.h,m!==null&&C in m&&(m=this.h,C in m&&delete m[C])),this.j=new Io(this)}d(Vi,z),Vi.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Vi.prototype.close=function(){gf(this.g)},Vi.prototype.o=function(m){var C=this.g;if(typeof m=="string"){var N={};N.__data__=m,m=N}else this.v&&(N={},N.__data__=ct(m),m=N);C.i.push(new It(C.Ya++,m)),C.I==3&&Ui(C)},Vi.prototype.N=function(){this.g.l=null,delete this.j,gf(this.g),delete this.g,Vi.Z.N.call(this)};function Vl(m){ut.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var C=m.__sm__;if(C){e:{for(const N in C){m=N;break e}m=void 0}(this.i=m)&&(m=this.i,C=C!==null&&m in C?C[m]:void 0),this.data=C}else this.data=m}d(Vl,ut);function yf(){$e.call(this),this.status=1}d(yf,$e);function Io(m){this.g=m}d(Io,bs),Io.prototype.ra=function(){U(this.g,"a")},Io.prototype.qa=function(m){U(this.g,new Vl(m))},Io.prototype.pa=function(m){U(this.g,new yf)},Io.prototype.oa=function(){U(this.g,"b")},Ro.prototype.createWebChannel=Ro.prototype.g,Vi.prototype.send=Vi.prototype.o,Vi.prototype.open=Vi.prototype.m,Vi.prototype.close=Vi.prototype.close,LN=function(){return new Ro},bN=function(){return Ve()},PN=$,TE={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Bn.NO_ERROR=0,Bn.TIMEOUT=8,Bn.HTTP_ERROR=6,R_=Bn,rr.COMPLETE="complete",IN=rr,Nt.EventType=gt,gt.OPEN="a",gt.CLOSE="b",gt.ERROR="c",gt.MESSAGE="d",z.prototype.listen=z.prototype.J,hd=Nt,An.prototype.listenOnce=An.prototype.K,An.prototype.getLastError=An.prototype.Ha,An.prototype.getLastErrorCode=An.prototype.ya,An.prototype.getStatus=An.prototype.ca,An.prototype.getResponseJson=An.prototype.La,An.prototype.getResponseText=An.prototype.la,An.prototype.send=An.prototype.ea,An.prototype.setWithCredentials=An.prototype.Fa,RN=An}).apply(typeof hg<"u"?hg:typeof self<"u"?self:typeof window<"u"?window:{});const TR="@firebase/firestore",MR="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ki=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ki.UNAUTHENTICATED=new Ki(null),Ki.GOOGLE_CREDENTIALS=new Ki("google-credentials-uid"),Ki.FIRST_PARTY=new Ki("first-party-uid"),Ki.MOCK_USER=new Ki("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nf="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bu=new R1("@firebase/firestore");function Yc(){return Bu.logLevel}function tt(n,...e){if(Bu.logLevel<=Xt.DEBUG){const t=e.map(B1);Bu.debug(`Firestore (${nf}): ${n}`,...t)}}function ia(n,...e){if(Bu.logLevel<=Xt.ERROR){const t=e.map(B1);Bu.error(`Firestore (${nf}): ${n}`,...t)}}function Vh(n,...e){if(Bu.logLevel<=Xt.WARN){const t=e.map(B1);Bu.warn(`Firestore (${nf}): ${n}`,...t)}}function B1(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tt(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,NN(n,i,t)}function NN(n,e,t){let i=`FIRESTORE (${nf}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw ia(i),new Error(i)}function hn(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||NN(e,r,i)}function Dt(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Xe extends ua{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DN{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class q5{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ki.UNAUTHENTICATED))}shutdown(){}}class X5{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Y5{constructor(e){this.t=e,this.currentUser=Ki.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){hn(this.o===void 0,42304);let i=this.i;const r=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve();let s=new el;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new el,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},a=l=>{tt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(tt("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new el)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(tt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(hn(typeof i.accessToken=="string",31837,{l:i}),new DN(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return hn(e===null||typeof e=="string",2055,{h:e}),new Ki(e)}}class $5{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Ki.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class K5{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new $5(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Ki.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class AR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Q5{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Yr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){hn(this.o===void 0,3512);const i=s=>{s.error!=null&&tt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,tt("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};const r=s=>{tt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?r(s):tt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new AR(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(hn(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new AR(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J5(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=J5(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%62))}return i}}function Yt(n,e){return n<e?-1:n>e?1:0}function ME(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),s=e.charAt(i);if(r!==s)return Mx(r)===Mx(s)?Yt(r,s):Mx(r)?1:-1}return Yt(n.length,e.length)}const Z5=55296,e6=57343;function Mx(n){const e=n.charCodeAt(0);return e>=Z5&&e<=e6}function zh(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CR="__name__";class oo{constructor(e,t,i){t===void 0?t=0:t>e.length&&Tt(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Tt(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return oo.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof oo?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=oo.compareSegments(e.get(r),t.get(r));if(s!==0)return s}return Yt(e.length,t.length)}static compareSegments(e,t){const i=oo.isNumericId(e),r=oo.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?oo.extractNumericId(e).compare(oo.extractNumericId(t)):ME(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Za.fromString(e.substring(4,e.length-2))}}class xn extends oo{construct(e,t,i){return new xn(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Xe(Se.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new xn(t)}static emptyPath(){return new xn([])}}const t6=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bi extends oo{construct(e,t,i){return new bi(e,t,i)}static isValidIdentifier(e){return t6.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bi.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===CR}static keyField(){return new bi([CR])}static fromServerFormat(e){const t=[];let i="",r=0;const s=()=>{if(i.length===0)throw new Xe(Se.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new Xe(Se.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Xe(Se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new Xe(Se.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new bi(t)}static emptyPath(){return new bi([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e){this.path=e}static fromPath(e){return new pt(xn.fromString(e))}static fromName(e){return new pt(xn.fromString(e).popFirst(5))}static empty(){return new pt(xn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&xn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return xn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new pt(new xn(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kN(n,e,t){if(!t)throw new Xe(Se.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function n6(n,e,t,i){if(e===!0&&i===!0)throw new Xe(Se.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function RR(n){if(!pt.isDocumentKey(n))throw new Xe(Se.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function IR(n){if(pt.isDocumentKey(n))throw new Xe(Se.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ON(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function av(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Tt(12329,{type:typeof n})}function Ts(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Xe(Se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=av(n);throw new Xe(Se.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function li(n,e){const t={typeString:n};return e&&(t.value=e),t}function Bp(n,e){if(!ON(n))throw new Xe(Se.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,s="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const o=n[i];if(r&&typeof o!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${i}' field to equal '${s.value}'`;break}}if(t)throw new Xe(Se.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PR=-62135596800,bR=1e6;class wn{static now(){return wn.fromMillis(Date.now())}static fromDate(e){return wn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*bR);return new wn(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Xe(Se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Xe(Se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<PR)throw new Xe(Se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Xe(Se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/bR}_compareTo(e){return this.seconds===e.seconds?Yt(this.nanoseconds,e.nanoseconds):Yt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:wn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Bp(e,wn._jsonSchema))return new wn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-PR;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}wn._jsonSchemaVersion="firestore/timestamp/1.0",wn._jsonSchema={type:li("string",wn._jsonSchemaVersion),seconds:li("number"),nanoseconds:li("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{static fromTimestamp(e){return new Lt(e)}static min(){return new Lt(new wn(0,0))}static max(){return new Lt(new wn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tp=-1;function i6(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Lt.fromTimestamp(i===1e9?new wn(t+1,0):new wn(t,i));return new ll(r,pt.empty(),e)}function r6(n){return new ll(n.readTime,n.key,tp)}class ll{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new ll(Lt.min(),pt.empty(),tp)}static max(){return new ll(Lt.max(),pt.empty(),tp)}}function s6(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=pt.comparator(n.documentKey,e.documentKey),t!==0?t:Yt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class a6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rf(n){if(n.code!==Se.FAILED_PRECONDITION||n.message!==o6)throw n;tt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Tt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Te((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Te?t:Te.resolve(t)}catch(t){return Te.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Te.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Te.reject(t)}static resolve(e){return new Te((t,i)=>{t(e)})}static reject(e){return new Te((t,i)=>{i(e)})}static waitFor(e){return new Te((t,i)=>{let r=0,s=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&t()},l=>i(l))}),o=!0,s===r&&t()})}static or(e){let t=Te.resolve(!1);for(const i of e)t=t.next(r=>r?Te.resolve(r):i());return t}static forEach(e,t){const i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new Te((i,r)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const h=l;t(e[h]).next(f=>{o[h]=f,++a,a===s&&i(o)},f=>r(f))}})}static doWhile(e,t){return new Te((i,r)=>{const s=()=>{e()===!0?t().next(()=>{s()},r):i()};s()})}}function l6(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function sf(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lv{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}lv.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G1=-1;function uv(n){return n==null}function xy(n){return n===0&&1/n==-1/0}function u6(n){return typeof n=="number"&&Number.isInteger(n)&&!xy(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UN="";function c6(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=LR(e)),e=h6(n.get(t),e);return LR(e)}function h6(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const s=n.charAt(r);switch(s){case"\0":t+="";break;case UN:t+="";break;default:t+=s}}return t}function LR(n){return n+UN+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NR(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function wl(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function FN(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e,t){this.comparator=e,this.root=t||Pi.EMPTY}insert(e,t){return new zn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Pi.BLACK,null,null))}remove(e){return new zn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Pi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fg(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fg(this.root,e,this.comparator,!1)}getReverseIterator(){return new fg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fg(this.root,e,this.comparator,!0)}}class fg{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Pi{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??Pi.RED,this.left=r??Pi.EMPTY,this.right=s??Pi.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new Pi(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Pi.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Pi.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Pi.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Pi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Tt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Tt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Tt(27949);return e+(this.isRed()?0:1)}}Pi.EMPTY=null,Pi.RED=!0,Pi.BLACK=!1;Pi.EMPTY=new class{constructor(){this.size=0}get key(){throw Tt(57766)}get value(){throw Tt(16141)}get color(){throw Tt(16727)}get left(){throw Tt(29726)}get right(){throw Tt(36894)}copy(e,t,i,r,s){return this}insert(e,t,i){return new Pi(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e){this.comparator=e,this.data=new zn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new DR(this.data.getIterator())}getIteratorFrom(e){return new DR(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof mi)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new mi(this.comparator);return t.data=e,t}}class DR{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr{constructor(e){this.fields=e,e.sort(bi.comparator)}static empty(){return new Jr([])}unionWith(e){let t=new mi(bi.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Jr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return zh(this.fields,e.fields,(t,i)=>t.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VN extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new VN("Invalid base64 string: "+s):s}}(e);return new Di(t)}static fromUint8Array(e){const t=function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s}(e);return new Di(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Yt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Di.EMPTY_BYTE_STRING=new Di("");const f6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ul(n){if(hn(!!n,39018),typeof n=="string"){let e=0;const t=f6.exec(n);if(hn(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Jn(n.seconds),nanos:Jn(n.nanos)}}function Jn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function cl(n){return typeof n=="string"?Di.fromBase64String(n):Di.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zN="server_timestamp",BN="__type__",HN="__previous_value__",GN="__local_write_time__";function W1(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[BN])==null?void 0:i.stringValue)===zN}function cv(n){const e=n.mapValue.fields[HN];return W1(e)?cv(e):e}function np(n){const e=ul(n.mapValue.fields[GN].timestampValue);return new wn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d6{constructor(e,t,i,r,s,o,a,l,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=h,this.isUsingEmulator=f}}const Sy="(default)";class ip{constructor(e,t){this.projectId=e,this.database=t||Sy}static empty(){return new ip("","")}get isDefaultDatabase(){return this.database===Sy}isEqual(e){return e instanceof ip&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WN="__type__",p6="__max__",dg={mapValue:{}},jN="__vector__",Ey="value";function hl(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?W1(n)?4:g6(n)?9007199254740991:m6(n)?10:11:Tt(28295,{value:n})}function Eo(n,e){if(n===e)return!0;const t=hl(n);if(t!==hl(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return np(n).isEqual(np(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=ul(r.timestampValue),a=ul(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,s){return cl(r.bytesValue).isEqual(cl(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,s){return Jn(r.geoPointValue.latitude)===Jn(s.geoPointValue.latitude)&&Jn(r.geoPointValue.longitude)===Jn(s.geoPointValue.longitude)}(n,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return Jn(r.integerValue)===Jn(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=Jn(r.doubleValue),a=Jn(s.doubleValue);return o===a?xy(o)===xy(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return zh(n.arrayValue.values||[],e.arrayValue.values||[],Eo);case 10:case 11:return function(r,s){const o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(NR(o)!==NR(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Eo(o[l],a[l])))return!1;return!0}(n,e);default:return Tt(52216,{left:n})}}function rp(n,e){return(n.values||[]).find(t=>Eo(t,e))!==void 0}function Bh(n,e){if(n===e)return 0;const t=hl(n),i=hl(e);if(t!==i)return Yt(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Yt(n.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Jn(s.integerValue||s.doubleValue),l=Jn(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return kR(n.timestampValue,e.timestampValue);case 4:return kR(np(n),np(e));case 5:return ME(n.stringValue,e.stringValue);case 6:return function(s,o){const a=cl(s),l=cl(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let h=0;h<a.length&&h<l.length;h++){const f=Yt(a[h],l[h]);if(f!==0)return f}return Yt(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Yt(Jn(s.latitude),Jn(o.latitude));return a!==0?a:Yt(Jn(s.longitude),Jn(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return OR(n.arrayValue,e.arrayValue);case 10:return function(s,o){var p,_,v,T;const a=s.fields||{},l=o.fields||{},h=(p=a[Ey])==null?void 0:p.arrayValue,f=(_=l[Ey])==null?void 0:_.arrayValue,d=Yt(((v=h==null?void 0:h.values)==null?void 0:v.length)||0,((T=f==null?void 0:f.values)==null?void 0:T.length)||0);return d!==0?d:OR(h,f)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===dg.mapValue&&o===dg.mapValue)return 0;if(s===dg.mapValue)return 1;if(o===dg.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),h=o.fields||{},f=Object.keys(h);l.sort(),f.sort();for(let d=0;d<l.length&&d<f.length;++d){const p=ME(l[d],f[d]);if(p!==0)return p;const _=Bh(a[l[d]],h[f[d]]);if(_!==0)return _}return Yt(l.length,f.length)}(n.mapValue,e.mapValue);default:throw Tt(23264,{he:t})}}function kR(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Yt(n,e);const t=ul(n),i=ul(e),r=Yt(t.seconds,i.seconds);return r!==0?r:Yt(t.nanos,i.nanos)}function OR(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const s=Bh(t[r],i[r]);if(s)return s}return Yt(t.length,i.length)}function Hh(n){return AE(n)}function AE(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const i=ul(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return cl(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return pt.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",r=!0;for(const s of t.values||[])r?r=!1:i+=",",i+=AE(s);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){const i=Object.keys(t.fields||{}).sort();let r="{",s=!0;for(const o of i)s?s=!1:r+=",",r+=`${o}:${AE(t.fields[o])}`;return r+"}"}(n.mapValue):Tt(61005,{value:n})}function I_(n){switch(hl(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=cv(n);return e?16+I_(e):16;case 5:return 2*n.stringValue.length;case 6:return cl(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((r,s)=>r+I_(s),0)}(n.arrayValue);case 10:case 11:return function(i){let r=0;return wl(i.fields,(s,o)=>{r+=s.length+I_(o)}),r}(n.mapValue);default:throw Tt(13486,{value:n})}}function UR(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function CE(n){return!!n&&"integerValue"in n}function j1(n){return!!n&&"arrayValue"in n}function FR(n){return!!n&&"nullValue"in n}function VR(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function P_(n){return!!n&&"mapValue"in n}function m6(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[WN])==null?void 0:i.stringValue)===jN}function Cd(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return wl(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Cd(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Cd(n.arrayValue.values[t]);return e}return{...n}}function g6(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===p6}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this.value=e}static empty(){return new Pr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!P_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Cd(t)}setAll(e){let t=bi.emptyPath(),i={},r=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,i,r),i={},r=[],t=a.popLast()}o?i[a.lastSegment()]=Cd(o):r.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){const t=this.field(e.popLast());P_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Eo(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];P_(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){wl(t,(r,s)=>e[r]=s);for(const r of i)delete e[r]}clone(){return new Pr(Cd(this.value))}}function qN(n){const e=[];return wl(n.fields,(t,i)=>{const r=new bi([t]);if(P_(i)){const s=qN(i.mapValue).fields;if(s.length===0)e.push(r);else for(const o of s)e.push(r.child(o))}else e.push(r)}),new Jr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(e,t,i,r,s,o,a){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ji(e,0,Lt.min(),Lt.min(),Lt.min(),Pr.empty(),0)}static newFoundDocument(e,t,i,r){return new Ji(e,1,t,Lt.min(),i,r,0)}static newNoDocument(e,t){return new Ji(e,2,t,Lt.min(),Lt.min(),Pr.empty(),0)}static newUnknownDocument(e,t){return new Ji(e,3,t,Lt.min(),Lt.min(),Pr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Lt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Lt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ji&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ji(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(e,t){this.position=e,this.inclusive=t}}function zR(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const s=e[r],o=n.position[r];if(s.field.isKeyField()?i=pt.comparator(pt.fromName(o.referenceValue),t.key):i=Bh(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function BR(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Eo(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(e,t="asc"){this.field=e,this.dir=t}}function _6(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XN{}class ai extends XN{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new v6(e,t,i):t==="array-contains"?new E6(e,i):t==="in"?new w6(e,i):t==="not-in"?new T6(e,i):t==="array-contains-any"?new M6(e,i):new ai(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new x6(e,i):new S6(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Bh(t,this.value)):t!==null&&hl(this.value)===hl(t)&&this.matchesComparison(Bh(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Tt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ys extends XN{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ys(e,t)}matches(e){return YN(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function YN(n){return n.op==="and"}function $N(n){return y6(n)&&YN(n)}function y6(n){for(const e of n.filters)if(e instanceof Ys)return!1;return!0}function RE(n){if(n instanceof ai)return n.field.canonicalString()+n.op.toString()+Hh(n.value);if($N(n))return n.filters.map(e=>RE(e)).join(",");{const e=n.filters.map(t=>RE(t)).join(",");return`${n.op}(${e})`}}function KN(n,e){return n instanceof ai?function(i,r){return r instanceof ai&&i.op===r.op&&i.field.isEqual(r.field)&&Eo(i.value,r.value)}(n,e):n instanceof Ys?function(i,r){return r instanceof Ys&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((s,o,a)=>s&&KN(o,r.filters[a]),!0):!1}(n,e):void Tt(19439)}function QN(n){return n instanceof ai?function(t){return`${t.field.canonicalString()} ${t.op} ${Hh(t.value)}`}(n):n instanceof Ys?function(t){return t.op.toString()+" {"+t.getFilters().map(QN).join(" ,")+"}"}(n):"Filter"}class v6 extends ai{constructor(e,t,i){super(e,t,i),this.key=pt.fromName(i.referenceValue)}matches(e){const t=pt.comparator(e.key,this.key);return this.matchesComparison(t)}}class x6 extends ai{constructor(e,t){super(e,"in",t),this.keys=JN("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class S6 extends ai{constructor(e,t){super(e,"not-in",t),this.keys=JN("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function JN(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map(i=>pt.fromName(i.referenceValue))}class E6 extends ai{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return j1(t)&&rp(t.arrayValue,this.value)}}class w6 extends ai{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&rp(this.value.arrayValue,t)}}class T6 extends ai{constructor(e,t){super(e,"not-in",t)}matches(e){if(rp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!rp(this.value.arrayValue,t)}}class M6 extends ai{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!j1(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>rp(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6{constructor(e,t=null,i=[],r=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}}function HR(n,e=null,t=[],i=[],r=null,s=null,o=null){return new A6(n,e,t,i,r,s,o)}function q1(n){const e=Dt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>RE(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),uv(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>Hh(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>Hh(i)).join(",")),e.Te=t}return e.Te}function X1(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!_6(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!KN(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!BR(n.startAt,e.startAt)&&BR(n.endAt,e.endAt)}function IE(n){return pt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class of{constructor(e,t=null,i=[],r=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function C6(n,e,t,i,r,s,o,a){return new of(n,e,t,i,r,s,o,a)}function hv(n){return new of(n)}function GR(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function ZN(n){return n.collectionGroup!==null}function Rd(n){const e=Dt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new mi(bi.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(h=>{h.isInequality()&&(a=a.add(h.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new sp(s,i))}),t.has(bi.keyField().canonicalString())||e.Ie.push(new sp(bi.keyField(),i))}return e.Ie}function mo(n){const e=Dt(n);return e.Ee||(e.Ee=R6(e,Rd(n))),e.Ee}function R6(n,e){if(n.limitType==="F")return HR(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{const s=r.dir==="desc"?"asc":"desc";return new sp(r.field,s)});const t=n.endAt?new wy(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new wy(n.startAt.position,n.startAt.inclusive):null;return HR(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function PE(n,e){const t=n.filters.concat([e]);return new of(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Ty(n,e,t){return new of(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function fv(n,e){return X1(mo(n),mo(e))&&n.limitType===e.limitType}function eD(n){return`${q1(mo(n))}|lt:${n.limitType}`}function $c(n){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(r=>QN(r)).join(", ")}]`),uv(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(r=>Hh(r)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(r=>Hh(r)).join(",")),`Target(${i})`}(mo(n))}; limitType=${n.limitType})`}function dv(n,e){return e.isFoundDocument()&&function(i,r){const s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):pt.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(n,e)&&function(i,r){for(const s of Rd(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(n,e)&&function(i,r){for(const s of i.filters)if(!s.matches(r))return!1;return!0}(n,e)&&function(i,r){return!(i.startAt&&!function(o,a,l){const h=zR(o,a,l);return o.inclusive?h<=0:h<0}(i.startAt,Rd(i),r)||i.endAt&&!function(o,a,l){const h=zR(o,a,l);return o.inclusive?h>=0:h>0}(i.endAt,Rd(i),r))}(n,e)}function I6(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function tD(n){return(e,t)=>{let i=!1;for(const r of Rd(n)){const s=P6(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function P6(n,e,t){const i=n.field.isKeyField()?pt.comparator(e.key,t.key):function(s,o,a){const l=o.data.field(s),h=a.data.field(s);return l!==null&&h!==null?Bh(l,h):Tt(42886)}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Tt(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){wl(this.inner,(t,i)=>{for(const[r,s]of i)e(r,s)})}isEmpty(){return FN(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b6=new zn(pt.comparator);function ra(){return b6}const nD=new zn(pt.comparator);function fd(...n){let e=nD;for(const t of n)e=e.insert(t.key,t);return e}function iD(n){let e=nD;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function _u(){return Id()}function rD(){return Id()}function Id(){return new Yu(n=>n.toString(),(n,e)=>n.isEqual(e))}const L6=new zn(pt.comparator),N6=new mi(pt.comparator);function $t(...n){let e=N6;for(const t of n)e=e.add(t);return e}const D6=new mi(Yt);function k6(){return D6}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y1(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xy(e)?"-0":e}}function sD(n){return{integerValue:""+n}}function O6(n,e){return u6(e)?sD(e):Y1(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv{constructor(){this._=void 0}}function U6(n,e,t){return n instanceof My?function(r,s){const o={fields:{[BN]:{stringValue:zN},[GN]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&W1(s)&&(s=cv(s)),s&&(o.fields[HN]=s),{mapValue:o}}(t,e):n instanceof op?aD(n,e):n instanceof ap?lD(n,e):function(r,s){const o=oD(r,s),a=WR(o)+WR(r.Ae);return CE(o)&&CE(r.Ae)?sD(a):Y1(r.serializer,a)}(n,e)}function F6(n,e,t){return n instanceof op?aD(n,e):n instanceof ap?lD(n,e):t}function oD(n,e){return n instanceof Ay?function(i){return CE(i)||function(s){return!!s&&"doubleValue"in s}(i)}(e)?e:{integerValue:0}:null}class My extends pv{}class op extends pv{constructor(e){super(),this.elements=e}}function aD(n,e){const t=uD(e);for(const i of n.elements)t.some(r=>Eo(r,i))||t.push(i);return{arrayValue:{values:t}}}class ap extends pv{constructor(e){super(),this.elements=e}}function lD(n,e){let t=uD(e);for(const i of n.elements)t=t.filter(r=>!Eo(r,i));return{arrayValue:{values:t}}}class Ay extends pv{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function WR(n){return Jn(n.integerValue||n.doubleValue)}function uD(n){return j1(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function V6(n,e){return n.field.isEqual(e.field)&&function(i,r){return i instanceof op&&r instanceof op||i instanceof ap&&r instanceof ap?zh(i.elements,r.elements,Eo):i instanceof Ay&&r instanceof Ay?Eo(i.Ae,r.Ae):i instanceof My&&r instanceof My}(n.transform,e.transform)}class z6{constructor(e,t){this.version=e,this.transformResults=t}}class Ms{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ms}static exists(e){return new Ms(void 0,e)}static updateTime(e){return new Ms(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function b_(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class mv{}function cD(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new $1(n.key,Ms.none()):new Hp(n.key,n.data,Ms.none());{const t=n.data,i=Pr.empty();let r=new mi(bi.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new Tl(n.key,i,new Jr(r.toArray()),Ms.none())}}function B6(n,e,t){n instanceof Hp?function(r,s,o){const a=r.value.clone(),l=qR(r.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Tl?function(r,s,o){if(!b_(r.precondition,s))return void s.convertToUnknownDocument(o.version);const a=qR(r.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(hD(r)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Pd(n,e,t,i){return n instanceof Hp?function(s,o,a,l){if(!b_(s.precondition,o))return a;const h=s.value.clone(),f=XR(s.fieldTransforms,l,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(n,e,t,i):n instanceof Tl?function(s,o,a,l){if(!b_(s.precondition,o))return a;const h=XR(s.fieldTransforms,l,o),f=o.data;return f.setAll(hD(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(n,e,t,i):function(s,o,a){return b_(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function H6(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),s=oD(i.transform,r||null);s!=null&&(t===null&&(t=Pr.empty()),t.set(i.field,s))}return t||null}function jR(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&zh(i,r,(s,o)=>V6(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Hp extends mv{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Tl extends mv{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function hD(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function qR(n,e,t){const i=new Map;hn(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const s=n[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,F6(o,a,t[r]))}return i}function XR(n,e,t){const i=new Map;for(const r of n){const s=r.transform,o=t.data.field(r.field);i.set(r.field,U6(s,o,e))}return i}class $1 extends mv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class G6 extends mv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W6{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&B6(s,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Pd(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Pd(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=rD();return this.mutations.forEach(r=>{const s=e.get(r.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(r.key)?null:a;const l=cD(o,a);l!==null&&i.set(r.key,l),o.isValidDocument()||o.convertToNoDocument(Lt.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),$t())}isEqual(e){return this.batchId===e.batchId&&zh(this.mutations,e.mutations,(t,i)=>jR(t,i))&&zh(this.baseMutations,e.baseMutations,(t,i)=>jR(t,i))}}class K1{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){hn(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=function(){return L6}();const s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new K1(e,t,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j6{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q6{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var si,Jt;function X6(n){switch(n){case Se.OK:return Tt(64938);case Se.CANCELLED:case Se.UNKNOWN:case Se.DEADLINE_EXCEEDED:case Se.RESOURCE_EXHAUSTED:case Se.INTERNAL:case Se.UNAVAILABLE:case Se.UNAUTHENTICATED:return!1;case Se.INVALID_ARGUMENT:case Se.NOT_FOUND:case Se.ALREADY_EXISTS:case Se.PERMISSION_DENIED:case Se.FAILED_PRECONDITION:case Se.ABORTED:case Se.OUT_OF_RANGE:case Se.UNIMPLEMENTED:case Se.DATA_LOSS:return!0;default:return Tt(15467,{code:n})}}function fD(n){if(n===void 0)return ia("GRPC error has no .code"),Se.UNKNOWN;switch(n){case si.OK:return Se.OK;case si.CANCELLED:return Se.CANCELLED;case si.UNKNOWN:return Se.UNKNOWN;case si.DEADLINE_EXCEEDED:return Se.DEADLINE_EXCEEDED;case si.RESOURCE_EXHAUSTED:return Se.RESOURCE_EXHAUSTED;case si.INTERNAL:return Se.INTERNAL;case si.UNAVAILABLE:return Se.UNAVAILABLE;case si.UNAUTHENTICATED:return Se.UNAUTHENTICATED;case si.INVALID_ARGUMENT:return Se.INVALID_ARGUMENT;case si.NOT_FOUND:return Se.NOT_FOUND;case si.ALREADY_EXISTS:return Se.ALREADY_EXISTS;case si.PERMISSION_DENIED:return Se.PERMISSION_DENIED;case si.FAILED_PRECONDITION:return Se.FAILED_PRECONDITION;case si.ABORTED:return Se.ABORTED;case si.OUT_OF_RANGE:return Se.OUT_OF_RANGE;case si.UNIMPLEMENTED:return Se.UNIMPLEMENTED;case si.DATA_LOSS:return Se.DATA_LOSS;default:return Tt(39323,{code:n})}}(Jt=si||(si={}))[Jt.OK=0]="OK",Jt[Jt.CANCELLED=1]="CANCELLED",Jt[Jt.UNKNOWN=2]="UNKNOWN",Jt[Jt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Jt[Jt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Jt[Jt.NOT_FOUND=5]="NOT_FOUND",Jt[Jt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Jt[Jt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Jt[Jt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Jt[Jt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Jt[Jt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Jt[Jt.ABORTED=10]="ABORTED",Jt[Jt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Jt[Jt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Jt[Jt.INTERNAL=13]="INTERNAL",Jt[Jt.UNAVAILABLE=14]="UNAVAILABLE",Jt[Jt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y6(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $6=new Za([4294967295,4294967295],0);function YR(n){const e=Y6().encode(n),t=new CN;return t.update(e),new Uint8Array(t.digest())}function $R(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Za([t,i],0),new Za([r,s],0)]}class Q1{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new dd(`Invalid padding: ${t}`);if(i<0)throw new dd(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new dd(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new dd(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Za.fromNumber(this.ge)}ye(e,t,i){let r=e.add(t.multiply(Za.fromNumber(i)));return r.compare($6)===1&&(r=new Za([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=YR(e),[i,r]=$R(t);for(let s=0;s<this.hashCount;s++){const o=this.ye(i,r,s);if(!this.we(o))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Q1(s,r,t);return i.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const t=YR(e),[i,r]=$R(t);for(let s=0;s<this.hashCount;s++){const o=this.ye(i,r,s);this.Se(o)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class dd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,Gp.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new gv(Lt.min(),r,new zn(Yt),ra(),$t())}}class Gp{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Gp(i,t,$t(),$t(),$t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_{constructor(e,t,i,r){this.be=e,this.removedTargetIds=t,this.key=i,this.De=r}}class dD{constructor(e,t){this.targetId=e,this.Ce=t}}class pD{constructor(e,t,i=Di.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class KR{constructor(){this.ve=0,this.Fe=QR(),this.Me=Di.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=$t(),t=$t(),i=$t();return this.Fe.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Tt(38017,{changeType:s})}}),new Gp(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=QR()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,hn(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class K6{constructor(e){this.Ge=e,this.ze=new Map,this.je=ra(),this.Je=pg(),this.He=pg(),this.Ye=new zn(Yt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Tt(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((i,r)=>{this.rt(r)&&t(r)})}st(e){const t=e.targetId,i=e.Ce.count,r=this.ot(t);if(r){const s=r.target;if(IE(s))if(i===0){const o=new pt(s.path);this.et(t,o,Ji.newNoDocument(o,Lt.min()))}else hn(i===1,20013,{expectedCount:i});else{const o=this._t(t);if(o!==i){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(t);const h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t;let o,a;try{o=cl(i).toUint8Array()}catch(l){if(l instanceof VN)return Vh("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Q1(o,r,s)}catch(l){return Vh(l instanceof dd?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let r=0;return i.forEach(s=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(t,s,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((s,o)=>{const a=this.ot(o);if(a){if(s.current&&IE(a.target)){const l=new pt(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,Ji.newNoDocument(l,e))}s.Be&&(t.set(o,s.ke()),s.qe())}});let i=$t();this.He.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const h=this.ot(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));const r=new gv(e,t,this.Ye,this.je,i);return this.je=ra(),this.Je=pg(),this.He=pg(),this.Ye=new zn(Yt),r}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new KR,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new mi(Yt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new mi(Yt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||tt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new KR),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function pg(){return new zn(pt.comparator)}function QR(){return new zn(pt.comparator)}const Q6={asc:"ASCENDING",desc:"DESCENDING"},J6={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Z6={and:"AND",or:"OR"};class eH{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function bE(n,e){return n.useProto3Json||uv(e)?e:{value:e}}function Cy(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function mD(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function tH(n,e){return Cy(n,e.toTimestamp())}function go(n){return hn(!!n,49232),Lt.fromTimestamp(function(t){const i=ul(t);return new wn(i.seconds,i.nanos)}(n))}function J1(n,e){return LE(n,e).canonicalString()}function LE(n,e){const t=function(r){return new xn(["projects",r.projectId,"databases",r.database])}(n).child("documents");return e===void 0?t:t.child(e)}function gD(n){const e=xn.fromString(n);return hn(SD(e),10190,{key:e.toString()}),e}function NE(n,e){return J1(n.databaseId,e.path)}function Ax(n,e){const t=gD(e);if(t.get(1)!==n.databaseId.projectId)throw new Xe(Se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Xe(Se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new pt(yD(t))}function _D(n,e){return J1(n.databaseId,e)}function nH(n){const e=gD(n);return e.length===4?xn.emptyPath():yD(e)}function DE(n){return new xn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function yD(n){return hn(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function JR(n,e,t){return{name:NE(n,e),fields:t.value.mapValue.fields}}function iH(n,e){let t;if("targetChange"in e){e.targetChange;const i=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Tt(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(h,f){return h.useProto3Json?(hn(f===void 0||typeof f=="string",58123),Di.fromBase64String(f||"")):(hn(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),Di.fromUint8Array(f||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(h){const f=h.code===void 0?Se.UNKNOWN:fD(h.code);return new Xe(f,h.message||"")}(o);t=new pD(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Ax(n,i.document.name),s=go(i.document.updateTime),o=i.document.createTime?go(i.document.createTime):Lt.min(),a=new Pr({mapValue:{fields:i.document.fields}}),l=Ji.newFoundDocument(r,s,o,a),h=i.targetIds||[],f=i.removedTargetIds||[];t=new L_(h,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Ax(n,i.document),s=i.readTime?go(i.readTime):Lt.min(),o=Ji.newNoDocument(r,s),a=i.removedTargetIds||[];t=new L_([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Ax(n,i.document),s=i.removedTargetIds||[];t=new L_([],s,r,null)}else{if(!("filter"in e))return Tt(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:s}=i,o=new q6(r,s),a=i.targetId;t=new dD(a,o)}}return t}function rH(n,e){let t;if(e instanceof Hp)t={update:JR(n,e.key,e.value)};else if(e instanceof $1)t={delete:NE(n,e.key)};else if(e instanceof Tl)t={update:JR(n,e.key,e.data),updateMask:dH(e.fieldMask)};else{if(!(e instanceof G6))return Tt(16599,{Vt:e.type});t={verify:NE(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(s,o){const a=o.transform;if(a instanceof My)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof op)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ap)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ay)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw Tt(20930,{transform:o.transform})}(0,i))),e.precondition.isNone||(t.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:tH(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Tt(27497)}(n,e.precondition)),t}function sH(n,e){return n&&n.length>0?(hn(e!==void 0,14353),n.map(t=>function(r,s){let o=r.updateTime?go(r.updateTime):go(s);return o.isEqual(Lt.min())&&(o=go(s)),new z6(o,r.transformResults||[])}(t,e))):[]}function oH(n,e){return{documents:[_D(n,e.path)]}}function aH(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=_D(n,r);const s=function(h){if(h.length!==0)return xD(Ys.create(h,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(h){if(h.length!==0)return h.map(f=>function(p){return{field:Kc(p.field),direction:cH(p.dir)}}(f))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=bE(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ft:t,parent:r}}function lH(n){let e=nH(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){hn(i===1,65062);const f=t.from[0];f.allDescendants?r=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=function(d){const p=vD(d);return p instanceof Ys&&$N(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(d){return d.map(p=>function(v){return new sp(Qc(v.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(p))}(t.orderBy));let a=null;t.limit&&(a=function(d){let p;return p=typeof d=="object"?d.value:d,uv(p)?null:p}(t.limit));let l=null;t.startAt&&(l=function(d){const p=!!d.before,_=d.values||[];return new wy(_,p)}(t.startAt));let h=null;return t.endAt&&(h=function(d){const p=!d.before,_=d.values||[];return new wy(_,p)}(t.endAt)),C6(e,r,o,s,a,"F",l,h)}function uH(n,e){const t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Tt(28987,{purpose:r})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function vD(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Qc(t.unaryFilter.field);return ai.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Qc(t.unaryFilter.field);return ai.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Qc(t.unaryFilter.field);return ai.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Qc(t.unaryFilter.field);return ai.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Tt(61313);default:return Tt(60726)}}(n):n.fieldFilter!==void 0?function(t){return ai.create(Qc(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Tt(58110);default:return Tt(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ys.create(t.compositeFilter.filters.map(i=>vD(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Tt(1026)}}(t.compositeFilter.op))}(n):Tt(30097,{filter:n})}function cH(n){return Q6[n]}function hH(n){return J6[n]}function fH(n){return Z6[n]}function Kc(n){return{fieldPath:n.canonicalString()}}function Qc(n){return bi.fromServerFormat(n.fieldPath)}function xD(n){return n instanceof ai?function(t){if(t.op==="=="){if(VR(t.value))return{unaryFilter:{field:Kc(t.field),op:"IS_NAN"}};if(FR(t.value))return{unaryFilter:{field:Kc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(VR(t.value))return{unaryFilter:{field:Kc(t.field),op:"IS_NOT_NAN"}};if(FR(t.value))return{unaryFilter:{field:Kc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Kc(t.field),op:hH(t.op),value:t.value}}}(n):n instanceof Ys?function(t){const i=t.getFilters().map(r=>xD(r));return i.length===1?i[0]:{compositeFilter:{op:fH(t.op),filters:i}}}(n):Tt(54877,{filter:n})}function dH(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function SD(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba{constructor(e,t,i,r,s=Lt.min(),o=Lt.min(),a=Di.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Ba(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ba(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ba(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ba(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pH{constructor(e){this.yt=e}}function mH(n){const e=lH({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Ty(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gH{constructor(){this.Cn=new _H}addToCollectionParentIndex(e,t){return this.Cn.add(t),Te.resolve()}getCollectionParents(e,t){return Te.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Te.resolve()}deleteFieldIndex(e,t){return Te.resolve()}deleteAllFieldIndexes(e){return Te.resolve()}createTargetIndexes(e,t){return Te.resolve()}getDocumentsMatchingTarget(e,t){return Te.resolve(null)}getIndexType(e,t){return Te.resolve(0)}getFieldIndexes(e,t){return Te.resolve([])}getNextCollectionGroupToUpdate(e){return Te.resolve(null)}getMinOffset(e,t){return Te.resolve(ll.min())}getMinOffsetFromCollectionGroup(e,t){return Te.resolve(ll.min())}updateCollectionGroup(e,t,i){return Te.resolve()}updateIndexEntries(e,t){return Te.resolve()}}class _H{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new mi(xn.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new mi(xn.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ED=41943040;class Rr{static withCacheSize(e){return new Rr(e,Rr.DEFAULT_COLLECTION_PERCENTILE,Rr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Rr.DEFAULT_COLLECTION_PERCENTILE=10,Rr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Rr.DEFAULT=new Rr(ED,Rr.DEFAULT_COLLECTION_PERCENTILE,Rr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Rr.DISABLED=new Rr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Gh(0)}static cr(){return new Gh(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI="LruGarbageCollector",yH=1048576;function tI([n,e],[t,i]){const r=Yt(n,t);return r===0?Yt(e,i):r}class vH{constructor(e){this.Ir=e,this.buffer=new mi(tI),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();tI(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class xH{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){tt(eI,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){sf(t)?tt(eI,"Ignoring IndexedDB error during garbage collection: ",t):await rf(t)}await this.Vr(3e5)})}}class SH{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return Te.resolve(lv.ce);const i=new vH(t);return this.mr.forEachTarget(e,r=>i.Ar(r.sequenceNumber)).next(()=>this.mr.pr(e,r=>i.Ar(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(tt("LruGarbageCollector","Garbage collection skipped; disabled"),Te.resolve(ZR)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(tt("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ZR):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,s,o,a,l,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(tt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),r=this.params.maximumSequenceNumbersToCollect):r=d,o=Date.now(),this.nthSequenceNumber(e,r))).next(d=>(i=d,a=Date.now(),this.removeTargets(e,i,t))).next(d=>(s=d,l=Date.now(),this.removeOrphanedDocuments(e,i))).next(d=>(h=Date.now(),Yc()<=Xt.DEBUG&&tt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${d} documents in `+(h-l)+`ms
Total Duration: ${h-f}ms`),Te.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:d})))}}function EH(n,e){return new SH(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wH{constructor(){this.changes=new Yu(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ji.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?Te.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TH{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MH{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&Pd(i.mutation,r,Jr.empty(),wn.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,$t()).next(()=>i))}getLocalViewOfDocuments(e,t,i=$t()){const r=_u();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let o=fd();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const i=_u();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,$t()))}populateOverlays(e,t,i){const r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,i,r){let s=ra();const o=Id(),a=function(){return Id()}();return t.forEach((l,h)=>{const f=i.get(h.key);r.has(h.key)&&(f===void 0||f.mutation instanceof Tl)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),Pd(f.mutation,h,f.mutation.getFieldMask(),wn.now())):o.set(h.key,Jr.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((h,f)=>o.set(h,f)),t.forEach((h,f)=>a.set(h,new TH(f,o.get(h)??null))),a))}recalculateAndSaveOverlays(e,t){const i=Id();let r=new zn((o,a)=>o-a),s=$t();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const h=t.get(l);if(h===null)return;let f=i.get(l)||Jr.empty();f=a.applyToLocalView(h,f),i.set(l,f);const d=(r.get(a.batchId)||$t()).add(l);r=r.insert(a.batchId,d)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),h=l.key,f=l.value,d=rD();f.forEach(p=>{if(!s.has(p)){const _=cD(t.get(p),i.get(p));_!==null&&d.set(p,_),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,d))}return Te.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return function(o){return pt.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ZN(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{const o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):Te.resolve(_u());let a=tp,l=s;return o.next(h=>Te.forEach(h,(f,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(f)?Te.resolve():this.remoteDocumentCache.getEntry(e,f).next(p=>{l=l.insert(f,p)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,l,h,$t())).next(f=>({batchId:a,changes:iD(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new pt(t)).next(i=>{let r=fd();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const s=t.collectionGroup;let o=fd();return this.indexManager.getCollectionParents(e,s).next(a=>Te.forEach(a,l=>{const h=function(d,p){return new of(p,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next(f=>{f.forEach((d,p)=>{o=o.insert(d,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r))).next(o=>{s.forEach((l,h)=>{const f=h.getKey();o.get(f)===null&&(o=o.insert(f,Ji.newInvalidDocument(f)))});let a=fd();return o.forEach((l,h)=>{const f=s.get(l);f!==void 0&&Pd(f.mutation,h,Jr.empty(),wn.now()),dv(t,h)&&(a=a.insert(l,h))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AH{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Te.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:go(r.createTime)}}(t)),Te.resolve()}getNamedQuery(e,t){return Te.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(r){return{name:r.name,query:mH(r.bundledQuery),readTime:go(r.readTime)}}(t)),Te.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CH{constructor(){this.overlays=new zn(pt.comparator),this.qr=new Map}getOverlay(e,t){return Te.resolve(this.overlays.get(t))}getOverlays(e,t){const i=_u();return Te.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.St(e,t,s)}),Te.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(i)),Te.resolve()}getOverlaysForCollection(e,t,i){const r=_u(),s=t.length+1,o=new pt(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,h=l.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&l.largestBatchId>i&&r.set(l.getKey(),l)}return Te.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new zn((h,f)=>h-f);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let f=s.get(h.largestBatchId);f===null&&(f=_u(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const a=_u(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((h,f)=>a.set(h,f)),!(a.size()>=r)););return Te.resolve(a)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new j6(t,i));let s=this.qr.get(t);s===void 0&&(s=$t(),this.qr.set(t,s)),this.qr.set(t,s.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RH{constructor(){this.sessionToken=Di.EMPTY_BYTE_STRING}getSessionToken(e){return Te.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Te.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z1{constructor(){this.Qr=new mi(Mi.$r),this.Ur=new mi(Mi.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new Mi(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Gr(new Mi(e,t))}zr(e,t){e.forEach(i=>this.removeReference(i,t))}jr(e){const t=new pt(new xn([])),i=new Mi(t,e),r=new Mi(t,e+1),s=[];return this.Ur.forEachInRange([i,r],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new pt(new xn([])),i=new Mi(t,e),r=new Mi(t,e+1);let s=$t();return this.Ur.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new Mi(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Mi{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return pt.comparator(e.key,t.key)||Yt(e.Yr,t.Yr)}static Kr(e,t){return Yt(e.Yr,t.Yr)||pt.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IH{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new mi(Mi.$r)}checkEmpty(e){return Te.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new W6(s,t,i,r);this.mutationQueue.push(o);for(const a of r)this.Zr=this.Zr.add(new Mi(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Te.resolve(o)}lookupMutationBatch(e,t){return Te.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),s=r<0?0:r;return Te.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Te.resolve(this.mutationQueue.length===0?G1:this.tr-1)}getAllMutationBatches(e){return Te.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Mi(t,0),r=new Mi(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([i,r],o=>{const a=this.Xr(o.Yr);s.push(a)}),Te.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new mi(Yt);return t.forEach(r=>{const s=new Mi(r,0),o=new Mi(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],a=>{i=i.add(a.Yr)})}),Te.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let s=i;pt.isDocumentKey(s)||(s=s.child(""));const o=new Mi(new pt(s),0);let a=new mi(Yt);return this.Zr.forEachWhile(l=>{const h=l.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(a=a.add(l.Yr)),!0)},o),Te.resolve(this.ti(a))}ti(e){const t=[];return e.forEach(i=>{const r=this.Xr(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){hn(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return Te.forEach(t.mutations,r=>{const s=new Mi(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=i})}ir(e){}containsKey(e,t){const i=new Mi(t,0),r=this.Zr.firstAfterOrEqual(i);return Te.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Te.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PH{constructor(e){this.ri=e,this.docs=function(){return new zn(pt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return Te.resolve(i?i.document.mutableCopy():Ji.newInvalidDocument(t))}getEntries(e,t){let i=ra();return t.forEach(r=>{const s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():Ji.newInvalidDocument(r))}),Te.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=ra();const o=t.path,a=new pt(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:h,value:{document:f}}=l.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||s6(r6(f),i)<=0||(r.has(f.key)||dv(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return Te.resolve(s)}getAllFromCollectionGroup(e,t,i,r){Tt(9500)}ii(e,t){return Te.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new bH(this)}getSize(e){return Te.resolve(this.size)}}class bH extends wH{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)}),Te.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LH{constructor(e){this.persistence=e,this.si=new Yu(t=>q1(t),X1),this.lastRemoteSnapshotVersion=Lt.min(),this.highestTargetId=0,this.oi=0,this._i=new Z1,this.targetCount=0,this.ai=Gh.ur()}forEachTarget(e,t){return this.si.forEach((i,r)=>t(r)),Te.resolve()}getLastRemoteSnapshotVersion(e){return Te.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Te.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Te.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),Te.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Gh(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Te.resolve()}updateTargetData(e,t){return this.Pr(t),Te.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Te.resolve()}removeTargets(e,t,i){let r=0;const s=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=t&&i.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),Te.waitFor(s).next(()=>r)}getTargetCount(e){return Te.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return Te.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),Te.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),Te.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Te.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return Te.resolve(i)}containsKey(e,t){return Te.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(e,t){this.ui={},this.overlays={},this.ci=new lv(0),this.li=!1,this.li=!0,this.hi=new RH,this.referenceDelegate=e(this),this.Pi=new LH(this),this.indexManager=new gH,this.remoteDocumentCache=function(r){return new PH(r)}(i=>this.referenceDelegate.Ti(i)),this.serializer=new pH(t),this.Ii=new AH(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new CH,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new IH(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){tt("MemoryPersistence","Starting transaction:",e);const r=new NH(this.ci.next());return this.referenceDelegate.Ei(),i(r).next(s=>this.referenceDelegate.di(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Ai(e,t){return Te.or(Object.values(this.ui).map(i=>()=>i.containsKey(e,t)))}}class NH extends a6{constructor(e){super(),this.currentSequenceNumber=e}}class eT{constructor(e){this.persistence=e,this.Ri=new Z1,this.Vi=null}static mi(e){return new eT(e)}get fi(){if(this.Vi)return this.Vi;throw Tt(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),Te.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),Te.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Te.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(r=>this.fi.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.fi.add(s.toString()))}).next(()=>i.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Te.forEach(this.fi,i=>{const r=pt.fromPath(i);return this.gi(e,r).next(s=>{s||t.removeEntry(r,Lt.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return Te.or([()=>Te.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Ry{constructor(e,t){this.persistence=e,this.pi=new Yu(i=>c6(i.path),(i,r)=>i.isEqual(r)),this.garbageCollector=EH(this,t)}static mi(e,t){return new Ry(e,t)}Ei(){}di(e){return Te.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}wr(e){let t=0;return this.pr(e,i=>{t++}).next(()=>t)}pr(e,t){return Te.forEach(this.pi,(i,r)=>this.br(e,i,r).next(s=>s?Te.resolve():t(r)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ii(e,o=>this.br(e,o,t).next(a=>{a||(i++,s.removeEntry(o,Lt.min()))})).next(()=>s.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Te.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),Te.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),Te.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Te.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=I_(e.data.value)),t}br(e,t,i){return Te.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return Te.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tT{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=$t(),r=$t();for(const s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new tT(e,t.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DH{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kH{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return pV()?8:l6(nr())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const s={result:null};return this.ys(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,t,r,i).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new DH;return this.Ss(e,t,o).next(a=>{if(s.result=a,this.Vs)return this.bs(e,t,o,a.size)})}).next(()=>s.result)}bs(e,t,i,r){return i.documentReadCount<this.fs?(Yc()<=Xt.DEBUG&&tt("QueryEngine","SDK will not create cache indexes for query:",$c(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Te.resolve()):(Yc()<=Xt.DEBUG&&tt("QueryEngine","Query:",$c(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Yc()<=Xt.DEBUG&&tt("QueryEngine","The SDK decides to create cache indexes for query:",$c(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,mo(t))):Te.resolve())}ys(e,t){if(GR(t))return Te.resolve(null);let i=mo(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=Ty(t,null,"F"),i=mo(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{const o=$t(...s);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,i).next(l=>{const h=this.Ds(t,a);return this.Cs(t,h,o,l.readTime)?this.ys(e,Ty(t,null,"F")):this.vs(e,h,t,l)}))})))}ws(e,t,i,r){return GR(t)||r.isEqual(Lt.min())?Te.resolve(null):this.ps.getDocuments(e,i).next(s=>{const o=this.Ds(t,s);return this.Cs(t,o,i,r)?Te.resolve(null):(Yc()<=Xt.DEBUG&&tt("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),$c(t)),this.vs(e,o,t,i6(r,tp)).next(a=>a))})}Ds(e,t){let i=new mi(tD(e));return t.forEach((r,s)=>{dv(e,s)&&(i=i.add(s))}),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,i){return Yc()<=Xt.DEBUG&&tt("QueryEngine","Using full collection scan to execute query:",$c(t)),this.ps.getDocumentsMatchingQuery(e,t,ll.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nT="LocalStore",OH=3e8;class UH{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new zn(Yt),this.xs=new Yu(s=>q1(s),X1),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new MH(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function FH(n,e,t,i){return new UH(n,e,t,i)}async function TD(n,e){const t=Dt(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(i))).next(s=>{const o=[],a=[];let l=$t();for(const h of r){o.push(h.batchId);for(const f of h.mutations)l=l.add(f.key)}for(const h of s){a.push(h.batchId);for(const f of h.mutations)l=l.add(f.key)}return t.localDocuments.getDocuments(i,l).next(h=>({Ls:h,removedBatchIds:o,addedBatchIds:a}))})})}function VH(n,e){const t=Dt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,h,f){const d=h.batch,p=d.keys();let _=Te.resolve();return p.forEach(v=>{_=_.next(()=>f.getEntry(l,v)).next(T=>{const x=h.docVersions.get(v);hn(x!==null,48541),T.version.compareTo(x)<0&&(d.applyToRemoteDocument(T,h),T.isValidDocument()&&(T.setReadTime(h.commitVersion),f.addEntry(T)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(l,d))}(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(a){let l=$t();for(let h=0;h<a.mutationResults.length;++h)a.mutationResults[h].transformResults.length>0&&(l=l.add(a.batch.mutations[h].key));return l}(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function MD(n){const e=Dt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function zH(n,e){const t=Dt(n),i=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const a=[];e.targetChanges.forEach((f,d)=>{const p=r.get(d);if(!p)return;a.push(t.Pi.removeMatchingKeys(s,f.removedDocuments,d).next(()=>t.Pi.addMatchingKeys(s,f.addedDocuments,d)));let _=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?_=_.withResumeToken(Di.EMPTY_BYTE_STRING,Lt.min()).withLastLimboFreeSnapshotVersion(Lt.min()):f.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(f.resumeToken,i)),r=r.insert(d,_),function(T,x,y){return T.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=OH?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(p,_,f)&&a.push(t.Pi.updateTargetData(s,_))});let l=ra(),h=$t();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))}),a.push(BH(s,o,e.documentUpdates).next(f=>{l=f.ks,h=f.qs})),!i.isEqual(Lt.min())){const f=t.Pi.getLastRemoteSnapshotVersion(s).next(d=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,i));a.push(f)}return Te.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,h)).next(()=>l)}).then(s=>(t.Ms=r,s))}function BH(n,e,t){let i=$t(),r=$t();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let o=ra();return t.forEach((a,l)=>{const h=s.get(a);l.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(Lt.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):tt(nT,"Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",l.version)}),{ks:o,qs:r}})}function HH(n,e){const t=Dt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=G1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function GH(n,e){const t=Dt(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.Pi.getTargetData(i,e).next(s=>s?(r=s,Te.resolve(r)):t.Pi.allocateTargetId(i).next(o=>(r=new Ba(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=t.Ms.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i})}async function kE(n,e,t){const i=Dt(n),r=i.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",s,o=>i.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!sf(o))throw o;tt(nT,`Failed to update sequence numbers for target ${e}: ${o}`)}i.Ms=i.Ms.remove(e),i.xs.delete(r.target)}function nI(n,e,t){const i=Dt(n);let r=Lt.min(),s=$t();return i.persistence.runTransaction("Execute query","readwrite",o=>function(l,h,f){const d=Dt(l),p=d.xs.get(f);return p!==void 0?Te.resolve(d.Ms.get(p)):d.Pi.getTargetData(h,f)}(i,o,mo(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>i.Fs.getDocumentsMatchingQuery(o,e,t?r:Lt.min(),t?s:$t())).next(a=>(WH(i,I6(e),a),{documents:a,Qs:s})))}function WH(n,e,t){let i=n.Os.get(e)||Lt.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.Os.set(e,i)}class iI{constructor(){this.activeTargetIds=k6()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class jH{constructor(){this.Mo=new iI,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new iI,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qH{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rI="ConnectivityMonitor";class sI{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){tt(rI,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){tt(rI,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mg=null;function OE(){return mg===null?mg=function(){return 268435456+Math.round(2147483648*Math.random())}():mg++,"0x"+mg.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cx="RestConnection",XH={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class YH{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===Sy?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,s){const o=OE(),a=this.zo(e,t.toUriEncodedString());tt(Cx,`Sending RPC '${e}' ${o}:`,a,i);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,r,s);const{host:h}=new URL(a),f=Zh(h);return this.Jo(e,a,l,i,f).then(d=>(tt(Cx,`Received RPC '${e}' ${o}: `,d),d),d=>{throw Vh(Cx,`RPC '${e}' ${o} failed with error: `,d,"url: ",a,"request:",i),d})}Ho(e,t,i,r,s,o){return this.Go(e,t,i,r,s)}jo(e,t,i){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+nf}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,s)=>e[s]=r),i&&i.headers.forEach((r,s)=>e[s]=r)}zo(e,t){const i=XH[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $H{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qi="WebChannelConnection";class KH extends YH{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,s){const o=OE();return new Promise((a,l)=>{const h=new RN;h.setWithCredentials(!0),h.listenOnce(IN.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case R_.NO_ERROR:const d=h.getResponseJson();tt(qi,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(d)),a(d);break;case R_.TIMEOUT:tt(qi,`RPC '${e}' ${o} timed out`),l(new Xe(Se.DEADLINE_EXCEEDED,"Request time out"));break;case R_.HTTP_ERROR:const p=h.getStatus();if(tt(qi,`RPC '${e}' ${o} failed with status:`,p,"response text:",h.getResponseText()),p>0){let _=h.getResponseJson();Array.isArray(_)&&(_=_[0]);const v=_==null?void 0:_.error;if(v&&v.status&&v.message){const T=function(y){const w=y.toLowerCase().replace(/_/g,"-");return Object.values(Se).indexOf(w)>=0?w:Se.UNKNOWN}(v.status);l(new Xe(T,v.message))}else l(new Xe(Se.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new Xe(Se.UNAVAILABLE,"Connection failed."));break;default:Tt(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{tt(qi,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(r);tt(qi,`RPC '${e}' ${o} sending request:`,r),h.send(t,"POST",f,i,15)})}T_(e,t,i){const r=OE(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=LN(),a=bN(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,i),l.encodeInitMessageHeaders=!0;const f=s.join("");tt(qi,`Creating RPC '${e}' stream ${r}: ${f}`,l);const d=o.createWebChannel(f,l);this.I_(d);let p=!1,_=!1;const v=new $H({Yo:x=>{_?tt(qi,`Not sending because RPC '${e}' stream ${r} is closed:`,x):(p||(tt(qi,`Opening RPC '${e}' stream ${r} transport.`),d.open(),p=!0),tt(qi,`RPC '${e}' stream ${r} sending:`,x),d.send(x))},Zo:()=>d.close()}),T=(x,y,w)=>{x.listen(y,E=>{try{w(E)}catch(I){setTimeout(()=>{throw I},0)}})};return T(d,hd.EventType.OPEN,()=>{_||(tt(qi,`RPC '${e}' stream ${r} transport opened.`),v.o_())}),T(d,hd.EventType.CLOSE,()=>{_||(_=!0,tt(qi,`RPC '${e}' stream ${r} transport closed`),v.a_(),this.E_(d))}),T(d,hd.EventType.ERROR,x=>{_||(_=!0,Vh(qi,`RPC '${e}' stream ${r} transport errored. Name:`,x.name,"Message:",x.message),v.a_(new Xe(Se.UNAVAILABLE,"The operation could not be completed")))}),T(d,hd.EventType.MESSAGE,x=>{var y;if(!_){const w=x.data[0];hn(!!w,16349);const E=w,I=(E==null?void 0:E.error)||((y=E[0])==null?void 0:y.error);if(I){tt(qi,`RPC '${e}' stream ${r} received error:`,I);const O=I.status;let D=function(k){const M=si[k];if(M!==void 0)return fD(M)}(O),R=I.message;D===void 0&&(D=Se.INTERNAL,R="Unknown error status: "+O+" with message "+I.message),_=!0,v.a_(new Xe(D,R)),d.close()}else tt(qi,`RPC '${e}' stream ${r} received:`,w),v.u_(w)}}),T(a,PN.STAT_EVENT,x=>{x.stat===TE.PROXY?tt(qi,`RPC '${e}' stream ${r} detected buffering proxy`):x.stat===TE.NOPROXY&&tt(qi,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{v.__()},0),v}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function Rx(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _v(n){return new eH(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AD{constructor(e,t,i=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&tt("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oI="PersistentStream";class CD{constructor(e,t,i,r,s,o,a,l){this.Mi=e,this.S_=i,this.b_=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new AD(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Se.RESOURCE_EXHAUSTED?(ia(t.toString()),ia("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Se.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.D_===t&&this.G_(i,r)},i=>{e(()=>{const r=new Xe(Se.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)})})}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{i(()=>this.listener.Xo())}),this.stream.t_(()=>{i(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(r=>{i(()=>this.z_(r))}),this.stream.onMessage(r=>{i(()=>++this.F_==1?this.J_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return tt(oI,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(tt(oI,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class QH extends CD{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=iH(this.serializer,e),i=function(s){if(!("targetChange"in s))return Lt.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Lt.min():o.readTime?go(o.readTime):Lt.min()}(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=DE(this.serializer),t.addTarget=function(s,o){let a;const l=o.target;if(a=IE(l)?{documents:oH(s,l)}:{query:aH(s,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=mD(s,o.resumeToken);const h=bE(s,o.expectedCount);h!==null&&(a.expectedCount=h)}else if(o.snapshotVersion.compareTo(Lt.min())>0){a.readTime=Cy(s,o.snapshotVersion.toTimestamp());const h=bE(s,o.expectedCount);h!==null&&(a.expectedCount=h)}return a}(this.serializer,e);const i=uH(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=DE(this.serializer),t.removeTarget=e,this.q_(t)}}class JH extends CD{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return hn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,hn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){hn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=sH(e.writeResults,e.commitTime),i=go(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=DE(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>rH(this.serializer,i))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZH{}class eG extends ZH{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Xe(Se.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,LE(t,i),r,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Xe(Se.UNKNOWN,s.toString())})}Ho(e,t,i,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,LE(t,i),r,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Xe(Se.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class tG{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ia(t),this.aa=!1):tt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hu="RemoteStore";class nG{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{i.enqueueAndForget(async()=>{$u(this)&&(tt(Hu,"Restarting streams for network reachability change."),await async function(l){const h=Dt(l);h.Ea.add(4),await Wp(h),h.Ra.set("Unknown"),h.Ea.delete(4),await yv(h)}(this))})}),this.Ra=new tG(i,r)}}async function yv(n){if($u(n))for(const e of n.da)await e(!0)}async function Wp(n){for(const e of n.da)await e(!1)}function RD(n,e){const t=Dt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),oT(t)?sT(t):af(t).O_()&&rT(t,e))}function iT(n,e){const t=Dt(n),i=af(t);t.Ia.delete(e),i.O_()&&ID(t,e),t.Ia.size===0&&(i.O_()?i.L_():$u(t)&&t.Ra.set("Unknown"))}function rT(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Lt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}af(n).Y_(e)}function ID(n,e){n.Va.Ue(e),af(n).Z_(e)}function sT(n){n.Va=new K6({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),af(n).start(),n.Ra.ua()}function oT(n){return $u(n)&&!af(n).x_()&&n.Ia.size>0}function $u(n){return Dt(n).Ea.size===0}function PD(n){n.Va=void 0}async function iG(n){n.Ra.set("Online")}async function rG(n){n.Ia.forEach((e,t)=>{rT(n,e)})}async function sG(n,e){PD(n),oT(n)?(n.Ra.ha(e),sT(n)):n.Ra.set("Unknown")}async function oG(n,e,t){if(n.Ra.set("Online"),e instanceof pD&&e.state===2&&e.cause)try{await async function(r,s){const o=s.cause;for(const a of s.targetIds)r.Ia.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.Ia.delete(a),r.Va.removeTarget(a))}(n,e)}catch(i){tt(Hu,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Iy(n,i)}else if(e instanceof L_?n.Va.Ze(e):e instanceof dD?n.Va.st(e):n.Va.tt(e),!t.isEqual(Lt.min()))try{const i=await MD(n.localStore);t.compareTo(i)>=0&&await function(s,o){const a=s.Va.Tt(o);return a.targetChanges.forEach((l,h)=>{if(l.resumeToken.approximateByteSize()>0){const f=s.Ia.get(h);f&&s.Ia.set(h,f.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,h)=>{const f=s.Ia.get(l);if(!f)return;s.Ia.set(l,f.withResumeToken(Di.EMPTY_BYTE_STRING,f.snapshotVersion)),ID(s,l);const d=new Ba(f.target,l,h,f.sequenceNumber);rT(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(i){tt(Hu,"Failed to raise snapshot:",i),await Iy(n,i)}}async function Iy(n,e,t){if(!sf(e))throw e;n.Ea.add(1),await Wp(n),n.Ra.set("Offline"),t||(t=()=>MD(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{tt(Hu,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await yv(n)})}function bD(n,e){return e().catch(t=>Iy(n,t,e))}async function vv(n){const e=Dt(n),t=fl(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:G1;for(;aG(e);)try{const r=await HH(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,lG(e,r)}catch(r){await Iy(e,r)}LD(e)&&ND(e)}function aG(n){return $u(n)&&n.Ta.length<10}function lG(n,e){n.Ta.push(e);const t=fl(n);t.O_()&&t.X_&&t.ea(e.mutations)}function LD(n){return $u(n)&&!fl(n).x_()&&n.Ta.length>0}function ND(n){fl(n).start()}async function uG(n){fl(n).ra()}async function cG(n){const e=fl(n);for(const t of n.Ta)e.ea(t.mutations)}async function hG(n,e,t){const i=n.Ta.shift(),r=K1.from(i,e,t);await bD(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),await vv(n)}async function fG(n,e){e&&fl(n).X_&&await async function(i,r){if(function(o){return X6(o)&&o!==Se.ABORTED}(r.code)){const s=i.Ta.shift();fl(i).B_(),await bD(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r)),await vv(i)}}(n,e),LD(n)&&ND(n)}async function aI(n,e){const t=Dt(n);t.asyncQueue.verifyOperationInProgress(),tt(Hu,"RemoteStore received new credentials");const i=$u(t);t.Ea.add(3),await Wp(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await yv(t)}async function dG(n,e){const t=Dt(n);e?(t.Ea.delete(2),await yv(t)):e||(t.Ea.add(2),await Wp(t),t.Ra.set("Unknown"))}function af(n){return n.ma||(n.ma=function(t,i,r){const s=Dt(t);return s.sa(),new QH(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Xo:iG.bind(null,n),t_:rG.bind(null,n),r_:sG.bind(null,n),H_:oG.bind(null,n)}),n.da.push(async e=>{e?(n.ma.B_(),oT(n)?sT(n):n.Ra.set("Unknown")):(await n.ma.stop(),PD(n))})),n.ma}function fl(n){return n.fa||(n.fa=function(t,i,r){const s=Dt(t);return s.sa(),new JH(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:uG.bind(null,n),r_:fG.bind(null,n),ta:cG.bind(null,n),na:hG.bind(null,n)}),n.da.push(async e=>{e?(n.fa.B_(),await vv(n)):(await n.fa.stop(),n.Ta.length>0&&(tt(Hu,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aT{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new el,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,a=new aT(e,t,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Xe(Se.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function lT(n,e){if(ia("AsyncQueue",`${e}: ${n}`),sf(n))return new Xe(Se.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{static emptySet(e){return new Ch(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||pt.comparator(t.key,i.key):(t,i)=>pt.comparator(t.key,i.key),this.keyedMap=fd(),this.sortedSet=new zn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ch)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Ch;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{constructor(){this.ga=new zn(pt.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Tt(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,i)=>{e.push(i)}),e}}class Wh{constructor(e,t,i,r,s,o,a,l,h){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,t,i,r,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Wh(e,t,Ch.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&fv(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pG{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class mG{constructor(){this.queries=uI(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=Dt(t),s=r.queries;r.queries=uI(),s.forEach((o,a)=>{for(const l of a.Sa)l.onError(i)})})(this,new Xe(Se.ABORTED,"Firestore shutting down"))}}function uI(){return new Yu(n=>eD(n),fv)}async function DD(n,e){const t=Dt(n);let i=3;const r=e.query;let s=t.queries.get(r);s?!s.ba()&&e.Da()&&(i=2):(s=new pG,i=e.Da()?0:1);try{switch(i){case 0:s.wa=await t.onListen(r,!0);break;case 1:s.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(o){const a=lT(o,`Initialization of query '${$c(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&uT(t)}async function kD(n,e){const t=Dt(n),i=e.query;let r=3;const s=t.queries.get(i);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?r=e.Da()?0:1:!s.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function gG(n,e){const t=Dt(n);let i=!1;for(const r of e){const s=r.query,o=t.queries.get(s);if(o){for(const a of o.Sa)a.Fa(r)&&(i=!0);o.wa=r}}i&&uT(t)}function _G(n,e,t){const i=Dt(n),r=i.queries.get(e);if(r)for(const s of r.Sa)s.onError(t);i.queries.delete(e)}function uT(n){n.Ca.forEach(e=>{e.next()})}var UE,cI;(cI=UE||(UE={})).Ma="default",cI.Cache="cache";class OD{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new Wh(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Wh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==UE.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UD{constructor(e){this.key=e}}class FD{constructor(e){this.key=e}}class yG{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=$t(),this.mutatedKeys=$t(),this.eu=tD(e),this.tu=new Ch(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new lI,r=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,h=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((f,d)=>{const p=r.get(f),_=dv(this.query,d)?d:null,v=!!p&&this.mutatedKeys.has(p.key),T=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let x=!1;p&&_?p.data.isEqual(_.data)?v!==T&&(i.track({type:3,doc:_}),x=!0):this.su(p,_)||(i.track({type:2,doc:_}),x=!0,(l&&this.eu(_,l)>0||h&&this.eu(_,h)<0)&&(a=!0)):!p&&_?(i.track({type:0,doc:_}),x=!0):p&&!_&&(i.track({type:1,doc:p}),x=!0,(l||h)&&(a=!0)),x&&(_?(o=o.add(_),s=T?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),i.track({type:1,doc:f})}return{tu:o,iu:i,Cs:a,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((f,d)=>function(_,v){const T=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Tt(20277,{Rt:x})}};return T(_)-T(v)}(f.type,d.type)||this.eu(f.doc,d.doc)),this.ou(i),r=r??!1;const a=t&&!r?this._u():[],l=this.Xa.size===0&&this.current&&!r?1:0,h=l!==this.Za;return this.Za=l,o.length!==0||h?{snapshot:new Wh(this.query,e.tu,s,o,e.mutatedKeys,l===0,h,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new lI,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=$t(),this.tu.forEach(i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))});const t=[];return e.forEach(i=>{this.Xa.has(i)||t.push(new FD(i))}),this.Xa.forEach(i=>{e.has(i)||t.push(new UD(i))}),t}cu(e){this.Ya=e.Qs,this.Xa=$t();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Wh.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const cT="SyncEngine";class vG{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class xG{constructor(e){this.key=e,this.hu=!1}}class SG{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Yu(a=>eD(a),fv),this.Iu=new Map,this.Eu=new Set,this.du=new zn(pt.comparator),this.Au=new Map,this.Ru=new Z1,this.Vu={},this.mu=new Map,this.fu=Gh.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function EG(n,e,t=!0){const i=WD(n);let r;const s=i.Tu.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.lu()):r=await VD(i,e,t,!0),r}async function wG(n,e){const t=WD(n);await VD(t,e,!0,!1)}async function VD(n,e,t,i){const r=await GH(n.localStore,mo(e)),s=r.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let a;return i&&(a=await TG(n,e,s,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&RD(n.remoteStore,r),a}async function TG(n,e,t,i,r){n.pu=(d,p,_)=>async function(T,x,y,w){let E=x.view.ru(y);E.Cs&&(E=await nI(T.localStore,x.query,!1).then(({documents:R})=>x.view.ru(R,E)));const I=w&&w.targetChanges.get(x.targetId),O=w&&w.targetMismatches.get(x.targetId)!=null,D=x.view.applyChanges(E,T.isPrimaryClient,I,O);return fI(T,x.targetId,D.au),D.snapshot}(n,d,p,_);const s=await nI(n.localStore,e,!0),o=new yG(e,s.Qs),a=o.ru(s.documents),l=Gp.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),h=o.applyChanges(a,n.isPrimaryClient,l);fI(n,t,h.au);const f=new vG(e,t,o);return n.Tu.set(e,f),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function MG(n,e,t){const i=Dt(n),r=i.Tu.get(e),s=i.Iu.get(r.targetId);if(s.length>1)return i.Iu.set(r.targetId,s.filter(o=>!fv(o,e))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await kE(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&iT(i.remoteStore,r.targetId),FE(i,r.targetId)}).catch(rf)):(FE(i,r.targetId),await kE(i.localStore,r.targetId,!0))}async function AG(n,e){const t=Dt(n),i=t.Tu.get(e),r=t.Iu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),iT(t.remoteStore,i.targetId))}async function CG(n,e,t){const i=DG(n);try{const r=await function(o,a){const l=Dt(o),h=wn.now(),f=a.reduce((_,v)=>_.add(v.key),$t());let d,p;return l.persistence.runTransaction("Locally write mutations","readwrite",_=>{let v=ra(),T=$t();return l.Ns.getEntries(_,f).next(x=>{v=x,v.forEach((y,w)=>{w.isValidDocument()||(T=T.add(y))})}).next(()=>l.localDocuments.getOverlayedDocuments(_,v)).next(x=>{d=x;const y=[];for(const w of a){const E=H6(w,d.get(w.key).overlayedDocument);E!=null&&y.push(new Tl(w.key,E,qN(E.value.mapValue),Ms.exists(!0)))}return l.mutationQueue.addMutationBatch(_,h,y,a)}).next(x=>{p=x;const y=x.applyToLocalDocumentSet(d,T);return l.documentOverlayCache.saveOverlays(_,x.batchId,y)})}).then(()=>({batchId:p.batchId,changes:iD(d)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),function(o,a,l){let h=o.Vu[o.currentUser.toKey()];h||(h=new zn(Yt)),h=h.insert(a,l),o.Vu[o.currentUser.toKey()]=h}(i,r.batchId,t),await jp(i,r.changes),await vv(i.remoteStore)}catch(r){const s=lT(r,"Failed to persist write");t.reject(s)}}async function zD(n,e){const t=Dt(n);try{const i=await zH(t.localStore,e);e.targetChanges.forEach((r,s)=>{const o=t.Au.get(s);o&&(hn(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?hn(o.hu,14607):r.removedDocuments.size>0&&(hn(o.hu,42227),o.hu=!1))}),await jp(t,i,e)}catch(i){await rf(i)}}function hI(n,e,t){const i=Dt(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach((s,o)=>{const a=o.view.va(e);a.snapshot&&r.push(a.snapshot)}),function(o,a){const l=Dt(o);l.onlineState=a;let h=!1;l.queries.forEach((f,d)=>{for(const p of d.Sa)p.va(a)&&(h=!0)}),h&&uT(l)}(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function RG(n,e,t){const i=Dt(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.Au.get(e),s=r&&r.key;if(s){let o=new zn(pt.comparator);o=o.insert(s,Ji.newNoDocument(s,Lt.min()));const a=$t().add(s),l=new gv(Lt.min(),new Map,new zn(Yt),o,a);await zD(i,l),i.du=i.du.remove(s),i.Au.delete(e),hT(i)}else await kE(i.localStore,e,!1).then(()=>FE(i,e,t)).catch(rf)}async function IG(n,e){const t=Dt(n),i=e.batch.batchId;try{const r=await VH(t.localStore,e);HD(t,i,null),BD(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await jp(t,r)}catch(r){await rf(r)}}async function PG(n,e,t){const i=Dt(n);try{const r=await function(o,a){const l=Dt(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let f;return l.mutationQueue.lookupMutationBatch(h,a).next(d=>(hn(d!==null,37113),f=d.keys(),l.mutationQueue.removeMutationBatch(h,d))).next(()=>l.mutationQueue.performConsistencyCheck(h)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(h,f,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f)).next(()=>l.localDocuments.getDocuments(h,f))})}(i.localStore,e);HD(i,e,t),BD(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await jp(i,r)}catch(r){await rf(r)}}function BD(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function HD(n,e,t){const i=Dt(n);let r=i.Vu[i.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}function FE(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach(i=>{n.Ru.containsKey(i)||GD(n,i)})}function GD(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(iT(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),hT(n))}function fI(n,e,t){for(const i of t)i instanceof UD?(n.Ru.addReference(i.key,e),bG(n,i)):i instanceof FD?(tt(cT,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||GD(n,i.key)):Tt(19791,{wu:i})}function bG(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(tt(cT,"New document in limbo: "+t),n.Eu.add(i),hT(n))}function hT(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new pt(xn.fromString(e)),i=n.fu.next();n.Au.set(i,new xG(t)),n.du=n.du.insert(t,i),RD(n.remoteStore,new Ba(mo(hv(t.path)),i,"TargetPurposeLimboResolution",lv.ce))}}async function jp(n,e,t){const i=Dt(n),r=[],s=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach((a,l)=>{o.push(i.pu(l,e,t).then(h=>{var f;if((h||t)&&i.isPrimaryClient){const d=h?!h.fromCache:(f=t==null?void 0:t.targetChanges.get(l.targetId))==null?void 0:f.current;i.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(h){r.push(h);const d=tT.As(l.targetId,h);s.push(d)}}))}),await Promise.all(o),i.Pu.H_(r),await async function(l,h){const f=Dt(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>Te.forEach(h,p=>Te.forEach(p.Es,_=>f.persistence.referenceDelegate.addReference(d,p.targetId,_)).next(()=>Te.forEach(p.ds,_=>f.persistence.referenceDelegate.removeReference(d,p.targetId,_)))))}catch(d){if(!sf(d))throw d;tt(nT,"Failed to update sequence numbers: "+d)}for(const d of h){const p=d.targetId;if(!d.fromCache){const _=f.Ms.get(p),v=_.snapshotVersion,T=_.withLastLimboFreeSnapshotVersion(v);f.Ms=f.Ms.insert(p,T)}}}(i.localStore,s))}async function LG(n,e){const t=Dt(n);if(!t.currentUser.isEqual(e)){tt(cT,"User change. New user:",e.toKey());const i=await TD(t.localStore,e);t.currentUser=e,function(s,o){s.mu.forEach(a=>{a.forEach(l=>{l.reject(new Xe(Se.CANCELLED,o))})}),s.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await jp(t,i.Ls)}}function NG(n,e){const t=Dt(n),i=t.Au.get(e);if(i&&i.hu)return $t().add(i.key);{let r=$t();const s=t.Iu.get(e);if(!s)return r;for(const o of s){const a=t.Tu.get(o);r=r.unionWith(a.view.nu)}return r}}function WD(n){const e=Dt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=zD.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=NG.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=RG.bind(null,e),e.Pu.H_=gG.bind(null,e.eventManager),e.Pu.yu=_G.bind(null,e.eventManager),e}function DG(n){const e=Dt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=IG.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=PG.bind(null,e),e}class Py{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=_v(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return FH(this.persistence,new kH,e.initialUser,this.serializer)}Cu(e){return new wD(eT.mi,this.serializer)}Du(e){return new jH}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Py.provider={build:()=>new Py};class kG extends Py{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){hn(this.persistence.referenceDelegate instanceof Ry,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new xH(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Rr.withCacheSize(this.cacheSizeBytes):Rr.DEFAULT;return new wD(i=>Ry.mi(i,t),this.serializer)}}class VE{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>hI(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=LG.bind(null,this.syncEngine),await dG(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new mG}()}createDatastore(e){const t=_v(e.databaseInfo.databaseId),i=function(s){return new KH(s)}(e.databaseInfo);return function(s,o,a,l){return new eG(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return function(i,r,s,o,a){return new nG(i,r,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>hI(this.syncEngine,t,0),function(){return sI.v()?new sI:new qH}())}createSyncEngine(e,t){return function(r,s,o,a,l,h,f){const d=new SG(r,s,o,a,l,h);return f&&(d.gu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(r){const s=Dt(r);tt(Hu,"RemoteStore shutting down."),s.Ea.add(5),await Wp(s),s.Aa.shutdown(),s.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}VE.provider={build:()=>new VE};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jD{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ia("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dl="FirestoreClient";class OG{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=Ki.UNAUTHENTICATED,this.clientId=H1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,async o=>{tt(dl,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(i,o=>(tt(dl,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new el;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=lT(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function Ix(n,e){n.asyncQueue.verifyOperationInProgress(),tt(dl,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(async r=>{i.isEqual(r)||(await TD(e.localStore,r),i=r)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function dI(n,e){n.asyncQueue.verifyOperationInProgress();const t=await UG(n);tt(dl,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>aI(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>aI(e.remoteStore,r)),n._onlineComponents=e}async function UG(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){tt(dl,"Using user provided OfflineComponentProvider");try{await Ix(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(r){return r.name==="FirebaseError"?r.code===Se.FAILED_PRECONDITION||r.code===Se.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;Vh("Error using user provided cache. Falling back to memory cache: "+t),await Ix(n,new Py)}}else tt(dl,"Using default OfflineComponentProvider"),await Ix(n,new kG(void 0));return n._offlineComponents}async function qD(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(tt(dl,"Using user provided OnlineComponentProvider"),await dI(n,n._uninitializedComponentsProvider._online)):(tt(dl,"Using default OnlineComponentProvider"),await dI(n,new VE))),n._onlineComponents}function FG(n){return qD(n).then(e=>e.syncEngine)}async function zE(n){const e=await qD(n),t=e.eventManager;return t.onListen=EG.bind(null,e.syncEngine),t.onUnlisten=MG.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=wG.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=AG.bind(null,e.syncEngine),t}function VG(n,e,t={}){const i=new el;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,h){const f=new jD({next:p=>{f.Nu(),o.enqueueAndForget(()=>kD(s,d));const _=p.docs.has(a);!_&&p.fromCache?h.reject(new Xe(Se.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&p.fromCache&&l&&l.source==="server"?h.reject(new Xe(Se.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(p)},error:p=>h.reject(p)}),d=new OD(hv(a.path),f,{includeMetadataChanges:!0,qa:!0});return DD(s,d)}(await zE(n),n.asyncQueue,e,t,i)),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XD(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pI=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YD="firestore.googleapis.com",mI=!0;class gI{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Xe(Se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=YD,this.ssl=mI}else this.host=e.host,this.ssl=e.ssl??mI;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=ED;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<yH)throw new Xe(Se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}n6("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=XD(e.experimentalLongPollingOptions??{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Xe(Se.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Xe(Se.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Xe(Se.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class xv{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gI({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Xe(Se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Xe(Se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gI(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new q5;switch(i.type){case"firstParty":return new K5(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Xe(Se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const i=pI.get(t);i&&(tt("ComponentProvider","Removing Datastore"),pI.delete(t),i.terminate())}(this),Promise.resolve()}}function zG(n,e,t,i={}){var h;n=Ts(n,xv);const r=Zh(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},a=`${e}:${t}`;r&&(BL(`https://${a}`),HL("Firestore",!0)),s.host!==YD&&s.host!==a&&Vh("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:r,emulatorOptions:i};if(!Uu(l,o)&&(n._setSettings(l),i.mockUserToken)){let f,d;if(typeof i.mockUserToken=="string")f=i.mockUserToken,d=Ki.MOCK_USER;else{f=sV(i.mockUserToken,(h=n._app)==null?void 0:h.options.projectId);const p=i.mockUserToken.sub||i.mockUserToken.user_id;if(!p)throw new Xe(Se.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Ki(p)}n._authCredentials=new X5(new DN(f,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Ml(this.firestore,e,this._query)}}class Xn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new tl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Xn(this.firestore,e,this._key)}toJSON(){return{type:Xn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Bp(t,Xn._jsonSchema))return new Xn(e,i||null,new pt(xn.fromString(t.referencePath)))}}Xn._jsonSchemaVersion="firestore/documentReference/1.0",Xn._jsonSchema={type:li("string",Xn._jsonSchemaVersion),referencePath:li("string")};class tl extends Ml{constructor(e,t,i){super(e,t,hv(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Xn(this.firestore,null,new pt(e))}withConverter(e){return new tl(this.firestore,e,this._path)}}function qK(n,e,...t){if(n=ci(n),kN("collection","path",e),n instanceof xv){const i=xn.fromString(e,...t);return IR(i),new tl(n,null,i)}{if(!(n instanceof Xn||n instanceof tl))throw new Xe(Se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(xn.fromString(e,...t));return IR(i),new tl(n.firestore,null,i)}}function BG(n,e,...t){if(n=ci(n),arguments.length===1&&(e=H1.newId()),kN("doc","path",e),n instanceof xv){const i=xn.fromString(e,...t);return RR(i),new Xn(n,null,new pt(i))}{if(!(n instanceof Xn||n instanceof tl))throw new Xe(Se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(xn.fromString(e,...t));return RR(i),new Xn(n.firestore,n instanceof tl?n.converter:null,new pt(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I="AsyncQueue";class yI{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new AD(this,"async_queue_retry"),this._c=()=>{const i=Rx();i&&tt(_I,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Rx();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Rx();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new el;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!sf(e))throw e;tt(_I,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(i=>{throw this.nc=i,this.rc=!1,ia("INTERNAL UNHANDLED ERROR: ",vI(i)),i}).then(i=>(this.rc=!1,i))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=aT.createAndSchedule(this,e,t,i,s=>this.hc(s));return this.tc.push(r),r}uc(){this.nc&&Tt(47125,{Pc:vI(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function vI(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xI(n){return function(t,i){if(typeof t!="object"||t===null)return!1;const r=t;for(const s of i)if(s in r&&typeof r[s]=="function")return!0;return!1}(n,["next","error","complete"])}class pl extends xv{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new yI,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new yI(e),this._firestoreClient=void 0,await e}}}function XK(n,e){const t=typeof n=="object"?n:jL(),i=typeof n=="string"?n:Sy,r=P1(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=iV("firestore");s&&zG(r,...s)}return r}function fT(n){if(n._terminated)throw new Xe(Se.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||HG(n),n._firestoreClient}function HG(n){var i,r,s;const e=n._freezeSettings(),t=function(a,l,h,f){return new d6(a,l,h,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,XD(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((s=e.localCache)!=null&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new OG(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new xs(Di.fromBase64String(e))}catch(t){throw new Xe(Se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new xs(Di.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:xs._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Bp(e,xs._jsonSchema))return xs.fromBase64String(e.bytes)}}xs._jsonSchemaVersion="firestore/bytes/1.0",xs._jsonSchema={type:li("string",xs._jsonSchemaVersion),bytes:li("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Xe(Se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bi(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dT{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Xe(Se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Xe(Se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Yt(this._lat,e._lat)||Yt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:_o._jsonSchemaVersion}}static fromJSON(e){if(Bp(e,_o._jsonSchema))return new _o(e.latitude,e.longitude)}}_o._jsonSchemaVersion="firestore/geoPoint/1.0",_o._jsonSchema={type:li("string",_o._jsonSchemaVersion),latitude:li("number"),longitude:li("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:yo._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Bp(e,yo._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new yo(e.vectorValues);throw new Xe(Se.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}yo._jsonSchemaVersion="firestore/vectorValue/1.0",yo._jsonSchema={type:li("string",yo._jsonSchemaVersion),vectorValues:li("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GG=/^__.*__$/;class WG{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Tl(e,this.data,this.fieldMask,t,this.fieldTransforms):new Hp(e,this.data,t,this.fieldTransforms)}}class $D{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Tl(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function KD(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Tt(40011,{Ac:n})}}class pT{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new pT({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return by(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(KD(this.Ac)&&GG.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class jG{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||_v(e)}Cc(e,t,i,r=!1){return new pT({Ac:e,methodName:t,Dc:i,path:bi.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ev(n){const e=n._freezeSettings(),t=_v(n._databaseId);return new jG(n._databaseId,!!e.ignoreUndefinedProperties,t)}function QD(n,e,t,i,r,s={}){const o=n.Cc(s.merge||s.mergeFields?2:0,e,t,r);mT("Data must be an object, but it was:",o,i);const a=JD(i,o);let l,h;if(s.merge)l=new Jr(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const d of s.mergeFields){const p=BE(e,d,t);if(!o.contains(p))throw new Xe(Se.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);e3(f,p)||f.push(p)}l=new Jr(f),h=o.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,h=o.fieldTransforms;return new WG(new Pr(a),l,h)}class wv extends dT{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof wv}}function qG(n,e,t,i){const r=n.Cc(1,e,t);mT("Data must be an object, but it was:",r,i);const s=[],o=Pr.empty();wl(i,(l,h)=>{const f=gT(e,l,t);h=ci(h);const d=r.yc(f);if(h instanceof wv)s.push(f);else{const p=qp(h,d);p!=null&&(s.push(f),o.set(f,p))}});const a=new Jr(s);return new $D(o,a,r.fieldTransforms)}function XG(n,e,t,i,r,s){const o=n.Cc(1,e,t),a=[BE(e,i,t)],l=[r];if(s.length%2!=0)throw new Xe(Se.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)a.push(BE(e,s[p])),l.push(s[p+1]);const h=[],f=Pr.empty();for(let p=a.length-1;p>=0;--p)if(!e3(h,a[p])){const _=a[p];let v=l[p];v=ci(v);const T=o.yc(_);if(v instanceof wv)h.push(_);else{const x=qp(v,T);x!=null&&(h.push(_),f.set(_,x))}}const d=new Jr(h);return new $D(f,d,o.fieldTransforms)}function YG(n,e,t,i=!1){return qp(t,n.Cc(i?4:3,e))}function qp(n,e){if(ZD(n=ci(n)))return mT("Unsupported field value:",e,n),JD(n,e);if(n instanceof dT)return function(i,r){if(!KD(r.Ac))throw r.Sc(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(i,r){const s=[];let o=0;for(const a of i){let l=qp(a,r.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(n,e)}return function(i,r){if((i=ci(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return O6(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=wn.fromDate(i);return{timestampValue:Cy(r.serializer,s)}}if(i instanceof wn){const s=new wn(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Cy(r.serializer,s)}}if(i instanceof _o)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof xs)return{bytesValue:mD(r.serializer,i._byteString)};if(i instanceof Xn){const s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:J1(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof yo)return function(o,a){return{mapValue:{fields:{[WN]:{stringValue:jN},[Ey]:{arrayValue:{values:o.toArray().map(h=>{if(typeof h!="number")throw a.Sc("VectorValues must only contain numeric values.");return Y1(a.serializer,h)})}}}}}}(i,r);throw r.Sc(`Unsupported field value: ${av(i)}`)}(n,e)}function JD(n,e){const t={};return FN(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wl(n,(i,r)=>{const s=qp(r,e.mc(i));s!=null&&(t[i]=s)}),{mapValue:{fields:t}}}function ZD(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof wn||n instanceof _o||n instanceof xs||n instanceof Xn||n instanceof dT||n instanceof yo)}function mT(n,e,t){if(!ZD(t)||!ON(t)){const i=av(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function BE(n,e,t){if((e=ci(e))instanceof Sv)return e._internalPath;if(typeof e=="string")return gT(n,e);throw by("Field path arguments must be of type string or ",n,!1,void 0,t)}const $G=new RegExp("[~\\*/\\[\\]]");function gT(n,e,t){if(e.search($G)>=0)throw by(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Sv(...e.split("."))._internalPath}catch{throw by(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function by(n,e,t,i,r){const s=i&&!i.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${i}`),o&&(l+=` in document ${r}`),l+=")"),new Xe(Se.INVALID_ARGUMENT,a+n+l)}function e3(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t3{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Xn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new KG(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(_T("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class KG extends t3{data(){return super.data()}}function _T(n,e){return typeof e=="string"?gT(n,e):e instanceof Sv?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QG(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Xe(Se.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class yT{}class vT extends yT{}function YK(n,e,...t){let i=[];e instanceof yT&&i.push(e),i=i.concat(t),function(s){const o=s.filter(l=>l instanceof ST).length,a=s.filter(l=>l instanceof xT).length;if(o>1||o>0&&a>0)throw new Xe(Se.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)n=r._apply(n);return n}class xT extends vT{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new xT(e,t,i)}_apply(e){const t=this._parse(e);return n3(e._query,t),new Ml(e.firestore,e.converter,PE(e._query,t))}_parse(e){const t=Ev(e.firestore);return function(s,o,a,l,h,f,d){let p;if(h.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new Xe(Se.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){EI(d,f);const v=[];for(const T of d)v.push(SI(l,s,T));p={arrayValue:{values:v}}}else p=SI(l,s,d)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||EI(d,f),p=YG(a,o,d,f==="in"||f==="not-in");return ai.create(h,f,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class ST extends yT{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new ST(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:Ys.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(r,s){let o=r;const a=s.getFlattenedFilters();for(const l of a)n3(o,l),o=PE(o,l)}(e._query,t),new Ml(e.firestore,e.converter,PE(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class ET extends vT{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new ET(e,t)}_apply(e){const t=function(r,s,o){if(r.startAt!==null)throw new Xe(Se.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new Xe(Se.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new sp(s,o)}(e._query,this._field,this._direction);return new Ml(e.firestore,e.converter,function(r,s){const o=r.explicitOrderBy.concat([s]);return new of(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}function $K(n,e="asc"){const t=e,i=_T("orderBy",n);return ET._create(i,t)}class wT extends vT{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new wT(e,t,i)}_apply(e){return new Ml(e.firestore,e.converter,Ty(e._query,this._limit,this._limitType))}}function KK(n){return wT._create("limit",n,"F")}function SI(n,e,t){if(typeof(t=ci(t))=="string"){if(t==="")throw new Xe(Se.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ZN(e)&&t.indexOf("/")!==-1)throw new Xe(Se.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(xn.fromString(t));if(!pt.isDocumentKey(i))throw new Xe(Se.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return UR(n,new pt(i))}if(t instanceof Xn)return UR(n,t._key);throw new Xe(Se.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${av(t)}.`)}function EI(n,e){if(!Array.isArray(n)||n.length===0)throw new Xe(Se.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function n3(n,e){const t=function(r,s){for(const o of r)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Xe(Se.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Xe(Se.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class JG{convertValue(e,t="none"){switch(hl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Jn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(cl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Tt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return wl(e,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertVectorValue(e){var i,r,s;const t=(s=(r=(i=e.fields)==null?void 0:i[Ey].arrayValue)==null?void 0:r.values)==null?void 0:s.map(o=>Jn(o.doubleValue));return new yo(t)}convertGeoPoint(e){return new _o(Jn(e.latitude),Jn(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=cv(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(np(e));default:return null}}convertTimestamp(e){const t=ul(e);return new wn(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=xn.fromString(e);hn(SD(i),9688,{name:e});const r=new ip(i.get(1),i.get(3)),s=new pt(i.popFirst(5));return r.isEqual(t)||ia(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i3(n,e,t){let i;return i=n?n.toFirestore(e):e,i}class pd{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Mu extends t3{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new N_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(_T("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Xe(Se.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Mu._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Mu._jsonSchemaVersion="firestore/documentSnapshot/1.0",Mu._jsonSchema={type:li("string",Mu._jsonSchemaVersion),bundleSource:li("string","DocumentSnapshot"),bundleName:li("string"),bundle:li("string")};class N_ extends Mu{data(e={}){return super.data(e)}}class Rh{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new pd(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new N_(this._firestore,this._userDataWriter,i.key,i,new pd(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Xe(Se.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(a=>{const l=new N_(r._firestore,r._userDataWriter,a.doc.key,a.doc,new pd(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new N_(r._firestore,r._userDataWriter,a.doc.key,a.doc,new pd(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,f=-1;return a.type!==0&&(h=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),f=o.indexOf(a.doc.key)),{type:ZG(a.type),doc:l,oldIndex:h,newIndex:f}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Xe(Se.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Rh._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=H1.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach(s=>{s._document!==null&&(t.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),r.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function ZG(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Tt(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QK(n){n=Ts(n,Xn);const e=Ts(n.firestore,pl);return VG(fT(e),n._key).then(t=>s3(e,n,t))}Rh._jsonSchemaVersion="firestore/querySnapshot/1.0",Rh._jsonSchema={type:li("string",Rh._jsonSchemaVersion),bundleSource:li("string","QuerySnapshot"),bundleName:li("string"),bundle:li("string")};class r3 extends JG{constructor(e){super(),this.firestore=e}convertBytes(e){return new xs(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Xn(this.firestore,null,t)}}function JK(n,e,t){n=Ts(n,Xn);const i=Ts(n.firestore,pl),r=i3(n.converter,e);return Tv(i,[QD(Ev(i),"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,Ms.none())])}function ZK(n,e,t,...i){n=Ts(n,Xn);const r=Ts(n.firestore,pl),s=Ev(r);let o;return o=typeof(e=ci(e))=="string"||e instanceof Sv?XG(s,"updateDoc",n._key,e,t,i):qG(s,"updateDoc",n._key,e),Tv(r,[o.toMutation(n._key,Ms.exists(!0))])}function eQ(n){return Tv(Ts(n.firestore,pl),[new $1(n._key,Ms.none())])}function tQ(n,e){const t=Ts(n.firestore,pl),i=BG(n),r=i3(n.converter,e);return Tv(t,[QD(Ev(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,Ms.exists(!1))]).then(()=>i)}function nQ(n,...e){var l,h,f;n=ci(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||xI(e[i])||(t=e[i++]);const r={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(xI(e[i])){const d=e[i];e[i]=(l=d.next)==null?void 0:l.bind(d),e[i+1]=(h=d.error)==null?void 0:h.bind(d),e[i+2]=(f=d.complete)==null?void 0:f.bind(d)}let s,o,a;if(n instanceof Xn)o=Ts(n.firestore,pl),a=hv(n._key.path),s={next:d=>{e[i]&&e[i](s3(o,n,d))},error:e[i+1],complete:e[i+2]};else{const d=Ts(n,Ml);o=Ts(d.firestore,pl),a=d._query;const p=new r3(o);s={next:_=>{e[i]&&e[i](new Rh(o,p,d,_))},error:e[i+1],complete:e[i+2]},QG(n._query)}return function(p,_,v,T){const x=new jD(T),y=new OD(_,x,v);return p.asyncQueue.enqueueAndForget(async()=>DD(await zE(p),y)),()=>{x.Nu(),p.asyncQueue.enqueueAndForget(async()=>kD(await zE(p),y))}}(fT(o),a,r,s)}function Tv(n,e){return function(i,r){const s=new el;return i.asyncQueue.enqueueAndForget(async()=>CG(await FG(i),r,s)),s.promise}(fT(n),e)}function s3(n,e,t){const i=t.docs.get(e._key),r=new r3(n);return new Mu(n,r,e._key,i,new pd(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(r){nf=r})(ef),Uh(new Fu("firestore",(i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),a=new pl(new Y5(i.getProvider("auth-internal")),new Q5(o,i.getProvider("app-check-internal")),function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Xe(Se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ip(h.options.projectId,f)}(o,r),o);return s={useFetchStreams:t,...s},a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Ja(TR,MR,e),Ja(TR,MR,"esm2020")})();/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e9=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),t9=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),wI=n=>{const e=t9(n);return e.charAt(0).toUpperCase()+e.slice(1)},o3=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),n9=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var i9={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r9=pe.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:o,...a},l)=>pe.createElement("svg",{ref:l,...i9,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:o3("lucide",r),...!s&&!n9(a)&&{"aria-hidden":"true"},...a},[...o.map(([h,f])=>pe.createElement(h,f)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=(n,e)=>{const t=pe.forwardRef(({className:i,...r},s)=>pe.createElement(r9,{ref:s,iconNode:e,className:o3(`lucide-${e9(wI(n))}`,`lucide-${n}`,i),...r}));return t.displayName=wI(n),t};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s9=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],iQ=Zt("arrow-left",s9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o9=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],rQ=Zt("bell",o9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a9=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],sQ=Zt("book-open",a9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l9=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],oQ=Zt("briefcase",l9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u9=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],aQ=Zt("calendar",u9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c9=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],lQ=Zt("chevron-down",c9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h9=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],uQ=Zt("chevron-right",h9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f9=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],cQ=Zt("clock",f9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d9=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],hQ=Zt("cloud",d9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p9=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],fQ=Zt("code",p9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m9=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],dQ=Zt("coffee",m9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g9=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]],pQ=Zt("heading-1",g9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _9=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]],mQ=Zt("heading-2",_9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y9=[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]],gQ=Zt("heading-3",y9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v9=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],_Q=Zt("image",v9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x9=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],yQ=Zt("info",x9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S9=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],vQ=Zt("log-in",S9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E9=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],xQ=Zt("log-out",E9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w9=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],SQ=Zt("map-pin",w9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T9=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],EQ=Zt("pause",T9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M9=[["path",{d:"M13 4v16",key:"8vvj80"}],["path",{d:"M17 4v16",key:"7dpous"}],["path",{d:"M19 4H9.5a4.5 4.5 0 0 0 0 9H13",key:"sh4n9v"}]],wQ=Zt("pilcrow",M9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A9=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],TQ=Zt("play",A9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C9=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],MQ=Zt("plus",C9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R9=[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]],AQ=Zt("quote",R9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I9=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],CQ=Zt("refresh-cw",I9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P9=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],RQ=Zt("rotate-ccw",P9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b9=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],IQ=Zt("save",b9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L9=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],PQ=Zt("settings-2",L9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N9=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],bQ=Zt("settings",N9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D9=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],LQ=Zt("square-pen",D9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k9=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],NQ=Zt("sun",k9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O9=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],DQ=Zt("trash-2",O9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U9=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],kQ=Zt("user",U9);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F9=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],OQ=Zt("x",F9);/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const lf="161",ou={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},au={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},a3=0,HE=1,l3=2,V9=3,u3=0,Mv=1,bd=2,Fs=3,sa=0,_r=1,lo=2,Ko=0,Au=1,Ly=2,GE=3,WE=4,c3=5,Fa=100,h3=101,f3=102,jE=103,qE=104,d3=200,p3=201,m3=202,g3=203,Ny=204,Dy=205,_3=206,y3=207,v3=208,x3=209,S3=210,E3=211,w3=212,T3=213,M3=214,A3=0,C3=1,R3=2,lp=3,I3=4,P3=5,b3=6,L3=7,Xp=0,N3=1,D3=2,vo=0,k3=1,O3=2,U3=3,TT=4,F3=5,V3=6,XE="attached",z3="detached",Av=300,oa=301,ml=302,up=303,cp=304,uf=306,hp=1e3,Zi=1001,fp=1002,Zn=1003,ky=1004,z9=1004,hu=1005,B9=1005,On=1006,Ld=1007,H9=1007,uo=1008,G9=1008,xo=1009,B3=1010,H3=1011,Cv=1012,MT=1013,qo=1014,Ss=1015,jh=1016,AT=1017,CT=1018,nl=1020,G3=1021,pr=1023,W3=1024,j3=1025,il=1026,Gu=1027,q3=1028,RT=1029,X3=1030,IT=1031,PT=1033,D_=33776,k_=33777,O_=33778,U_=33779,YE=35840,$E=35841,KE=35842,QE=35843,bT=36196,JE=37492,ZE=37496,ew=37808,tw=37809,nw=37810,iw=37811,rw=37812,sw=37813,ow=37814,aw=37815,lw=37816,uw=37817,cw=37818,hw=37819,fw=37820,dw=37821,F_=36492,pw=36494,mw=36495,Y3=36283,gw=36284,_w=36285,yw=36286,$3=2200,K3=2201,Q3=2202,dp=2300,pp=2301,V_=2302,yu=2400,vu=2401,mp=2402,Rv=2500,LT=2501,W9=0,j9=1,q9=2,NT=3e3,rl=3001,J3=3200,Z3=3201,Al=0,ek=1,$r="",di="srgb",wo="srgb-linear",Iv="display-p3",Yp="display-p3-linear",gp="linear",yn="srgb",_p="rec709",yp="p3",X9=0,lu=7680,Y9=7681,$9=7682,K9=7683,Q9=34055,J9=34056,Z9=5386,e8=512,t8=513,n8=514,i8=515,r8=516,s8=517,o8=518,vw=519,tk=512,nk=513,ik=514,DT=515,rk=516,sk=517,ok=518,ak=519,vp=35044,xw=35048,a8=35040,l8=35045,u8=35049,c8=35041,h8=35046,f8=35050,d8=35042,p8="100",Sw="300 es",Oy=1035,co=2e3,xp=2001;let ha=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}};const Xi=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let TI=1234567;const Cu=Math.PI/180,qh=180/Math.PI;function es(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Xi[n&255]+Xi[n>>8&255]+Xi[n>>16&255]+Xi[n>>24&255]+"-"+Xi[e&255]+Xi[e>>8&255]+"-"+Xi[e>>16&15|64]+Xi[e>>24&255]+"-"+Xi[t&63|128]+Xi[t>>8&255]+"-"+Xi[t>>16&255]+Xi[t>>24&255]+Xi[i&255]+Xi[i>>8&255]+Xi[i>>16&255]+Xi[i>>24&255]).toLowerCase()}function qn(n,e,t){return Math.max(e,Math.min(t,n))}function kT(n,e){return(n%e+e)%e}function m8(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)}function g8(n,e,t){return n!==e?(t-n)/(e-n):0}function Nd(n,e,t){return(1-t)*n+t*e}function _8(n,e,t,i){return Nd(n,e,1-Math.exp(-t*i))}function y8(n,e=1){return e-Math.abs(kT(n,e*2)-e)}function v8(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function x8(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function S8(n,e){return n+Math.floor(Math.random()*(e-n+1))}function E8(n,e){return n+Math.random()*(e-n)}function w8(n){return n*(.5-Math.random())}function T8(n){n!==void 0&&(TI=n);let e=TI+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function M8(n){return n*Cu}function A8(n){return n*qh}function Ew(n){return(n&n-1)===0&&n!==0}function C8(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Uy(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function R8(n,e,t,i,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),h=s((e+i)/2),f=o((e+i)/2),d=s((e-i)/2),p=o((e-i)/2),_=s((i-e)/2),v=o((i-e)/2);switch(r){case"XYX":n.set(a*f,l*d,l*p,a*h);break;case"YZY":n.set(l*p,a*f,l*d,a*h);break;case"ZXZ":n.set(l*d,l*p,a*f,a*h);break;case"XZX":n.set(a*f,l*v,l*_,a*h);break;case"YXY":n.set(l*_,a*f,l*v,a*h);break;case"ZYZ":n.set(l*v,l*_,a*f,a*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function mr(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Ft(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const OT={DEG2RAD:Cu,RAD2DEG:qh,generateUUID:es,clamp:qn,euclideanModulo:kT,mapLinear:m8,inverseLerp:g8,lerp:Nd,damp:_8,pingpong:y8,smoothstep:v8,smootherstep:x8,randInt:S8,randFloat:E8,randFloatSpread:w8,seededRandom:T8,degToRad:M8,radToDeg:A8,isPowerOfTwo:Ew,ceilPowerOfTwo:C8,floorPowerOfTwo:Uy,setQuaternionFromProperEuler:R8,normalize:Ft,denormalize:mr};class ge{constructor(e=0,t=0){ge.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(qn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Bt{constructor(e,t,i,r,s,o,a,l,h){Bt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,h)}set(e,t,i,r,s,o,a,l,h){const f=this.elements;return f[0]=e,f[1]=r,f[2]=a,f[3]=t,f[4]=s,f[5]=l,f[6]=i,f[7]=o,f[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],h=i[1],f=i[4],d=i[7],p=i[2],_=i[5],v=i[8],T=r[0],x=r[3],y=r[6],w=r[1],E=r[4],I=r[7],O=r[2],D=r[5],R=r[8];return s[0]=o*T+a*w+l*O,s[3]=o*x+a*E+l*D,s[6]=o*y+a*I+l*R,s[1]=h*T+f*w+d*O,s[4]=h*x+f*E+d*D,s[7]=h*y+f*I+d*R,s[2]=p*T+_*w+v*O,s[5]=p*x+_*E+v*D,s[8]=p*y+_*I+v*R,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],h=e[7],f=e[8];return t*o*f-t*a*h-i*s*f+i*a*l+r*s*h-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],h=e[7],f=e[8],d=f*o-a*h,p=a*l-f*s,_=h*s-o*l,v=t*d+i*p+r*_;if(v===0)return this.set(0,0,0,0,0,0,0,0,0);const T=1/v;return e[0]=d*T,e[1]=(r*h-f*i)*T,e[2]=(a*i-r*o)*T,e[3]=p*T,e[4]=(f*t-r*l)*T,e[5]=(r*s-a*t)*T,e[6]=_*T,e[7]=(i*l-h*t)*T,e[8]=(o*t-i*s)*T,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),h=Math.sin(s);return this.set(i*l,i*h,-i*(l*o+h*a)+o+e,-r*h,r*l,-r*(-h*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(Px.makeScale(e,t)),this}rotate(e){return this.premultiply(Px.makeRotation(-e)),this}translate(e,t){return this.premultiply(Px.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const Px=new Bt;function lk(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const I8={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function fh(n,e){return new I8[n](e)}function Sp(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function uk(){const n=Sp("canvas");return n.style.display="block",n}const MI={};function Ru(n){n in MI||(MI[n]=!0,console.warn(n))}const AI=new Bt().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),CI=new Bt().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),gg={[wo]:{transfer:gp,primaries:_p,toReference:n=>n,fromReference:n=>n},[di]:{transfer:yn,primaries:_p,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[Yp]:{transfer:gp,primaries:yp,toReference:n=>n.applyMatrix3(CI),fromReference:n=>n.applyMatrix3(AI)},[Iv]:{transfer:yn,primaries:yp,toReference:n=>n.convertSRGBToLinear().applyMatrix3(CI),fromReference:n=>n.applyMatrix3(AI).convertLinearToSRGB()}},P8=new Set([wo,Yp]),dn={enabled:!0,_workingColorSpace:wo,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!P8.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const i=gg[e].toReference,r=gg[t].fromReference;return r(i(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return gg[n].primaries},getTransfer:function(n){return n===$r?gp:gg[n].transfer}};function Ih(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function bx(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Ac;class UT{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Ac===void 0&&(Ac=Sp("canvas")),Ac.width=e.width,Ac.height=e.height;const i=Ac.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Ac}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Sp("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Ih(s[o]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(Ih(t[i]/255)*255):t[i]=Ih(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let b8=0;class xu{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:b8++}),this.uuid=es(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(Lx(r[o].image)):s.push(Lx(r[o]))}else s=Lx(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function Lx(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?UT.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let L8=0;class Pn extends ha{constructor(e=Pn.DEFAULT_IMAGE,t=Pn.DEFAULT_MAPPING,i=Zi,r=Zi,s=On,o=uo,a=pr,l=xo,h=Pn.DEFAULT_ANISOTROPY,f=$r){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:L8++}),this.uuid=es(),this.name="",this.source=new xu(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=h,this.format=a,this.internalFormat=null,this.type=l,this.offset=new ge(0,0),this.repeat=new ge(1,1),this.center=new ge(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Bt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof f=="string"?this.colorSpace=f:(Ru("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=f===rl?di:$r),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Av)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case hp:e.x=e.x-Math.floor(e.x);break;case Zi:e.x=e.x<0?0:1;break;case fp:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case hp:e.y=e.y-Math.floor(e.y);break;case Zi:e.y=e.y<0?0:1;break;case fp:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Ru("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===di?rl:NT}set encoding(e){Ru("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===rl?di:$r}}Pn.DEFAULT_IMAGE=null;Pn.DEFAULT_MAPPING=Av;Pn.DEFAULT_ANISOTROPY=1;class cn{constructor(e=0,t=0,i=0,r=1){cn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,h=l[0],f=l[4],d=l[8],p=l[1],_=l[5],v=l[9],T=l[2],x=l[6],y=l[10];if(Math.abs(f-p)<.01&&Math.abs(d-T)<.01&&Math.abs(v-x)<.01){if(Math.abs(f+p)<.1&&Math.abs(d+T)<.1&&Math.abs(v+x)<.1&&Math.abs(h+_+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const E=(h+1)/2,I=(_+1)/2,O=(y+1)/2,D=(f+p)/4,R=(d+T)/4,b=(v+x)/4;return E>I&&E>O?E<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(E),r=D/i,s=R/i):I>O?I<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(I),i=D/r,s=b/r):O<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(O),i=R/s,r=b/s),this.set(i,r,s,t),this}let w=Math.sqrt((x-v)*(x-v)+(d-T)*(d-T)+(p-f)*(p-f));return Math.abs(w)<.001&&(w=1),this.x=(x-v)/w,this.y=(d-T)/w,this.z=(p-f)/w,this.w=Math.acos((h+_+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class ck extends ha{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new cn(0,0,e,t),this.scissorTest=!1,this.viewport=new cn(0,0,e,t);const r={width:e,height:t,depth:1};i.encoding!==void 0&&(Ru("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===rl?di:$r),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:On,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new Pn(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new xu(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class $s extends ck{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class Pv extends Pn{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Zn,this.minFilter=Zn,this.wrapR=Zi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class N8 extends $s{constructor(e=1,t=1,i=1,r={}){super(e,t,r),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new Pv(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class FT extends Pn{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Zn,this.minFilter=Zn,this.wrapR=Zi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class D8 extends $s{constructor(e=1,t=1,i=1,r={}){super(e,t,r),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new FT(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class k8 extends $s{constructor(e=1,t=1,i=1,r={}){super(e,t,r),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<i;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,i=e.texture.length;t<i;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class gi{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],h=i[r+1],f=i[r+2],d=i[r+3];const p=s[o+0],_=s[o+1],v=s[o+2],T=s[o+3];if(a===0){e[t+0]=l,e[t+1]=h,e[t+2]=f,e[t+3]=d;return}if(a===1){e[t+0]=p,e[t+1]=_,e[t+2]=v,e[t+3]=T;return}if(d!==T||l!==p||h!==_||f!==v){let x=1-a;const y=l*p+h*_+f*v+d*T,w=y>=0?1:-1,E=1-y*y;if(E>Number.EPSILON){const O=Math.sqrt(E),D=Math.atan2(O,y*w);x=Math.sin(x*D)/O,a=Math.sin(a*D)/O}const I=a*w;if(l=l*x+p*I,h=h*x+_*I,f=f*x+v*I,d=d*x+T*I,x===1-a){const O=1/Math.sqrt(l*l+h*h+f*f+d*d);l*=O,h*=O,f*=O,d*=O}}e[t]=l,e[t+1]=h,e[t+2]=f,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],h=i[r+2],f=i[r+3],d=s[o],p=s[o+1],_=s[o+2],v=s[o+3];return e[t]=a*v+f*d+l*_-h*p,e[t+1]=l*v+f*p+h*d-a*_,e[t+2]=h*v+f*_+a*p-l*d,e[t+3]=f*v-a*d-l*p-h*_,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,h=a(i/2),f=a(r/2),d=a(s/2),p=l(i/2),_=l(r/2),v=l(s/2);switch(o){case"XYZ":this._x=p*f*d+h*_*v,this._y=h*_*d-p*f*v,this._z=h*f*v+p*_*d,this._w=h*f*d-p*_*v;break;case"YXZ":this._x=p*f*d+h*_*v,this._y=h*_*d-p*f*v,this._z=h*f*v-p*_*d,this._w=h*f*d+p*_*v;break;case"ZXY":this._x=p*f*d-h*_*v,this._y=h*_*d+p*f*v,this._z=h*f*v+p*_*d,this._w=h*f*d-p*_*v;break;case"ZYX":this._x=p*f*d-h*_*v,this._y=h*_*d+p*f*v,this._z=h*f*v-p*_*d,this._w=h*f*d+p*_*v;break;case"YZX":this._x=p*f*d+h*_*v,this._y=h*_*d+p*f*v,this._z=h*f*v-p*_*d,this._w=h*f*d-p*_*v;break;case"XZY":this._x=p*f*d-h*_*v,this._y=h*_*d-p*f*v,this._z=h*f*v+p*_*d,this._w=h*f*d+p*_*v;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],h=t[2],f=t[6],d=t[10],p=i+a+d;if(p>0){const _=.5/Math.sqrt(p+1);this._w=.25/_,this._x=(f-l)*_,this._y=(s-h)*_,this._z=(o-r)*_}else if(i>a&&i>d){const _=2*Math.sqrt(1+i-a-d);this._w=(f-l)/_,this._x=.25*_,this._y=(r+o)/_,this._z=(s+h)/_}else if(a>d){const _=2*Math.sqrt(1+a-i-d);this._w=(s-h)/_,this._x=(r+o)/_,this._y=.25*_,this._z=(l+f)/_}else{const _=2*Math.sqrt(1+d-i-a);this._w=(o-r)/_,this._x=(s+h)/_,this._y=(l+f)/_,this._z=.25*_}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(qn(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,h=t._z,f=t._w;return this._x=i*f+o*a+r*h-s*l,this._y=r*f+o*l+s*a-i*h,this._z=s*f+o*h+i*l-r*a,this._w=o*f-i*a-r*l-s*h,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const _=1-t;return this._w=_*o+t*this._w,this._x=_*i+t*this._x,this._y=_*r+t*this._y,this._z=_*s+t*this._z,this.normalize(),this}const h=Math.sqrt(l),f=Math.atan2(h,a),d=Math.sin((1-t)*f)/h,p=Math.sin(t*f)/h;return this._w=o*d+this._w*p,this._x=i*d+this._x*p,this._y=r*d+this._y*p,this._z=s*d+this._z*p,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class G{constructor(e=0,t=0,i=0){G.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(RI.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(RI.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,h=2*(o*r-a*i),f=2*(a*t-s*r),d=2*(s*i-o*t);return this.x=t+l*h+o*d-a*f,this.y=i+l*f+a*h-s*d,this.z=r+l*d+s*f-o*h,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return Nx.copy(this).projectOnVector(e),this.sub(Nx)}reflect(e){return this.sub(Nx.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(qn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Nx=new G,RI=new gi;class yr{constructor(e=new G(1/0,1/0,1/0),t=new G(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Ds.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Ds.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Ds.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const s=i.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Ds):Ds.fromBufferAttribute(s,o),Ds.applyMatrix4(e.matrixWorld),this.expandByPoint(Ds);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),_g.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),_g.copy(i.boundingBox)),_g.applyMatrix4(e.matrixWorld),this.union(_g)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Ds),Ds.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Wf),yg.subVectors(this.max,Wf),Cc.subVectors(e.a,Wf),Rc.subVectors(e.b,Wf),Ic.subVectors(e.c,Wf),Ea.subVectors(Rc,Cc),wa.subVectors(Ic,Rc),Xl.subVectors(Cc,Ic);let t=[0,-Ea.z,Ea.y,0,-wa.z,wa.y,0,-Xl.z,Xl.y,Ea.z,0,-Ea.x,wa.z,0,-wa.x,Xl.z,0,-Xl.x,-Ea.y,Ea.x,0,-wa.y,wa.x,0,-Xl.y,Xl.x,0];return!Dx(t,Cc,Rc,Ic,yg)||(t=[1,0,0,0,1,0,0,0,1],!Dx(t,Cc,Rc,Ic,yg))?!1:(vg.crossVectors(Ea,wa),t=[vg.x,vg.y,vg.z],Dx(t,Cc,Rc,Ic,yg))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ds).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Ds).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Lo[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Lo[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Lo[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Lo[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Lo[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Lo[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Lo[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Lo[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Lo),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Lo=[new G,new G,new G,new G,new G,new G,new G,new G],Ds=new G,_g=new yr,Cc=new G,Rc=new G,Ic=new G,Ea=new G,wa=new G,Xl=new G,Wf=new G,yg=new G,vg=new G,Yl=new G;function Dx(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Yl.fromArray(n,s);const a=r.x*Math.abs(Yl.x)+r.y*Math.abs(Yl.y)+r.z*Math.abs(Yl.z),l=e.dot(Yl),h=t.dot(Yl),f=i.dot(Yl);if(Math.max(-Math.max(l,h,f),Math.min(l,h,f))>a)return!1}return!0}const O8=new yr,jf=new G,kx=new G;class er{constructor(e=new G,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):O8.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;jf.subVectors(e,this.center);const t=jf.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.addScaledVector(jf,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(kx.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(jf.copy(e.center).add(kx)),this.expandByPoint(jf.copy(e.center).sub(kx))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const No=new G,Ox=new G,xg=new G,Ta=new G,Ux=new G,Sg=new G,Fx=new G;class Ku{constructor(e=new G,t=new G(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,No)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=No.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(No.copy(this.origin).addScaledVector(this.direction,t),No.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){Ox.copy(e).add(t).multiplyScalar(.5),xg.copy(t).sub(e).normalize(),Ta.copy(this.origin).sub(Ox);const s=e.distanceTo(t)*.5,o=-this.direction.dot(xg),a=Ta.dot(this.direction),l=-Ta.dot(xg),h=Ta.lengthSq(),f=Math.abs(1-o*o);let d,p,_,v;if(f>0)if(d=o*l-a,p=o*a-l,v=s*f,d>=0)if(p>=-v)if(p<=v){const T=1/f;d*=T,p*=T,_=d*(d+o*p+2*a)+p*(o*d+p+2*l)+h}else p=s,d=Math.max(0,-(o*p+a)),_=-d*d+p*(p+2*l)+h;else p=-s,d=Math.max(0,-(o*p+a)),_=-d*d+p*(p+2*l)+h;else p<=-v?(d=Math.max(0,-(-o*s+a)),p=d>0?-s:Math.min(Math.max(-s,-l),s),_=-d*d+p*(p+2*l)+h):p<=v?(d=0,p=Math.min(Math.max(-s,-l),s),_=p*(p+2*l)+h):(d=Math.max(0,-(o*s+a)),p=d>0?s:Math.min(Math.max(-s,-l),s),_=-d*d+p*(p+2*l)+h);else p=o>0?-s:s,d=Math.max(0,-(o*p+a)),_=-d*d+p*(p+2*l)+h;return i&&i.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(Ox).addScaledVector(xg,p),_}intersectSphere(e,t){No.subVectors(e.center,this.origin);const i=No.dot(this.direction),r=No.dot(No)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const h=1/this.direction.x,f=1/this.direction.y,d=1/this.direction.z,p=this.origin;return h>=0?(i=(e.min.x-p.x)*h,r=(e.max.x-p.x)*h):(i=(e.max.x-p.x)*h,r=(e.min.x-p.x)*h),f>=0?(s=(e.min.y-p.y)*f,o=(e.max.y-p.y)*f):(s=(e.max.y-p.y)*f,o=(e.min.y-p.y)*f),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),d>=0?(a=(e.min.z-p.z)*d,l=(e.max.z-p.z)*d):(a=(e.max.z-p.z)*d,l=(e.min.z-p.z)*d),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,No)!==null}intersectTriangle(e,t,i,r,s){Ux.subVectors(t,e),Sg.subVectors(i,e),Fx.crossVectors(Ux,Sg);let o=this.direction.dot(Fx),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Ta.subVectors(this.origin,e);const l=a*this.direction.dot(Sg.crossVectors(Ta,Sg));if(l<0)return null;const h=a*this.direction.dot(Ux.cross(Ta));if(h<0||l+h>o)return null;const f=-a*Ta.dot(Fx);return f<0?null:this.at(f/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Mt{constructor(e,t,i,r,s,o,a,l,h,f,d,p,_,v,T,x){Mt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,h,f,d,p,_,v,T,x)}set(e,t,i,r,s,o,a,l,h,f,d,p,_,v,T,x){const y=this.elements;return y[0]=e,y[4]=t,y[8]=i,y[12]=r,y[1]=s,y[5]=o,y[9]=a,y[13]=l,y[2]=h,y[6]=f,y[10]=d,y[14]=p,y[3]=_,y[7]=v,y[11]=T,y[15]=x,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Mt().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/Pc.setFromMatrixColumn(e,0).length(),s=1/Pc.setFromMatrixColumn(e,1).length(),o=1/Pc.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),h=Math.sin(r),f=Math.cos(s),d=Math.sin(s);if(e.order==="XYZ"){const p=o*f,_=o*d,v=a*f,T=a*d;t[0]=l*f,t[4]=-l*d,t[8]=h,t[1]=_+v*h,t[5]=p-T*h,t[9]=-a*l,t[2]=T-p*h,t[6]=v+_*h,t[10]=o*l}else if(e.order==="YXZ"){const p=l*f,_=l*d,v=h*f,T=h*d;t[0]=p+T*a,t[4]=v*a-_,t[8]=o*h,t[1]=o*d,t[5]=o*f,t[9]=-a,t[2]=_*a-v,t[6]=T+p*a,t[10]=o*l}else if(e.order==="ZXY"){const p=l*f,_=l*d,v=h*f,T=h*d;t[0]=p-T*a,t[4]=-o*d,t[8]=v+_*a,t[1]=_+v*a,t[5]=o*f,t[9]=T-p*a,t[2]=-o*h,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const p=o*f,_=o*d,v=a*f,T=a*d;t[0]=l*f,t[4]=v*h-_,t[8]=p*h+T,t[1]=l*d,t[5]=T*h+p,t[9]=_*h-v,t[2]=-h,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const p=o*l,_=o*h,v=a*l,T=a*h;t[0]=l*f,t[4]=T-p*d,t[8]=v*d+_,t[1]=d,t[5]=o*f,t[9]=-a*f,t[2]=-h*f,t[6]=_*d+v,t[10]=p-T*d}else if(e.order==="XZY"){const p=o*l,_=o*h,v=a*l,T=a*h;t[0]=l*f,t[4]=-d,t[8]=h*f,t[1]=p*d+T,t[5]=o*f,t[9]=_*d-v,t[2]=v*d-_,t[6]=a*f,t[10]=T*d+p}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(U8,e,F8)}lookAt(e,t,i){const r=this.elements;return jr.subVectors(e,t),jr.lengthSq()===0&&(jr.z=1),jr.normalize(),Ma.crossVectors(i,jr),Ma.lengthSq()===0&&(Math.abs(i.z)===1?jr.x+=1e-4:jr.z+=1e-4,jr.normalize(),Ma.crossVectors(i,jr)),Ma.normalize(),Eg.crossVectors(jr,Ma),r[0]=Ma.x,r[4]=Eg.x,r[8]=jr.x,r[1]=Ma.y,r[5]=Eg.y,r[9]=jr.y,r[2]=Ma.z,r[6]=Eg.z,r[10]=jr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],h=i[12],f=i[1],d=i[5],p=i[9],_=i[13],v=i[2],T=i[6],x=i[10],y=i[14],w=i[3],E=i[7],I=i[11],O=i[15],D=r[0],R=r[4],b=r[8],k=r[12],M=r[1],P=r[5],V=r[9],F=r[13],Y=r[2],re=r[6],se=r[10],ye=r[14],W=r[3],K=r[7],Q=r[11],ee=r[15];return s[0]=o*D+a*M+l*Y+h*W,s[4]=o*R+a*P+l*re+h*K,s[8]=o*b+a*V+l*se+h*Q,s[12]=o*k+a*F+l*ye+h*ee,s[1]=f*D+d*M+p*Y+_*W,s[5]=f*R+d*P+p*re+_*K,s[9]=f*b+d*V+p*se+_*Q,s[13]=f*k+d*F+p*ye+_*ee,s[2]=v*D+T*M+x*Y+y*W,s[6]=v*R+T*P+x*re+y*K,s[10]=v*b+T*V+x*se+y*Q,s[14]=v*k+T*F+x*ye+y*ee,s[3]=w*D+E*M+I*Y+O*W,s[7]=w*R+E*P+I*re+O*K,s[11]=w*b+E*V+I*se+O*Q,s[15]=w*k+E*F+I*ye+O*ee,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],h=e[13],f=e[2],d=e[6],p=e[10],_=e[14],v=e[3],T=e[7],x=e[11],y=e[15];return v*(+s*l*d-r*h*d-s*a*p+i*h*p+r*a*_-i*l*_)+T*(+t*l*_-t*h*p+s*o*p-r*o*_+r*h*f-s*l*f)+x*(+t*h*d-t*a*_-s*o*d+i*o*_+s*a*f-i*h*f)+y*(-r*a*f-t*l*d+t*a*p+r*o*d-i*o*p+i*l*f)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],h=e[7],f=e[8],d=e[9],p=e[10],_=e[11],v=e[12],T=e[13],x=e[14],y=e[15],w=d*x*h-T*p*h+T*l*_-a*x*_-d*l*y+a*p*y,E=v*p*h-f*x*h-v*l*_+o*x*_+f*l*y-o*p*y,I=f*T*h-v*d*h+v*a*_-o*T*_-f*a*y+o*d*y,O=v*d*l-f*T*l-v*a*p+o*T*p+f*a*x-o*d*x,D=t*w+i*E+r*I+s*O;if(D===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const R=1/D;return e[0]=w*R,e[1]=(T*p*s-d*x*s-T*r*_+i*x*_+d*r*y-i*p*y)*R,e[2]=(a*x*s-T*l*s+T*r*h-i*x*h-a*r*y+i*l*y)*R,e[3]=(d*l*s-a*p*s-d*r*h+i*p*h+a*r*_-i*l*_)*R,e[4]=E*R,e[5]=(f*x*s-v*p*s+v*r*_-t*x*_-f*r*y+t*p*y)*R,e[6]=(v*l*s-o*x*s-v*r*h+t*x*h+o*r*y-t*l*y)*R,e[7]=(o*p*s-f*l*s+f*r*h-t*p*h-o*r*_+t*l*_)*R,e[8]=I*R,e[9]=(v*d*s-f*T*s-v*i*_+t*T*_+f*i*y-t*d*y)*R,e[10]=(o*T*s-v*a*s+v*i*h-t*T*h-o*i*y+t*a*y)*R,e[11]=(f*a*s-o*d*s-f*i*h+t*d*h+o*i*_-t*a*_)*R,e[12]=O*R,e[13]=(f*T*r-v*d*r+v*i*p-t*T*p-f*i*x+t*d*x)*R,e[14]=(v*a*r-o*T*r-v*i*l+t*T*l+o*i*x-t*a*x)*R,e[15]=(o*d*r-f*a*r+f*i*l-t*d*l-o*i*p+t*a*p)*R,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,h=s*o,f=s*a;return this.set(h*o+i,h*a-r*l,h*l+r*a,0,h*a+r*l,f*a+i,f*l-r*o,0,h*l-r*a,f*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,h=s+s,f=o+o,d=a+a,p=s*h,_=s*f,v=s*d,T=o*f,x=o*d,y=a*d,w=l*h,E=l*f,I=l*d,O=i.x,D=i.y,R=i.z;return r[0]=(1-(T+y))*O,r[1]=(_+I)*O,r[2]=(v-E)*O,r[3]=0,r[4]=(_-I)*D,r[5]=(1-(p+y))*D,r[6]=(x+w)*D,r[7]=0,r[8]=(v+E)*R,r[9]=(x-w)*R,r[10]=(1-(p+T))*R,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=Pc.set(r[0],r[1],r[2]).length();const o=Pc.set(r[4],r[5],r[6]).length(),a=Pc.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],ks.copy(this);const h=1/s,f=1/o,d=1/a;return ks.elements[0]*=h,ks.elements[1]*=h,ks.elements[2]*=h,ks.elements[4]*=f,ks.elements[5]*=f,ks.elements[6]*=f,ks.elements[8]*=d,ks.elements[9]*=d,ks.elements[10]*=d,t.setFromRotationMatrix(ks),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=co){const l=this.elements,h=2*s/(t-e),f=2*s/(i-r),d=(t+e)/(t-e),p=(i+r)/(i-r);let _,v;if(a===co)_=-(o+s)/(o-s),v=-2*o*s/(o-s);else if(a===xp)_=-o/(o-s),v=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=h,l[4]=0,l[8]=d,l[12]=0,l[1]=0,l[5]=f,l[9]=p,l[13]=0,l[2]=0,l[6]=0,l[10]=_,l[14]=v,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=co){const l=this.elements,h=1/(t-e),f=1/(i-r),d=1/(o-s),p=(t+e)*h,_=(i+r)*f;let v,T;if(a===co)v=(o+s)*d,T=-2*d;else if(a===xp)v=s*d,T=-1*d;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*h,l[4]=0,l[8]=0,l[12]=-p,l[1]=0,l[5]=2*f,l[9]=0,l[13]=-_,l[2]=0,l[6]=0,l[10]=T,l[14]=-v,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Pc=new G,ks=new Mt,U8=new G(0,0,0),F8=new G(1,1,1),Ma=new G,Eg=new G,jr=new G,II=new Mt,PI=new gi;class $p{constructor(e=0,t=0,i=0,r=$p.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],h=r[5],f=r[9],d=r[2],p=r[6],_=r[10];switch(t){case"XYZ":this._y=Math.asin(qn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-f,_),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(p,h),this._z=0);break;case"YXZ":this._x=Math.asin(-qn(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(a,_),this._z=Math.atan2(l,h)):(this._y=Math.atan2(-d,s),this._z=0);break;case"ZXY":this._x=Math.asin(qn(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(-d,_),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-qn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(p,_),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,h));break;case"YZX":this._z=Math.asin(qn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-f,h),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(a,_));break;case"XZY":this._z=Math.asin(-qn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(p,h),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-f,_),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return II.makeRotationFromQuaternion(e),this.setFromRotationMatrix(II,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return PI.setFromEuler(this),this.setFromQuaternion(PI,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}$p.DEFAULT_ORDER="XYZ";class Iu{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let V8=0;const bI=new G,bc=new gi,Do=new Mt,wg=new G,qf=new G,z8=new G,B8=new gi,LI=new G(1,0,0),NI=new G(0,1,0),DI=new G(0,0,1),H8={type:"added"},G8={type:"removed"};class ln extends ha{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:V8++}),this.uuid=es(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ln.DEFAULT_UP.clone();const e=new G,t=new $p,i=new gi,r=new G(1,1,1);function s(){i.setFromEuler(t,!1)}function o(){t.setFromQuaternion(i,void 0,!1)}t._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Mt},normalMatrix:{value:new Bt}}),this.matrix=new Mt,this.matrixWorld=new Mt,this.matrixAutoUpdate=ln.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=ln.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Iu,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return bc.setFromAxisAngle(e,t),this.quaternion.multiply(bc),this}rotateOnWorldAxis(e,t){return bc.setFromAxisAngle(e,t),this.quaternion.premultiply(bc),this}rotateX(e){return this.rotateOnAxis(LI,e)}rotateY(e){return this.rotateOnAxis(NI,e)}rotateZ(e){return this.rotateOnAxis(DI,e)}translateOnAxis(e,t){return bI.copy(e).applyQuaternion(this.quaternion),this.position.add(bI.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(LI,e)}translateY(e){return this.translateOnAxis(NI,e)}translateZ(e){return this.translateOnAxis(DI,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Do.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?wg.copy(e):wg.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),qf.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Do.lookAt(qf,wg,this.up):Do.lookAt(wg,qf,this.up),this.quaternion.setFromRotationMatrix(Do),r&&(Do.extractRotation(r.matrixWorld),bc.setFromRotationMatrix(Do),this.quaternion.premultiply(bc.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(H8)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(G8)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Do.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Do.multiply(e.parent.matrixWorld)),e.applyMatrix4(Do),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,i=[]){this[e]===t&&i.push(this);const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].getObjectsByProperty(e,t,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(qf,e,z8),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(qf,B8,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++){const s=t[i];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++){const a=r[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),r.maxGeometryCount=this._maxGeometryCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()}));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let h=0,f=l.length;h<f;h++){const d=l[h];s(e.shapes,d)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,h=this.material.length;l<h;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),h=o(e.textures),f=o(e.images),d=o(e.shapes),p=o(e.skeletons),_=o(e.animations),v=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),h.length>0&&(i.textures=h),f.length>0&&(i.images=f),d.length>0&&(i.shapes=d),p.length>0&&(i.skeletons=p),_.length>0&&(i.animations=_),v.length>0&&(i.nodes=v)}return i.object=r,i;function o(a){const l=[];for(const h in a){const f=a[h];delete f.metadata,l.push(f)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}ln.DEFAULT_UP=new G(0,1,0);ln.DEFAULT_MATRIX_AUTO_UPDATE=!0;ln.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Os=new G,ko=new G,Vx=new G,Oo=new G,Lc=new G,Nc=new G,kI=new G,zx=new G,Bx=new G,Hx=new G;class Kr{constructor(e=new G,t=new G,i=new G){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),Os.subVectors(e,t),r.cross(Os);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){Os.subVectors(r,t),ko.subVectors(i,t),Vx.subVectors(e,t);const o=Os.dot(Os),a=Os.dot(ko),l=Os.dot(Vx),h=ko.dot(ko),f=ko.dot(Vx),d=o*h-a*a;if(d===0)return s.set(0,0,0),null;const p=1/d,_=(h*l-a*f)*p,v=(o*f-a*l)*p;return s.set(1-_-v,v,_)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,Oo)===null?!1:Oo.x>=0&&Oo.y>=0&&Oo.x+Oo.y<=1}static getInterpolation(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,Oo)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,Oo.x),l.addScaledVector(o,Oo.y),l.addScaledVector(a,Oo.z),l)}static isFrontFacing(e,t,i,r){return Os.subVectors(i,t),ko.subVectors(e,t),Os.cross(ko).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Os.subVectors(this.c,this.b),ko.subVectors(this.a,this.b),Os.cross(ko).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Kr.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Kr.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,r,s){return Kr.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return Kr.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Kr.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;Lc.subVectors(r,i),Nc.subVectors(s,i),zx.subVectors(e,i);const l=Lc.dot(zx),h=Nc.dot(zx);if(l<=0&&h<=0)return t.copy(i);Bx.subVectors(e,r);const f=Lc.dot(Bx),d=Nc.dot(Bx);if(f>=0&&d<=f)return t.copy(r);const p=l*d-f*h;if(p<=0&&l>=0&&f<=0)return o=l/(l-f),t.copy(i).addScaledVector(Lc,o);Hx.subVectors(e,s);const _=Lc.dot(Hx),v=Nc.dot(Hx);if(v>=0&&_<=v)return t.copy(s);const T=_*h-l*v;if(T<=0&&h>=0&&v<=0)return a=h/(h-v),t.copy(i).addScaledVector(Nc,a);const x=f*v-_*d;if(x<=0&&d-f>=0&&_-v>=0)return kI.subVectors(s,r),a=(d-f)/(d-f+(_-v)),t.copy(r).addScaledVector(kI,a);const y=1/(x+T+p);return o=T*y,a=p*y,t.copy(i).addScaledVector(Lc,o).addScaledVector(Nc,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const hk={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Aa={h:0,s:0,l:0},Tg={h:0,s:0,l:0};function Gx(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class Ye{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=di){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,dn.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=dn.workingColorSpace){return this.r=e,this.g=t,this.b=i,dn.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=dn.workingColorSpace){if(e=kT(e,1),t=qn(t,0,1),i=qn(i,0,1),t===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=Gx(o,s,e+1/3),this.g=Gx(o,s,e),this.b=Gx(o,s,e-1/3)}return dn.toWorkingColorSpace(this,r),this}setStyle(e,t=di){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=di){const i=hk[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Ih(e.r),this.g=Ih(e.g),this.b=Ih(e.b),this}copyLinearToSRGB(e){return this.r=bx(e.r),this.g=bx(e.g),this.b=bx(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=di){return dn.fromWorkingColorSpace(Yi.copy(this),e),Math.round(qn(Yi.r*255,0,255))*65536+Math.round(qn(Yi.g*255,0,255))*256+Math.round(qn(Yi.b*255,0,255))}getHexString(e=di){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=dn.workingColorSpace){dn.fromWorkingColorSpace(Yi.copy(this),t);const i=Yi.r,r=Yi.g,s=Yi.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,h;const f=(a+o)/2;if(a===o)l=0,h=0;else{const d=o-a;switch(h=f<=.5?d/(o+a):d/(2-o-a),o){case i:l=(r-s)/d+(r<s?6:0);break;case r:l=(s-i)/d+2;break;case s:l=(i-r)/d+4;break}l/=6}return e.h=l,e.s=h,e.l=f,e}getRGB(e,t=dn.workingColorSpace){return dn.fromWorkingColorSpace(Yi.copy(this),t),e.r=Yi.r,e.g=Yi.g,e.b=Yi.b,e}getStyle(e=di){dn.fromWorkingColorSpace(Yi.copy(this),e);const t=Yi.r,i=Yi.g,r=Yi.b;return e!==di?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,t,i){return this.getHSL(Aa),this.setHSL(Aa.h+e,Aa.s+t,Aa.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Aa),e.getHSL(Tg);const i=Nd(Aa.h,Tg.h,t),r=Nd(Aa.s,Tg.s,t),s=Nd(Aa.l,Tg.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Yi=new Ye;Ye.NAMES=hk;let W8=0;class ir extends ha{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:W8++}),this.uuid=es(),this.name="",this.type="Material",this.blending=Au,this.side=sa,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Ny,this.blendDst=Dy,this.blendEquation=Fa,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Ye(0,0,0),this.blendAlpha=0,this.depthFunc=lp,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=vw,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=lu,this.stencilZFail=lu,this.stencilZPass=lu,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Au&&(i.blending=this.blending),this.side!==sa&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==Ny&&(i.blendSrc=this.blendSrc),this.blendDst!==Dy&&(i.blendDst=this.blendDst),this.blendEquation!==Fa&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==lp&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==vw&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==lu&&(i.stencilFail=this.stencilFail),this.stencilZFail!==lu&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==lu&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Cl extends ir{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ye(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Xp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Bo=j8();function j8(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const h=l-127;h<-27?(i[l]=0,i[l|256]=32768,r[l]=24,r[l|256]=24):h<-14?(i[l]=1024>>-h-14,i[l|256]=1024>>-h-14|32768,r[l]=-h-1,r[l|256]=-h-1):h<=15?(i[l]=h+15<<10,i[l|256]=h+15<<10|32768,r[l]=13,r[l|256]=13):h<128?(i[l]=31744,i[l|256]=64512,r[l]=24,r[l|256]=24):(i[l]=31744,i[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let h=l<<13,f=0;for(;!(h&8388608);)h<<=1,f-=8388608;h&=-8388609,f+=947912704,s[l]=h|f}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function Cr(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=qn(n,-65504,65504),Bo.floatView[0]=n;const e=Bo.uint32View[0],t=e>>23&511;return Bo.baseTable[t]+((e&8388607)>>Bo.shiftTable[t])}function md(n){const e=n>>10;return Bo.uint32View[0]=Bo.mantissaTable[Bo.offsetTable[e]+(n&1023)]+Bo.exponentTable[e],Bo.floatView[0]}const q8={toHalfFloat:Cr,fromHalfFloat:md},ri=new G,Mg=new ge;class mn{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=vp,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Ss,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return Ru("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)Mg.fromBufferAttribute(this,t),Mg.applyMatrix3(e),this.setXY(t,Mg.x,Mg.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)ri.fromBufferAttribute(this,t),ri.applyMatrix3(e),this.setXYZ(t,ri.x,ri.y,ri.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)ri.fromBufferAttribute(this,t),ri.applyMatrix4(e),this.setXYZ(t,ri.x,ri.y,ri.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)ri.fromBufferAttribute(this,t),ri.applyNormalMatrix(e),this.setXYZ(t,ri.x,ri.y,ri.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)ri.fromBufferAttribute(this,t),ri.transformDirection(e),this.setXYZ(t,ri.x,ri.y,ri.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=mr(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Ft(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=mr(t,this.array)),t}setX(e,t){return this.normalized&&(t=Ft(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=mr(t,this.array)),t}setY(e,t){return this.normalized&&(t=Ft(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=mr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Ft(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=mr(t,this.array)),t}setW(e,t){return this.normalized&&(t=Ft(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Ft(t,this.array),i=Ft(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Ft(t,this.array),i=Ft(i,this.array),r=Ft(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Ft(t,this.array),i=Ft(i,this.array),r=Ft(r,this.array),s=Ft(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==vp&&(e.usage=this.usage),e}}class X8 extends mn{constructor(e,t,i){super(new Int8Array(e),t,i)}}class Y8 extends mn{constructor(e,t,i){super(new Uint8Array(e),t,i)}}class $8 extends mn{constructor(e,t,i){super(new Uint8ClampedArray(e),t,i)}}class K8 extends mn{constructor(e,t,i){super(new Int16Array(e),t,i)}}class VT extends mn{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class Q8 extends mn{constructor(e,t,i){super(new Int32Array(e),t,i)}}class zT extends mn{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class J8 extends mn{constructor(e,t,i){super(new Uint16Array(e),t,i),this.isFloat16BufferAttribute=!0}getX(e){let t=md(this.array[e*this.itemSize]);return this.normalized&&(t=mr(t,this.array)),t}setX(e,t){return this.normalized&&(t=Ft(t,this.array)),this.array[e*this.itemSize]=Cr(t),this}getY(e){let t=md(this.array[e*this.itemSize+1]);return this.normalized&&(t=mr(t,this.array)),t}setY(e,t){return this.normalized&&(t=Ft(t,this.array)),this.array[e*this.itemSize+1]=Cr(t),this}getZ(e){let t=md(this.array[e*this.itemSize+2]);return this.normalized&&(t=mr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Ft(t,this.array)),this.array[e*this.itemSize+2]=Cr(t),this}getW(e){let t=md(this.array[e*this.itemSize+3]);return this.normalized&&(t=mr(t,this.array)),t}setW(e,t){return this.normalized&&(t=Ft(t,this.array)),this.array[e*this.itemSize+3]=Cr(t),this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Ft(t,this.array),i=Ft(i,this.array)),this.array[e+0]=Cr(t),this.array[e+1]=Cr(i),this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Ft(t,this.array),i=Ft(i,this.array),r=Ft(r,this.array)),this.array[e+0]=Cr(t),this.array[e+1]=Cr(i),this.array[e+2]=Cr(r),this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Ft(t,this.array),i=Ft(i,this.array),r=Ft(r,this.array),s=Ft(s,this.array)),this.array[e+0]=Cr(t),this.array[e+1]=Cr(i),this.array[e+2]=Cr(r),this.array[e+3]=Cr(s),this}}class lt extends mn{constructor(e,t,i){super(new Float32Array(e),t,i)}}class Z8 extends mn{constructor(e,t,i){super(new Float64Array(e),t,i)}}let eW=0;const _s=new Mt,Wx=new ln,Dc=new G,qr=new yr,Xf=new yr,Ti=new G;class Ht extends ha{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:eW++}),this.uuid=es(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(lk(e)?zT:VT)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new Bt().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return _s.makeRotationFromQuaternion(e),this.applyMatrix4(_s),this}rotateX(e){return _s.makeRotationX(e),this.applyMatrix4(_s),this}rotateY(e){return _s.makeRotationY(e),this.applyMatrix4(_s),this}rotateZ(e){return _s.makeRotationZ(e),this.applyMatrix4(_s),this}translate(e,t,i){return _s.makeTranslation(e,t,i),this.applyMatrix4(_s),this}scale(e,t,i){return _s.makeScale(e,t,i),this.applyMatrix4(_s),this}lookAt(e){return Wx.lookAt(e),Wx.updateMatrix(),this.applyMatrix4(Wx.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Dc).negate(),this.translate(Dc.x,Dc.y,Dc.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new lt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new yr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new G(-1/0,-1/0,-1/0),new G(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){const s=t[i];qr.setFromBufferAttribute(s),this.morphTargetsRelative?(Ti.addVectors(this.boundingBox.min,qr.min),this.boundingBox.expandByPoint(Ti),Ti.addVectors(this.boundingBox.max,qr.max),this.boundingBox.expandByPoint(Ti)):(this.boundingBox.expandByPoint(qr.min),this.boundingBox.expandByPoint(qr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new er);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new G,1/0);return}if(e){const i=this.boundingSphere.center;if(qr.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];Xf.setFromBufferAttribute(a),this.morphTargetsRelative?(Ti.addVectors(qr.min,Xf.min),qr.expandByPoint(Ti),Ti.addVectors(qr.max,Xf.max),qr.expandByPoint(Ti)):(qr.expandByPoint(Xf.min),qr.expandByPoint(Xf.max))}qr.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)Ti.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Ti));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let h=0,f=a.count;h<f;h++)Ti.fromBufferAttribute(a,h),l&&(Dc.fromBufferAttribute(e,h),Ti.add(Dc)),r=Math.max(r,i.distanceToSquared(Ti))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new mn(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,h=[],f=[];for(let M=0;M<a;M++)h[M]=new G,f[M]=new G;const d=new G,p=new G,_=new G,v=new ge,T=new ge,x=new ge,y=new G,w=new G;function E(M,P,V){d.fromArray(r,M*3),p.fromArray(r,P*3),_.fromArray(r,V*3),v.fromArray(o,M*2),T.fromArray(o,P*2),x.fromArray(o,V*2),p.sub(d),_.sub(d),T.sub(v),x.sub(v);const F=1/(T.x*x.y-x.x*T.y);isFinite(F)&&(y.copy(p).multiplyScalar(x.y).addScaledVector(_,-T.y).multiplyScalar(F),w.copy(_).multiplyScalar(T.x).addScaledVector(p,-x.x).multiplyScalar(F),h[M].add(y),h[P].add(y),h[V].add(y),f[M].add(w),f[P].add(w),f[V].add(w))}let I=this.groups;I.length===0&&(I=[{start:0,count:i.length}]);for(let M=0,P=I.length;M<P;++M){const V=I[M],F=V.start,Y=V.count;for(let re=F,se=F+Y;re<se;re+=3)E(i[re+0],i[re+1],i[re+2])}const O=new G,D=new G,R=new G,b=new G;function k(M){R.fromArray(s,M*3),b.copy(R);const P=h[M];O.copy(P),O.sub(R.multiplyScalar(R.dot(P))).normalize(),D.crossVectors(b,P);const F=D.dot(f[M])<0?-1:1;l[M*4]=O.x,l[M*4+1]=O.y,l[M*4+2]=O.z,l[M*4+3]=F}for(let M=0,P=I.length;M<P;++M){const V=I[M],F=V.start,Y=V.count;for(let re=F,se=F+Y;re<se;re+=3)k(i[re+0]),k(i[re+1]),k(i[re+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new mn(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let p=0,_=i.count;p<_;p++)i.setXYZ(p,0,0,0);const r=new G,s=new G,o=new G,a=new G,l=new G,h=new G,f=new G,d=new G;if(e)for(let p=0,_=e.count;p<_;p+=3){const v=e.getX(p+0),T=e.getX(p+1),x=e.getX(p+2);r.fromBufferAttribute(t,v),s.fromBufferAttribute(t,T),o.fromBufferAttribute(t,x),f.subVectors(o,s),d.subVectors(r,s),f.cross(d),a.fromBufferAttribute(i,v),l.fromBufferAttribute(i,T),h.fromBufferAttribute(i,x),a.add(f),l.add(f),h.add(f),i.setXYZ(v,a.x,a.y,a.z),i.setXYZ(T,l.x,l.y,l.z),i.setXYZ(x,h.x,h.y,h.z)}else for(let p=0,_=t.count;p<_;p+=3)r.fromBufferAttribute(t,p+0),s.fromBufferAttribute(t,p+1),o.fromBufferAttribute(t,p+2),f.subVectors(o,s),d.subVectors(r,s),f.cross(d),i.setXYZ(p+0,f.x,f.y,f.z),i.setXYZ(p+1,f.x,f.y,f.z),i.setXYZ(p+2,f.x,f.y,f.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Ti.fromBufferAttribute(e,t),Ti.normalize(),e.setXYZ(t,Ti.x,Ti.y,Ti.z)}toNonIndexed(){function e(a,l){const h=a.array,f=a.itemSize,d=a.normalized,p=new h.constructor(l.length*f);let _=0,v=0;for(let T=0,x=l.length;T<x;T++){a.isInterleavedBufferAttribute?_=l[T]*a.data.stride+a.offset:_=l[T]*f;for(let y=0;y<f;y++)p[v++]=h[_++]}return new mn(p,f,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Ht,i=this.index.array,r=this.attributes;for(const a in r){const l=r[a],h=e(l,i);t.setAttribute(a,h)}const s=this.morphAttributes;for(const a in s){const l=[],h=s[a];for(let f=0,d=h.length;f<d;f++){const p=h[f],_=e(p,i);l.push(_)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const h=o[a];t.addGroup(h.start,h.count,h.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const h in l)l[h]!==void 0&&(e[h]=l[h]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i){const h=i[l];e.data.attributes[l]=h.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const h=this.morphAttributes[l],f=[];for(let d=0,p=h.length;d<p;d++){const _=h[d];f.push(_.toJSON(e.data))}f.length>0&&(r[l]=f,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(t));const r=e.attributes;for(const h in r){const f=r[h];this.setAttribute(h,f.clone(t))}const s=e.morphAttributes;for(const h in s){const f=[],d=s[h];for(let p=0,_=d.length;p<_;p++)f.push(d[p].clone(t));this.morphAttributes[h]=f}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let h=0,f=o.length;h<f;h++){const d=o[h];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const OI=new Mt,$l=new Ku,Ag=new er,UI=new G,kc=new G,Oc=new G,Uc=new G,jx=new G,Cg=new G,Rg=new ge,Ig=new ge,Pg=new ge,FI=new G,VI=new G,zI=new G,bg=new G,Lg=new G;class ui extends ln{constructor(e=new Ht,t=new Cl){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){Cg.set(0,0,0);for(let l=0,h=s.length;l<h;l++){const f=a[l],d=s[l];f!==0&&(jx.fromBufferAttribute(d,e),o?Cg.addScaledVector(jx,f):Cg.addScaledVector(jx.sub(t),f))}t.add(Cg)}return t}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),Ag.copy(i.boundingSphere),Ag.applyMatrix4(s),$l.copy(e.ray).recast(e.near),!(Ag.containsPoint($l.origin)===!1&&($l.intersectSphere(Ag,UI)===null||$l.origin.distanceToSquared(UI)>(e.far-e.near)**2))&&(OI.copy(s).invert(),$l.copy(e.ray).applyMatrix4(OI),!(i.boundingBox!==null&&$l.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,$l)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,h=s.attributes.uv,f=s.attributes.uv1,d=s.attributes.normal,p=s.groups,_=s.drawRange;if(a!==null)if(Array.isArray(o))for(let v=0,T=p.length;v<T;v++){const x=p[v],y=o[x.materialIndex],w=Math.max(x.start,_.start),E=Math.min(a.count,Math.min(x.start+x.count,_.start+_.count));for(let I=w,O=E;I<O;I+=3){const D=a.getX(I),R=a.getX(I+1),b=a.getX(I+2);r=Ng(this,y,e,i,h,f,d,D,R,b),r&&(r.faceIndex=Math.floor(I/3),r.face.materialIndex=x.materialIndex,t.push(r))}}else{const v=Math.max(0,_.start),T=Math.min(a.count,_.start+_.count);for(let x=v,y=T;x<y;x+=3){const w=a.getX(x),E=a.getX(x+1),I=a.getX(x+2);r=Ng(this,o,e,i,h,f,d,w,E,I),r&&(r.faceIndex=Math.floor(x/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let v=0,T=p.length;v<T;v++){const x=p[v],y=o[x.materialIndex],w=Math.max(x.start,_.start),E=Math.min(l.count,Math.min(x.start+x.count,_.start+_.count));for(let I=w,O=E;I<O;I+=3){const D=I,R=I+1,b=I+2;r=Ng(this,y,e,i,h,f,d,D,R,b),r&&(r.faceIndex=Math.floor(I/3),r.face.materialIndex=x.materialIndex,t.push(r))}}else{const v=Math.max(0,_.start),T=Math.min(l.count,_.start+_.count);for(let x=v,y=T;x<y;x+=3){const w=x,E=x+1,I=x+2;r=Ng(this,o,e,i,h,f,d,w,E,I),r&&(r.faceIndex=Math.floor(x/3),t.push(r))}}}}function tW(n,e,t,i,r,s,o,a){let l;if(e.side===_r?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===sa,a),l===null)return null;Lg.copy(a),Lg.applyMatrix4(n.matrixWorld);const h=t.ray.origin.distanceTo(Lg);return h<t.near||h>t.far?null:{distance:h,point:Lg.clone(),object:n}}function Ng(n,e,t,i,r,s,o,a,l,h){n.getVertexPosition(a,kc),n.getVertexPosition(l,Oc),n.getVertexPosition(h,Uc);const f=tW(n,e,t,i,kc,Oc,Uc,bg);if(f){r&&(Rg.fromBufferAttribute(r,a),Ig.fromBufferAttribute(r,l),Pg.fromBufferAttribute(r,h),f.uv=Kr.getInterpolation(bg,kc,Oc,Uc,Rg,Ig,Pg,new ge)),s&&(Rg.fromBufferAttribute(s,a),Ig.fromBufferAttribute(s,l),Pg.fromBufferAttribute(s,h),f.uv1=Kr.getInterpolation(bg,kc,Oc,Uc,Rg,Ig,Pg,new ge),f.uv2=f.uv1),o&&(FI.fromBufferAttribute(o,a),VI.fromBufferAttribute(o,l),zI.fromBufferAttribute(o,h),f.normal=Kr.getInterpolation(bg,kc,Oc,Uc,FI,VI,zI,new G),f.normal.dot(i.direction)>0&&f.normal.multiplyScalar(-1));const d={a,b:l,c:h,normal:new G,materialIndex:0};Kr.getNormal(kc,Oc,Uc,d.normal),f.face=d}return f}class Qu extends Ht{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],h=[],f=[],d=[];let p=0,_=0;v("z","y","x",-1,-1,i,t,e,o,s,0),v("z","y","x",1,-1,i,t,-e,o,s,1),v("x","z","y",1,1,e,i,t,r,o,2),v("x","z","y",1,-1,e,i,-t,r,o,3),v("x","y","z",1,-1,e,t,i,r,s,4),v("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new lt(h,3)),this.setAttribute("normal",new lt(f,3)),this.setAttribute("uv",new lt(d,2));function v(T,x,y,w,E,I,O,D,R,b,k){const M=I/R,P=O/b,V=I/2,F=O/2,Y=D/2,re=R+1,se=b+1;let ye=0,W=0;const K=new G;for(let Q=0;Q<se;Q++){const ee=Q*P-F;for(let _e=0;_e<re;_e++){const Ne=_e*M-V;K[T]=Ne*w,K[x]=ee*E,K[y]=Y,h.push(K.x,K.y,K.z),K[T]=0,K[x]=0,K[y]=D>0?1:-1,f.push(K.x,K.y,K.z),d.push(_e/R),d.push(1-Q/b),ye+=1}}for(let Q=0;Q<b;Q++)for(let ee=0;ee<R;ee++){const _e=p+ee+re*Q,Ne=p+ee+re*(Q+1),oe=p+(ee+1)+re*(Q+1),xe=p+(ee+1)+re*Q;l.push(_e,Ne,xe),l.push(Ne,oe,xe),W+=6}a.addGroup(_,W,k),_+=W,p+=ye}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Qu(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Xh(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function fr(n){const e={};for(let t=0;t<n.length;t++){const i=Xh(n[t]);for(const r in i)e[r]=i[r]}return e}function nW(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function fk(n){return n.getRenderTarget()===null?n.outputColorSpace:dn.workingColorSpace}const dk={clone:Xh,merge:fr};var iW=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,rW=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ns extends ir{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=iW,this.fragmentShader=rW,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Xh(e.uniforms),this.uniformsGroups=nW(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class Kp extends ln{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Mt,this.projectionMatrix=new Mt,this.projectionMatrixInverse=new Mt,this.coordinateSystem=co}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Ca=new G,BI=new ge,HI=new ge;class ti extends Kp{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=qh*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Cu*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return qh*2*Math.atan(Math.tan(Cu*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){Ca.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Ca.x,Ca.y).multiplyScalar(-e/Ca.z),Ca.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Ca.x,Ca.y).multiplyScalar(-e/Ca.z)}getViewSize(e,t){return this.getViewBounds(e,BI,HI),t.subVectors(HI,BI)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Cu*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,h=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/h,r*=o.width/l,i*=o.height/h}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Fc=-90,Vc=1;class pk extends ln{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new ti(Fc,Vc,e,t);r.layers=this.layers,this.add(r);const s=new ti(Fc,Vc,e,t);s.layers=this.layers,this.add(s);const o=new ti(Fc,Vc,e,t);o.layers=this.layers,this.add(o);const a=new ti(Fc,Vc,e,t);a.layers=this.layers,this.add(a);const l=new ti(Fc,Vc,e,t);l.layers=this.layers,this.add(l);const h=new ti(Fc,Vc,e,t);h.layers=this.layers,this.add(h)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,l]=t;for(const h of t)this.remove(h);if(e===co)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===xp)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const h of t)this.add(h),h.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,h,f]=this.children,d=e.getRenderTarget(),p=e.getActiveCubeFace(),_=e.getActiveMipmapLevel(),v=e.xr.enabled;e.xr.enabled=!1;const T=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,l),e.setRenderTarget(i,4,r),e.render(t,h),i.texture.generateMipmaps=T,e.setRenderTarget(i,5,r),e.render(t,f),e.setRenderTarget(d,p,_),e.xr.enabled=v,i.texture.needsPMREMUpdate=!0}}class Qp extends Pn{constructor(e,t,i,r,s,o,a,l,h,f){e=e!==void 0?e:[],t=t!==void 0?t:oa,super(e,t,i,r,s,o,a,l,h,f),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class mk extends $s{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];t.encoding!==void 0&&(Ru("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===rl?di:$r),this.texture=new Qp(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:On}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Qu(5,5,5),s=new ns({name:"CubemapFromEquirect",uniforms:Xh(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:_r,blending:Ko});s.uniforms.tEquirect.value=t;const o=new ui(r,s),a=t.minFilter;return t.minFilter===uo&&(t.minFilter=On),new pk(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const qx=new G,sW=new G,oW=new Bt;class zo{constructor(e=new G(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=qx.subVectors(i,t).cross(sW.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(qx),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||oW.getNormalMatrix(e),r=this.coplanarPoint(qx).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Kl=new er,Dg=new G;class Jp{constructor(e=new zo,t=new zo,i=new zo,r=new zo,s=new zo,o=new zo){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=co){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],h=r[4],f=r[5],d=r[6],p=r[7],_=r[8],v=r[9],T=r[10],x=r[11],y=r[12],w=r[13],E=r[14],I=r[15];if(i[0].setComponents(l-s,p-h,x-_,I-y).normalize(),i[1].setComponents(l+s,p+h,x+_,I+y).normalize(),i[2].setComponents(l+o,p+f,x+v,I+w).normalize(),i[3].setComponents(l-o,p-f,x-v,I-w).normalize(),i[4].setComponents(l-a,p-d,x-T,I-E).normalize(),t===co)i[5].setComponents(l+a,p+d,x+T,I+E).normalize();else if(t===xp)i[5].setComponents(a,d,T,E).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Kl.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Kl.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Kl)}intersectsSprite(e){return Kl.center.set(0,0,0),Kl.radius=.7071067811865476,Kl.applyMatrix4(e.matrixWorld),this.intersectsSphere(Kl)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(Dg.x=r.normal.x>0?e.max.x:e.min.x,Dg.y=r.normal.y>0?e.max.y:e.min.y,Dg.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Dg)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function gk(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function aW(n,e){const t=e.isWebGL2,i=new WeakMap;function r(h,f){const d=h.array,p=h.usage,_=d.byteLength,v=n.createBuffer();n.bindBuffer(f,v),n.bufferData(f,d,p),h.onUploadCallback();let T;if(d instanceof Float32Array)T=n.FLOAT;else if(d instanceof Uint16Array)if(h.isFloat16BufferAttribute)if(t)T=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else T=n.UNSIGNED_SHORT;else if(d instanceof Int16Array)T=n.SHORT;else if(d instanceof Uint32Array)T=n.UNSIGNED_INT;else if(d instanceof Int32Array)T=n.INT;else if(d instanceof Int8Array)T=n.BYTE;else if(d instanceof Uint8Array)T=n.UNSIGNED_BYTE;else if(d instanceof Uint8ClampedArray)T=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);return{buffer:v,type:T,bytesPerElement:d.BYTES_PER_ELEMENT,version:h.version,size:_}}function s(h,f,d){const p=f.array,_=f._updateRange,v=f.updateRanges;if(n.bindBuffer(d,h),_.count===-1&&v.length===0&&n.bufferSubData(d,0,p),v.length!==0){for(let T=0,x=v.length;T<x;T++){const y=v[T];t?n.bufferSubData(d,y.start*p.BYTES_PER_ELEMENT,p,y.start,y.count):n.bufferSubData(d,y.start*p.BYTES_PER_ELEMENT,p.subarray(y.start,y.start+y.count))}f.clearUpdateRanges()}_.count!==-1&&(t?n.bufferSubData(d,_.offset*p.BYTES_PER_ELEMENT,p,_.offset,_.count):n.bufferSubData(d,_.offset*p.BYTES_PER_ELEMENT,p.subarray(_.offset,_.offset+_.count)),_.count=-1),f.onUploadCallback()}function o(h){return h.isInterleavedBufferAttribute&&(h=h.data),i.get(h)}function a(h){h.isInterleavedBufferAttribute&&(h=h.data);const f=i.get(h);f&&(n.deleteBuffer(f.buffer),i.delete(h))}function l(h,f){if(h.isGLBufferAttribute){const p=i.get(h);(!p||p.version<h.version)&&i.set(h,{buffer:h.buffer,type:h.type,bytesPerElement:h.elementSize,version:h.version});return}h.isInterleavedBufferAttribute&&(h=h.data);const d=i.get(h);if(d===void 0)i.set(h,r(h,f));else if(d.version<h.version){if(d.size!==h.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");s(d.buffer,h,f),d.version=h.version}}return{get:o,remove:a,update:l}}class cf extends Ht{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),h=a+1,f=l+1,d=e/a,p=t/l,_=[],v=[],T=[],x=[];for(let y=0;y<f;y++){const w=y*p-o;for(let E=0;E<h;E++){const I=E*d-s;v.push(I,-w,0),T.push(0,0,1),x.push(E/a),x.push(1-y/l)}}for(let y=0;y<l;y++)for(let w=0;w<a;w++){const E=w+h*y,I=w+h*(y+1),O=w+1+h*(y+1),D=w+1+h*y;_.push(E,I,D),_.push(I,O,D)}this.setIndex(_),this.setAttribute("position",new lt(v,3)),this.setAttribute("normal",new lt(T,3)),this.setAttribute("uv",new lt(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cf(e.width,e.height,e.widthSegments,e.heightSegments)}}var lW=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,uW=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,cW=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,hW=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,fW=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,dW=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,pW=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,mW=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,gW=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,_W=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,yW=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,vW=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,xW=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,SW=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,EW=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,wW=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,TW=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,MW=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,AW=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,CW=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,RW=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,IW=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,PW=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,bW=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,LW=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,NW=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,DW=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,kW=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,OW=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,UW=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,FW="gl_FragColor = linearToOutputTexel( gl_FragColor );",VW=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,zW=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,BW=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,HW=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,GW=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,WW=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,jW=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,qW=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,XW=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,YW=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,$W=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,KW=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,QW=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,JW=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,ZW=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,e7=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,t7=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,n7=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,i7=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,r7=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,s7=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,o7=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,a7=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,l7=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,u7=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,c7=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,h7=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,f7=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,d7=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,p7=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,m7=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,g7=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,_7=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,y7=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,v7=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,x7=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,S7=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,E7=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,w7=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,T7=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,M7=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,A7=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,C7=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,R7=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,I7=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,P7=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,b7=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,L7=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,N7=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,D7=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,k7=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,O7=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,U7=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,F7=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,V7=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,z7=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,B7=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,H7=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,G7=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,W7=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,j7=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,q7=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,X7=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Y7=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,$7=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,K7=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Q7=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,J7=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Z7=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,ej=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,tj=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,nj=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,ij=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,rj=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,sj=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,oj=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const aj=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,lj=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,uj=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,cj=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,hj=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fj=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,dj=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,pj=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,mj=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,gj=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,_j=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,yj=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vj=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,xj=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Sj=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Ej=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,wj=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Tj=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Mj=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Aj=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Cj=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Rj=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Ij=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Pj=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,bj=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Lj=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Nj=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Dj=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,kj=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Oj=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Uj=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Fj=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Vj=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,zj=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Vt={alphahash_fragment:lW,alphahash_pars_fragment:uW,alphamap_fragment:cW,alphamap_pars_fragment:hW,alphatest_fragment:fW,alphatest_pars_fragment:dW,aomap_fragment:pW,aomap_pars_fragment:mW,batching_pars_vertex:gW,batching_vertex:_W,begin_vertex:yW,beginnormal_vertex:vW,bsdfs:xW,iridescence_fragment:SW,bumpmap_pars_fragment:EW,clipping_planes_fragment:wW,clipping_planes_pars_fragment:TW,clipping_planes_pars_vertex:MW,clipping_planes_vertex:AW,color_fragment:CW,color_pars_fragment:RW,color_pars_vertex:IW,color_vertex:PW,common:bW,cube_uv_reflection_fragment:LW,defaultnormal_vertex:NW,displacementmap_pars_vertex:DW,displacementmap_vertex:kW,emissivemap_fragment:OW,emissivemap_pars_fragment:UW,colorspace_fragment:FW,colorspace_pars_fragment:VW,envmap_fragment:zW,envmap_common_pars_fragment:BW,envmap_pars_fragment:HW,envmap_pars_vertex:GW,envmap_physical_pars_fragment:t7,envmap_vertex:WW,fog_vertex:jW,fog_pars_vertex:qW,fog_fragment:XW,fog_pars_fragment:YW,gradientmap_pars_fragment:$W,lightmap_fragment:KW,lightmap_pars_fragment:QW,lights_lambert_fragment:JW,lights_lambert_pars_fragment:ZW,lights_pars_begin:e7,lights_toon_fragment:n7,lights_toon_pars_fragment:i7,lights_phong_fragment:r7,lights_phong_pars_fragment:s7,lights_physical_fragment:o7,lights_physical_pars_fragment:a7,lights_fragment_begin:l7,lights_fragment_maps:u7,lights_fragment_end:c7,logdepthbuf_fragment:h7,logdepthbuf_pars_fragment:f7,logdepthbuf_pars_vertex:d7,logdepthbuf_vertex:p7,map_fragment:m7,map_pars_fragment:g7,map_particle_fragment:_7,map_particle_pars_fragment:y7,metalnessmap_fragment:v7,metalnessmap_pars_fragment:x7,morphcolor_vertex:S7,morphnormal_vertex:E7,morphtarget_pars_vertex:w7,morphtarget_vertex:T7,normal_fragment_begin:M7,normal_fragment_maps:A7,normal_pars_fragment:C7,normal_pars_vertex:R7,normal_vertex:I7,normalmap_pars_fragment:P7,clearcoat_normal_fragment_begin:b7,clearcoat_normal_fragment_maps:L7,clearcoat_pars_fragment:N7,iridescence_pars_fragment:D7,opaque_fragment:k7,packing:O7,premultiplied_alpha_fragment:U7,project_vertex:F7,dithering_fragment:V7,dithering_pars_fragment:z7,roughnessmap_fragment:B7,roughnessmap_pars_fragment:H7,shadowmap_pars_fragment:G7,shadowmap_pars_vertex:W7,shadowmap_vertex:j7,shadowmask_pars_fragment:q7,skinbase_vertex:X7,skinning_pars_vertex:Y7,skinning_vertex:$7,skinnormal_vertex:K7,specularmap_fragment:Q7,specularmap_pars_fragment:J7,tonemapping_fragment:Z7,tonemapping_pars_fragment:ej,transmission_fragment:tj,transmission_pars_fragment:nj,uv_pars_fragment:ij,uv_pars_vertex:rj,uv_vertex:sj,worldpos_vertex:oj,background_vert:aj,background_frag:lj,backgroundCube_vert:uj,backgroundCube_frag:cj,cube_vert:hj,cube_frag:fj,depth_vert:dj,depth_frag:pj,distanceRGBA_vert:mj,distanceRGBA_frag:gj,equirect_vert:_j,equirect_frag:yj,linedashed_vert:vj,linedashed_frag:xj,meshbasic_vert:Sj,meshbasic_frag:Ej,meshlambert_vert:wj,meshlambert_frag:Tj,meshmatcap_vert:Mj,meshmatcap_frag:Aj,meshnormal_vert:Cj,meshnormal_frag:Rj,meshphong_vert:Ij,meshphong_frag:Pj,meshphysical_vert:bj,meshphysical_frag:Lj,meshtoon_vert:Nj,meshtoon_frag:Dj,points_vert:kj,points_frag:Oj,shadow_vert:Uj,shadow_frag:Fj,sprite_vert:Vj,sprite_frag:zj},Fe={common:{diffuse:{value:new Ye(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Bt},alphaMap:{value:null},alphaMapTransform:{value:new Bt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Bt}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Bt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Bt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Bt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Bt},normalScale:{value:new ge(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Bt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Bt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Bt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Bt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ye(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ye(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Bt},alphaTest:{value:0},uvTransform:{value:new Bt}},sprite:{diffuse:{value:new Ye(16777215)},opacity:{value:1},center:{value:new ge(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Bt},alphaMap:{value:null},alphaMapTransform:{value:new Bt},alphaTest:{value:0}}},Hs={basic:{uniforms:fr([Fe.common,Fe.specularmap,Fe.envmap,Fe.aomap,Fe.lightmap,Fe.fog]),vertexShader:Vt.meshbasic_vert,fragmentShader:Vt.meshbasic_frag},lambert:{uniforms:fr([Fe.common,Fe.specularmap,Fe.envmap,Fe.aomap,Fe.lightmap,Fe.emissivemap,Fe.bumpmap,Fe.normalmap,Fe.displacementmap,Fe.fog,Fe.lights,{emissive:{value:new Ye(0)}}]),vertexShader:Vt.meshlambert_vert,fragmentShader:Vt.meshlambert_frag},phong:{uniforms:fr([Fe.common,Fe.specularmap,Fe.envmap,Fe.aomap,Fe.lightmap,Fe.emissivemap,Fe.bumpmap,Fe.normalmap,Fe.displacementmap,Fe.fog,Fe.lights,{emissive:{value:new Ye(0)},specular:{value:new Ye(1118481)},shininess:{value:30}}]),vertexShader:Vt.meshphong_vert,fragmentShader:Vt.meshphong_frag},standard:{uniforms:fr([Fe.common,Fe.envmap,Fe.aomap,Fe.lightmap,Fe.emissivemap,Fe.bumpmap,Fe.normalmap,Fe.displacementmap,Fe.roughnessmap,Fe.metalnessmap,Fe.fog,Fe.lights,{emissive:{value:new Ye(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Vt.meshphysical_vert,fragmentShader:Vt.meshphysical_frag},toon:{uniforms:fr([Fe.common,Fe.aomap,Fe.lightmap,Fe.emissivemap,Fe.bumpmap,Fe.normalmap,Fe.displacementmap,Fe.gradientmap,Fe.fog,Fe.lights,{emissive:{value:new Ye(0)}}]),vertexShader:Vt.meshtoon_vert,fragmentShader:Vt.meshtoon_frag},matcap:{uniforms:fr([Fe.common,Fe.bumpmap,Fe.normalmap,Fe.displacementmap,Fe.fog,{matcap:{value:null}}]),vertexShader:Vt.meshmatcap_vert,fragmentShader:Vt.meshmatcap_frag},points:{uniforms:fr([Fe.points,Fe.fog]),vertexShader:Vt.points_vert,fragmentShader:Vt.points_frag},dashed:{uniforms:fr([Fe.common,Fe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Vt.linedashed_vert,fragmentShader:Vt.linedashed_frag},depth:{uniforms:fr([Fe.common,Fe.displacementmap]),vertexShader:Vt.depth_vert,fragmentShader:Vt.depth_frag},normal:{uniforms:fr([Fe.common,Fe.bumpmap,Fe.normalmap,Fe.displacementmap,{opacity:{value:1}}]),vertexShader:Vt.meshnormal_vert,fragmentShader:Vt.meshnormal_frag},sprite:{uniforms:fr([Fe.sprite,Fe.fog]),vertexShader:Vt.sprite_vert,fragmentShader:Vt.sprite_frag},background:{uniforms:{uvTransform:{value:new Bt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Vt.background_vert,fragmentShader:Vt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Vt.backgroundCube_vert,fragmentShader:Vt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Vt.cube_vert,fragmentShader:Vt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Vt.equirect_vert,fragmentShader:Vt.equirect_frag},distanceRGBA:{uniforms:fr([Fe.common,Fe.displacementmap,{referencePosition:{value:new G},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Vt.distanceRGBA_vert,fragmentShader:Vt.distanceRGBA_frag},shadow:{uniforms:fr([Fe.lights,Fe.fog,{color:{value:new Ye(0)},opacity:{value:1}}]),vertexShader:Vt.shadow_vert,fragmentShader:Vt.shadow_frag}};Hs.physical={uniforms:fr([Hs.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Bt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Bt},clearcoatNormalScale:{value:new ge(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Bt},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Bt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Bt},sheen:{value:0},sheenColor:{value:new Ye(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Bt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Bt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Bt},transmissionSamplerSize:{value:new ge},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Bt},attenuationDistance:{value:0},attenuationColor:{value:new Ye(0)},specularColor:{value:new Ye(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Bt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Bt},anisotropyVector:{value:new ge},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Bt}}]),vertexShader:Vt.meshphysical_vert,fragmentShader:Vt.meshphysical_frag};const kg={r:0,b:0,g:0};function Bj(n,e,t,i,r,s,o){const a=new Ye(0);let l=s===!0?0:1,h,f,d=null,p=0,_=null;function v(x,y){let w=!1,E=y.isScene===!0?y.background:null;E&&E.isTexture&&(E=(y.backgroundBlurriness>0?t:e).get(E)),E===null?T(a,l):E&&E.isColor&&(T(E,1),w=!0);const I=n.xr.getEnvironmentBlendMode();I==="additive"?i.buffers.color.setClear(0,0,0,1,o):I==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||w)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),E&&(E.isCubeTexture||E.mapping===uf)?(f===void 0&&(f=new ui(new Qu(1,1,1),new ns({name:"BackgroundCubeMaterial",uniforms:Xh(Hs.backgroundCube.uniforms),vertexShader:Hs.backgroundCube.vertexShader,fragmentShader:Hs.backgroundCube.fragmentShader,side:_r,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),f.geometry.deleteAttribute("uv"),f.onBeforeRender=function(O,D,R){this.matrixWorld.copyPosition(R.matrixWorld)},Object.defineProperty(f.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(f)),f.material.uniforms.envMap.value=E,f.material.uniforms.flipEnvMap.value=E.isCubeTexture&&E.isRenderTargetTexture===!1?-1:1,f.material.uniforms.backgroundBlurriness.value=y.backgroundBlurriness,f.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,f.material.toneMapped=dn.getTransfer(E.colorSpace)!==yn,(d!==E||p!==E.version||_!==n.toneMapping)&&(f.material.needsUpdate=!0,d=E,p=E.version,_=n.toneMapping),f.layers.enableAll(),x.unshift(f,f.geometry,f.material,0,0,null)):E&&E.isTexture&&(h===void 0&&(h=new ui(new cf(2,2),new ns({name:"BackgroundMaterial",uniforms:Xh(Hs.background.uniforms),vertexShader:Hs.background.vertexShader,fragmentShader:Hs.background.fragmentShader,side:sa,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(h)),h.material.uniforms.t2D.value=E,h.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,h.material.toneMapped=dn.getTransfer(E.colorSpace)!==yn,E.matrixAutoUpdate===!0&&E.updateMatrix(),h.material.uniforms.uvTransform.value.copy(E.matrix),(d!==E||p!==E.version||_!==n.toneMapping)&&(h.material.needsUpdate=!0,d=E,p=E.version,_=n.toneMapping),h.layers.enableAll(),x.unshift(h,h.geometry,h.material,0,0,null))}function T(x,y){x.getRGB(kg,fk(n)),i.buffers.color.setClear(kg.r,kg.g,kg.b,y,o)}return{getClearColor:function(){return a},setClearColor:function(x,y=1){a.set(x),l=y,T(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(x){l=x,T(a,l)},render:v}}function Hj(n,e,t,i){const r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||s!==null,a={},l=x(null);let h=l,f=!1;function d(Y,re,se,ye,W){let K=!1;if(o){const Q=T(ye,se,re);h!==Q&&(h=Q,_(h.object)),K=y(Y,ye,se,W),K&&w(Y,ye,se,W)}else{const Q=re.wireframe===!0;(h.geometry!==ye.id||h.program!==se.id||h.wireframe!==Q)&&(h.geometry=ye.id,h.program=se.id,h.wireframe=Q,K=!0)}W!==null&&t.update(W,n.ELEMENT_ARRAY_BUFFER),(K||f)&&(f=!1,b(Y,re,se,ye),W!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(W).buffer))}function p(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}function _(Y){return i.isWebGL2?n.bindVertexArray(Y):s.bindVertexArrayOES(Y)}function v(Y){return i.isWebGL2?n.deleteVertexArray(Y):s.deleteVertexArrayOES(Y)}function T(Y,re,se){const ye=se.wireframe===!0;let W=a[Y.id];W===void 0&&(W={},a[Y.id]=W);let K=W[re.id];K===void 0&&(K={},W[re.id]=K);let Q=K[ye];return Q===void 0&&(Q=x(p()),K[ye]=Q),Q}function x(Y){const re=[],se=[],ye=[];for(let W=0;W<r;W++)re[W]=0,se[W]=0,ye[W]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:re,enabledAttributes:se,attributeDivisors:ye,object:Y,attributes:{},index:null}}function y(Y,re,se,ye){const W=h.attributes,K=re.attributes;let Q=0;const ee=se.getAttributes();for(const _e in ee)if(ee[_e].location>=0){const oe=W[_e];let xe=K[_e];if(xe===void 0&&(_e==="instanceMatrix"&&Y.instanceMatrix&&(xe=Y.instanceMatrix),_e==="instanceColor"&&Y.instanceColor&&(xe=Y.instanceColor)),oe===void 0||oe.attribute!==xe||xe&&oe.data!==xe.data)return!0;Q++}return h.attributesNum!==Q||h.index!==ye}function w(Y,re,se,ye){const W={},K=re.attributes;let Q=0;const ee=se.getAttributes();for(const _e in ee)if(ee[_e].location>=0){let oe=K[_e];oe===void 0&&(_e==="instanceMatrix"&&Y.instanceMatrix&&(oe=Y.instanceMatrix),_e==="instanceColor"&&Y.instanceColor&&(oe=Y.instanceColor));const xe={};xe.attribute=oe,oe&&oe.data&&(xe.data=oe.data),W[_e]=xe,Q++}h.attributes=W,h.attributesNum=Q,h.index=ye}function E(){const Y=h.newAttributes;for(let re=0,se=Y.length;re<se;re++)Y[re]=0}function I(Y){O(Y,0)}function O(Y,re){const se=h.newAttributes,ye=h.enabledAttributes,W=h.attributeDivisors;se[Y]=1,ye[Y]===0&&(n.enableVertexAttribArray(Y),ye[Y]=1),W[Y]!==re&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Y,re),W[Y]=re)}function D(){const Y=h.newAttributes,re=h.enabledAttributes;for(let se=0,ye=re.length;se<ye;se++)re[se]!==Y[se]&&(n.disableVertexAttribArray(se),re[se]=0)}function R(Y,re,se,ye,W,K,Q){Q===!0?n.vertexAttribIPointer(Y,re,se,W,K):n.vertexAttribPointer(Y,re,se,ye,W,K)}function b(Y,re,se,ye){if(i.isWebGL2===!1&&(Y.isInstancedMesh||ye.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;E();const W=ye.attributes,K=se.getAttributes(),Q=re.defaultAttributeValues;for(const ee in K){const _e=K[ee];if(_e.location>=0){let Ne=W[ee];if(Ne===void 0&&(ee==="instanceMatrix"&&Y.instanceMatrix&&(Ne=Y.instanceMatrix),ee==="instanceColor"&&Y.instanceColor&&(Ne=Y.instanceColor)),Ne!==void 0){const oe=Ne.normalized,xe=Ne.itemSize,Le=t.get(Ne);if(Le===void 0)continue;const ze=Le.buffer,at=Le.type,Ze=Le.bytesPerElement,St=i.isWebGL2===!0&&(at===n.INT||at===n.UNSIGNED_INT||Ne.gpuType===MT);if(Ne.isInterleavedBufferAttribute){const nt=Ne.data,X=nt.stride,Ce=Ne.offset;if(nt.isInstancedInterleavedBuffer){for(let me=0;me<_e.locationSize;me++)O(_e.location+me,nt.meshPerAttribute);Y.isInstancedMesh!==!0&&ye._maxInstanceCount===void 0&&(ye._maxInstanceCount=nt.meshPerAttribute*nt.count)}else for(let me=0;me<_e.locationSize;me++)I(_e.location+me);n.bindBuffer(n.ARRAY_BUFFER,ze);for(let me=0;me<_e.locationSize;me++)R(_e.location+me,xe/_e.locationSize,at,oe,X*Ze,(Ce+xe/_e.locationSize*me)*Ze,St)}else{if(Ne.isInstancedBufferAttribute){for(let nt=0;nt<_e.locationSize;nt++)O(_e.location+nt,Ne.meshPerAttribute);Y.isInstancedMesh!==!0&&ye._maxInstanceCount===void 0&&(ye._maxInstanceCount=Ne.meshPerAttribute*Ne.count)}else for(let nt=0;nt<_e.locationSize;nt++)I(_e.location+nt);n.bindBuffer(n.ARRAY_BUFFER,ze);for(let nt=0;nt<_e.locationSize;nt++)R(_e.location+nt,xe/_e.locationSize,at,oe,xe*Ze,xe/_e.locationSize*nt*Ze,St)}}else if(Q!==void 0){const oe=Q[ee];if(oe!==void 0)switch(oe.length){case 2:n.vertexAttrib2fv(_e.location,oe);break;case 3:n.vertexAttrib3fv(_e.location,oe);break;case 4:n.vertexAttrib4fv(_e.location,oe);break;default:n.vertexAttrib1fv(_e.location,oe)}}}}D()}function k(){V();for(const Y in a){const re=a[Y];for(const se in re){const ye=re[se];for(const W in ye)v(ye[W].object),delete ye[W];delete re[se]}delete a[Y]}}function M(Y){if(a[Y.id]===void 0)return;const re=a[Y.id];for(const se in re){const ye=re[se];for(const W in ye)v(ye[W].object),delete ye[W];delete re[se]}delete a[Y.id]}function P(Y){for(const re in a){const se=a[re];if(se[Y.id]===void 0)continue;const ye=se[Y.id];for(const W in ye)v(ye[W].object),delete ye[W];delete se[Y.id]}}function V(){F(),f=!0,h!==l&&(h=l,_(h.object))}function F(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:d,reset:V,resetDefaultState:F,dispose:k,releaseStatesOfGeometry:M,releaseStatesOfProgram:P,initAttributes:E,enableAttribute:I,disableUnusedAttributes:D}}function Gj(n,e,t,i){const r=i.isWebGL2;let s;function o(f){s=f}function a(f,d){n.drawArrays(s,f,d),t.update(d,s,1)}function l(f,d,p){if(p===0)return;let _,v;if(r)_=n,v="drawArraysInstanced";else if(_=e.get("ANGLE_instanced_arrays"),v="drawArraysInstancedANGLE",_===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}_[v](s,f,d,p),t.update(d,s,p)}function h(f,d,p){if(p===0)return;const _=e.get("WEBGL_multi_draw");if(_===null)for(let v=0;v<p;v++)this.render(f[v],d[v]);else{_.multiDrawArraysWEBGL(s,f,0,d,0,p);let v=0;for(let T=0;T<p;T++)v+=d[T];t.update(v,s,1)}}this.setMode=o,this.render=a,this.renderInstances=l,this.renderMultiDraw=h}function Wj(n,e,t){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const R=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(R.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(R){if(R==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";R="mediump"}return R==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext";let a=t.precision!==void 0?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const h=o||e.has("WEBGL_draw_buffers"),f=t.logarithmicDepthBuffer===!0,d=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),p=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),_=n.getParameter(n.MAX_TEXTURE_SIZE),v=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),T=n.getParameter(n.MAX_VERTEX_ATTRIBS),x=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),y=n.getParameter(n.MAX_VARYING_VECTORS),w=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),E=p>0,I=o||e.has("OES_texture_float"),O=E&&I,D=o?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:h,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:f,maxTextures:d,maxVertexTextures:p,maxTextureSize:_,maxCubemapSize:v,maxAttributes:T,maxVertexUniforms:x,maxVaryings:y,maxFragmentUniforms:w,vertexTextures:E,floatFragmentTextures:I,floatVertexTextures:O,maxSamples:D}}function jj(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new zo,a=new Bt,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,p){const _=d.length!==0||p||i!==0||r;return r=p,i=d.length,_},this.beginShadows=function(){s=!0,f(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,p){t=f(d,p,0)},this.setState=function(d,p,_){const v=d.clippingPlanes,T=d.clipIntersection,x=d.clipShadows,y=n.get(d);if(!r||v===null||v.length===0||s&&!x)s?f(null):h();else{const w=s?0:i,E=w*4;let I=y.clippingState||null;l.value=I,I=f(v,p,E,_);for(let O=0;O!==E;++O)I[O]=t[O];y.clippingState=I,this.numIntersection=T?this.numPlanes:0,this.numPlanes+=w}};function h(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function f(d,p,_,v){const T=d!==null?d.length:0;let x=null;if(T!==0){if(x=l.value,v!==!0||x===null){const y=_+T*4,w=p.matrixWorldInverse;a.getNormalMatrix(w),(x===null||x.length<y)&&(x=new Float32Array(y));for(let E=0,I=_;E!==T;++E,I+=4)o.copy(d[E]).applyMatrix4(w,a),o.normal.toArray(x,I),x[I+3]=o.constant}l.value=x,l.needsUpdate=!0}return e.numPlanes=T,e.numIntersection=0,x}}function qj(n){let e=new WeakMap;function t(o,a){return a===up?o.mapping=oa:a===cp&&(o.mapping=ml),o}function i(o){if(o&&o.isTexture){const a=o.mapping;if(a===up||a===cp)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const h=new mk(l.height);return h.fromEquirectangularTexture(n,o),e.set(o,h),o.addEventListener("dispose",r),t(h.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}class sl extends Kp{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=h*this.view.offsetX,o=s+h*this.view.width,a-=f*this.view.offsetY,l=a-f*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const dh=4,GI=[.125,.215,.35,.446,.526,.582],fu=20,Xx=new sl,WI=new Ye;let Yx=null,$x=0,Kx=0;const uu=(1+Math.sqrt(5))/2,zc=1/uu,jI=[new G(1,1,1),new G(-1,1,1),new G(1,1,-1),new G(-1,1,-1),new G(0,uu,zc),new G(0,uu,-zc),new G(zc,0,uu),new G(-zc,0,uu),new G(uu,zc,0),new G(-uu,zc,0)];class ww{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){Yx=this._renderer.getRenderTarget(),$x=this._renderer.getActiveCubeFace(),Kx=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=YI(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=XI(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Yx,$x,Kx),e.scissorTest=!1,Og(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===oa||e.mapping===ml?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Yx=this._renderer.getRenderTarget(),$x=this._renderer.getActiveCubeFace(),Kx=this._renderer.getActiveMipmapLevel();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:On,minFilter:On,generateMipmaps:!1,type:jh,format:pr,colorSpace:wo,depthBuffer:!1},r=qI(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=qI(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Xj(s)),this._blurMaterial=Yj(s,e,t)}return r}_compileMaterial(e){const t=new ui(this._lodPlanes[0],e);this._renderer.compile(t,Xx)}_sceneToCubeUV(e,t,i,r){const a=new ti(90,1,t,i),l=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],f=this._renderer,d=f.autoClear,p=f.toneMapping;f.getClearColor(WI),f.toneMapping=vo,f.autoClear=!1;const _=new Cl({name:"PMREM.Background",side:_r,depthWrite:!1,depthTest:!1}),v=new ui(new Qu,_);let T=!1;const x=e.background;x?x.isColor&&(_.color.copy(x),e.background=null,T=!0):(_.color.copy(WI),T=!0);for(let y=0;y<6;y++){const w=y%3;w===0?(a.up.set(0,l[y],0),a.lookAt(h[y],0,0)):w===1?(a.up.set(0,0,l[y]),a.lookAt(0,h[y],0)):(a.up.set(0,l[y],0),a.lookAt(0,0,h[y]));const E=this._cubeSize;Og(r,w*E,y>2?E:0,E,E),f.setRenderTarget(r),T&&f.render(v,a),f.render(e,a)}v.geometry.dispose(),v.material.dispose(),f.toneMapping=p,f.autoClear=d,e.background=x}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===oa||e.mapping===ml;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=YI()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=XI());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new ui(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;Og(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,Xx)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=jI[(r-1)%jI.length];this._blur(e,r-1,r,s,o)}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,h=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const f=3,d=new ui(this._lodPlanes[r],h),p=h.uniforms,_=this._sizeLods[i]-1,v=isFinite(s)?Math.PI/(2*_):2*Math.PI/(2*fu-1),T=s/v,x=isFinite(s)?1+Math.floor(f*T):fu;x>fu&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${x} samples when the maximum is set to ${fu}`);const y=[];let w=0;for(let R=0;R<fu;++R){const b=R/T,k=Math.exp(-b*b/2);y.push(k),R===0?w+=k:R<x&&(w+=2*k)}for(let R=0;R<y.length;R++)y[R]=y[R]/w;p.envMap.value=e.texture,p.samples.value=x,p.weights.value=y,p.latitudinal.value=o==="latitudinal",a&&(p.poleAxis.value=a);const{_lodMax:E}=this;p.dTheta.value=v,p.mipInt.value=E-i;const I=this._sizeLods[r],O=3*I*(r>E-dh?r-E+dh:0),D=4*(this._cubeSize-I);Og(t,O,D,3*I,2*I),l.setRenderTarget(t),l.render(d,Xx)}}function Xj(n){const e=[],t=[],i=[];let r=n;const s=n-dh+1+GI.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-dh?l=GI[o-n+dh-1]:o===0&&(l=0),i.push(l);const h=1/(a-2),f=-h,d=1+h,p=[f,f,d,f,d,d,f,f,d,d,f,d],_=6,v=6,T=3,x=2,y=1,w=new Float32Array(T*v*_),E=new Float32Array(x*v*_),I=new Float32Array(y*v*_);for(let D=0;D<_;D++){const R=D%3*2/3-1,b=D>2?0:-1,k=[R,b,0,R+2/3,b,0,R+2/3,b+1,0,R,b,0,R+2/3,b+1,0,R,b+1,0];w.set(k,T*v*D),E.set(p,x*v*D);const M=[D,D,D,D,D,D];I.set(M,y*v*D)}const O=new Ht;O.setAttribute("position",new mn(w,T)),O.setAttribute("uv",new mn(E,x)),O.setAttribute("faceIndex",new mn(I,y)),e.push(O),r>dh&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function qI(n,e,t){const i=new $s(n,e,t);return i.texture.mapping=uf,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Og(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function Yj(n,e,t){const i=new Float32Array(fu),r=new G(0,1,0);return new ns({name:"SphericalGaussianBlur",defines:{n:fu,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:BT(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ko,depthTest:!1,depthWrite:!1})}function XI(){return new ns({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:BT(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ko,depthTest:!1,depthWrite:!1})}function YI(){return new ns({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:BT(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ko,depthTest:!1,depthWrite:!1})}function BT(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function $j(n){let e=new WeakMap,t=null;function i(a){if(a&&a.isTexture){const l=a.mapping,h=l===up||l===cp,f=l===oa||l===ml;if(h||f)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let d=e.get(a);return t===null&&(t=new ww(n)),d=h?t.fromEquirectangular(a,d):t.fromCubemap(a,d),e.set(a,d),d.texture}else{if(e.has(a))return e.get(a).texture;{const d=a.image;if(h&&d&&d.height>0||f&&d&&r(d)){t===null&&(t=new ww(n));const p=h?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,p),a.addEventListener("dispose",s),p.texture}else return null}}}return a}function r(a){let l=0;const h=6;for(let f=0;f<h;f++)a[f]!==void 0&&l++;return l===h}function s(a){const l=a.target;l.removeEventListener("dispose",s);const h=e.get(l);h!==void 0&&(e.delete(l),h.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:o}}function Kj(n){const e={};function t(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return t(i)!==null},init:function(i){i.isWebGL2?(t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance")):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return r===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function Qj(n,e,t,i){const r={},s=new WeakMap;function o(d){const p=d.target;p.index!==null&&e.remove(p.index);for(const v in p.attributes)e.remove(p.attributes[v]);for(const v in p.morphAttributes){const T=p.morphAttributes[v];for(let x=0,y=T.length;x<y;x++)e.remove(T[x])}p.removeEventListener("dispose",o),delete r[p.id];const _=s.get(p);_&&(e.remove(_),s.delete(p)),i.releaseStatesOfGeometry(p),p.isInstancedBufferGeometry===!0&&delete p._maxInstanceCount,t.memory.geometries--}function a(d,p){return r[p.id]===!0||(p.addEventListener("dispose",o),r[p.id]=!0,t.memory.geometries++),p}function l(d){const p=d.attributes;for(const v in p)e.update(p[v],n.ARRAY_BUFFER);const _=d.morphAttributes;for(const v in _){const T=_[v];for(let x=0,y=T.length;x<y;x++)e.update(T[x],n.ARRAY_BUFFER)}}function h(d){const p=[],_=d.index,v=d.attributes.position;let T=0;if(_!==null){const w=_.array;T=_.version;for(let E=0,I=w.length;E<I;E+=3){const O=w[E+0],D=w[E+1],R=w[E+2];p.push(O,D,D,R,R,O)}}else if(v!==void 0){const w=v.array;T=v.version;for(let E=0,I=w.length/3-1;E<I;E+=3){const O=E+0,D=E+1,R=E+2;p.push(O,D,D,R,R,O)}}else return;const x=new(lk(p)?zT:VT)(p,1);x.version=T;const y=s.get(d);y&&e.remove(y),s.set(d,x)}function f(d){const p=s.get(d);if(p){const _=d.index;_!==null&&p.version<_.version&&h(d)}else h(d);return s.get(d)}return{get:a,update:l,getWireframeAttribute:f}}function Jj(n,e,t,i){const r=i.isWebGL2;let s;function o(_){s=_}let a,l;function h(_){a=_.type,l=_.bytesPerElement}function f(_,v){n.drawElements(s,v,a,_*l),t.update(v,s,1)}function d(_,v,T){if(T===0)return;let x,y;if(r)x=n,y="drawElementsInstanced";else if(x=e.get("ANGLE_instanced_arrays"),y="drawElementsInstancedANGLE",x===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}x[y](s,v,a,_*l,T),t.update(v,s,T)}function p(_,v,T){if(T===0)return;const x=e.get("WEBGL_multi_draw");if(x===null)for(let y=0;y<T;y++)this.render(_[y]/l,v[y]);else{x.multiDrawElementsWEBGL(s,v,0,a,_,0,T);let y=0;for(let w=0;w<T;w++)y+=v[w];t.update(y,s,1)}}this.setMode=o,this.setIndex=h,this.render=f,this.renderInstances=d,this.renderMultiDraw=p}function Zj(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:i}}function eq(n,e){return n[0]-e[0]}function tq(n,e){return Math.abs(e[1])-Math.abs(n[1])}function nq(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new cn,a=[];for(let h=0;h<8;h++)a[h]=[h,0];function l(h,f,d){const p=h.morphTargetInfluences;if(e.isWebGL2===!0){const _=f.morphAttributes.position||f.morphAttributes.normal||f.morphAttributes.color,v=_!==void 0?_.length:0;let T=s.get(f);if(T===void 0||T.count!==v){let Y=function(){V.dispose(),s.delete(f),f.removeEventListener("dispose",Y)};T!==void 0&&T.texture.dispose();const w=f.morphAttributes.position!==void 0,E=f.morphAttributes.normal!==void 0,I=f.morphAttributes.color!==void 0,O=f.morphAttributes.position||[],D=f.morphAttributes.normal||[],R=f.morphAttributes.color||[];let b=0;w===!0&&(b=1),E===!0&&(b=2),I===!0&&(b=3);let k=f.attributes.position.count*b,M=1;k>e.maxTextureSize&&(M=Math.ceil(k/e.maxTextureSize),k=e.maxTextureSize);const P=new Float32Array(k*M*4*v),V=new Pv(P,k,M,v);V.type=Ss,V.needsUpdate=!0;const F=b*4;for(let re=0;re<v;re++){const se=O[re],ye=D[re],W=R[re],K=k*M*4*re;for(let Q=0;Q<se.count;Q++){const ee=Q*F;w===!0&&(o.fromBufferAttribute(se,Q),P[K+ee+0]=o.x,P[K+ee+1]=o.y,P[K+ee+2]=o.z,P[K+ee+3]=0),E===!0&&(o.fromBufferAttribute(ye,Q),P[K+ee+4]=o.x,P[K+ee+5]=o.y,P[K+ee+6]=o.z,P[K+ee+7]=0),I===!0&&(o.fromBufferAttribute(W,Q),P[K+ee+8]=o.x,P[K+ee+9]=o.y,P[K+ee+10]=o.z,P[K+ee+11]=W.itemSize===4?o.w:1)}}T={count:v,texture:V,size:new ge(k,M)},s.set(f,T),f.addEventListener("dispose",Y)}let x=0;for(let w=0;w<p.length;w++)x+=p[w];const y=f.morphTargetsRelative?1:1-x;d.getUniforms().setValue(n,"morphTargetBaseInfluence",y),d.getUniforms().setValue(n,"morphTargetInfluences",p),d.getUniforms().setValue(n,"morphTargetsTexture",T.texture,t),d.getUniforms().setValue(n,"morphTargetsTextureSize",T.size)}else{const _=p===void 0?0:p.length;let v=i[f.id];if(v===void 0||v.length!==_){v=[];for(let E=0;E<_;E++)v[E]=[E,0];i[f.id]=v}for(let E=0;E<_;E++){const I=v[E];I[0]=E,I[1]=p[E]}v.sort(tq);for(let E=0;E<8;E++)E<_&&v[E][1]?(a[E][0]=v[E][0],a[E][1]=v[E][1]):(a[E][0]=Number.MAX_SAFE_INTEGER,a[E][1]=0);a.sort(eq);const T=f.morphAttributes.position,x=f.morphAttributes.normal;let y=0;for(let E=0;E<8;E++){const I=a[E],O=I[0],D=I[1];O!==Number.MAX_SAFE_INTEGER&&D?(T&&f.getAttribute("morphTarget"+E)!==T[O]&&f.setAttribute("morphTarget"+E,T[O]),x&&f.getAttribute("morphNormal"+E)!==x[O]&&f.setAttribute("morphNormal"+E,x[O]),r[E]=D,y+=D):(T&&f.hasAttribute("morphTarget"+E)===!0&&f.deleteAttribute("morphTarget"+E),x&&f.hasAttribute("morphNormal"+E)===!0&&f.deleteAttribute("morphNormal"+E),r[E]=0)}const w=f.morphTargetsRelative?1:1-y;d.getUniforms().setValue(n,"morphTargetBaseInfluence",w),d.getUniforms().setValue(n,"morphTargetInfluences",r)}}return{update:l}}function iq(n,e,t,i){let r=new WeakMap;function s(l){const h=i.render.frame,f=l.geometry,d=e.get(l,f);if(r.get(d)!==h&&(e.update(d),r.set(d,h)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==h&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),r.set(l,h))),l.isSkinnedMesh){const p=l.skeleton;r.get(p)!==h&&(p.update(),r.set(p,h))}return d}function o(){r=new WeakMap}function a(l){const h=l.target;h.removeEventListener("dispose",a),t.remove(h.instanceMatrix),h.instanceColor!==null&&t.remove(h.instanceColor)}return{update:s,dispose:o}}class HT extends Pn{constructor(e,t,i,r,s,o,a,l,h,f){if(f=f!==void 0?f:il,f!==il&&f!==Gu)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&f===il&&(i=qo),i===void 0&&f===Gu&&(i=nl),super(null,r,s,o,a,l,f,i,h),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:Zn,this.minFilter=l!==void 0?l:Zn,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const _k=new Pn,yk=new HT(1,1);yk.compareFunction=DT;const vk=new Pv,xk=new FT,Sk=new Qp,$I=[],KI=[],QI=new Float32Array(16),JI=new Float32Array(9),ZI=new Float32Array(4);function hf(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=$I[r];if(s===void 0&&(s=new Float32Array(r),$I[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function _i(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function yi(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function bv(n,e){let t=KI[e];t===void 0&&(t=new Int32Array(e),KI[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function rq(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function sq(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(_i(t,e))return;n.uniform2fv(this.addr,e),yi(t,e)}}function oq(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(_i(t,e))return;n.uniform3fv(this.addr,e),yi(t,e)}}function aq(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(_i(t,e))return;n.uniform4fv(this.addr,e),yi(t,e)}}function lq(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(_i(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),yi(t,e)}else{if(_i(t,i))return;ZI.set(i),n.uniformMatrix2fv(this.addr,!1,ZI),yi(t,i)}}function uq(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(_i(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),yi(t,e)}else{if(_i(t,i))return;JI.set(i),n.uniformMatrix3fv(this.addr,!1,JI),yi(t,i)}}function cq(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(_i(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),yi(t,e)}else{if(_i(t,i))return;QI.set(i),n.uniformMatrix4fv(this.addr,!1,QI),yi(t,i)}}function hq(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function fq(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(_i(t,e))return;n.uniform2iv(this.addr,e),yi(t,e)}}function dq(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(_i(t,e))return;n.uniform3iv(this.addr,e),yi(t,e)}}function pq(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(_i(t,e))return;n.uniform4iv(this.addr,e),yi(t,e)}}function mq(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function gq(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(_i(t,e))return;n.uniform2uiv(this.addr,e),yi(t,e)}}function _q(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(_i(t,e))return;n.uniform3uiv(this.addr,e),yi(t,e)}}function yq(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(_i(t,e))return;n.uniform4uiv(this.addr,e),yi(t,e)}}function vq(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r);const s=this.type===n.SAMPLER_2D_SHADOW?yk:_k;t.setTexture2D(e||s,r)}function xq(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||xk,r)}function Sq(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||Sk,r)}function Eq(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||vk,r)}function wq(n){switch(n){case 5126:return rq;case 35664:return sq;case 35665:return oq;case 35666:return aq;case 35674:return lq;case 35675:return uq;case 35676:return cq;case 5124:case 35670:return hq;case 35667:case 35671:return fq;case 35668:case 35672:return dq;case 35669:case 35673:return pq;case 5125:return mq;case 36294:return gq;case 36295:return _q;case 36296:return yq;case 35678:case 36198:case 36298:case 36306:case 35682:return vq;case 35679:case 36299:case 36307:return xq;case 35680:case 36300:case 36308:case 36293:return Sq;case 36289:case 36303:case 36311:case 36292:return Eq}}function Tq(n,e){n.uniform1fv(this.addr,e)}function Mq(n,e){const t=hf(e,this.size,2);n.uniform2fv(this.addr,t)}function Aq(n,e){const t=hf(e,this.size,3);n.uniform3fv(this.addr,t)}function Cq(n,e){const t=hf(e,this.size,4);n.uniform4fv(this.addr,t)}function Rq(n,e){const t=hf(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function Iq(n,e){const t=hf(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function Pq(n,e){const t=hf(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function bq(n,e){n.uniform1iv(this.addr,e)}function Lq(n,e){n.uniform2iv(this.addr,e)}function Nq(n,e){n.uniform3iv(this.addr,e)}function Dq(n,e){n.uniform4iv(this.addr,e)}function kq(n,e){n.uniform1uiv(this.addr,e)}function Oq(n,e){n.uniform2uiv(this.addr,e)}function Uq(n,e){n.uniform3uiv(this.addr,e)}function Fq(n,e){n.uniform4uiv(this.addr,e)}function Vq(n,e,t){const i=this.cache,r=e.length,s=bv(t,r);_i(i,s)||(n.uniform1iv(this.addr,s),yi(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||_k,s[o])}function zq(n,e,t){const i=this.cache,r=e.length,s=bv(t,r);_i(i,s)||(n.uniform1iv(this.addr,s),yi(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||xk,s[o])}function Bq(n,e,t){const i=this.cache,r=e.length,s=bv(t,r);_i(i,s)||(n.uniform1iv(this.addr,s),yi(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||Sk,s[o])}function Hq(n,e,t){const i=this.cache,r=e.length,s=bv(t,r);_i(i,s)||(n.uniform1iv(this.addr,s),yi(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||vk,s[o])}function Gq(n){switch(n){case 5126:return Tq;case 35664:return Mq;case 35665:return Aq;case 35666:return Cq;case 35674:return Rq;case 35675:return Iq;case 35676:return Pq;case 5124:case 35670:return bq;case 35667:case 35671:return Lq;case 35668:case 35672:return Nq;case 35669:case 35673:return Dq;case 5125:return kq;case 36294:return Oq;case 36295:return Uq;case 36296:return Fq;case 35678:case 36198:case 36298:case 36306:case 35682:return Vq;case 35679:case 36299:case 36307:return zq;case 35680:case 36300:case 36308:case 36293:return Bq;case 36289:case 36303:case 36311:case 36292:return Hq}}class Wq{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=wq(t.type)}}class jq{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=Gq(t.type)}}class qq{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const Qx=/(\w+)(\])?(\[|\.)?/g;function eP(n,e){n.seq.push(e),n.map[e.id]=e}function Xq(n,e,t){const i=n.name,r=i.length;for(Qx.lastIndex=0;;){const s=Qx.exec(i),o=Qx.lastIndex;let a=s[1];const l=s[2]==="]",h=s[3];if(l&&(a=a|0),h===void 0||h==="["&&o+2===r){eP(t,h===void 0?new Wq(a,n,e):new jq(a,n,e));break}else{let d=t.map[a];d===void 0&&(d=new qq(a),eP(t,d)),t=d}}}class z_{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);Xq(s,o,this)}}setValue(e,t,i,r){const s=this.map[t];s!==void 0&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function tP(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const Yq=37297;let $q=0;function Kq(n,e){const t=n.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join(`
`)}function Qq(n){const e=dn.getPrimaries(dn.workingColorSpace),t=dn.getPrimaries(n);let i;switch(e===t?i="":e===yp&&t===_p?i="LinearDisplayP3ToLinearSRGB":e===_p&&t===yp&&(i="LinearSRGBToLinearDisplayP3"),n){case wo:case Yp:return[i,"LinearTransferOETF"];case di:case Iv:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}function nP(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+Kq(n.getShaderSource(e),o)}else return r}function Jq(n,e){const t=Qq(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function Zq(n,e){let t;switch(e){case k3:t="Linear";break;case O3:t="Reinhard";break;case U3:t="OptimizedCineon";break;case TT:t="ACESFilmic";break;case V3:t="AgX";break;case F3:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function eX(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.alphaToCoverage||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ph).join(`
`)}function tX(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(ph).join(`
`)}function nX(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function iX(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function ph(n){return n!==""}function iP(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function rP(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const rX=/^[ \t]*#include +<([\w\d./]+)>/gm;function Tw(n){return n.replace(rX,oX)}const sX=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function oX(n,e){let t=Vt[e];if(t===void 0){const i=sX.get(e);if(i!==void 0)t=Vt[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return Tw(t)}const aX=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function sP(n){return n.replace(aX,lX)}function lX(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function oP(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	`;return n.isWebGL2&&(e+=`precision ${n.precision} sampler3D;
		precision ${n.precision} sampler2DArray;
		precision ${n.precision} sampler2DShadow;
		precision ${n.precision} samplerCubeShadow;
		precision ${n.precision} sampler2DArrayShadow;
		precision ${n.precision} isampler2D;
		precision ${n.precision} isampler3D;
		precision ${n.precision} isamplerCube;
		precision ${n.precision} isampler2DArray;
		precision ${n.precision} usampler2D;
		precision ${n.precision} usampler3D;
		precision ${n.precision} usamplerCube;
		precision ${n.precision} usampler2DArray;
		`),n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function uX(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===Mv?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===bd?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Fs&&(e="SHADOWMAP_TYPE_VSM"),e}function cX(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case oa:case ml:e="ENVMAP_TYPE_CUBE";break;case uf:e="ENVMAP_TYPE_CUBE_UV";break}return e}function hX(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case ml:e="ENVMAP_MODE_REFRACTION";break}return e}function fX(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Xp:e="ENVMAP_BLENDING_MULTIPLY";break;case N3:e="ENVMAP_BLENDING_MIX";break;case D3:e="ENVMAP_BLENDING_ADD";break}return e}function dX(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function pX(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=uX(t),h=cX(t),f=hX(t),d=fX(t),p=dX(t),_=t.isWebGL2?"":eX(t),v=tX(t),T=nX(s),x=r.createProgram();let y,w,E=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(y=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,T].filter(ph).join(`
`),y.length>0&&(y+=`
`),w=[_,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,T].filter(ph).join(`
`),w.length>0&&(w+=`
`)):(y=[oP(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,T,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+f:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(ph).join(`
`),w=[_,oP(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,T,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.envMap?"#define "+f:"",t.envMap?"#define "+d:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==vo?"#define TONE_MAPPING":"",t.toneMapping!==vo?Vt.tonemapping_pars_fragment:"",t.toneMapping!==vo?Zq("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Vt.colorspace_pars_fragment,Jq("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(ph).join(`
`)),o=Tw(o),o=iP(o,t),o=rP(o,t),a=Tw(a),a=iP(a,t),a=rP(a,t),o=sP(o),a=sP(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(E=`#version 300 es
`,y=[v,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+y,w=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===Sw?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Sw?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+w);const I=E+y+o,O=E+w+a,D=tP(r,r.VERTEX_SHADER,I),R=tP(r,r.FRAGMENT_SHADER,O);r.attachShader(x,D),r.attachShader(x,R),t.index0AttributeName!==void 0?r.bindAttribLocation(x,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(x,0,"position"),r.linkProgram(x);function b(V){if(n.debug.checkShaderErrors){const F=r.getProgramInfoLog(x).trim(),Y=r.getShaderInfoLog(D).trim(),re=r.getShaderInfoLog(R).trim();let se=!0,ye=!0;if(r.getProgramParameter(x,r.LINK_STATUS)===!1)if(se=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(r,x,D,R);else{const W=nP(r,D,"vertex"),K=nP(r,R,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(x,r.VALIDATE_STATUS)+`

Material Name: `+V.name+`
Material Type: `+V.type+`

Program Info Log: `+F+`
`+W+`
`+K)}else F!==""?console.warn("THREE.WebGLProgram: Program Info Log:",F):(Y===""||re==="")&&(ye=!1);ye&&(V.diagnostics={runnable:se,programLog:F,vertexShader:{log:Y,prefix:y},fragmentShader:{log:re,prefix:w}})}r.deleteShader(D),r.deleteShader(R),k=new z_(r,x),M=iX(r,x)}let k;this.getUniforms=function(){return k===void 0&&b(this),k};let M;this.getAttributes=function(){return M===void 0&&b(this),M};let P=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return P===!1&&(P=r.getProgramParameter(x,Yq)),P},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(x),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=$q++,this.cacheKey=e,this.usedTimes=1,this.program=x,this.vertexShader=D,this.fragmentShader=R,this}let mX=0;class gX{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new _X(e),t.set(e,i)),i}}class _X{constructor(e){this.id=mX++,this.code=e,this.usedTimes=0}}function yX(n,e,t,i,r,s,o){const a=new Iu,l=new gX,h=new Set,f=[],d=r.isWebGL2,p=r.logarithmicDepthBuffer,_=r.vertexTextures;let v=r.precision;const T={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function x(M){return h.add(M),M===0?"uv":`uv${M}`}function y(M,P,V,F,Y){const re=F.fog,se=Y.geometry,ye=M.isMeshStandardMaterial?F.environment:null,W=(M.isMeshStandardMaterial?t:e).get(M.envMap||ye),K=W&&W.mapping===uf?W.image.height:null,Q=T[M.type];M.precision!==null&&(v=r.getMaxPrecision(M.precision),v!==M.precision&&console.warn("THREE.WebGLProgram.getParameters:",M.precision,"not supported, using",v,"instead."));const ee=se.morphAttributes.position||se.morphAttributes.normal||se.morphAttributes.color,_e=ee!==void 0?ee.length:0;let Ne=0;se.morphAttributes.position!==void 0&&(Ne=1),se.morphAttributes.normal!==void 0&&(Ne=2),se.morphAttributes.color!==void 0&&(Ne=3);let oe,xe,Le,ze;if(Q){const jt=Hs[Q];oe=jt.vertexShader,xe=jt.fragmentShader}else oe=M.vertexShader,xe=M.fragmentShader,l.update(M),Le=l.getVertexShaderID(M),ze=l.getFragmentShaderID(M);const at=n.getRenderTarget(),Ze=Y.isInstancedMesh===!0,St=Y.isBatchedMesh===!0,nt=!!M.map,X=!!M.matcap,Ce=!!W,me=!!M.aoMap,Pe=!!M.lightMap,ve=!!M.bumpMap,st=!!M.normalMap,Be=!!M.displacementMap,z=!!M.emissiveMap,U=!!M.metalnessMap,te=!!M.roughnessMap,Ie=M.anisotropy>0,Ae=M.clearcoat>0,Ee=M.iridescence>0,Ke=M.sheen>0,Ue=M.transmission>0,je=Ie&&!!M.anisotropyMap,ct=Ae&&!!M.clearcoatMap,Rt=Ae&&!!M.clearcoatNormalMap,Re=Ae&&!!M.clearcoatRoughnessMap,Gt=Ee&&!!M.iridescenceMap,Nt=Ee&&!!M.iridescenceThicknessMap,gt=Ke&&!!M.sheenColorMap,ut=Ke&&!!M.sheenRoughnessMap,$e=!!M.specularMap,$=!!M.specularColorMap,we=!!M.specularIntensityMap,Ve=Ue&&!!M.transmissionMap,Ge=Ue&&!!M.thicknessMap,mt=!!M.gradientMap,q=!!M.alphaMap,Me=M.alphaTest>0,De=!!M.alphaHash,Qe=!!M.extensions;let Je=vo;M.toneMapped&&(at===null||at.isXRRenderTarget===!0)&&(Je=n.toneMapping);const kt={isWebGL2:d,shaderID:Q,shaderType:M.type,shaderName:M.name,vertexShader:oe,fragmentShader:xe,defines:M.defines,customVertexShaderID:Le,customFragmentShaderID:ze,isRawShaderMaterial:M.isRawShaderMaterial===!0,glslVersion:M.glslVersion,precision:v,batching:St,instancing:Ze,instancingColor:Ze&&Y.instanceColor!==null,supportsVertexTextures:_,outputColorSpace:at===null?n.outputColorSpace:at.isXRRenderTarget===!0?at.texture.colorSpace:wo,alphaToCoverage:!!M.alphaToCoverage,map:nt,matcap:X,envMap:Ce,envMapMode:Ce&&W.mapping,envMapCubeUVHeight:K,aoMap:me,lightMap:Pe,bumpMap:ve,normalMap:st,displacementMap:_&&Be,emissiveMap:z,normalMapObjectSpace:st&&M.normalMapType===ek,normalMapTangentSpace:st&&M.normalMapType===Al,metalnessMap:U,roughnessMap:te,anisotropy:Ie,anisotropyMap:je,clearcoat:Ae,clearcoatMap:ct,clearcoatNormalMap:Rt,clearcoatRoughnessMap:Re,iridescence:Ee,iridescenceMap:Gt,iridescenceThicknessMap:Nt,sheen:Ke,sheenColorMap:gt,sheenRoughnessMap:ut,specularMap:$e,specularColorMap:$,specularIntensityMap:we,transmission:Ue,transmissionMap:Ve,thicknessMap:Ge,gradientMap:mt,opaque:M.transparent===!1&&M.blending===Au&&M.alphaToCoverage===!1,alphaMap:q,alphaTest:Me,alphaHash:De,combine:M.combine,mapUv:nt&&x(M.map.channel),aoMapUv:me&&x(M.aoMap.channel),lightMapUv:Pe&&x(M.lightMap.channel),bumpMapUv:ve&&x(M.bumpMap.channel),normalMapUv:st&&x(M.normalMap.channel),displacementMapUv:Be&&x(M.displacementMap.channel),emissiveMapUv:z&&x(M.emissiveMap.channel),metalnessMapUv:U&&x(M.metalnessMap.channel),roughnessMapUv:te&&x(M.roughnessMap.channel),anisotropyMapUv:je&&x(M.anisotropyMap.channel),clearcoatMapUv:ct&&x(M.clearcoatMap.channel),clearcoatNormalMapUv:Rt&&x(M.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Re&&x(M.clearcoatRoughnessMap.channel),iridescenceMapUv:Gt&&x(M.iridescenceMap.channel),iridescenceThicknessMapUv:Nt&&x(M.iridescenceThicknessMap.channel),sheenColorMapUv:gt&&x(M.sheenColorMap.channel),sheenRoughnessMapUv:ut&&x(M.sheenRoughnessMap.channel),specularMapUv:$e&&x(M.specularMap.channel),specularColorMapUv:$&&x(M.specularColorMap.channel),specularIntensityMapUv:we&&x(M.specularIntensityMap.channel),transmissionMapUv:Ve&&x(M.transmissionMap.channel),thicknessMapUv:Ge&&x(M.thicknessMap.channel),alphaMapUv:q&&x(M.alphaMap.channel),vertexTangents:!!se.attributes.tangent&&(st||Ie),vertexColors:M.vertexColors,vertexAlphas:M.vertexColors===!0&&!!se.attributes.color&&se.attributes.color.itemSize===4,pointsUvs:Y.isPoints===!0&&!!se.attributes.uv&&(nt||q),fog:!!re,useFog:M.fog===!0,fogExp2:!!re&&re.isFogExp2,flatShading:M.flatShading===!0,sizeAttenuation:M.sizeAttenuation===!0,logarithmicDepthBuffer:p,skinning:Y.isSkinnedMesh===!0,morphTargets:se.morphAttributes.position!==void 0,morphNormals:se.morphAttributes.normal!==void 0,morphColors:se.morphAttributes.color!==void 0,morphTargetsCount:_e,morphTextureStride:Ne,numDirLights:P.directional.length,numPointLights:P.point.length,numSpotLights:P.spot.length,numSpotLightMaps:P.spotLightMap.length,numRectAreaLights:P.rectArea.length,numHemiLights:P.hemi.length,numDirLightShadows:P.directionalShadowMap.length,numPointLightShadows:P.pointShadowMap.length,numSpotLightShadows:P.spotShadowMap.length,numSpotLightShadowsWithMaps:P.numSpotLightShadowsWithMaps,numLightProbes:P.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:M.dithering,shadowMapEnabled:n.shadowMap.enabled&&V.length>0,shadowMapType:n.shadowMap.type,toneMapping:Je,useLegacyLights:n._useLegacyLights,decodeVideoTexture:nt&&M.map.isVideoTexture===!0&&dn.getTransfer(M.map.colorSpace)===yn,premultipliedAlpha:M.premultipliedAlpha,doubleSided:M.side===lo,flipSided:M.side===_r,useDepthPacking:M.depthPacking>=0,depthPacking:M.depthPacking||0,index0AttributeName:M.index0AttributeName,extensionDerivatives:Qe&&M.extensions.derivatives===!0,extensionFragDepth:Qe&&M.extensions.fragDepth===!0,extensionDrawBuffers:Qe&&M.extensions.drawBuffers===!0,extensionShaderTextureLOD:Qe&&M.extensions.shaderTextureLOD===!0,extensionClipCullDistance:Qe&&M.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:Qe&&M.extensions.multiDraw===!0&&i.has("WEBGL_multi_draw"),rendererExtensionFragDepth:d||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||i.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:M.customProgramCacheKey()};return kt.vertexUv1s=h.has(1),kt.vertexUv2s=h.has(2),kt.vertexUv3s=h.has(3),h.clear(),kt}function w(M){const P=[];if(M.shaderID?P.push(M.shaderID):(P.push(M.customVertexShaderID),P.push(M.customFragmentShaderID)),M.defines!==void 0)for(const V in M.defines)P.push(V),P.push(M.defines[V]);return M.isRawShaderMaterial===!1&&(E(P,M),I(P,M),P.push(n.outputColorSpace)),P.push(M.customProgramCacheKey),P.join()}function E(M,P){M.push(P.precision),M.push(P.outputColorSpace),M.push(P.envMapMode),M.push(P.envMapCubeUVHeight),M.push(P.mapUv),M.push(P.alphaMapUv),M.push(P.lightMapUv),M.push(P.aoMapUv),M.push(P.bumpMapUv),M.push(P.normalMapUv),M.push(P.displacementMapUv),M.push(P.emissiveMapUv),M.push(P.metalnessMapUv),M.push(P.roughnessMapUv),M.push(P.anisotropyMapUv),M.push(P.clearcoatMapUv),M.push(P.clearcoatNormalMapUv),M.push(P.clearcoatRoughnessMapUv),M.push(P.iridescenceMapUv),M.push(P.iridescenceThicknessMapUv),M.push(P.sheenColorMapUv),M.push(P.sheenRoughnessMapUv),M.push(P.specularMapUv),M.push(P.specularColorMapUv),M.push(P.specularIntensityMapUv),M.push(P.transmissionMapUv),M.push(P.thicknessMapUv),M.push(P.combine),M.push(P.fogExp2),M.push(P.sizeAttenuation),M.push(P.morphTargetsCount),M.push(P.morphAttributeCount),M.push(P.numDirLights),M.push(P.numPointLights),M.push(P.numSpotLights),M.push(P.numSpotLightMaps),M.push(P.numHemiLights),M.push(P.numRectAreaLights),M.push(P.numDirLightShadows),M.push(P.numPointLightShadows),M.push(P.numSpotLightShadows),M.push(P.numSpotLightShadowsWithMaps),M.push(P.numLightProbes),M.push(P.shadowMapType),M.push(P.toneMapping),M.push(P.numClippingPlanes),M.push(P.numClipIntersection),M.push(P.depthPacking)}function I(M,P){a.disableAll(),P.isWebGL2&&a.enable(0),P.supportsVertexTextures&&a.enable(1),P.instancing&&a.enable(2),P.instancingColor&&a.enable(3),P.matcap&&a.enable(4),P.envMap&&a.enable(5),P.normalMapObjectSpace&&a.enable(6),P.normalMapTangentSpace&&a.enable(7),P.clearcoat&&a.enable(8),P.iridescence&&a.enable(9),P.alphaTest&&a.enable(10),P.vertexColors&&a.enable(11),P.vertexAlphas&&a.enable(12),P.vertexUv1s&&a.enable(13),P.vertexUv2s&&a.enable(14),P.vertexUv3s&&a.enable(15),P.vertexTangents&&a.enable(16),P.anisotropy&&a.enable(17),P.alphaHash&&a.enable(18),P.batching&&a.enable(19),M.push(a.mask),a.disableAll(),P.fog&&a.enable(0),P.useFog&&a.enable(1),P.flatShading&&a.enable(2),P.logarithmicDepthBuffer&&a.enable(3),P.skinning&&a.enable(4),P.morphTargets&&a.enable(5),P.morphNormals&&a.enable(6),P.morphColors&&a.enable(7),P.premultipliedAlpha&&a.enable(8),P.shadowMapEnabled&&a.enable(9),P.useLegacyLights&&a.enable(10),P.doubleSided&&a.enable(11),P.flipSided&&a.enable(12),P.useDepthPacking&&a.enable(13),P.dithering&&a.enable(14),P.transmission&&a.enable(15),P.sheen&&a.enable(16),P.opaque&&a.enable(17),P.pointsUvs&&a.enable(18),P.decodeVideoTexture&&a.enable(19),P.alphaToCoverage&&a.enable(20),M.push(a.mask)}function O(M){const P=T[M.type];let V;if(P){const F=Hs[P];V=dk.clone(F.uniforms)}else V=M.uniforms;return V}function D(M,P){let V;for(let F=0,Y=f.length;F<Y;F++){const re=f[F];if(re.cacheKey===P){V=re,++V.usedTimes;break}}return V===void 0&&(V=new pX(n,P,M,s),f.push(V)),V}function R(M){if(--M.usedTimes===0){const P=f.indexOf(M);f[P]=f[f.length-1],f.pop(),M.destroy()}}function b(M){l.remove(M)}function k(){l.dispose()}return{getParameters:y,getProgramCacheKey:w,getUniforms:O,acquireProgram:D,releaseProgram:R,releaseShaderCache:b,programs:f,dispose:k}}function vX(){let n=new WeakMap;function e(s){let o=n.get(s);return o===void 0&&(o={},n.set(s,o)),o}function t(s){n.delete(s)}function i(s,o,a){n.get(s)[o]=a}function r(){n=new WeakMap}return{get:e,remove:t,update:i,dispose:r}}function xX(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function aP(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function lP(){const n=[];let e=0;const t=[],i=[],r=[];function s(){e=0,t.length=0,i.length=0,r.length=0}function o(d,p,_,v,T,x){let y=n[e];return y===void 0?(y={id:d.id,object:d,geometry:p,material:_,groupOrder:v,renderOrder:d.renderOrder,z:T,group:x},n[e]=y):(y.id=d.id,y.object=d,y.geometry=p,y.material=_,y.groupOrder=v,y.renderOrder=d.renderOrder,y.z=T,y.group=x),e++,y}function a(d,p,_,v,T,x){const y=o(d,p,_,v,T,x);_.transmission>0?i.push(y):_.transparent===!0?r.push(y):t.push(y)}function l(d,p,_,v,T,x){const y=o(d,p,_,v,T,x);_.transmission>0?i.unshift(y):_.transparent===!0?r.unshift(y):t.unshift(y)}function h(d,p){t.length>1&&t.sort(d||xX),i.length>1&&i.sort(p||aP),r.length>1&&r.sort(p||aP)}function f(){for(let d=e,p=n.length;d<p;d++){const _=n[d];if(_.id===null)break;_.id=null,_.object=null,_.geometry=null,_.material=null,_.group=null}}return{opaque:t,transmissive:i,transparent:r,init:s,push:a,unshift:l,finish:f,sort:h}}function SX(){let n=new WeakMap;function e(i,r){const s=n.get(i);let o;return s===void 0?(o=new lP,n.set(i,[o])):r>=s.length?(o=new lP,s.push(o)):o=s[r],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function EX(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new G,color:new Ye};break;case"SpotLight":t={position:new G,direction:new G,color:new Ye,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new G,color:new Ye,distance:0,decay:0};break;case"HemisphereLight":t={direction:new G,skyColor:new Ye,groundColor:new Ye};break;case"RectAreaLight":t={color:new Ye,position:new G,halfWidth:new G,halfHeight:new G};break}return n[e.id]=t,t}}}function wX(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ge};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ge};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ge,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let TX=0;function MX(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function AX(n,e){const t=new EX,i=wX(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let f=0;f<9;f++)r.probe.push(new G);const s=new G,o=new Mt,a=new Mt;function l(f,d){let p=0,_=0,v=0;for(let V=0;V<9;V++)r.probe[V].set(0,0,0);let T=0,x=0,y=0,w=0,E=0,I=0,O=0,D=0,R=0,b=0,k=0;f.sort(MX);const M=d===!0?Math.PI:1;for(let V=0,F=f.length;V<F;V++){const Y=f[V],re=Y.color,se=Y.intensity,ye=Y.distance,W=Y.shadow&&Y.shadow.map?Y.shadow.map.texture:null;if(Y.isAmbientLight)p+=re.r*se*M,_+=re.g*se*M,v+=re.b*se*M;else if(Y.isLightProbe){for(let K=0;K<9;K++)r.probe[K].addScaledVector(Y.sh.coefficients[K],se);k++}else if(Y.isDirectionalLight){const K=t.get(Y);if(K.color.copy(Y.color).multiplyScalar(Y.intensity*M),Y.castShadow){const Q=Y.shadow,ee=i.get(Y);ee.shadowBias=Q.bias,ee.shadowNormalBias=Q.normalBias,ee.shadowRadius=Q.radius,ee.shadowMapSize=Q.mapSize,r.directionalShadow[T]=ee,r.directionalShadowMap[T]=W,r.directionalShadowMatrix[T]=Y.shadow.matrix,I++}r.directional[T]=K,T++}else if(Y.isSpotLight){const K=t.get(Y);K.position.setFromMatrixPosition(Y.matrixWorld),K.color.copy(re).multiplyScalar(se*M),K.distance=ye,K.coneCos=Math.cos(Y.angle),K.penumbraCos=Math.cos(Y.angle*(1-Y.penumbra)),K.decay=Y.decay,r.spot[y]=K;const Q=Y.shadow;if(Y.map&&(r.spotLightMap[R]=Y.map,R++,Q.updateMatrices(Y),Y.castShadow&&b++),r.spotLightMatrix[y]=Q.matrix,Y.castShadow){const ee=i.get(Y);ee.shadowBias=Q.bias,ee.shadowNormalBias=Q.normalBias,ee.shadowRadius=Q.radius,ee.shadowMapSize=Q.mapSize,r.spotShadow[y]=ee,r.spotShadowMap[y]=W,D++}y++}else if(Y.isRectAreaLight){const K=t.get(Y);K.color.copy(re).multiplyScalar(se),K.halfWidth.set(Y.width*.5,0,0),K.halfHeight.set(0,Y.height*.5,0),r.rectArea[w]=K,w++}else if(Y.isPointLight){const K=t.get(Y);if(K.color.copy(Y.color).multiplyScalar(Y.intensity*M),K.distance=Y.distance,K.decay=Y.decay,Y.castShadow){const Q=Y.shadow,ee=i.get(Y);ee.shadowBias=Q.bias,ee.shadowNormalBias=Q.normalBias,ee.shadowRadius=Q.radius,ee.shadowMapSize=Q.mapSize,ee.shadowCameraNear=Q.camera.near,ee.shadowCameraFar=Q.camera.far,r.pointShadow[x]=ee,r.pointShadowMap[x]=W,r.pointShadowMatrix[x]=Y.shadow.matrix,O++}r.point[x]=K,x++}else if(Y.isHemisphereLight){const K=t.get(Y);K.skyColor.copy(Y.color).multiplyScalar(se*M),K.groundColor.copy(Y.groundColor).multiplyScalar(se*M),r.hemi[E]=K,E++}}w>0&&(e.isWebGL2?n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=Fe.LTC_FLOAT_1,r.rectAreaLTC2=Fe.LTC_FLOAT_2):(r.rectAreaLTC1=Fe.LTC_HALF_1,r.rectAreaLTC2=Fe.LTC_HALF_2):n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=Fe.LTC_FLOAT_1,r.rectAreaLTC2=Fe.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=Fe.LTC_HALF_1,r.rectAreaLTC2=Fe.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=p,r.ambient[1]=_,r.ambient[2]=v;const P=r.hash;(P.directionalLength!==T||P.pointLength!==x||P.spotLength!==y||P.rectAreaLength!==w||P.hemiLength!==E||P.numDirectionalShadows!==I||P.numPointShadows!==O||P.numSpotShadows!==D||P.numSpotMaps!==R||P.numLightProbes!==k)&&(r.directional.length=T,r.spot.length=y,r.rectArea.length=w,r.point.length=x,r.hemi.length=E,r.directionalShadow.length=I,r.directionalShadowMap.length=I,r.pointShadow.length=O,r.pointShadowMap.length=O,r.spotShadow.length=D,r.spotShadowMap.length=D,r.directionalShadowMatrix.length=I,r.pointShadowMatrix.length=O,r.spotLightMatrix.length=D+R-b,r.spotLightMap.length=R,r.numSpotLightShadowsWithMaps=b,r.numLightProbes=k,P.directionalLength=T,P.pointLength=x,P.spotLength=y,P.rectAreaLength=w,P.hemiLength=E,P.numDirectionalShadows=I,P.numPointShadows=O,P.numSpotShadows=D,P.numSpotMaps=R,P.numLightProbes=k,r.version=TX++)}function h(f,d){let p=0,_=0,v=0,T=0,x=0;const y=d.matrixWorldInverse;for(let w=0,E=f.length;w<E;w++){const I=f[w];if(I.isDirectionalLight){const O=r.directional[p];O.direction.setFromMatrixPosition(I.matrixWorld),s.setFromMatrixPosition(I.target.matrixWorld),O.direction.sub(s),O.direction.transformDirection(y),p++}else if(I.isSpotLight){const O=r.spot[v];O.position.setFromMatrixPosition(I.matrixWorld),O.position.applyMatrix4(y),O.direction.setFromMatrixPosition(I.matrixWorld),s.setFromMatrixPosition(I.target.matrixWorld),O.direction.sub(s),O.direction.transformDirection(y),v++}else if(I.isRectAreaLight){const O=r.rectArea[T];O.position.setFromMatrixPosition(I.matrixWorld),O.position.applyMatrix4(y),a.identity(),o.copy(I.matrixWorld),o.premultiply(y),a.extractRotation(o),O.halfWidth.set(I.width*.5,0,0),O.halfHeight.set(0,I.height*.5,0),O.halfWidth.applyMatrix4(a),O.halfHeight.applyMatrix4(a),T++}else if(I.isPointLight){const O=r.point[_];O.position.setFromMatrixPosition(I.matrixWorld),O.position.applyMatrix4(y),_++}else if(I.isHemisphereLight){const O=r.hemi[x];O.direction.setFromMatrixPosition(I.matrixWorld),O.direction.transformDirection(y),x++}}}return{setup:l,setupView:h,state:r}}function uP(n,e){const t=new AX(n,e),i=[],r=[];function s(){i.length=0,r.length=0}function o(d){i.push(d)}function a(d){r.push(d)}function l(d){t.setup(i,d)}function h(d){t.setupView(i,d)}return{init:s,state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:l,setupLightsView:h,pushLight:o,pushShadow:a}}function CX(n,e){let t=new WeakMap;function i(s,o=0){const a=t.get(s);let l;return a===void 0?(l=new uP(n,e),t.set(s,[l])):o>=a.length?(l=new uP(n,e),a.push(l)):l=a[o],l}function r(){t=new WeakMap}return{get:i,dispose:r}}class GT extends ir{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=J3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class WT extends ir{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const RX=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,IX=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function PX(n,e,t){let i=new Jp;const r=new ge,s=new ge,o=new cn,a=new GT({depthPacking:Z3}),l=new WT,h={},f=t.maxTextureSize,d={[sa]:_r,[_r]:sa,[lo]:lo},p=new ns({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ge},radius:{value:4}},vertexShader:RX,fragmentShader:IX}),_=p.clone();_.defines.HORIZONTAL_PASS=1;const v=new Ht;v.setAttribute("position",new mn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const T=new ui(v,p),x=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Mv;let y=this.type;this.render=function(D,R,b){if(x.enabled===!1||x.autoUpdate===!1&&x.needsUpdate===!1||D.length===0)return;const k=n.getRenderTarget(),M=n.getActiveCubeFace(),P=n.getActiveMipmapLevel(),V=n.state;V.setBlending(Ko),V.buffers.color.setClear(1,1,1,1),V.buffers.depth.setTest(!0),V.setScissorTest(!1);const F=y!==Fs&&this.type===Fs,Y=y===Fs&&this.type!==Fs;for(let re=0,se=D.length;re<se;re++){const ye=D[re],W=ye.shadow;if(W===void 0){console.warn("THREE.WebGLShadowMap:",ye,"has no shadow.");continue}if(W.autoUpdate===!1&&W.needsUpdate===!1)continue;r.copy(W.mapSize);const K=W.getFrameExtents();if(r.multiply(K),s.copy(W.mapSize),(r.x>f||r.y>f)&&(r.x>f&&(s.x=Math.floor(f/K.x),r.x=s.x*K.x,W.mapSize.x=s.x),r.y>f&&(s.y=Math.floor(f/K.y),r.y=s.y*K.y,W.mapSize.y=s.y)),W.map===null||F===!0||Y===!0){const ee=this.type!==Fs?{minFilter:Zn,magFilter:Zn}:{};W.map!==null&&W.map.dispose(),W.map=new $s(r.x,r.y,ee),W.map.texture.name=ye.name+".shadowMap",W.camera.updateProjectionMatrix()}n.setRenderTarget(W.map),n.clear();const Q=W.getViewportCount();for(let ee=0;ee<Q;ee++){const _e=W.getViewport(ee);o.set(s.x*_e.x,s.y*_e.y,s.x*_e.z,s.y*_e.w),V.viewport(o),W.updateMatrices(ye,ee),i=W.getFrustum(),I(R,b,W.camera,ye,this.type)}W.isPointLightShadow!==!0&&this.type===Fs&&w(W,b),W.needsUpdate=!1}y=this.type,x.needsUpdate=!1,n.setRenderTarget(k,M,P)};function w(D,R){const b=e.update(T);p.defines.VSM_SAMPLES!==D.blurSamples&&(p.defines.VSM_SAMPLES=D.blurSamples,_.defines.VSM_SAMPLES=D.blurSamples,p.needsUpdate=!0,_.needsUpdate=!0),D.mapPass===null&&(D.mapPass=new $s(r.x,r.y)),p.uniforms.shadow_pass.value=D.map.texture,p.uniforms.resolution.value=D.mapSize,p.uniforms.radius.value=D.radius,n.setRenderTarget(D.mapPass),n.clear(),n.renderBufferDirect(R,null,b,p,T,null),_.uniforms.shadow_pass.value=D.mapPass.texture,_.uniforms.resolution.value=D.mapSize,_.uniforms.radius.value=D.radius,n.setRenderTarget(D.map),n.clear(),n.renderBufferDirect(R,null,b,_,T,null)}function E(D,R,b,k){let M=null;const P=b.isPointLight===!0?D.customDistanceMaterial:D.customDepthMaterial;if(P!==void 0)M=P;else if(M=b.isPointLight===!0?l:a,n.localClippingEnabled&&R.clipShadows===!0&&Array.isArray(R.clippingPlanes)&&R.clippingPlanes.length!==0||R.displacementMap&&R.displacementScale!==0||R.alphaMap&&R.alphaTest>0||R.map&&R.alphaTest>0){const V=M.uuid,F=R.uuid;let Y=h[V];Y===void 0&&(Y={},h[V]=Y);let re=Y[F];re===void 0&&(re=M.clone(),Y[F]=re,R.addEventListener("dispose",O)),M=re}if(M.visible=R.visible,M.wireframe=R.wireframe,k===Fs?M.side=R.shadowSide!==null?R.shadowSide:R.side:M.side=R.shadowSide!==null?R.shadowSide:d[R.side],M.alphaMap=R.alphaMap,M.alphaTest=R.alphaTest,M.map=R.map,M.clipShadows=R.clipShadows,M.clippingPlanes=R.clippingPlanes,M.clipIntersection=R.clipIntersection,M.displacementMap=R.displacementMap,M.displacementScale=R.displacementScale,M.displacementBias=R.displacementBias,M.wireframeLinewidth=R.wireframeLinewidth,M.linewidth=R.linewidth,b.isPointLight===!0&&M.isMeshDistanceMaterial===!0){const V=n.properties.get(M);V.light=b}return M}function I(D,R,b,k,M){if(D.visible===!1)return;if(D.layers.test(R.layers)&&(D.isMesh||D.isLine||D.isPoints)&&(D.castShadow||D.receiveShadow&&M===Fs)&&(!D.frustumCulled||i.intersectsObject(D))){D.modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,D.matrixWorld);const F=e.update(D),Y=D.material;if(Array.isArray(Y)){const re=F.groups;for(let se=0,ye=re.length;se<ye;se++){const W=re[se],K=Y[W.materialIndex];if(K&&K.visible){const Q=E(D,K,k,M);D.onBeforeShadow(n,D,R,b,F,Q,W),n.renderBufferDirect(b,null,F,Q,D,W),D.onAfterShadow(n,D,R,b,F,Q,W)}}}else if(Y.visible){const re=E(D,Y,k,M);D.onBeforeShadow(n,D,R,b,F,re,null),n.renderBufferDirect(b,null,F,re,D,null),D.onAfterShadow(n,D,R,b,F,re,null)}}const V=D.children;for(let F=0,Y=V.length;F<Y;F++)I(V[F],R,b,k,M)}function O(D){D.target.removeEventListener("dispose",O);for(const b in h){const k=h[b],M=D.target.uuid;M in k&&(k[M].dispose(),delete k[M])}}}function bX(n,e,t){const i=t.isWebGL2;function r(){let q=!1;const Me=new cn;let De=null;const Qe=new cn(0,0,0,0);return{setMask:function(Je){De!==Je&&!q&&(n.colorMask(Je,Je,Je,Je),De=Je)},setLocked:function(Je){q=Je},setClear:function(Je,kt,jt,en,bn){bn===!0&&(Je*=en,kt*=en,jt*=en),Me.set(Je,kt,jt,en),Qe.equals(Me)===!1&&(n.clearColor(Je,kt,jt,en),Qe.copy(Me))},reset:function(){q=!1,De=null,Qe.set(-1,0,0,0)}}}function s(){let q=!1,Me=null,De=null,Qe=null;return{setTest:function(Je){Je?Ze(n.DEPTH_TEST):St(n.DEPTH_TEST)},setMask:function(Je){Me!==Je&&!q&&(n.depthMask(Je),Me=Je)},setFunc:function(Je){if(De!==Je){switch(Je){case A3:n.depthFunc(n.NEVER);break;case C3:n.depthFunc(n.ALWAYS);break;case R3:n.depthFunc(n.LESS);break;case lp:n.depthFunc(n.LEQUAL);break;case I3:n.depthFunc(n.EQUAL);break;case P3:n.depthFunc(n.GEQUAL);break;case b3:n.depthFunc(n.GREATER);break;case L3:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}De=Je}},setLocked:function(Je){q=Je},setClear:function(Je){Qe!==Je&&(n.clearDepth(Je),Qe=Je)},reset:function(){q=!1,Me=null,De=null,Qe=null}}}function o(){let q=!1,Me=null,De=null,Qe=null,Je=null,kt=null,jt=null,en=null,bn=null;return{setTest:function(Kt){q||(Kt?Ze(n.STENCIL_TEST):St(n.STENCIL_TEST))},setMask:function(Kt){Me!==Kt&&!q&&(n.stencilMask(Kt),Me=Kt)},setFunc:function(Kt,Bn,rr){(De!==Kt||Qe!==Bn||Je!==rr)&&(n.stencilFunc(Kt,Bn,rr),De=Kt,Qe=Bn,Je=rr)},setOp:function(Kt,Bn,rr){(kt!==Kt||jt!==Bn||en!==rr)&&(n.stencilOp(Kt,Bn,rr),kt=Kt,jt=Bn,en=rr)},setLocked:function(Kt){q=Kt},setClear:function(Kt){bn!==Kt&&(n.clearStencil(Kt),bn=Kt)},reset:function(){q=!1,Me=null,De=null,Qe=null,Je=null,kt=null,jt=null,en=null,bn=null}}}const a=new r,l=new s,h=new o,f=new WeakMap,d=new WeakMap;let p={},_={},v=new WeakMap,T=[],x=null,y=!1,w=null,E=null,I=null,O=null,D=null,R=null,b=null,k=new Ye(0,0,0),M=0,P=!1,V=null,F=null,Y=null,re=null,se=null;const ye=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let W=!1,K=0;const Q=n.getParameter(n.VERSION);Q.indexOf("WebGL")!==-1?(K=parseFloat(/^WebGL (\d)/.exec(Q)[1]),W=K>=1):Q.indexOf("OpenGL ES")!==-1&&(K=parseFloat(/^OpenGL ES (\d)/.exec(Q)[1]),W=K>=2);let ee=null,_e={};const Ne=n.getParameter(n.SCISSOR_BOX),oe=n.getParameter(n.VIEWPORT),xe=new cn().fromArray(Ne),Le=new cn().fromArray(oe);function ze(q,Me,De,Qe){const Je=new Uint8Array(4),kt=n.createTexture();n.bindTexture(q,kt),n.texParameteri(q,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(q,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let jt=0;jt<De;jt++)i&&(q===n.TEXTURE_3D||q===n.TEXTURE_2D_ARRAY)?n.texImage3D(Me,0,n.RGBA,1,1,Qe,0,n.RGBA,n.UNSIGNED_BYTE,Je):n.texImage2D(Me+jt,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Je);return kt}const at={};at[n.TEXTURE_2D]=ze(n.TEXTURE_2D,n.TEXTURE_2D,1),at[n.TEXTURE_CUBE_MAP]=ze(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(at[n.TEXTURE_2D_ARRAY]=ze(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),at[n.TEXTURE_3D]=ze(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),h.setClear(0),Ze(n.DEPTH_TEST),l.setFunc(lp),Be(!1),z(HE),Ze(n.CULL_FACE),ve(Ko);function Ze(q){p[q]!==!0&&(n.enable(q),p[q]=!0)}function St(q){p[q]!==!1&&(n.disable(q),p[q]=!1)}function nt(q,Me){return _[q]!==Me?(n.bindFramebuffer(q,Me),_[q]=Me,i&&(q===n.DRAW_FRAMEBUFFER&&(_[n.FRAMEBUFFER]=Me),q===n.FRAMEBUFFER&&(_[n.DRAW_FRAMEBUFFER]=Me)),!0):!1}function X(q,Me){let De=T,Qe=!1;if(q)if(De=v.get(Me),De===void 0&&(De=[],v.set(Me,De)),q.isWebGLMultipleRenderTargets){const Je=q.texture;if(De.length!==Je.length||De[0]!==n.COLOR_ATTACHMENT0){for(let kt=0,jt=Je.length;kt<jt;kt++)De[kt]=n.COLOR_ATTACHMENT0+kt;De.length=Je.length,Qe=!0}}else De[0]!==n.COLOR_ATTACHMENT0&&(De[0]=n.COLOR_ATTACHMENT0,Qe=!0);else De[0]!==n.BACK&&(De[0]=n.BACK,Qe=!0);Qe&&(t.isWebGL2?n.drawBuffers(De):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(De))}function Ce(q){return x!==q?(n.useProgram(q),x=q,!0):!1}const me={[Fa]:n.FUNC_ADD,[h3]:n.FUNC_SUBTRACT,[f3]:n.FUNC_REVERSE_SUBTRACT};if(i)me[jE]=n.MIN,me[qE]=n.MAX;else{const q=e.get("EXT_blend_minmax");q!==null&&(me[jE]=q.MIN_EXT,me[qE]=q.MAX_EXT)}const Pe={[d3]:n.ZERO,[p3]:n.ONE,[m3]:n.SRC_COLOR,[Ny]:n.SRC_ALPHA,[S3]:n.SRC_ALPHA_SATURATE,[v3]:n.DST_COLOR,[_3]:n.DST_ALPHA,[g3]:n.ONE_MINUS_SRC_COLOR,[Dy]:n.ONE_MINUS_SRC_ALPHA,[x3]:n.ONE_MINUS_DST_COLOR,[y3]:n.ONE_MINUS_DST_ALPHA,[E3]:n.CONSTANT_COLOR,[w3]:n.ONE_MINUS_CONSTANT_COLOR,[T3]:n.CONSTANT_ALPHA,[M3]:n.ONE_MINUS_CONSTANT_ALPHA};function ve(q,Me,De,Qe,Je,kt,jt,en,bn,Kt){if(q===Ko){y===!0&&(St(n.BLEND),y=!1);return}if(y===!1&&(Ze(n.BLEND),y=!0),q!==c3){if(q!==w||Kt!==P){if((E!==Fa||D!==Fa)&&(n.blendEquation(n.FUNC_ADD),E=Fa,D=Fa),Kt)switch(q){case Au:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Ly:n.blendFunc(n.ONE,n.ONE);break;case GE:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case WE:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",q);break}else switch(q){case Au:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Ly:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case GE:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case WE:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",q);break}I=null,O=null,R=null,b=null,k.set(0,0,0),M=0,w=q,P=Kt}return}Je=Je||Me,kt=kt||De,jt=jt||Qe,(Me!==E||Je!==D)&&(n.blendEquationSeparate(me[Me],me[Je]),E=Me,D=Je),(De!==I||Qe!==O||kt!==R||jt!==b)&&(n.blendFuncSeparate(Pe[De],Pe[Qe],Pe[kt],Pe[jt]),I=De,O=Qe,R=kt,b=jt),(en.equals(k)===!1||bn!==M)&&(n.blendColor(en.r,en.g,en.b,bn),k.copy(en),M=bn),w=q,P=!1}function st(q,Me){q.side===lo?St(n.CULL_FACE):Ze(n.CULL_FACE);let De=q.side===_r;Me&&(De=!De),Be(De),q.blending===Au&&q.transparent===!1?ve(Ko):ve(q.blending,q.blendEquation,q.blendSrc,q.blendDst,q.blendEquationAlpha,q.blendSrcAlpha,q.blendDstAlpha,q.blendColor,q.blendAlpha,q.premultipliedAlpha),l.setFunc(q.depthFunc),l.setTest(q.depthTest),l.setMask(q.depthWrite),a.setMask(q.colorWrite);const Qe=q.stencilWrite;h.setTest(Qe),Qe&&(h.setMask(q.stencilWriteMask),h.setFunc(q.stencilFunc,q.stencilRef,q.stencilFuncMask),h.setOp(q.stencilFail,q.stencilZFail,q.stencilZPass)),te(q.polygonOffset,q.polygonOffsetFactor,q.polygonOffsetUnits),q.alphaToCoverage===!0?Ze(n.SAMPLE_ALPHA_TO_COVERAGE):St(n.SAMPLE_ALPHA_TO_COVERAGE)}function Be(q){V!==q&&(q?n.frontFace(n.CW):n.frontFace(n.CCW),V=q)}function z(q){q!==a3?(Ze(n.CULL_FACE),q!==F&&(q===HE?n.cullFace(n.BACK):q===l3?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):St(n.CULL_FACE),F=q}function U(q){q!==Y&&(W&&n.lineWidth(q),Y=q)}function te(q,Me,De){q?(Ze(n.POLYGON_OFFSET_FILL),(re!==Me||se!==De)&&(n.polygonOffset(Me,De),re=Me,se=De)):St(n.POLYGON_OFFSET_FILL)}function Ie(q){q?Ze(n.SCISSOR_TEST):St(n.SCISSOR_TEST)}function Ae(q){q===void 0&&(q=n.TEXTURE0+ye-1),ee!==q&&(n.activeTexture(q),ee=q)}function Ee(q,Me,De){De===void 0&&(ee===null?De=n.TEXTURE0+ye-1:De=ee);let Qe=_e[De];Qe===void 0&&(Qe={type:void 0,texture:void 0},_e[De]=Qe),(Qe.type!==q||Qe.texture!==Me)&&(ee!==De&&(n.activeTexture(De),ee=De),n.bindTexture(q,Me||at[q]),Qe.type=q,Qe.texture=Me)}function Ke(){const q=_e[ee];q!==void 0&&q.type!==void 0&&(n.bindTexture(q.type,null),q.type=void 0,q.texture=void 0)}function Ue(){try{n.compressedTexImage2D.apply(n,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function je(){try{n.compressedTexImage3D.apply(n,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function ct(){try{n.texSubImage2D.apply(n,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Rt(){try{n.texSubImage3D.apply(n,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Re(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Gt(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function Nt(){try{n.texStorage2D.apply(n,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function gt(){try{n.texStorage3D.apply(n,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function ut(){try{n.texImage2D.apply(n,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function $e(){try{n.texImage3D.apply(n,arguments)}catch(q){console.error("THREE.WebGLState:",q)}}function $(q){xe.equals(q)===!1&&(n.scissor(q.x,q.y,q.z,q.w),xe.copy(q))}function we(q){Le.equals(q)===!1&&(n.viewport(q.x,q.y,q.z,q.w),Le.copy(q))}function Ve(q,Me){let De=d.get(Me);De===void 0&&(De=new WeakMap,d.set(Me,De));let Qe=De.get(q);Qe===void 0&&(Qe=n.getUniformBlockIndex(Me,q.name),De.set(q,Qe))}function Ge(q,Me){const Qe=d.get(Me).get(q);f.get(Me)!==Qe&&(n.uniformBlockBinding(Me,Qe,q.__bindingPointIndex),f.set(Me,Qe))}function mt(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),i===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),p={},ee=null,_e={},_={},v=new WeakMap,T=[],x=null,y=!1,w=null,E=null,I=null,O=null,D=null,R=null,b=null,k=new Ye(0,0,0),M=0,P=!1,V=null,F=null,Y=null,re=null,se=null,xe.set(0,0,n.canvas.width,n.canvas.height),Le.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),h.reset()}return{buffers:{color:a,depth:l,stencil:h},enable:Ze,disable:St,bindFramebuffer:nt,drawBuffers:X,useProgram:Ce,setBlending:ve,setMaterial:st,setFlipSided:Be,setCullFace:z,setLineWidth:U,setPolygonOffset:te,setScissorTest:Ie,activeTexture:Ae,bindTexture:Ee,unbindTexture:Ke,compressedTexImage2D:Ue,compressedTexImage3D:je,texImage2D:ut,texImage3D:$e,updateUBOMapping:Ve,uniformBlockBinding:Ge,texStorage2D:Nt,texStorage3D:gt,texSubImage2D:ct,texSubImage3D:Rt,compressedTexSubImage2D:Re,compressedTexSubImage3D:Gt,scissor:$,viewport:we,reset:mt}}function LX(n,e,t,i,r,s,o){const a=r.isWebGL2,l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,h=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),f=new WeakMap;let d;const p=new WeakMap;let _=!1;try{_=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function v(z,U){return _?new OffscreenCanvas(z,U):Sp("canvas")}function T(z,U,te,Ie){let Ae=1;if((z.width>Ie||z.height>Ie)&&(Ae=Ie/Math.max(z.width,z.height)),Ae<1||U===!0)if(typeof HTMLImageElement<"u"&&z instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&z instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&z instanceof ImageBitmap){const Ee=U?Uy:Math.floor,Ke=Ee(Ae*z.width),Ue=Ee(Ae*z.height);d===void 0&&(d=v(Ke,Ue));const je=te?v(Ke,Ue):d;return je.width=Ke,je.height=Ue,je.getContext("2d").drawImage(z,0,0,Ke,Ue),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+z.width+"x"+z.height+") to ("+Ke+"x"+Ue+")."),je}else return"data"in z&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+z.width+"x"+z.height+")."),z;return z}function x(z){return Ew(z.width)&&Ew(z.height)}function y(z){return a?!1:z.wrapS!==Zi||z.wrapT!==Zi||z.minFilter!==Zn&&z.minFilter!==On}function w(z,U){return z.generateMipmaps&&U&&z.minFilter!==Zn&&z.minFilter!==On}function E(z){n.generateMipmap(z)}function I(z,U,te,Ie,Ae=!1){if(a===!1)return U;if(z!==null){if(n[z]!==void 0)return n[z];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+z+"'")}let Ee=U;if(U===n.RED&&(te===n.FLOAT&&(Ee=n.R32F),te===n.HALF_FLOAT&&(Ee=n.R16F),te===n.UNSIGNED_BYTE&&(Ee=n.R8)),U===n.RED_INTEGER&&(te===n.UNSIGNED_BYTE&&(Ee=n.R8UI),te===n.UNSIGNED_SHORT&&(Ee=n.R16UI),te===n.UNSIGNED_INT&&(Ee=n.R32UI),te===n.BYTE&&(Ee=n.R8I),te===n.SHORT&&(Ee=n.R16I),te===n.INT&&(Ee=n.R32I)),U===n.RG&&(te===n.FLOAT&&(Ee=n.RG32F),te===n.HALF_FLOAT&&(Ee=n.RG16F),te===n.UNSIGNED_BYTE&&(Ee=n.RG8)),U===n.RGBA){const Ke=Ae?gp:dn.getTransfer(Ie);te===n.FLOAT&&(Ee=n.RGBA32F),te===n.HALF_FLOAT&&(Ee=n.RGBA16F),te===n.UNSIGNED_BYTE&&(Ee=Ke===yn?n.SRGB8_ALPHA8:n.RGBA8),te===n.UNSIGNED_SHORT_4_4_4_4&&(Ee=n.RGBA4),te===n.UNSIGNED_SHORT_5_5_5_1&&(Ee=n.RGB5_A1)}return(Ee===n.R16F||Ee===n.R32F||Ee===n.RG16F||Ee===n.RG32F||Ee===n.RGBA16F||Ee===n.RGBA32F)&&e.get("EXT_color_buffer_float"),Ee}function O(z,U,te){return w(z,te)===!0||z.isFramebufferTexture&&z.minFilter!==Zn&&z.minFilter!==On?Math.log2(Math.max(U.width,U.height))+1:z.mipmaps!==void 0&&z.mipmaps.length>0?z.mipmaps.length:z.isCompressedTexture&&Array.isArray(z.image)?U.mipmaps.length:1}function D(z){return z===Zn||z===ky||z===hu?n.NEAREST:n.LINEAR}function R(z){const U=z.target;U.removeEventListener("dispose",R),k(U),U.isVideoTexture&&f.delete(U)}function b(z){const U=z.target;U.removeEventListener("dispose",b),P(U)}function k(z){const U=i.get(z);if(U.__webglInit===void 0)return;const te=z.source,Ie=p.get(te);if(Ie){const Ae=Ie[U.__cacheKey];Ae.usedTimes--,Ae.usedTimes===0&&M(z),Object.keys(Ie).length===0&&p.delete(te)}i.remove(z)}function M(z){const U=i.get(z);n.deleteTexture(U.__webglTexture);const te=z.source,Ie=p.get(te);delete Ie[U.__cacheKey],o.memory.textures--}function P(z){const U=z.texture,te=i.get(z),Ie=i.get(U);if(Ie.__webglTexture!==void 0&&(n.deleteTexture(Ie.__webglTexture),o.memory.textures--),z.depthTexture&&z.depthTexture.dispose(),z.isWebGLCubeRenderTarget)for(let Ae=0;Ae<6;Ae++){if(Array.isArray(te.__webglFramebuffer[Ae]))for(let Ee=0;Ee<te.__webglFramebuffer[Ae].length;Ee++)n.deleteFramebuffer(te.__webglFramebuffer[Ae][Ee]);else n.deleteFramebuffer(te.__webglFramebuffer[Ae]);te.__webglDepthbuffer&&n.deleteRenderbuffer(te.__webglDepthbuffer[Ae])}else{if(Array.isArray(te.__webglFramebuffer))for(let Ae=0;Ae<te.__webglFramebuffer.length;Ae++)n.deleteFramebuffer(te.__webglFramebuffer[Ae]);else n.deleteFramebuffer(te.__webglFramebuffer);if(te.__webglDepthbuffer&&n.deleteRenderbuffer(te.__webglDepthbuffer),te.__webglMultisampledFramebuffer&&n.deleteFramebuffer(te.__webglMultisampledFramebuffer),te.__webglColorRenderbuffer)for(let Ae=0;Ae<te.__webglColorRenderbuffer.length;Ae++)te.__webglColorRenderbuffer[Ae]&&n.deleteRenderbuffer(te.__webglColorRenderbuffer[Ae]);te.__webglDepthRenderbuffer&&n.deleteRenderbuffer(te.__webglDepthRenderbuffer)}if(z.isWebGLMultipleRenderTargets)for(let Ae=0,Ee=U.length;Ae<Ee;Ae++){const Ke=i.get(U[Ae]);Ke.__webglTexture&&(n.deleteTexture(Ke.__webglTexture),o.memory.textures--),i.remove(U[Ae])}i.remove(U),i.remove(z)}let V=0;function F(){V=0}function Y(){const z=V;return z>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+z+" texture units while this GPU supports only "+r.maxTextures),V+=1,z}function re(z){const U=[];return U.push(z.wrapS),U.push(z.wrapT),U.push(z.wrapR||0),U.push(z.magFilter),U.push(z.minFilter),U.push(z.anisotropy),U.push(z.internalFormat),U.push(z.format),U.push(z.type),U.push(z.generateMipmaps),U.push(z.premultiplyAlpha),U.push(z.flipY),U.push(z.unpackAlignment),U.push(z.colorSpace),U.join()}function se(z,U){const te=i.get(z);if(z.isVideoTexture&&st(z),z.isRenderTargetTexture===!1&&z.version>0&&te.__version!==z.version){const Ie=z.image;if(Ie===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Ie.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{xe(te,z,U);return}}t.bindTexture(n.TEXTURE_2D,te.__webglTexture,n.TEXTURE0+U)}function ye(z,U){const te=i.get(z);if(z.version>0&&te.__version!==z.version){xe(te,z,U);return}t.bindTexture(n.TEXTURE_2D_ARRAY,te.__webglTexture,n.TEXTURE0+U)}function W(z,U){const te=i.get(z);if(z.version>0&&te.__version!==z.version){xe(te,z,U);return}t.bindTexture(n.TEXTURE_3D,te.__webglTexture,n.TEXTURE0+U)}function K(z,U){const te=i.get(z);if(z.version>0&&te.__version!==z.version){Le(te,z,U);return}t.bindTexture(n.TEXTURE_CUBE_MAP,te.__webglTexture,n.TEXTURE0+U)}const Q={[hp]:n.REPEAT,[Zi]:n.CLAMP_TO_EDGE,[fp]:n.MIRRORED_REPEAT},ee={[Zn]:n.NEAREST,[ky]:n.NEAREST_MIPMAP_NEAREST,[hu]:n.NEAREST_MIPMAP_LINEAR,[On]:n.LINEAR,[Ld]:n.LINEAR_MIPMAP_NEAREST,[uo]:n.LINEAR_MIPMAP_LINEAR},_e={[tk]:n.NEVER,[ak]:n.ALWAYS,[nk]:n.LESS,[DT]:n.LEQUAL,[ik]:n.EQUAL,[ok]:n.GEQUAL,[rk]:n.GREATER,[sk]:n.NOTEQUAL};function Ne(z,U,te){if(U.type===Ss&&e.has("OES_texture_float_linear")===!1&&(U.magFilter===On||U.magFilter===Ld||U.magFilter===hu||U.magFilter===uo||U.minFilter===On||U.minFilter===Ld||U.minFilter===hu||U.minFilter===uo)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),te?(n.texParameteri(z,n.TEXTURE_WRAP_S,Q[U.wrapS]),n.texParameteri(z,n.TEXTURE_WRAP_T,Q[U.wrapT]),(z===n.TEXTURE_3D||z===n.TEXTURE_2D_ARRAY)&&n.texParameteri(z,n.TEXTURE_WRAP_R,Q[U.wrapR]),n.texParameteri(z,n.TEXTURE_MAG_FILTER,ee[U.magFilter]),n.texParameteri(z,n.TEXTURE_MIN_FILTER,ee[U.minFilter])):(n.texParameteri(z,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(z,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(z===n.TEXTURE_3D||z===n.TEXTURE_2D_ARRAY)&&n.texParameteri(z,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(U.wrapS!==Zi||U.wrapT!==Zi)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(z,n.TEXTURE_MAG_FILTER,D(U.magFilter)),n.texParameteri(z,n.TEXTURE_MIN_FILTER,D(U.minFilter)),U.minFilter!==Zn&&U.minFilter!==On&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),U.compareFunction&&(n.texParameteri(z,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(z,n.TEXTURE_COMPARE_FUNC,_e[U.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const Ie=e.get("EXT_texture_filter_anisotropic");if(U.magFilter===Zn||U.minFilter!==hu&&U.minFilter!==uo||U.type===Ss&&e.has("OES_texture_float_linear")===!1||a===!1&&U.type===jh&&e.has("OES_texture_half_float_linear")===!1)return;(U.anisotropy>1||i.get(U).__currentAnisotropy)&&(n.texParameterf(z,Ie.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(U.anisotropy,r.getMaxAnisotropy())),i.get(U).__currentAnisotropy=U.anisotropy)}}function oe(z,U){let te=!1;z.__webglInit===void 0&&(z.__webglInit=!0,U.addEventListener("dispose",R));const Ie=U.source;let Ae=p.get(Ie);Ae===void 0&&(Ae={},p.set(Ie,Ae));const Ee=re(U);if(Ee!==z.__cacheKey){Ae[Ee]===void 0&&(Ae[Ee]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,te=!0),Ae[Ee].usedTimes++;const Ke=Ae[z.__cacheKey];Ke!==void 0&&(Ae[z.__cacheKey].usedTimes--,Ke.usedTimes===0&&M(U)),z.__cacheKey=Ee,z.__webglTexture=Ae[Ee].texture}return te}function xe(z,U,te){let Ie=n.TEXTURE_2D;(U.isDataArrayTexture||U.isCompressedArrayTexture)&&(Ie=n.TEXTURE_2D_ARRAY),U.isData3DTexture&&(Ie=n.TEXTURE_3D);const Ae=oe(z,U),Ee=U.source;t.bindTexture(Ie,z.__webglTexture,n.TEXTURE0+te);const Ke=i.get(Ee);if(Ee.version!==Ke.__version||Ae===!0){t.activeTexture(n.TEXTURE0+te);const Ue=dn.getPrimaries(dn.workingColorSpace),je=U.colorSpace===$r?null:dn.getPrimaries(U.colorSpace),ct=U.colorSpace===$r||Ue===je?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,U.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,U.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,U.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,ct);const Rt=y(U)&&x(U.image)===!1;let Re=T(U.image,Rt,!1,r.maxTextureSize);Re=Be(U,Re);const Gt=x(Re)||a,Nt=s.convert(U.format,U.colorSpace);let gt=s.convert(U.type),ut=I(U.internalFormat,Nt,gt,U.colorSpace,U.isVideoTexture);Ne(Ie,U,Gt);let $e;const $=U.mipmaps,we=a&&U.isVideoTexture!==!0&&ut!==bT,Ve=Ke.__version===void 0||Ae===!0,Ge=Ee.dataReady,mt=O(U,Re,Gt);if(U.isDepthTexture)ut=n.DEPTH_COMPONENT,a?U.type===Ss?ut=n.DEPTH_COMPONENT32F:U.type===qo?ut=n.DEPTH_COMPONENT24:U.type===nl?ut=n.DEPTH24_STENCIL8:ut=n.DEPTH_COMPONENT16:U.type===Ss&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),U.format===il&&ut===n.DEPTH_COMPONENT&&U.type!==Cv&&U.type!==qo&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),U.type=qo,gt=s.convert(U.type)),U.format===Gu&&ut===n.DEPTH_COMPONENT&&(ut=n.DEPTH_STENCIL,U.type!==nl&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),U.type=nl,gt=s.convert(U.type))),Ve&&(we?t.texStorage2D(n.TEXTURE_2D,1,ut,Re.width,Re.height):t.texImage2D(n.TEXTURE_2D,0,ut,Re.width,Re.height,0,Nt,gt,null));else if(U.isDataTexture)if($.length>0&&Gt){we&&Ve&&t.texStorage2D(n.TEXTURE_2D,mt,ut,$[0].width,$[0].height);for(let q=0,Me=$.length;q<Me;q++)$e=$[q],we?Ge&&t.texSubImage2D(n.TEXTURE_2D,q,0,0,$e.width,$e.height,Nt,gt,$e.data):t.texImage2D(n.TEXTURE_2D,q,ut,$e.width,$e.height,0,Nt,gt,$e.data);U.generateMipmaps=!1}else we?(Ve&&t.texStorage2D(n.TEXTURE_2D,mt,ut,Re.width,Re.height),Ge&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,Re.width,Re.height,Nt,gt,Re.data)):t.texImage2D(n.TEXTURE_2D,0,ut,Re.width,Re.height,0,Nt,gt,Re.data);else if(U.isCompressedTexture)if(U.isCompressedArrayTexture){we&&Ve&&t.texStorage3D(n.TEXTURE_2D_ARRAY,mt,ut,$[0].width,$[0].height,Re.depth);for(let q=0,Me=$.length;q<Me;q++)$e=$[q],U.format!==pr?Nt!==null?we?Ge&&t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,q,0,0,0,$e.width,$e.height,Re.depth,Nt,$e.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,q,ut,$e.width,$e.height,Re.depth,0,$e.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):we?Ge&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,q,0,0,0,$e.width,$e.height,Re.depth,Nt,gt,$e.data):t.texImage3D(n.TEXTURE_2D_ARRAY,q,ut,$e.width,$e.height,Re.depth,0,Nt,gt,$e.data)}else{we&&Ve&&t.texStorage2D(n.TEXTURE_2D,mt,ut,$[0].width,$[0].height);for(let q=0,Me=$.length;q<Me;q++)$e=$[q],U.format!==pr?Nt!==null?we?Ge&&t.compressedTexSubImage2D(n.TEXTURE_2D,q,0,0,$e.width,$e.height,Nt,$e.data):t.compressedTexImage2D(n.TEXTURE_2D,q,ut,$e.width,$e.height,0,$e.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):we?Ge&&t.texSubImage2D(n.TEXTURE_2D,q,0,0,$e.width,$e.height,Nt,gt,$e.data):t.texImage2D(n.TEXTURE_2D,q,ut,$e.width,$e.height,0,Nt,gt,$e.data)}else if(U.isDataArrayTexture)we?(Ve&&t.texStorage3D(n.TEXTURE_2D_ARRAY,mt,ut,Re.width,Re.height,Re.depth),Ge&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,Re.width,Re.height,Re.depth,Nt,gt,Re.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,ut,Re.width,Re.height,Re.depth,0,Nt,gt,Re.data);else if(U.isData3DTexture)we?(Ve&&t.texStorage3D(n.TEXTURE_3D,mt,ut,Re.width,Re.height,Re.depth),Ge&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,Re.width,Re.height,Re.depth,Nt,gt,Re.data)):t.texImage3D(n.TEXTURE_3D,0,ut,Re.width,Re.height,Re.depth,0,Nt,gt,Re.data);else if(U.isFramebufferTexture){if(Ve)if(we)t.texStorage2D(n.TEXTURE_2D,mt,ut,Re.width,Re.height);else{let q=Re.width,Me=Re.height;for(let De=0;De<mt;De++)t.texImage2D(n.TEXTURE_2D,De,ut,q,Me,0,Nt,gt,null),q>>=1,Me>>=1}}else if($.length>0&&Gt){we&&Ve&&t.texStorage2D(n.TEXTURE_2D,mt,ut,$[0].width,$[0].height);for(let q=0,Me=$.length;q<Me;q++)$e=$[q],we?Ge&&t.texSubImage2D(n.TEXTURE_2D,q,0,0,Nt,gt,$e):t.texImage2D(n.TEXTURE_2D,q,ut,Nt,gt,$e);U.generateMipmaps=!1}else we?(Ve&&t.texStorage2D(n.TEXTURE_2D,mt,ut,Re.width,Re.height),Ge&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,Nt,gt,Re)):t.texImage2D(n.TEXTURE_2D,0,ut,Nt,gt,Re);w(U,Gt)&&E(Ie),Ke.__version=Ee.version,U.onUpdate&&U.onUpdate(U)}z.__version=U.version}function Le(z,U,te){if(U.image.length!==6)return;const Ie=oe(z,U),Ae=U.source;t.bindTexture(n.TEXTURE_CUBE_MAP,z.__webglTexture,n.TEXTURE0+te);const Ee=i.get(Ae);if(Ae.version!==Ee.__version||Ie===!0){t.activeTexture(n.TEXTURE0+te);const Ke=dn.getPrimaries(dn.workingColorSpace),Ue=U.colorSpace===$r?null:dn.getPrimaries(U.colorSpace),je=U.colorSpace===$r||Ke===Ue?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,U.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,U.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,U.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,je);const ct=U.isCompressedTexture||U.image[0].isCompressedTexture,Rt=U.image[0]&&U.image[0].isDataTexture,Re=[];for(let q=0;q<6;q++)!ct&&!Rt?Re[q]=T(U.image[q],!1,!0,r.maxCubemapSize):Re[q]=Rt?U.image[q].image:U.image[q],Re[q]=Be(U,Re[q]);const Gt=Re[0],Nt=x(Gt)||a,gt=s.convert(U.format,U.colorSpace),ut=s.convert(U.type),$e=I(U.internalFormat,gt,ut,U.colorSpace),$=a&&U.isVideoTexture!==!0,we=Ee.__version===void 0||Ie===!0,Ve=Ae.dataReady;let Ge=O(U,Gt,Nt);Ne(n.TEXTURE_CUBE_MAP,U,Nt);let mt;if(ct){$&&we&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Ge,$e,Gt.width,Gt.height);for(let q=0;q<6;q++){mt=Re[q].mipmaps;for(let Me=0;Me<mt.length;Me++){const De=mt[Me];U.format!==pr?gt!==null?$?Ve&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,Me,0,0,De.width,De.height,gt,De.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,Me,$e,De.width,De.height,0,De.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):$?Ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,Me,0,0,De.width,De.height,gt,ut,De.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,Me,$e,De.width,De.height,0,gt,ut,De.data)}}}else{mt=U.mipmaps,$&&we&&(mt.length>0&&Ge++,t.texStorage2D(n.TEXTURE_CUBE_MAP,Ge,$e,Re[0].width,Re[0].height));for(let q=0;q<6;q++)if(Rt){$?Ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,0,0,Re[q].width,Re[q].height,gt,ut,Re[q].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,$e,Re[q].width,Re[q].height,0,gt,ut,Re[q].data);for(let Me=0;Me<mt.length;Me++){const Qe=mt[Me].image[q].image;$?Ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,Me+1,0,0,Qe.width,Qe.height,gt,ut,Qe.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,Me+1,$e,Qe.width,Qe.height,0,gt,ut,Qe.data)}}else{$?Ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,0,0,gt,ut,Re[q]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,0,$e,gt,ut,Re[q]);for(let Me=0;Me<mt.length;Me++){const De=mt[Me];$?Ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,Me+1,0,0,gt,ut,De.image[q]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+q,Me+1,$e,gt,ut,De.image[q])}}}w(U,Nt)&&E(n.TEXTURE_CUBE_MAP),Ee.__version=Ae.version,U.onUpdate&&U.onUpdate(U)}z.__version=U.version}function ze(z,U,te,Ie,Ae,Ee){const Ke=s.convert(te.format,te.colorSpace),Ue=s.convert(te.type),je=I(te.internalFormat,Ke,Ue,te.colorSpace);if(!i.get(U).__hasExternalTextures){const Rt=Math.max(1,U.width>>Ee),Re=Math.max(1,U.height>>Ee);Ae===n.TEXTURE_3D||Ae===n.TEXTURE_2D_ARRAY?t.texImage3D(Ae,Ee,je,Rt,Re,U.depth,0,Ke,Ue,null):t.texImage2D(Ae,Ee,je,Rt,Re,0,Ke,Ue,null)}t.bindFramebuffer(n.FRAMEBUFFER,z),ve(U)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Ie,Ae,i.get(te).__webglTexture,0,Pe(U)):(Ae===n.TEXTURE_2D||Ae>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&Ae<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,Ie,Ae,i.get(te).__webglTexture,Ee),t.bindFramebuffer(n.FRAMEBUFFER,null)}function at(z,U,te){if(n.bindRenderbuffer(n.RENDERBUFFER,z),U.depthBuffer&&!U.stencilBuffer){let Ie=a===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(te||ve(U)){const Ae=U.depthTexture;Ae&&Ae.isDepthTexture&&(Ae.type===Ss?Ie=n.DEPTH_COMPONENT32F:Ae.type===qo&&(Ie=n.DEPTH_COMPONENT24));const Ee=Pe(U);ve(U)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Ee,Ie,U.width,U.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,Ee,Ie,U.width,U.height)}else n.renderbufferStorage(n.RENDERBUFFER,Ie,U.width,U.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,z)}else if(U.depthBuffer&&U.stencilBuffer){const Ie=Pe(U);te&&ve(U)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,Ie,n.DEPTH24_STENCIL8,U.width,U.height):ve(U)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Ie,n.DEPTH24_STENCIL8,U.width,U.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,U.width,U.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,z)}else{const Ie=U.isWebGLMultipleRenderTargets===!0?U.texture:[U.texture];for(let Ae=0;Ae<Ie.length;Ae++){const Ee=Ie[Ae],Ke=s.convert(Ee.format,Ee.colorSpace),Ue=s.convert(Ee.type),je=I(Ee.internalFormat,Ke,Ue,Ee.colorSpace),ct=Pe(U);te&&ve(U)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,ct,je,U.width,U.height):ve(U)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ct,je,U.width,U.height):n.renderbufferStorage(n.RENDERBUFFER,je,U.width,U.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function Ze(z,U){if(U&&U.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,z),!(U.depthTexture&&U.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(U.depthTexture).__webglTexture||U.depthTexture.image.width!==U.width||U.depthTexture.image.height!==U.height)&&(U.depthTexture.image.width=U.width,U.depthTexture.image.height=U.height,U.depthTexture.needsUpdate=!0),se(U.depthTexture,0);const Ie=i.get(U.depthTexture).__webglTexture,Ae=Pe(U);if(U.depthTexture.format===il)ve(U)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Ie,0,Ae):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Ie,0);else if(U.depthTexture.format===Gu)ve(U)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Ie,0,Ae):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Ie,0);else throw new Error("Unknown depthTexture format")}function St(z){const U=i.get(z),te=z.isWebGLCubeRenderTarget===!0;if(z.depthTexture&&!U.__autoAllocateDepthBuffer){if(te)throw new Error("target.depthTexture not supported in Cube render targets");Ze(U.__webglFramebuffer,z)}else if(te){U.__webglDepthbuffer=[];for(let Ie=0;Ie<6;Ie++)t.bindFramebuffer(n.FRAMEBUFFER,U.__webglFramebuffer[Ie]),U.__webglDepthbuffer[Ie]=n.createRenderbuffer(),at(U.__webglDepthbuffer[Ie],z,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,U.__webglFramebuffer),U.__webglDepthbuffer=n.createRenderbuffer(),at(U.__webglDepthbuffer,z,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function nt(z,U,te){const Ie=i.get(z);U!==void 0&&ze(Ie.__webglFramebuffer,z,z.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),te!==void 0&&St(z)}function X(z){const U=z.texture,te=i.get(z),Ie=i.get(U);z.addEventListener("dispose",b),z.isWebGLMultipleRenderTargets!==!0&&(Ie.__webglTexture===void 0&&(Ie.__webglTexture=n.createTexture()),Ie.__version=U.version,o.memory.textures++);const Ae=z.isWebGLCubeRenderTarget===!0,Ee=z.isWebGLMultipleRenderTargets===!0,Ke=x(z)||a;if(Ae){te.__webglFramebuffer=[];for(let Ue=0;Ue<6;Ue++)if(a&&U.mipmaps&&U.mipmaps.length>0){te.__webglFramebuffer[Ue]=[];for(let je=0;je<U.mipmaps.length;je++)te.__webglFramebuffer[Ue][je]=n.createFramebuffer()}else te.__webglFramebuffer[Ue]=n.createFramebuffer()}else{if(a&&U.mipmaps&&U.mipmaps.length>0){te.__webglFramebuffer=[];for(let Ue=0;Ue<U.mipmaps.length;Ue++)te.__webglFramebuffer[Ue]=n.createFramebuffer()}else te.__webglFramebuffer=n.createFramebuffer();if(Ee)if(r.drawBuffers){const Ue=z.texture;for(let je=0,ct=Ue.length;je<ct;je++){const Rt=i.get(Ue[je]);Rt.__webglTexture===void 0&&(Rt.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&z.samples>0&&ve(z)===!1){const Ue=Ee?U:[U];te.__webglMultisampledFramebuffer=n.createFramebuffer(),te.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,te.__webglMultisampledFramebuffer);for(let je=0;je<Ue.length;je++){const ct=Ue[je];te.__webglColorRenderbuffer[je]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,te.__webglColorRenderbuffer[je]);const Rt=s.convert(ct.format,ct.colorSpace),Re=s.convert(ct.type),Gt=I(ct.internalFormat,Rt,Re,ct.colorSpace,z.isXRRenderTarget===!0),Nt=Pe(z);n.renderbufferStorageMultisample(n.RENDERBUFFER,Nt,Gt,z.width,z.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+je,n.RENDERBUFFER,te.__webglColorRenderbuffer[je])}n.bindRenderbuffer(n.RENDERBUFFER,null),z.depthBuffer&&(te.__webglDepthRenderbuffer=n.createRenderbuffer(),at(te.__webglDepthRenderbuffer,z,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(Ae){t.bindTexture(n.TEXTURE_CUBE_MAP,Ie.__webglTexture),Ne(n.TEXTURE_CUBE_MAP,U,Ke);for(let Ue=0;Ue<6;Ue++)if(a&&U.mipmaps&&U.mipmaps.length>0)for(let je=0;je<U.mipmaps.length;je++)ze(te.__webglFramebuffer[Ue][je],z,U,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,je);else ze(te.__webglFramebuffer[Ue],z,U,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0);w(U,Ke)&&E(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ee){const Ue=z.texture;for(let je=0,ct=Ue.length;je<ct;je++){const Rt=Ue[je],Re=i.get(Rt);t.bindTexture(n.TEXTURE_2D,Re.__webglTexture),Ne(n.TEXTURE_2D,Rt,Ke),ze(te.__webglFramebuffer,z,Rt,n.COLOR_ATTACHMENT0+je,n.TEXTURE_2D,0),w(Rt,Ke)&&E(n.TEXTURE_2D)}t.unbindTexture()}else{let Ue=n.TEXTURE_2D;if((z.isWebGL3DRenderTarget||z.isWebGLArrayRenderTarget)&&(a?Ue=z.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Ue,Ie.__webglTexture),Ne(Ue,U,Ke),a&&U.mipmaps&&U.mipmaps.length>0)for(let je=0;je<U.mipmaps.length;je++)ze(te.__webglFramebuffer[je],z,U,n.COLOR_ATTACHMENT0,Ue,je);else ze(te.__webglFramebuffer,z,U,n.COLOR_ATTACHMENT0,Ue,0);w(U,Ke)&&E(Ue),t.unbindTexture()}z.depthBuffer&&St(z)}function Ce(z){const U=x(z)||a,te=z.isWebGLMultipleRenderTargets===!0?z.texture:[z.texture];for(let Ie=0,Ae=te.length;Ie<Ae;Ie++){const Ee=te[Ie];if(w(Ee,U)){const Ke=z.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Ue=i.get(Ee).__webglTexture;t.bindTexture(Ke,Ue),E(Ke),t.unbindTexture()}}}function me(z){if(a&&z.samples>0&&ve(z)===!1){const U=z.isWebGLMultipleRenderTargets?z.texture:[z.texture],te=z.width,Ie=z.height;let Ae=n.COLOR_BUFFER_BIT;const Ee=[],Ke=z.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ue=i.get(z),je=z.isWebGLMultipleRenderTargets===!0;if(je)for(let ct=0;ct<U.length;ct++)t.bindFramebuffer(n.FRAMEBUFFER,Ue.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+ct,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Ue.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+ct,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Ue.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ue.__webglFramebuffer);for(let ct=0;ct<U.length;ct++){Ee.push(n.COLOR_ATTACHMENT0+ct),z.depthBuffer&&Ee.push(Ke);const Rt=Ue.__ignoreDepthValues!==void 0?Ue.__ignoreDepthValues:!1;if(Rt===!1&&(z.depthBuffer&&(Ae|=n.DEPTH_BUFFER_BIT),z.stencilBuffer&&(Ae|=n.STENCIL_BUFFER_BIT)),je&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Ue.__webglColorRenderbuffer[ct]),Rt===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[Ke]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Ke])),je){const Re=i.get(U[ct]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Re,0)}n.blitFramebuffer(0,0,te,Ie,0,0,te,Ie,Ae,n.NEAREST),h&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,Ee)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),je)for(let ct=0;ct<U.length;ct++){t.bindFramebuffer(n.FRAMEBUFFER,Ue.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+ct,n.RENDERBUFFER,Ue.__webglColorRenderbuffer[ct]);const Rt=i.get(U[ct]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Ue.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+ct,n.TEXTURE_2D,Rt,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ue.__webglMultisampledFramebuffer)}}function Pe(z){return Math.min(r.maxSamples,z.samples)}function ve(z){const U=i.get(z);return a&&z.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&U.__useRenderToTexture!==!1}function st(z){const U=o.render.frame;f.get(z)!==U&&(f.set(z,U),z.update())}function Be(z,U){const te=z.colorSpace,Ie=z.format,Ae=z.type;return z.isCompressedTexture===!0||z.isVideoTexture===!0||z.format===Oy||te!==wo&&te!==$r&&(dn.getTransfer(te)===yn?a===!1?e.has("EXT_sRGB")===!0&&Ie===pr?(z.format=Oy,z.minFilter=On,z.generateMipmaps=!1):U=UT.sRGBToLinear(U):(Ie!==pr||Ae!==xo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",te)),U}this.allocateTextureUnit=Y,this.resetTextureUnits=F,this.setTexture2D=se,this.setTexture2DArray=ye,this.setTexture3D=W,this.setTextureCube=K,this.rebindTextures=nt,this.setupRenderTarget=X,this.updateRenderTargetMipmap=Ce,this.updateMultisampleRenderTarget=me,this.setupDepthRenderbuffer=St,this.setupFrameBufferTexture=ze,this.useMultisampledRTT=ve}function Ek(n,e,t){const i=t.isWebGL2;function r(s,o=$r){let a;const l=dn.getTransfer(o);if(s===xo)return n.UNSIGNED_BYTE;if(s===AT)return n.UNSIGNED_SHORT_4_4_4_4;if(s===CT)return n.UNSIGNED_SHORT_5_5_5_1;if(s===B3)return n.BYTE;if(s===H3)return n.SHORT;if(s===Cv)return n.UNSIGNED_SHORT;if(s===MT)return n.INT;if(s===qo)return n.UNSIGNED_INT;if(s===Ss)return n.FLOAT;if(s===jh)return i?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===G3)return n.ALPHA;if(s===pr)return n.RGBA;if(s===W3)return n.LUMINANCE;if(s===j3)return n.LUMINANCE_ALPHA;if(s===il)return n.DEPTH_COMPONENT;if(s===Gu)return n.DEPTH_STENCIL;if(s===Oy)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===q3)return n.RED;if(s===RT)return n.RED_INTEGER;if(s===X3)return n.RG;if(s===IT)return n.RG_INTEGER;if(s===PT)return n.RGBA_INTEGER;if(s===D_||s===k_||s===O_||s===U_)if(l===yn)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===D_)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===k_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===O_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===U_)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===D_)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===k_)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===O_)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===U_)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===YE||s===$E||s===KE||s===QE)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===YE)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===$E)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===KE)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===QE)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===bT)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===JE||s===ZE)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===JE)return l===yn?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===ZE)return l===yn?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===ew||s===tw||s===nw||s===iw||s===rw||s===sw||s===ow||s===aw||s===lw||s===uw||s===cw||s===hw||s===fw||s===dw)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===ew)return l===yn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===tw)return l===yn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===nw)return l===yn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===iw)return l===yn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===rw)return l===yn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===sw)return l===yn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===ow)return l===yn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===aw)return l===yn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===lw)return l===yn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===uw)return l===yn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===cw)return l===yn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===hw)return l===yn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===fw)return l===yn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===dw)return l===yn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===F_||s===pw||s===mw)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===F_)return l===yn?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===pw)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===mw)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===Y3||s===gw||s===_w||s===yw)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===F_)return a.COMPRESSED_RED_RGTC1_EXT;if(s===gw)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===_w)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===yw)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===nl?i?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):n[s]!==void 0?n[s]:null}return{convert:r}}class wk extends ti{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class mh extends ln{constructor(){super(),this.isGroup=!0,this.type="Group"}}const NX={type:"move"};class Jx{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new mh,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new mh,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new G,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new G),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new mh,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new G,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new G),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,h=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(h&&e.hand){o=!0;for(const T of e.hand.values()){const x=t.getJointPose(T,i),y=this._getHandJoint(h,T);x!==null&&(y.matrix.fromArray(x.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.matrixWorldNeedsUpdate=!0,y.jointRadius=x.radius),y.visible=x!==null}const f=h.joints["index-finger-tip"],d=h.joints["thumb-tip"],p=f.position.distanceTo(d.position),_=.02,v=.005;h.inputState.pinching&&p>_+v?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!h.inputState.pinching&&p<=_-v&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(NX)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),h!==null&&(h.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const i=new mh;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}const DX=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,kX=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepthEXT = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepthEXT = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class OX{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,i){if(this.texture===null){const r=new Pn,s=e.properties.get(r);s.__webglTexture=t.texture,(t.depthNear!=i.depthNear||t.depthFar!=i.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}render(e,t){if(this.texture!==null){if(this.mesh===null){const i=t.cameras[0].viewport,r=new ns({extensions:{fragDepth:!0},vertexShader:DX,fragmentShader:kX,uniforms:{depthColor:{value:this.texture},depthWidth:{value:i.z},depthHeight:{value:i.w}}});this.mesh=new ui(new cf(20,20),r)}e.render(this.mesh,t)}}reset(){this.texture=null,this.mesh=null}}class UX extends ha{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,h=null,f=null,d=null,p=null,_=null,v=null;const T=new OX,x=t.getContextAttributes();let y=null,w=null;const E=[],I=[],O=new ge;let D=null;const R=new ti;R.layers.enable(1),R.viewport=new cn;const b=new ti;b.layers.enable(2),b.viewport=new cn;const k=[R,b],M=new wk;M.layers.enable(1),M.layers.enable(2);let P=null,V=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(oe){let xe=E[oe];return xe===void 0&&(xe=new Jx,E[oe]=xe),xe.getTargetRaySpace()},this.getControllerGrip=function(oe){let xe=E[oe];return xe===void 0&&(xe=new Jx,E[oe]=xe),xe.getGripSpace()},this.getHand=function(oe){let xe=E[oe];return xe===void 0&&(xe=new Jx,E[oe]=xe),xe.getHandSpace()};function F(oe){const xe=I.indexOf(oe.inputSource);if(xe===-1)return;const Le=E[xe];Le!==void 0&&(Le.update(oe.inputSource,oe.frame,h||o),Le.dispatchEvent({type:oe.type,data:oe.inputSource}))}function Y(){r.removeEventListener("select",F),r.removeEventListener("selectstart",F),r.removeEventListener("selectend",F),r.removeEventListener("squeeze",F),r.removeEventListener("squeezestart",F),r.removeEventListener("squeezeend",F),r.removeEventListener("end",Y),r.removeEventListener("inputsourceschange",re);for(let oe=0;oe<E.length;oe++){const xe=I[oe];xe!==null&&(I[oe]=null,E[oe].disconnect(xe))}P=null,V=null,T.reset(),e.setRenderTarget(y),_=null,p=null,d=null,r=null,w=null,Ne.stop(),i.isPresenting=!1,e.setPixelRatio(D),e.setSize(O.width,O.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(oe){s=oe,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(oe){a=oe,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h||o},this.setReferenceSpace=function(oe){h=oe},this.getBaseLayer=function(){return p!==null?p:_},this.getBinding=function(){return d},this.getFrame=function(){return v},this.getSession=function(){return r},this.setSession=async function(oe){if(r=oe,r!==null){if(y=e.getRenderTarget(),r.addEventListener("select",F),r.addEventListener("selectstart",F),r.addEventListener("selectend",F),r.addEventListener("squeeze",F),r.addEventListener("squeezestart",F),r.addEventListener("squeezeend",F),r.addEventListener("end",Y),r.addEventListener("inputsourceschange",re),x.xrCompatible!==!0&&await t.makeXRCompatible(),D=e.getPixelRatio(),e.getSize(O),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const xe={antialias:r.renderState.layers===void 0?x.antialias:!0,alpha:!0,depth:x.depth,stencil:x.stencil,framebufferScaleFactor:s};_=new XRWebGLLayer(r,t,xe),r.updateRenderState({baseLayer:_}),e.setPixelRatio(1),e.setSize(_.framebufferWidth,_.framebufferHeight,!1),w=new $s(_.framebufferWidth,_.framebufferHeight,{format:pr,type:xo,colorSpace:e.outputColorSpace,stencilBuffer:x.stencil})}else{let xe=null,Le=null,ze=null;x.depth&&(ze=x.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,xe=x.stencil?Gu:il,Le=x.stencil?nl:qo);const at={colorFormat:t.RGBA8,depthFormat:ze,scaleFactor:s};d=new XRWebGLBinding(r,t),p=d.createProjectionLayer(at),r.updateRenderState({layers:[p]}),e.setPixelRatio(1),e.setSize(p.textureWidth,p.textureHeight,!1),w=new $s(p.textureWidth,p.textureHeight,{format:pr,type:xo,depthTexture:new HT(p.textureWidth,p.textureHeight,Le,void 0,void 0,void 0,void 0,void 0,void 0,xe),stencilBuffer:x.stencil,colorSpace:e.outputColorSpace,samples:x.antialias?4:0});const Ze=e.properties.get(w);Ze.__ignoreDepthValues=p.ignoreDepthValues}w.isXRRenderTarget=!0,this.setFoveation(l),h=null,o=await r.requestReferenceSpace(a),Ne.setContext(r),Ne.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode};function re(oe){for(let xe=0;xe<oe.removed.length;xe++){const Le=oe.removed[xe],ze=I.indexOf(Le);ze>=0&&(I[ze]=null,E[ze].disconnect(Le))}for(let xe=0;xe<oe.added.length;xe++){const Le=oe.added[xe];let ze=I.indexOf(Le);if(ze===-1){for(let Ze=0;Ze<E.length;Ze++)if(Ze>=I.length){I.push(Le),ze=Ze;break}else if(I[Ze]===null){I[Ze]=Le,ze=Ze;break}if(ze===-1)break}const at=E[ze];at&&at.connect(Le)}}const se=new G,ye=new G;function W(oe,xe,Le){se.setFromMatrixPosition(xe.matrixWorld),ye.setFromMatrixPosition(Le.matrixWorld);const ze=se.distanceTo(ye),at=xe.projectionMatrix.elements,Ze=Le.projectionMatrix.elements,St=at[14]/(at[10]-1),nt=at[14]/(at[10]+1),X=(at[9]+1)/at[5],Ce=(at[9]-1)/at[5],me=(at[8]-1)/at[0],Pe=(Ze[8]+1)/Ze[0],ve=St*me,st=St*Pe,Be=ze/(-me+Pe),z=Be*-me;xe.matrixWorld.decompose(oe.position,oe.quaternion,oe.scale),oe.translateX(z),oe.translateZ(Be),oe.matrixWorld.compose(oe.position,oe.quaternion,oe.scale),oe.matrixWorldInverse.copy(oe.matrixWorld).invert();const U=St+Be,te=nt+Be,Ie=ve-z,Ae=st+(ze-z),Ee=X*nt/te*U,Ke=Ce*nt/te*U;oe.projectionMatrix.makePerspective(Ie,Ae,Ee,Ke,U,te),oe.projectionMatrixInverse.copy(oe.projectionMatrix).invert()}function K(oe,xe){xe===null?oe.matrixWorld.copy(oe.matrix):oe.matrixWorld.multiplyMatrices(xe.matrixWorld,oe.matrix),oe.matrixWorldInverse.copy(oe.matrixWorld).invert()}this.updateCamera=function(oe){if(r===null)return;T.texture!==null&&(oe.near=T.depthNear,oe.far=T.depthFar),M.near=b.near=R.near=oe.near,M.far=b.far=R.far=oe.far,(P!==M.near||V!==M.far)&&(r.updateRenderState({depthNear:M.near,depthFar:M.far}),P=M.near,V=M.far,R.near=P,R.far=V,b.near=P,b.far=V,R.updateProjectionMatrix(),b.updateProjectionMatrix(),oe.updateProjectionMatrix());const xe=oe.parent,Le=M.cameras;K(M,xe);for(let ze=0;ze<Le.length;ze++)K(Le[ze],xe);Le.length===2?W(M,R,b):M.projectionMatrix.copy(R.projectionMatrix),Q(oe,M,xe)};function Q(oe,xe,Le){Le===null?oe.matrix.copy(xe.matrixWorld):(oe.matrix.copy(Le.matrixWorld),oe.matrix.invert(),oe.matrix.multiply(xe.matrixWorld)),oe.matrix.decompose(oe.position,oe.quaternion,oe.scale),oe.updateMatrixWorld(!0),oe.projectionMatrix.copy(xe.projectionMatrix),oe.projectionMatrixInverse.copy(xe.projectionMatrixInverse),oe.isPerspectiveCamera&&(oe.fov=qh*2*Math.atan(1/oe.projectionMatrix.elements[5]),oe.zoom=1)}this.getCamera=function(){return M},this.getFoveation=function(){if(!(p===null&&_===null))return l},this.setFoveation=function(oe){l=oe,p!==null&&(p.fixedFoveation=oe),_!==null&&_.fixedFoveation!==void 0&&(_.fixedFoveation=oe)},this.hasDepthSensing=function(){return T.texture!==null};let ee=null;function _e(oe,xe){if(f=xe.getViewerPose(h||o),v=xe,f!==null){const Le=f.views;_!==null&&(e.setRenderTargetFramebuffer(w,_.framebuffer),e.setRenderTarget(w));let ze=!1;Le.length!==M.cameras.length&&(M.cameras.length=0,ze=!0);for(let Ze=0;Ze<Le.length;Ze++){const St=Le[Ze];let nt=null;if(_!==null)nt=_.getViewport(St);else{const Ce=d.getViewSubImage(p,St);nt=Ce.viewport,Ze===0&&(e.setRenderTargetTextures(w,Ce.colorTexture,p.ignoreDepthValues?void 0:Ce.depthStencilTexture),e.setRenderTarget(w))}let X=k[Ze];X===void 0&&(X=new ti,X.layers.enable(Ze),X.viewport=new cn,k[Ze]=X),X.matrix.fromArray(St.transform.matrix),X.matrix.decompose(X.position,X.quaternion,X.scale),X.projectionMatrix.fromArray(St.projectionMatrix),X.projectionMatrixInverse.copy(X.projectionMatrix).invert(),X.viewport.set(nt.x,nt.y,nt.width,nt.height),Ze===0&&(M.matrix.copy(X.matrix),M.matrix.decompose(M.position,M.quaternion,M.scale)),ze===!0&&M.cameras.push(X)}const at=r.enabledFeatures;if(at&&at.includes("depth-sensing")){const Ze=d.getDepthInformation(Le[0]);Ze&&Ze.isValid&&Ze.texture&&T.init(e,Ze,r.renderState)}}for(let Le=0;Le<E.length;Le++){const ze=I[Le],at=E[Le];ze!==null&&at!==void 0&&at.update(ze,xe,h||o)}T.render(e,M),ee&&ee(oe,xe),xe.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:xe}),v=null}const Ne=new gk;Ne.setAnimationLoop(_e),this.setAnimationLoop=function(oe){ee=oe},this.dispose=function(){}}}function FX(n,e){function t(x,y){x.matrixAutoUpdate===!0&&x.updateMatrix(),y.value.copy(x.matrix)}function i(x,y){y.color.getRGB(x.fogColor.value,fk(n)),y.isFog?(x.fogNear.value=y.near,x.fogFar.value=y.far):y.isFogExp2&&(x.fogDensity.value=y.density)}function r(x,y,w,E,I){y.isMeshBasicMaterial||y.isMeshLambertMaterial?s(x,y):y.isMeshToonMaterial?(s(x,y),d(x,y)):y.isMeshPhongMaterial?(s(x,y),f(x,y)):y.isMeshStandardMaterial?(s(x,y),p(x,y),y.isMeshPhysicalMaterial&&_(x,y,I)):y.isMeshMatcapMaterial?(s(x,y),v(x,y)):y.isMeshDepthMaterial?s(x,y):y.isMeshDistanceMaterial?(s(x,y),T(x,y)):y.isMeshNormalMaterial?s(x,y):y.isLineBasicMaterial?(o(x,y),y.isLineDashedMaterial&&a(x,y)):y.isPointsMaterial?l(x,y,w,E):y.isSpriteMaterial?h(x,y):y.isShadowMaterial?(x.color.value.copy(y.color),x.opacity.value=y.opacity):y.isShaderMaterial&&(y.uniformsNeedUpdate=!1)}function s(x,y){x.opacity.value=y.opacity,y.color&&x.diffuse.value.copy(y.color),y.emissive&&x.emissive.value.copy(y.emissive).multiplyScalar(y.emissiveIntensity),y.map&&(x.map.value=y.map,t(y.map,x.mapTransform)),y.alphaMap&&(x.alphaMap.value=y.alphaMap,t(y.alphaMap,x.alphaMapTransform)),y.bumpMap&&(x.bumpMap.value=y.bumpMap,t(y.bumpMap,x.bumpMapTransform),x.bumpScale.value=y.bumpScale,y.side===_r&&(x.bumpScale.value*=-1)),y.normalMap&&(x.normalMap.value=y.normalMap,t(y.normalMap,x.normalMapTransform),x.normalScale.value.copy(y.normalScale),y.side===_r&&x.normalScale.value.negate()),y.displacementMap&&(x.displacementMap.value=y.displacementMap,t(y.displacementMap,x.displacementMapTransform),x.displacementScale.value=y.displacementScale,x.displacementBias.value=y.displacementBias),y.emissiveMap&&(x.emissiveMap.value=y.emissiveMap,t(y.emissiveMap,x.emissiveMapTransform)),y.specularMap&&(x.specularMap.value=y.specularMap,t(y.specularMap,x.specularMapTransform)),y.alphaTest>0&&(x.alphaTest.value=y.alphaTest);const w=e.get(y).envMap;if(w&&(x.envMap.value=w,x.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,x.reflectivity.value=y.reflectivity,x.ior.value=y.ior,x.refractionRatio.value=y.refractionRatio),y.lightMap){x.lightMap.value=y.lightMap;const E=n._useLegacyLights===!0?Math.PI:1;x.lightMapIntensity.value=y.lightMapIntensity*E,t(y.lightMap,x.lightMapTransform)}y.aoMap&&(x.aoMap.value=y.aoMap,x.aoMapIntensity.value=y.aoMapIntensity,t(y.aoMap,x.aoMapTransform))}function o(x,y){x.diffuse.value.copy(y.color),x.opacity.value=y.opacity,y.map&&(x.map.value=y.map,t(y.map,x.mapTransform))}function a(x,y){x.dashSize.value=y.dashSize,x.totalSize.value=y.dashSize+y.gapSize,x.scale.value=y.scale}function l(x,y,w,E){x.diffuse.value.copy(y.color),x.opacity.value=y.opacity,x.size.value=y.size*w,x.scale.value=E*.5,y.map&&(x.map.value=y.map,t(y.map,x.uvTransform)),y.alphaMap&&(x.alphaMap.value=y.alphaMap,t(y.alphaMap,x.alphaMapTransform)),y.alphaTest>0&&(x.alphaTest.value=y.alphaTest)}function h(x,y){x.diffuse.value.copy(y.color),x.opacity.value=y.opacity,x.rotation.value=y.rotation,y.map&&(x.map.value=y.map,t(y.map,x.mapTransform)),y.alphaMap&&(x.alphaMap.value=y.alphaMap,t(y.alphaMap,x.alphaMapTransform)),y.alphaTest>0&&(x.alphaTest.value=y.alphaTest)}function f(x,y){x.specular.value.copy(y.specular),x.shininess.value=Math.max(y.shininess,1e-4)}function d(x,y){y.gradientMap&&(x.gradientMap.value=y.gradientMap)}function p(x,y){x.metalness.value=y.metalness,y.metalnessMap&&(x.metalnessMap.value=y.metalnessMap,t(y.metalnessMap,x.metalnessMapTransform)),x.roughness.value=y.roughness,y.roughnessMap&&(x.roughnessMap.value=y.roughnessMap,t(y.roughnessMap,x.roughnessMapTransform)),e.get(y).envMap&&(x.envMapIntensity.value=y.envMapIntensity)}function _(x,y,w){x.ior.value=y.ior,y.sheen>0&&(x.sheenColor.value.copy(y.sheenColor).multiplyScalar(y.sheen),x.sheenRoughness.value=y.sheenRoughness,y.sheenColorMap&&(x.sheenColorMap.value=y.sheenColorMap,t(y.sheenColorMap,x.sheenColorMapTransform)),y.sheenRoughnessMap&&(x.sheenRoughnessMap.value=y.sheenRoughnessMap,t(y.sheenRoughnessMap,x.sheenRoughnessMapTransform))),y.clearcoat>0&&(x.clearcoat.value=y.clearcoat,x.clearcoatRoughness.value=y.clearcoatRoughness,y.clearcoatMap&&(x.clearcoatMap.value=y.clearcoatMap,t(y.clearcoatMap,x.clearcoatMapTransform)),y.clearcoatRoughnessMap&&(x.clearcoatRoughnessMap.value=y.clearcoatRoughnessMap,t(y.clearcoatRoughnessMap,x.clearcoatRoughnessMapTransform)),y.clearcoatNormalMap&&(x.clearcoatNormalMap.value=y.clearcoatNormalMap,t(y.clearcoatNormalMap,x.clearcoatNormalMapTransform),x.clearcoatNormalScale.value.copy(y.clearcoatNormalScale),y.side===_r&&x.clearcoatNormalScale.value.negate())),y.iridescence>0&&(x.iridescence.value=y.iridescence,x.iridescenceIOR.value=y.iridescenceIOR,x.iridescenceThicknessMinimum.value=y.iridescenceThicknessRange[0],x.iridescenceThicknessMaximum.value=y.iridescenceThicknessRange[1],y.iridescenceMap&&(x.iridescenceMap.value=y.iridescenceMap,t(y.iridescenceMap,x.iridescenceMapTransform)),y.iridescenceThicknessMap&&(x.iridescenceThicknessMap.value=y.iridescenceThicknessMap,t(y.iridescenceThicknessMap,x.iridescenceThicknessMapTransform))),y.transmission>0&&(x.transmission.value=y.transmission,x.transmissionSamplerMap.value=w.texture,x.transmissionSamplerSize.value.set(w.width,w.height),y.transmissionMap&&(x.transmissionMap.value=y.transmissionMap,t(y.transmissionMap,x.transmissionMapTransform)),x.thickness.value=y.thickness,y.thicknessMap&&(x.thicknessMap.value=y.thicknessMap,t(y.thicknessMap,x.thicknessMapTransform)),x.attenuationDistance.value=y.attenuationDistance,x.attenuationColor.value.copy(y.attenuationColor)),y.anisotropy>0&&(x.anisotropyVector.value.set(y.anisotropy*Math.cos(y.anisotropyRotation),y.anisotropy*Math.sin(y.anisotropyRotation)),y.anisotropyMap&&(x.anisotropyMap.value=y.anisotropyMap,t(y.anisotropyMap,x.anisotropyMapTransform))),x.specularIntensity.value=y.specularIntensity,x.specularColor.value.copy(y.specularColor),y.specularColorMap&&(x.specularColorMap.value=y.specularColorMap,t(y.specularColorMap,x.specularColorMapTransform)),y.specularIntensityMap&&(x.specularIntensityMap.value=y.specularIntensityMap,t(y.specularIntensityMap,x.specularIntensityMapTransform))}function v(x,y){y.matcap&&(x.matcap.value=y.matcap)}function T(x,y){const w=e.get(y).light;x.referencePosition.value.setFromMatrixPosition(w.matrixWorld),x.nearDistance.value=w.shadow.camera.near,x.farDistance.value=w.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function VX(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(w,E){const I=E.program;i.uniformBlockBinding(w,I)}function h(w,E){let I=r[w.id];I===void 0&&(v(w),I=f(w),r[w.id]=I,w.addEventListener("dispose",x));const O=E.program;i.updateUBOMapping(w,O);const D=e.render.frame;s[w.id]!==D&&(p(w),s[w.id]=D)}function f(w){const E=d();w.__bindingPointIndex=E;const I=n.createBuffer(),O=w.__size,D=w.usage;return n.bindBuffer(n.UNIFORM_BUFFER,I),n.bufferData(n.UNIFORM_BUFFER,O,D),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,E,I),I}function d(){for(let w=0;w<a;w++)if(o.indexOf(w)===-1)return o.push(w),w;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function p(w){const E=r[w.id],I=w.uniforms,O=w.__cache;n.bindBuffer(n.UNIFORM_BUFFER,E);for(let D=0,R=I.length;D<R;D++){const b=Array.isArray(I[D])?I[D]:[I[D]];for(let k=0,M=b.length;k<M;k++){const P=b[k];if(_(P,D,k,O)===!0){const V=P.__offset,F=Array.isArray(P.value)?P.value:[P.value];let Y=0;for(let re=0;re<F.length;re++){const se=F[re],ye=T(se);typeof se=="number"||typeof se=="boolean"?(P.__data[0]=se,n.bufferSubData(n.UNIFORM_BUFFER,V+Y,P.__data)):se.isMatrix3?(P.__data[0]=se.elements[0],P.__data[1]=se.elements[1],P.__data[2]=se.elements[2],P.__data[3]=0,P.__data[4]=se.elements[3],P.__data[5]=se.elements[4],P.__data[6]=se.elements[5],P.__data[7]=0,P.__data[8]=se.elements[6],P.__data[9]=se.elements[7],P.__data[10]=se.elements[8],P.__data[11]=0):(se.toArray(P.__data,Y),Y+=ye.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,V,P.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function _(w,E,I,O){const D=w.value,R=E+"_"+I;if(O[R]===void 0)return typeof D=="number"||typeof D=="boolean"?O[R]=D:O[R]=D.clone(),!0;{const b=O[R];if(typeof D=="number"||typeof D=="boolean"){if(b!==D)return O[R]=D,!0}else if(b.equals(D)===!1)return b.copy(D),!0}return!1}function v(w){const E=w.uniforms;let I=0;const O=16;for(let R=0,b=E.length;R<b;R++){const k=Array.isArray(E[R])?E[R]:[E[R]];for(let M=0,P=k.length;M<P;M++){const V=k[M],F=Array.isArray(V.value)?V.value:[V.value];for(let Y=0,re=F.length;Y<re;Y++){const se=F[Y],ye=T(se),W=I%O;W!==0&&O-W<ye.boundary&&(I+=O-W),V.__data=new Float32Array(ye.storage/Float32Array.BYTES_PER_ELEMENT),V.__offset=I,I+=ye.storage}}}const D=I%O;return D>0&&(I+=O-D),w.__size=I,w.__cache={},this}function T(w){const E={boundary:0,storage:0};return typeof w=="number"||typeof w=="boolean"?(E.boundary=4,E.storage=4):w.isVector2?(E.boundary=8,E.storage=8):w.isVector3||w.isColor?(E.boundary=16,E.storage=12):w.isVector4?(E.boundary=16,E.storage=16):w.isMatrix3?(E.boundary=48,E.storage=48):w.isMatrix4?(E.boundary=64,E.storage=64):w.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",w),E}function x(w){const E=w.target;E.removeEventListener("dispose",x);const I=o.indexOf(E.__bindingPointIndex);o.splice(I,1),n.deleteBuffer(r[E.id]),delete r[E.id],delete s[E.id]}function y(){for(const w in r)n.deleteBuffer(r[w]);o=[],r={},s={}}return{bind:l,update:h,dispose:y}}class jT{constructor(e={}){const{canvas:t=uk(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:h=!1,powerPreference:f="default",failIfMajorPerformanceCaveat:d=!1}=e;this.isWebGLRenderer=!0;let p;i!==null?p=i.getContextAttributes().alpha:p=o;const _=new Uint32Array(4),v=new Int32Array(4);let T=null,x=null;const y=[],w=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=di,this._useLegacyLights=!1,this.toneMapping=vo,this.toneMappingExposure=1;const E=this;let I=!1,O=0,D=0,R=null,b=-1,k=null;const M=new cn,P=new cn;let V=null;const F=new Ye(0);let Y=0,re=t.width,se=t.height,ye=1,W=null,K=null;const Q=new cn(0,0,re,se),ee=new cn(0,0,re,se);let _e=!1;const Ne=new Jp;let oe=!1,xe=!1,Le=null;const ze=new Mt,at=new ge,Ze=new G,St={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function nt(){return R===null?ye:1}let X=i;function Ce(H,ne){for(let ce=0;ce<H.length;ce++){const he=H[ce],le=t.getContext(he,ne);if(le!==null)return le}return null}try{const H={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:h,powerPreference:f,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${lf}`),t.addEventListener("webglcontextlost",mt,!1),t.addEventListener("webglcontextrestored",q,!1),t.addEventListener("webglcontextcreationerror",Me,!1),X===null){const ne=["webgl2","webgl","experimental-webgl"];if(E.isWebGL1Renderer===!0&&ne.shift(),X=Ce(ne,H),X===null)throw Ce(ne)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&X instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),X.getShaderPrecisionFormat===void 0&&(X.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(H){throw console.error("THREE.WebGLRenderer: "+H.message),H}let me,Pe,ve,st,Be,z,U,te,Ie,Ae,Ee,Ke,Ue,je,ct,Rt,Re,Gt,Nt,gt,ut,$e,$,we;function Ve(){me=new Kj(X),Pe=new Wj(X,me,e),me.init(Pe),$e=new Ek(X,me,Pe),ve=new bX(X,me,Pe),st=new Zj(X),Be=new vX,z=new LX(X,me,ve,Be,Pe,$e,st),U=new qj(E),te=new $j(E),Ie=new aW(X,Pe),$=new Hj(X,me,Ie,Pe),Ae=new Qj(X,Ie,st,$),Ee=new iq(X,Ae,Ie,st),Nt=new nq(X,Pe,z),Rt=new jj(Be),Ke=new yX(E,U,te,me,Pe,$,Rt),Ue=new FX(E,Be),je=new SX,ct=new CX(me,Pe),Gt=new Bj(E,U,te,ve,Ee,p,l),Re=new PX(E,Ee,Pe),we=new VX(X,st,Pe,ve),gt=new Gj(X,me,st,Pe),ut=new Jj(X,me,st,Pe),st.programs=Ke.programs,E.capabilities=Pe,E.extensions=me,E.properties=Be,E.renderLists=je,E.shadowMap=Re,E.state=ve,E.info=st}Ve();const Ge=new UX(E,X);this.xr=Ge,this.getContext=function(){return X},this.getContextAttributes=function(){return X.getContextAttributes()},this.forceContextLoss=function(){const H=me.get("WEBGL_lose_context");H&&H.loseContext()},this.forceContextRestore=function(){const H=me.get("WEBGL_lose_context");H&&H.restoreContext()},this.getPixelRatio=function(){return ye},this.setPixelRatio=function(H){H!==void 0&&(ye=H,this.setSize(re,se,!1))},this.getSize=function(H){return H.set(re,se)},this.setSize=function(H,ne,ce=!0){if(Ge.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}re=H,se=ne,t.width=Math.floor(H*ye),t.height=Math.floor(ne*ye),ce===!0&&(t.style.width=H+"px",t.style.height=ne+"px"),this.setViewport(0,0,H,ne)},this.getDrawingBufferSize=function(H){return H.set(re*ye,se*ye).floor()},this.setDrawingBufferSize=function(H,ne,ce){re=H,se=ne,ye=ce,t.width=Math.floor(H*ce),t.height=Math.floor(ne*ce),this.setViewport(0,0,H,ne)},this.getCurrentViewport=function(H){return H.copy(M)},this.getViewport=function(H){return H.copy(Q)},this.setViewport=function(H,ne,ce,he){H.isVector4?Q.set(H.x,H.y,H.z,H.w):Q.set(H,ne,ce,he),ve.viewport(M.copy(Q).multiplyScalar(ye).floor())},this.getScissor=function(H){return H.copy(ee)},this.setScissor=function(H,ne,ce,he){H.isVector4?ee.set(H.x,H.y,H.z,H.w):ee.set(H,ne,ce,he),ve.scissor(P.copy(ee).multiplyScalar(ye).floor())},this.getScissorTest=function(){return _e},this.setScissorTest=function(H){ve.setScissorTest(_e=H)},this.setOpaqueSort=function(H){W=H},this.setTransparentSort=function(H){K=H},this.getClearColor=function(H){return H.copy(Gt.getClearColor())},this.setClearColor=function(){Gt.setClearColor.apply(Gt,arguments)},this.getClearAlpha=function(){return Gt.getClearAlpha()},this.setClearAlpha=function(){Gt.setClearAlpha.apply(Gt,arguments)},this.clear=function(H=!0,ne=!0,ce=!0){let he=0;if(H){let le=!1;if(R!==null){const We=R.texture.format;le=We===PT||We===IT||We===RT}if(le){const We=R.texture.type,ot=We===xo||We===qo||We===Cv||We===nl||We===AT||We===CT,ht=Gt.getClearColor(),_t=Gt.getClearAlpha(),It=ht.r,Et=ht.g,At=ht.b;ot?(_[0]=It,_[1]=Et,_[2]=At,_[3]=_t,X.clearBufferuiv(X.COLOR,0,_)):(v[0]=It,v[1]=Et,v[2]=At,v[3]=_t,X.clearBufferiv(X.COLOR,0,v))}else he|=X.COLOR_BUFFER_BIT}ne&&(he|=X.DEPTH_BUFFER_BIT),ce&&(he|=X.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),X.clear(he)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",mt,!1),t.removeEventListener("webglcontextrestored",q,!1),t.removeEventListener("webglcontextcreationerror",Me,!1),je.dispose(),ct.dispose(),Be.dispose(),U.dispose(),te.dispose(),Ee.dispose(),$.dispose(),we.dispose(),Ke.dispose(),Ge.dispose(),Ge.removeEventListener("sessionstart",bn),Ge.removeEventListener("sessionend",Kt),Le&&(Le.dispose(),Le=null),Bn.stop()};function mt(H){H.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),I=!0}function q(){console.log("THREE.WebGLRenderer: Context Restored."),I=!1;const H=st.autoReset,ne=Re.enabled,ce=Re.autoUpdate,he=Re.needsUpdate,le=Re.type;Ve(),st.autoReset=H,Re.enabled=ne,Re.autoUpdate=ce,Re.needsUpdate=he,Re.type=le}function Me(H){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",H.statusMessage)}function De(H){const ne=H.target;ne.removeEventListener("dispose",De),Qe(ne)}function Qe(H){Je(H),Be.remove(H)}function Je(H){const ne=Be.get(H).programs;ne!==void 0&&(ne.forEach(function(ce){Ke.releaseProgram(ce)}),H.isShaderMaterial&&Ke.releaseShaderCache(H))}this.renderBufferDirect=function(H,ne,ce,he,le,We){ne===null&&(ne=St);const ot=le.isMesh&&le.matrixWorld.determinant()<0,ht=Ll(H,ne,ce,he,le);ve.setMaterial(he,ot);let _t=ce.index,It=1;if(he.wireframe===!0){if(_t=Ae.getWireframeAttribute(ce),_t===void 0)return;It=2}const Et=ce.drawRange,At=ce.attributes.position;let _n=Et.start*It,Yn=(Et.start+Et.count)*It;We!==null&&(_n=Math.max(_n,We.start*It),Yn=Math.min(Yn,(We.start+We.count)*It)),_t!==null?(_n=Math.max(_n,0),Yn=Math.min(Yn,_t.count)):At!=null&&(_n=Math.max(_n,0),Yn=Math.min(Yn,At.count));const fn=Yn-_n;if(fn<0||fn===1/0)return;$.setup(le,he,ht,ce,_t);let $n,yt=gt;if(_t!==null&&($n=Ie.get(_t),yt=ut,yt.setIndex($n)),le.isMesh)he.wireframe===!0?(ve.setLineWidth(he.wireframeLinewidth*nt()),yt.setMode(X.LINES)):yt.setMode(X.TRIANGLES);else if(le.isLine){let et=he.linewidth;et===void 0&&(et=1),ve.setLineWidth(et*nt()),le.isLineSegments?yt.setMode(X.LINES):le.isLineLoop?yt.setMode(X.LINE_LOOP):yt.setMode(X.LINE_STRIP)}else le.isPoints?yt.setMode(X.POINTS):le.isSprite&&yt.setMode(X.TRIANGLES);if(le.isBatchedMesh)yt.renderMultiDraw(le._multiDrawStarts,le._multiDrawCounts,le._multiDrawCount);else if(le.isInstancedMesh)yt.renderInstances(_n,fn,le.count);else if(ce.isInstancedBufferGeometry){const et=ce._maxInstanceCount!==void 0?ce._maxInstanceCount:1/0,Er=Math.min(ce.instanceCount,et);yt.renderInstances(_n,fn,Er)}else yt.render(_n,fn)};function kt(H,ne,ce){H.transparent===!0&&H.side===lo&&H.forceSinglePass===!1?(H.side=_r,H.needsUpdate=!0,sr(H,ne,ce),H.side=sa,H.needsUpdate=!0,sr(H,ne,ce),H.side=lo):sr(H,ne,ce)}this.compile=function(H,ne,ce=null){ce===null&&(ce=H),x=ct.get(ce),x.init(),w.push(x),ce.traverseVisible(function(le){le.isLight&&le.layers.test(ne.layers)&&(x.pushLight(le),le.castShadow&&x.pushShadow(le))}),H!==ce&&H.traverseVisible(function(le){le.isLight&&le.layers.test(ne.layers)&&(x.pushLight(le),le.castShadow&&x.pushShadow(le))}),x.setupLights(E._useLegacyLights);const he=new Set;return H.traverse(function(le){const We=le.material;if(We)if(Array.isArray(We))for(let ot=0;ot<We.length;ot++){const ht=We[ot];kt(ht,ce,le),he.add(ht)}else kt(We,ce,le),he.add(We)}),w.pop(),x=null,he},this.compileAsync=function(H,ne,ce=null){const he=this.compile(H,ne,ce);return new Promise(le=>{function We(){if(he.forEach(function(ot){Be.get(ot).currentProgram.isReady()&&he.delete(ot)}),he.size===0){le(H);return}setTimeout(We,10)}me.get("KHR_parallel_shader_compile")!==null?We():setTimeout(We,10)})};let jt=null;function en(H){jt&&jt(H)}function bn(){Bn.stop()}function Kt(){Bn.start()}const Bn=new gk;Bn.setAnimationLoop(en),typeof self<"u"&&Bn.setContext(self),this.setAnimationLoop=function(H){jt=H,Ge.setAnimationLoop(H),H===null?Bn.stop():Bn.start()},Ge.addEventListener("sessionstart",bn),Ge.addEventListener("sessionend",Kt),this.render=function(H,ne){if(ne!==void 0&&ne.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(I===!0)return;H.matrixWorldAutoUpdate===!0&&H.updateMatrixWorld(),ne.parent===null&&ne.matrixWorldAutoUpdate===!0&&ne.updateMatrixWorld(),Ge.enabled===!0&&Ge.isPresenting===!0&&(Ge.cameraAutoUpdate===!0&&Ge.updateCamera(ne),ne=Ge.getCamera()),H.isScene===!0&&H.onBeforeRender(E,H,ne,R),x=ct.get(H,w.length),x.init(),w.push(x),ze.multiplyMatrices(ne.projectionMatrix,ne.matrixWorldInverse),Ne.setFromProjectionMatrix(ze),xe=this.localClippingEnabled,oe=Rt.init(this.clippingPlanes,xe),T=je.get(H,y.length),T.init(),y.push(T),rr(H,ne,0,E.sortObjects),T.finish(),E.sortObjects===!0&&T.sort(W,K),this.info.render.frame++,oe===!0&&Rt.beginShadows();const ce=x.state.shadowsArray;if(Re.render(ce,H,ne),oe===!0&&Rt.endShadows(),this.info.autoReset===!0&&this.info.reset(),(Ge.enabled===!1||Ge.isPresenting===!1||Ge.hasDepthSensing()===!1)&&Gt.render(T,H),x.setupLights(E._useLegacyLights),ne.isArrayCamera){const he=ne.cameras;for(let le=0,We=he.length;le<We;le++){const ot=he[le];fa(T,H,ot,ot.viewport)}}else fa(T,H,ne);R!==null&&(z.updateMultisampleRenderTarget(R),z.updateRenderTargetMipmap(R)),H.isScene===!0&&H.onAfterRender(E,H,ne),$.resetDefaultState(),b=-1,k=null,w.pop(),w.length>0?x=w[w.length-1]:x=null,y.pop(),y.length>0?T=y[y.length-1]:T=null};function rr(H,ne,ce,he){if(H.visible===!1)return;if(H.layers.test(ne.layers)){if(H.isGroup)ce=H.renderOrder;else if(H.isLOD)H.autoUpdate===!0&&H.update(ne);else if(H.isLight)x.pushLight(H),H.castShadow&&x.pushShadow(H);else if(H.isSprite){if(!H.frustumCulled||Ne.intersectsSprite(H)){he&&Ze.setFromMatrixPosition(H.matrixWorld).applyMatrix4(ze);const ot=Ee.update(H),ht=H.material;ht.visible&&T.push(H,ot,ht,ce,Ze.z,null)}}else if((H.isMesh||H.isLine||H.isPoints)&&(!H.frustumCulled||Ne.intersectsObject(H))){const ot=Ee.update(H),ht=H.material;if(he&&(H.boundingSphere!==void 0?(H.boundingSphere===null&&H.computeBoundingSphere(),Ze.copy(H.boundingSphere.center)):(ot.boundingSphere===null&&ot.computeBoundingSphere(),Ze.copy(ot.boundingSphere.center)),Ze.applyMatrix4(H.matrixWorld).applyMatrix4(ze)),Array.isArray(ht)){const _t=ot.groups;for(let It=0,Et=_t.length;It<Et;It++){const At=_t[It],_n=ht[At.materialIndex];_n&&_n.visible&&T.push(H,ot,_n,ce,Ze.z,At)}}else ht.visible&&T.push(H,ot,ht,ce,Ze.z,null)}}const We=H.children;for(let ot=0,ht=We.length;ot<ht;ot++)rr(We[ot],ne,ce,he)}function fa(H,ne,ce,he){const le=H.opaque,We=H.transmissive,ot=H.transparent;x.setupLightsView(ce),oe===!0&&Rt.setGlobalState(E.clippingPlanes,ce),We.length>0&&Mo(le,We,ne,ce),he&&ve.viewport(M.copy(he)),le.length>0&&ss(le,ne,ce),We.length>0&&ss(We,ne,ce),ot.length>0&&ss(ot,ne,ce),ve.buffers.depth.setTest(!0),ve.buffers.depth.setMask(!0),ve.buffers.color.setMask(!0),ve.setPolygonOffset(!1)}function Mo(H,ne,ce,he){if((ce.isScene===!0?ce.overrideMaterial:null)!==null)return;const We=Pe.isWebGL2;Le===null&&(Le=new $s(1,1,{generateMipmaps:!0,type:me.has("EXT_color_buffer_half_float")?jh:xo,minFilter:uo,samples:We?4:0})),E.getDrawingBufferSize(at),We?Le.setSize(at.x,at.y):Le.setSize(Uy(at.x),Uy(at.y));const ot=E.getRenderTarget();E.setRenderTarget(Le),E.getClearColor(F),Y=E.getClearAlpha(),Y<1&&E.setClearColor(16777215,.5),E.clear();const ht=E.toneMapping;E.toneMapping=vo,ss(H,ce,he),z.updateMultisampleRenderTarget(Le),z.updateRenderTargetMipmap(Le);let _t=!1;for(let It=0,Et=ne.length;It<Et;It++){const At=ne[It],_n=At.object,Yn=At.geometry,fn=At.material,$n=At.group;if(fn.side===lo&&_n.layers.test(he.layers)){const yt=fn.side;fn.side=_r,fn.needsUpdate=!0,Js(_n,ce,he,Yn,fn,$n),fn.side=yt,fn.needsUpdate=!0,_t=!0}}_t===!0&&(z.updateMultisampleRenderTarget(Le),z.updateRenderTargetMipmap(Le)),E.setRenderTarget(ot),E.setClearColor(F,Y),E.toneMapping=ht}function ss(H,ne,ce){const he=ne.isScene===!0?ne.overrideMaterial:null;for(let le=0,We=H.length;le<We;le++){const ot=H[le],ht=ot.object,_t=ot.geometry,It=he===null?ot.material:he,Et=ot.group;ht.layers.test(ce.layers)&&Js(ht,ne,ce,_t,It,Et)}}function Js(H,ne,ce,he,le,We){H.onBeforeRender(E,ne,ce,he,le,We),H.modelViewMatrix.multiplyMatrices(ce.matrixWorldInverse,H.matrixWorld),H.normalMatrix.getNormalMatrix(H.modelViewMatrix),le.onBeforeRender(E,ne,ce,he,H,We),le.transparent===!0&&le.side===lo&&le.forceSinglePass===!1?(le.side=_r,le.needsUpdate=!0,E.renderBufferDirect(ce,ne,he,le,H,We),le.side=sa,le.needsUpdate=!0,E.renderBufferDirect(ce,ne,he,le,H,We),le.side=lo):E.renderBufferDirect(ce,ne,he,le,H,We),H.onAfterRender(E,ne,ce,he,le,We)}function sr(H,ne,ce){ne.isScene!==!0&&(ne=St);const he=Be.get(H),le=x.state.lights,We=x.state.shadowsArray,ot=le.state.version,ht=Ke.getParameters(H,le.state,We,ne,ce),_t=Ke.getProgramCacheKey(ht);let It=he.programs;he.environment=H.isMeshStandardMaterial?ne.environment:null,he.fog=ne.fog,he.envMap=(H.isMeshStandardMaterial?te:U).get(H.envMap||he.environment),It===void 0&&(H.addEventListener("dispose",De),It=new Map,he.programs=It);let Et=It.get(_t);if(Et!==void 0){if(he.currentProgram===Et&&he.lightsStateVersion===ot)return bl(H,ht),Et}else ht.uniforms=Ke.getUniforms(H),H.onBuild(ce,ht,E),H.onBeforeCompile(ht,E),Et=Ke.acquireProgram(ht,_t),It.set(_t,Et),he.uniforms=ht.uniforms;const At=he.uniforms;return(!H.isShaderMaterial&&!H.isRawShaderMaterial||H.clipping===!0)&&(At.clippingPlanes=Rt.uniform),bl(H,ht),he.needsLights=tc(H),he.lightsStateVersion=ot,he.needsLights&&(At.ambientLightColor.value=le.state.ambient,At.lightProbe.value=le.state.probe,At.directionalLights.value=le.state.directional,At.directionalLightShadows.value=le.state.directionalShadow,At.spotLights.value=le.state.spot,At.spotLightShadows.value=le.state.spotShadow,At.rectAreaLights.value=le.state.rectArea,At.ltc_1.value=le.state.rectAreaLTC1,At.ltc_2.value=le.state.rectAreaLTC2,At.pointLights.value=le.state.point,At.pointLightShadows.value=le.state.pointShadow,At.hemisphereLights.value=le.state.hemi,At.directionalShadowMap.value=le.state.directionalShadowMap,At.directionalShadowMatrix.value=le.state.directionalShadowMatrix,At.spotShadowMap.value=le.state.spotShadowMap,At.spotLightMatrix.value=le.state.spotLightMatrix,At.spotLightMap.value=le.state.spotLightMap,At.pointShadowMap.value=le.state.pointShadowMap,At.pointShadowMatrix.value=le.state.pointShadowMatrix),he.currentProgram=Et,he.uniformsList=null,Et}function Pl(H){if(H.uniformsList===null){const ne=H.currentProgram.getUniforms();H.uniformsList=z_.seqWithValue(ne.seq,H.uniforms)}return H.uniformsList}function bl(H,ne){const ce=Be.get(H);ce.outputColorSpace=ne.outputColorSpace,ce.batching=ne.batching,ce.instancing=ne.instancing,ce.instancingColor=ne.instancingColor,ce.skinning=ne.skinning,ce.morphTargets=ne.morphTargets,ce.morphNormals=ne.morphNormals,ce.morphColors=ne.morphColors,ce.morphTargetsCount=ne.morphTargetsCount,ce.numClippingPlanes=ne.numClippingPlanes,ce.numIntersection=ne.numClipIntersection,ce.vertexAlphas=ne.vertexAlphas,ce.vertexTangents=ne.vertexTangents,ce.toneMapping=ne.toneMapping}function Ll(H,ne,ce,he,le){ne.isScene!==!0&&(ne=St),z.resetTextureUnits();const We=ne.fog,ot=he.isMeshStandardMaterial?ne.environment:null,ht=R===null?E.outputColorSpace:R.isXRRenderTarget===!0?R.texture.colorSpace:wo,_t=(he.isMeshStandardMaterial?te:U).get(he.envMap||ot),It=he.vertexColors===!0&&!!ce.attributes.color&&ce.attributes.color.itemSize===4,Et=!!ce.attributes.tangent&&(!!he.normalMap||he.anisotropy>0),At=!!ce.morphAttributes.position,_n=!!ce.morphAttributes.normal,Yn=!!ce.morphAttributes.color;let fn=vo;he.toneMapped&&(R===null||R.isXRRenderTarget===!0)&&(fn=E.toneMapping);const $n=ce.morphAttributes.position||ce.morphAttributes.normal||ce.morphAttributes.color,yt=$n!==void 0?$n.length:0,et=Be.get(he),Er=x.state.lights;if(oe===!0&&(xe===!0||H!==k)){const Ln=H===k&&he.id===b;Rt.setState(he,H,Ln)}let Ct=!1;he.version===et.__version?(et.needsLights&&et.lightsStateVersion!==Er.state.version||et.outputColorSpace!==ht||le.isBatchedMesh&&et.batching===!1||!le.isBatchedMesh&&et.batching===!0||le.isInstancedMesh&&et.instancing===!1||!le.isInstancedMesh&&et.instancing===!0||le.isSkinnedMesh&&et.skinning===!1||!le.isSkinnedMesh&&et.skinning===!0||le.isInstancedMesh&&et.instancingColor===!0&&le.instanceColor===null||le.isInstancedMesh&&et.instancingColor===!1&&le.instanceColor!==null||et.envMap!==_t||he.fog===!0&&et.fog!==We||et.numClippingPlanes!==void 0&&(et.numClippingPlanes!==Rt.numPlanes||et.numIntersection!==Rt.numIntersection)||et.vertexAlphas!==It||et.vertexTangents!==Et||et.morphTargets!==At||et.morphNormals!==_n||et.morphColors!==Yn||et.toneMapping!==fn||Pe.isWebGL2===!0&&et.morphTargetsCount!==yt)&&(Ct=!0):(Ct=!0,et.__version=he.version);let tn=et.currentProgram;Ct===!0&&(tn=sr(he,ne,le));let ki=!1,vi=!1,Hn=!1;const Pt=tn.getUniforms(),or=et.uniforms;if(ve.useProgram(tn.program)&&(ki=!0,vi=!0,Hn=!0),he.id!==b&&(b=he.id,vi=!0),ki||k!==H){Pt.setValue(X,"projectionMatrix",H.projectionMatrix),Pt.setValue(X,"viewMatrix",H.matrixWorldInverse);const Ln=Pt.map.cameraPosition;Ln!==void 0&&Ln.setValue(X,Ze.setFromMatrixPosition(H.matrixWorld)),Pe.logarithmicDepthBuffer&&Pt.setValue(X,"logDepthBufFC",2/(Math.log(H.far+1)/Math.LN2)),(he.isMeshPhongMaterial||he.isMeshToonMaterial||he.isMeshLambertMaterial||he.isMeshBasicMaterial||he.isMeshStandardMaterial||he.isShaderMaterial)&&Pt.setValue(X,"isOrthographic",H.isOrthographicCamera===!0),k!==H&&(k=H,vi=!0,Hn=!0)}if(le.isSkinnedMesh){Pt.setOptional(X,le,"bindMatrix"),Pt.setOptional(X,le,"bindMatrixInverse");const Ln=le.skeleton;Ln&&(Pe.floatVertexTextures?(Ln.boneTexture===null&&Ln.computeBoneTexture(),Pt.setValue(X,"boneTexture",Ln.boneTexture,z)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}le.isBatchedMesh&&(Pt.setOptional(X,le,"batchingTexture"),Pt.setValue(X,"batchingTexture",le._matricesTexture,z));const os=ce.morphAttributes;if((os.position!==void 0||os.normal!==void 0||os.color!==void 0&&Pe.isWebGL2===!0)&&Nt.update(le,ce,tn),(vi||et.receiveShadow!==le.receiveShadow)&&(et.receiveShadow=le.receiveShadow,Pt.setValue(X,"receiveShadow",le.receiveShadow)),he.isMeshGouraudMaterial&&he.envMap!==null&&(or.envMap.value=_t,or.flipEnvMap.value=_t.isCubeTexture&&_t.isRenderTargetTexture===!1?-1:1),vi&&(Pt.setValue(X,"toneMappingExposure",E.toneMappingExposure),et.needsLights&&Nl(or,Hn),We&&he.fog===!0&&Ue.refreshFogUniforms(or,We),Ue.refreshMaterialUniforms(or,he,ye,se,Le),z_.upload(X,Pl(et),or,z)),he.isShaderMaterial&&he.uniformsNeedUpdate===!0&&(z_.upload(X,Pl(et),or,z),he.uniformsNeedUpdate=!1),he.isSpriteMaterial&&Pt.setValue(X,"center",le.center),Pt.setValue(X,"modelViewMatrix",le.modelViewMatrix),Pt.setValue(X,"normalMatrix",le.normalMatrix),Pt.setValue(X,"modelMatrix",le.matrixWorld),he.isShaderMaterial||he.isRawShaderMaterial){const Ln=he.uniformsGroups;for(let da=0,Oi=Ln.length;da<Oi;da++)if(Pe.isWebGL2){const nc=Ln[da];we.update(nc,tn),we.bind(nc,tn)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return tn}function Nl(H,ne){H.ambientLightColor.needsUpdate=ne,H.lightProbe.needsUpdate=ne,H.directionalLights.needsUpdate=ne,H.directionalLightShadows.needsUpdate=ne,H.pointLights.needsUpdate=ne,H.pointLightShadows.needsUpdate=ne,H.spotLights.needsUpdate=ne,H.spotLightShadows.needsUpdate=ne,H.rectAreaLights.needsUpdate=ne,H.hemisphereLights.needsUpdate=ne}function tc(H){return H.isMeshLambertMaterial||H.isMeshToonMaterial||H.isMeshPhongMaterial||H.isMeshStandardMaterial||H.isShadowMaterial||H.isShaderMaterial&&H.lights===!0}this.getActiveCubeFace=function(){return O},this.getActiveMipmapLevel=function(){return D},this.getRenderTarget=function(){return R},this.setRenderTargetTextures=function(H,ne,ce){Be.get(H.texture).__webglTexture=ne,Be.get(H.depthTexture).__webglTexture=ce;const he=Be.get(H);he.__hasExternalTextures=!0,he.__hasExternalTextures&&(he.__autoAllocateDepthBuffer=ce===void 0,he.__autoAllocateDepthBuffer||me.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),he.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(H,ne){const ce=Be.get(H);ce.__webglFramebuffer=ne,ce.__useDefaultFramebuffer=ne===void 0},this.setRenderTarget=function(H,ne=0,ce=0){R=H,O=ne,D=ce;let he=!0,le=null,We=!1,ot=!1;if(H){const _t=Be.get(H);_t.__useDefaultFramebuffer!==void 0?(ve.bindFramebuffer(X.FRAMEBUFFER,null),he=!1):_t.__webglFramebuffer===void 0?z.setupRenderTarget(H):_t.__hasExternalTextures&&z.rebindTextures(H,Be.get(H.texture).__webglTexture,Be.get(H.depthTexture).__webglTexture);const It=H.texture;(It.isData3DTexture||It.isDataArrayTexture||It.isCompressedArrayTexture)&&(ot=!0);const Et=Be.get(H).__webglFramebuffer;H.isWebGLCubeRenderTarget?(Array.isArray(Et[ne])?le=Et[ne][ce]:le=Et[ne],We=!0):Pe.isWebGL2&&H.samples>0&&z.useMultisampledRTT(H)===!1?le=Be.get(H).__webglMultisampledFramebuffer:Array.isArray(Et)?le=Et[ce]:le=Et,M.copy(H.viewport),P.copy(H.scissor),V=H.scissorTest}else M.copy(Q).multiplyScalar(ye).floor(),P.copy(ee).multiplyScalar(ye).floor(),V=_e;if(ve.bindFramebuffer(X.FRAMEBUFFER,le)&&Pe.drawBuffers&&he&&ve.drawBuffers(H,le),ve.viewport(M),ve.scissor(P),ve.setScissorTest(V),We){const _t=Be.get(H.texture);X.framebufferTexture2D(X.FRAMEBUFFER,X.COLOR_ATTACHMENT0,X.TEXTURE_CUBE_MAP_POSITIVE_X+ne,_t.__webglTexture,ce)}else if(ot){const _t=Be.get(H.texture),It=ne||0;X.framebufferTextureLayer(X.FRAMEBUFFER,X.COLOR_ATTACHMENT0,_t.__webglTexture,ce||0,It)}b=-1},this.readRenderTargetPixels=function(H,ne,ce,he,le,We,ot){if(!(H&&H.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ht=Be.get(H).__webglFramebuffer;if(H.isWebGLCubeRenderTarget&&ot!==void 0&&(ht=ht[ot]),ht){ve.bindFramebuffer(X.FRAMEBUFFER,ht);try{const _t=H.texture,It=_t.format,Et=_t.type;if(It!==pr&&$e.convert(It)!==X.getParameter(X.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const At=Et===jh&&(me.has("EXT_color_buffer_half_float")||Pe.isWebGL2&&me.has("EXT_color_buffer_float"));if(Et!==xo&&$e.convert(Et)!==X.getParameter(X.IMPLEMENTATION_COLOR_READ_TYPE)&&!(Et===Ss&&(Pe.isWebGL2||me.has("OES_texture_float")||me.has("WEBGL_color_buffer_float")))&&!At){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ne>=0&&ne<=H.width-he&&ce>=0&&ce<=H.height-le&&X.readPixels(ne,ce,he,le,$e.convert(It),$e.convert(Et),We)}finally{const _t=R!==null?Be.get(R).__webglFramebuffer:null;ve.bindFramebuffer(X.FRAMEBUFFER,_t)}}},this.copyFramebufferToTexture=function(H,ne,ce=0){const he=Math.pow(2,-ce),le=Math.floor(ne.image.width*he),We=Math.floor(ne.image.height*he);z.setTexture2D(ne,0),X.copyTexSubImage2D(X.TEXTURE_2D,ce,0,0,H.x,H.y,le,We),ve.unbindTexture()},this.copyTextureToTexture=function(H,ne,ce,he=0){const le=ne.image.width,We=ne.image.height,ot=$e.convert(ce.format),ht=$e.convert(ce.type);z.setTexture2D(ce,0),X.pixelStorei(X.UNPACK_FLIP_Y_WEBGL,ce.flipY),X.pixelStorei(X.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ce.premultiplyAlpha),X.pixelStorei(X.UNPACK_ALIGNMENT,ce.unpackAlignment),ne.isDataTexture?X.texSubImage2D(X.TEXTURE_2D,he,H.x,H.y,le,We,ot,ht,ne.image.data):ne.isCompressedTexture?X.compressedTexSubImage2D(X.TEXTURE_2D,he,H.x,H.y,ne.mipmaps[0].width,ne.mipmaps[0].height,ot,ne.mipmaps[0].data):X.texSubImage2D(X.TEXTURE_2D,he,H.x,H.y,ot,ht,ne.image),he===0&&ce.generateMipmaps&&X.generateMipmap(X.TEXTURE_2D),ve.unbindTexture()},this.copyTextureToTexture3D=function(H,ne,ce,he,le=0){if(E.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const We=H.max.x-H.min.x+1,ot=H.max.y-H.min.y+1,ht=H.max.z-H.min.z+1,_t=$e.convert(he.format),It=$e.convert(he.type);let Et;if(he.isData3DTexture)z.setTexture3D(he,0),Et=X.TEXTURE_3D;else if(he.isDataArrayTexture||he.isCompressedArrayTexture)z.setTexture2DArray(he,0),Et=X.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}X.pixelStorei(X.UNPACK_FLIP_Y_WEBGL,he.flipY),X.pixelStorei(X.UNPACK_PREMULTIPLY_ALPHA_WEBGL,he.premultiplyAlpha),X.pixelStorei(X.UNPACK_ALIGNMENT,he.unpackAlignment);const At=X.getParameter(X.UNPACK_ROW_LENGTH),_n=X.getParameter(X.UNPACK_IMAGE_HEIGHT),Yn=X.getParameter(X.UNPACK_SKIP_PIXELS),fn=X.getParameter(X.UNPACK_SKIP_ROWS),$n=X.getParameter(X.UNPACK_SKIP_IMAGES),yt=ce.isCompressedTexture?ce.mipmaps[le]:ce.image;X.pixelStorei(X.UNPACK_ROW_LENGTH,yt.width),X.pixelStorei(X.UNPACK_IMAGE_HEIGHT,yt.height),X.pixelStorei(X.UNPACK_SKIP_PIXELS,H.min.x),X.pixelStorei(X.UNPACK_SKIP_ROWS,H.min.y),X.pixelStorei(X.UNPACK_SKIP_IMAGES,H.min.z),ce.isDataTexture||ce.isData3DTexture?X.texSubImage3D(Et,le,ne.x,ne.y,ne.z,We,ot,ht,_t,It,yt.data):ce.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),X.compressedTexSubImage3D(Et,le,ne.x,ne.y,ne.z,We,ot,ht,_t,yt.data)):X.texSubImage3D(Et,le,ne.x,ne.y,ne.z,We,ot,ht,_t,It,yt),X.pixelStorei(X.UNPACK_ROW_LENGTH,At),X.pixelStorei(X.UNPACK_IMAGE_HEIGHT,_n),X.pixelStorei(X.UNPACK_SKIP_PIXELS,Yn),X.pixelStorei(X.UNPACK_SKIP_ROWS,fn),X.pixelStorei(X.UNPACK_SKIP_IMAGES,$n),le===0&&he.generateMipmaps&&X.generateMipmap(Et),ve.unbindTexture()},this.initTexture=function(H){H.isCubeTexture?z.setTextureCube(H,0):H.isData3DTexture?z.setTexture3D(H,0):H.isDataArrayTexture||H.isCompressedArrayTexture?z.setTexture2DArray(H,0):z.setTexture2D(H,0),ve.unbindTexture()},this.resetState=function(){O=0,D=0,R=null,ve.reset(),$.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return co}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===Iv?"display-p3":"srgb",t.unpackColorSpace=dn.workingColorSpace===Yp?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===di?rl:NT}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===rl?di:wo}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class Tk extends jT{}Tk.prototype.isWebGL1Renderer=!0;class Lv{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Ye(e),this.density=t}clone(){return new Lv(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Nv{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new Ye(e),this.near=t,this.far=i}clone(){return new Nv(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class qT extends ln{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class Dv{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=vp,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=es()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return Ru("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=es()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=es()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const hr=new G;class Wu{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)hr.fromBufferAttribute(this,t),hr.applyMatrix4(e),this.setXYZ(t,hr.x,hr.y,hr.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)hr.fromBufferAttribute(this,t),hr.applyNormalMatrix(e),this.setXYZ(t,hr.x,hr.y,hr.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)hr.fromBufferAttribute(this,t),hr.transformDirection(e),this.setXYZ(t,hr.x,hr.y,hr.z);return this}getComponent(e,t){let i=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(i=mr(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Ft(i,this.array)),this.data.array[e*this.data.stride+this.offset+t]=i,this}setX(e,t){return this.normalized&&(t=Ft(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Ft(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Ft(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Ft(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=mr(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=mr(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=mr(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=mr(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ft(t,this.array),i=Ft(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ft(t,this.array),i=Ft(i,this.array),r=Ft(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ft(t,this.array),i=Ft(i,this.array),r=Ft(r,this.array),s=Ft(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new mn(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Wu(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class XT extends ir{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Ye(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Bc;const Yf=new G,Hc=new G,Gc=new G,Wc=new ge,$f=new ge,Mk=new Mt,Ug=new G,Kf=new G,Fg=new G,cP=new ge,Zx=new ge,hP=new ge;class Ak extends ln{constructor(e=new XT){if(super(),this.isSprite=!0,this.type="Sprite",Bc===void 0){Bc=new Ht;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new Dv(t,5);Bc.setIndex([0,1,2,0,2,3]),Bc.setAttribute("position",new Wu(i,3,0,!1)),Bc.setAttribute("uv",new Wu(i,2,3,!1))}this.geometry=Bc,this.material=e,this.center=new ge(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Hc.setFromMatrixScale(this.matrixWorld),Mk.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Gc.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Hc.multiplyScalar(-Gc.z);const i=this.material.rotation;let r,s;i!==0&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;Vg(Ug.set(-.5,-.5,0),Gc,o,Hc,r,s),Vg(Kf.set(.5,-.5,0),Gc,o,Hc,r,s),Vg(Fg.set(.5,.5,0),Gc,o,Hc,r,s),cP.set(0,0),Zx.set(1,0),hP.set(1,1);let a=e.ray.intersectTriangle(Ug,Kf,Fg,!1,Yf);if(a===null&&(Vg(Kf.set(-.5,.5,0),Gc,o,Hc,r,s),Zx.set(0,1),a=e.ray.intersectTriangle(Ug,Fg,Kf,!1,Yf),a===null))return;const l=e.ray.origin.distanceTo(Yf);l<e.near||l>e.far||t.push({distance:l,point:Yf.clone(),uv:Kr.getInterpolation(Yf,Ug,Kf,Fg,cP,Zx,hP,new ge),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Vg(n,e,t,i,r,s){Wc.subVectors(n,t).addScalar(.5).multiply(i),r!==void 0?($f.x=s*Wc.x-r*Wc.y,$f.y=r*Wc.x+s*Wc.y):$f.copy(Wc),n.copy(e),n.x+=$f.x,n.y+=$f.y,n.applyMatrix4(Mk)}const zg=new G,fP=new G;class Ck extends ln{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let i=0,r=t.length;i<r;i++){const s=t[i];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,i=0){t=Math.abs(t);const r=this.levels;let s;for(s=0;s<r.length&&!(t<r[s].distance);s++);return r.splice(s,0,{distance:t,hysteresis:i,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let i,r;for(i=1,r=t.length;i<r;i++){let s=t[i].distance;if(t[i].object.visible&&(s-=s*t[i].hysteresis),e<s)break}return t[i-1].object}return null}raycast(e,t){if(this.levels.length>0){zg.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(zg);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){zg.setFromMatrixPosition(e.matrixWorld),fP.setFromMatrixPosition(this.matrixWorld);const i=zg.distanceTo(fP)/e.zoom;t[0].object.visible=!0;let r,s;for(r=1,s=t.length;r<s;r++){let o=t[r].distance;if(t[r].object.visible&&(o-=o*t[r].hysteresis),i>=o)t[r-1].object.visible=!1,t[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const o=i[r];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const dP=new G,pP=new cn,mP=new cn,zX=new G,gP=new Mt,Bg=new G,eS=new er,_P=new Mt,tS=new Ku;class Rk extends ui{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=XE,this.bindMatrix=new Mt,this.bindMatrixInverse=new Mt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new yr),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,Bg),this.boundingBox.expandByPoint(Bg)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new er),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,Bg),this.boundingSphere.expandByPoint(Bg)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const i=this.material,r=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),eS.copy(this.boundingSphere),eS.applyMatrix4(r),e.ray.intersectsSphere(eS)!==!1&&(_P.copy(r).invert(),tS.copy(e.ray).applyMatrix4(_P),!(this.boundingBox!==null&&tS.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,tS)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new cn,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===XE?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===z3?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;pP.fromBufferAttribute(r.attributes.skinIndex,e),mP.fromBufferAttribute(r.attributes.skinWeight,e),dP.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=mP.getComponent(s);if(o!==0){const a=pP.getComponent(s);gP.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(zX.copy(dP).applyMatrix4(gP),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class YT extends ln{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Pu extends Pn{constructor(e=null,t=1,i=1,r,s,o,a,l,h=Zn,f=Zn,d,p){super(null,o,a,l,h,f,r,s,d,p),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const yP=new Mt,BX=new Mt;class kv{constructor(e=[],t=[]){this.uuid=es(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Mt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new Mt;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:BX;yP.multiplyMatrices(a,t[s]),yP.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new kv(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new Pu(t,e,e,pr,Ss);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new YT),this.bones.push(o),this.boneInverses.push(new Mt().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++){const o=t[r];e.bones.push(o.uuid);const a=i[r];e.boneInverses.push(a.toArray())}return e}}class Yh extends mn{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const jc=new Mt,vP=new Mt,Hg=[],xP=new yr,HX=new Mt,Qf=new ui,Jf=new er;class Ik extends ui{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Yh(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,HX)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new yr),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,jc),xP.copy(e.boundingBox).applyMatrix4(jc),this.boundingBox.union(xP)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new er),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,jc),Jf.copy(e.boundingSphere).applyMatrix4(jc),this.boundingSphere.union(Jf)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(Qf.geometry=this.geometry,Qf.material=this.material,Qf.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Jf.copy(this.boundingSphere),Jf.applyMatrix4(i),e.ray.intersectsSphere(Jf)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,jc),vP.multiplyMatrices(i,jc),Qf.matrixWorld=vP,Qf.raycast(e,Hg);for(let o=0,a=Hg.length;o<a;o++){const l=Hg[o];l.instanceId=s,l.object=this,t.push(l)}Hg.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Yh(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}function GX(n,e){return n.z-e.z}function WX(n,e){return e.z-n.z}class jX{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t){const i=this.pool,r=this.list;this.index>=i.length&&i.push({start:-1,count:-1,z:-1});const s=i[this.index];r.push(s),this.index++,s.start=e.start,s.count=e.count,s.z=t}reset(){this.list.length=0,this.index=0}}const qc="batchId",Ra=new Mt,SP=new Mt,qX=new Mt,EP=new Mt,nS=new Jp,Gg=new yr,Ql=new er,Zf=new G,iS=new jX,$i=new ui,Wg=[];function XX(n,e,t=0){const i=e.itemSize;if(n.isInterleavedBufferAttribute||n.array.constructor!==e.array.constructor){const r=n.count;for(let s=0;s<r;s++)for(let o=0;o<i;o++)e.setComponent(s+t,o,n.getComponent(s,o))}else e.array.set(n.array,t*i);e.needsUpdate=!0}class Pk extends ui{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,t,i=t*2,r){super(new Ht,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=t,this._maxIndexCount=i,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxGeometryCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),i=new Pu(t,e,e,pr,Ss);this._matricesTexture=i}_initializeGeometry(e){const t=this.geometry,i=this._maxVertexCount,r=this._maxGeometryCount,s=this._maxIndexCount;if(this._geometryInitialized===!1){for(const a in e.attributes){const l=e.getAttribute(a),{array:h,itemSize:f,normalized:d}=l,p=new h.constructor(i*f),_=new l.constructor(p,f,d);_.setUsage(l.usage),t.setAttribute(a,_)}if(e.getIndex()!==null){const a=i>65536?new Uint32Array(s):new Uint16Array(s);t.setIndex(new mn(a,1))}const o=r>65536?new Uint32Array(i):new Uint16Array(i);t.setAttribute(qc,new mn(o,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(qc))throw new Error(`BatchedMesh: Geometry cannot use attribute "${qc}"`);const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const i in t.attributes){if(i===qc)continue;if(!e.hasAttribute(i))throw new Error(`BatchedMesh: Added geometry missing "${i}". All geometries must have consistent attributes.`);const r=e.getAttribute(i),s=t.getAttribute(i);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new yr);const e=this._geometryCount,t=this.boundingBox,i=this._active;t.makeEmpty();for(let r=0;r<e;r++)i[r]!==!1&&(this.getMatrixAt(r,Ra),this.getBoundingBoxAt(r,Gg).applyMatrix4(Ra),t.union(Gg))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new er);const e=this._geometryCount,t=this.boundingSphere,i=this._active;t.makeEmpty();for(let r=0;r<e;r++)i[r]!==!1&&(this.getMatrixAt(r,Ra),this.getBoundingSphereAt(r,Ql).applyMatrix4(Ra),t.union(Ql))}addGeometry(e,t=-1,i=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const r={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let s=null;const o=this._reservedRanges,a=this._drawRanges,l=this._bounds;this._geometryCount!==0&&(s=o[o.length-1]),t===-1?r.vertexCount=e.getAttribute("position").count:r.vertexCount=t,s===null?r.vertexStart=0:r.vertexStart=s.vertexStart+s.vertexCount;const h=e.getIndex(),f=h!==null;if(f&&(i===-1?r.indexCount=h.count:r.indexCount=i,s===null?r.indexStart=0:r.indexStart=s.indexStart+s.indexCount),r.indexStart!==-1&&r.indexStart+r.indexCount>this._maxIndexCount||r.vertexStart+r.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const d=this._visibility,p=this._active,_=this._matricesTexture,v=this._matricesTexture.image.data;d.push(!0),p.push(!0);const T=this._geometryCount;this._geometryCount++,qX.toArray(v,T*16),_.needsUpdate=!0,o.push(r),a.push({start:f?r.indexStart:r.vertexStart,count:-1}),l.push({boxInitialized:!1,box:new yr,sphereInitialized:!1,sphere:new er});const x=this.geometry.getAttribute(qc);for(let y=0;y<r.vertexCount;y++)x.setX(r.vertexStart+y,T);return x.needsUpdate=!0,this.setGeometryAt(T,e),T}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const i=this.geometry,r=i.getIndex()!==null,s=i.getIndex(),o=t.getIndex(),a=this._reservedRanges[e];if(r&&o.count>a.indexCount||t.attributes.position.count>a.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const l=a.vertexStart,h=a.vertexCount;for(const _ in i.attributes){if(_===qc)continue;const v=t.getAttribute(_),T=i.getAttribute(_);XX(v,T,l);const x=v.itemSize;for(let y=v.count,w=h;y<w;y++){const E=l+y;for(let I=0;I<x;I++)T.setComponent(E,I,0)}T.needsUpdate=!0}if(r){const _=a.indexStart;for(let v=0;v<o.count;v++)s.setX(_+v,l+o.getX(v));for(let v=o.count,T=a.indexCount;v<T;v++)s.setX(_+v,l);s.needsUpdate=!0}const f=this._bounds[e];t.boundingBox!==null?(f.box.copy(t.boundingBox),f.boxInitialized=!0):f.boxInitialized=!1,t.boundingSphere!==null?(f.sphere.copy(t.boundingSphere),f.sphereInitialized=!0):f.sphereInitialized=!1;const d=this._drawRanges[e],p=t.getAttribute("position");return d.count=r?o.count:p.count,this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._active;return e>=t.length||t[e]===!1?this:(t[e]=!1,this._visibilityChanged=!0,this)}getBoundingBoxAt(e,t){if(this._active[e]===!1)return null;const r=this._bounds[e],s=r.box,o=this.geometry;if(r.boxInitialized===!1){s.makeEmpty();const a=o.index,l=o.attributes.position,h=this._drawRanges[e];for(let f=h.start,d=h.start+h.count;f<d;f++){let p=f;a&&(p=a.getX(p)),s.expandByPoint(Zf.fromBufferAttribute(l,p))}r.boxInitialized=!0}return t.copy(s),t}getBoundingSphereAt(e,t){if(this._active[e]===!1)return null;const r=this._bounds[e],s=r.sphere,o=this.geometry;if(r.sphereInitialized===!1){s.makeEmpty(),this.getBoundingBoxAt(e,Gg),Gg.getCenter(s.center);const a=o.index,l=o.attributes.position,h=this._drawRanges[e];let f=0;for(let d=h.start,p=h.start+h.count;d<p;d++){let _=d;a&&(_=a.getX(_)),Zf.fromBufferAttribute(l,_),f=Math.max(f,s.center.distanceToSquared(Zf))}s.radius=Math.sqrt(f),r.sphereInitialized=!0}return t.copy(s),t}setMatrixAt(e,t){const i=this._active,r=this._matricesTexture,s=this._matricesTexture.image.data,o=this._geometryCount;return e>=o||i[e]===!1?this:(t.toArray(s,e*16),r.needsUpdate=!0,this)}getMatrixAt(e,t){const i=this._active,r=this._matricesTexture.image.data,s=this._geometryCount;return e>=s||i[e]===!1?null:t.fromArray(r,e*16)}setVisibleAt(e,t){const i=this._visibility,r=this._active,s=this._geometryCount;return e>=s||r[e]===!1||i[e]===t?this:(i[e]=t,this._visibilityChanged=!0,this)}getVisibleAt(e){const t=this._visibility,i=this._active,r=this._geometryCount;return e>=r||i[e]===!1?!1:t[e]}raycast(e,t){const i=this._visibility,r=this._active,s=this._drawRanges,o=this._geometryCount,a=this.matrixWorld,l=this.geometry;$i.material=this.material,$i.geometry.index=l.index,$i.geometry.attributes=l.attributes,$i.geometry.boundingBox===null&&($i.geometry.boundingBox=new yr),$i.geometry.boundingSphere===null&&($i.geometry.boundingSphere=new er);for(let h=0;h<o;h++){if(!i[h]||!r[h])continue;const f=s[h];$i.geometry.setDrawRange(f.start,f.count),this.getMatrixAt(h,$i.matrixWorld).premultiply(a),this.getBoundingBoxAt(h,$i.geometry.boundingBox),this.getBoundingSphereAt(h,$i.geometry.boundingSphere),$i.raycast(e,Wg);for(let d=0,p=Wg.length;d<p;d++){const _=Wg[d];_.object=this,_.batchId=h,t.push(_)}Wg.length=0}$i.material=null,$i.geometry.index=null,$i.geometry.attributes={},$i.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,t,i,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=r.getIndex(),a=o===null?1:o.array.BYTES_PER_ELEMENT,l=this._active,h=this._visibility,f=this._multiDrawStarts,d=this._multiDrawCounts,p=this._drawRanges,_=this.perObjectFrustumCulled;_&&(EP.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse).multiply(this.matrixWorld),nS.setFromProjectionMatrix(EP,e.coordinateSystem));let v=0;if(this.sortObjects){SP.copy(this.matrixWorld).invert(),Zf.setFromMatrixPosition(i.matrixWorld).applyMatrix4(SP);for(let y=0,w=h.length;y<w;y++)if(h[y]&&l[y]){this.getMatrixAt(y,Ra),this.getBoundingSphereAt(y,Ql).applyMatrix4(Ra);let E=!1;if(_&&(E=!nS.intersectsSphere(Ql)),!E){const I=Zf.distanceTo(Ql.center);iS.push(p[y],I)}}const T=iS.list,x=this.customSort;x===null?T.sort(s.transparent?WX:GX):x.call(this,T,i);for(let y=0,w=T.length;y<w;y++){const E=T[y];f[v]=E.start*a,d[v]=E.count,v++}iS.reset()}else for(let T=0,x=h.length;T<x;T++)if(h[T]&&l[T]){let y=!1;if(_&&(this.getMatrixAt(T,Ra),this.getBoundingSphereAt(T,Ql).applyMatrix4(Ra),y=!nS.intersectsSphere(Ql)),!y){const w=p[T];f[v]=w.start*a,d[v]=w.count,v++}}this._multiDrawCount=v,this._visibilityChanged=!1}onBeforeShadow(e,t,i,r,s,o){this.onBeforeRender(e,null,r,s,o)}}class Sr extends ir{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ye(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const wP=new G,TP=new G,MP=new Mt,rS=new Ku,jg=new er;class gl extends ln{constructor(e=new Ht,t=new Sr){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)wP.fromBufferAttribute(t,r-1),TP.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=wP.distanceTo(TP);e.setAttribute("lineDistance",new lt(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),jg.copy(i.boundingSphere),jg.applyMatrix4(r),jg.radius+=s,e.ray.intersectsSphere(jg)===!1)return;MP.copy(r).invert(),rS.copy(e.ray).applyMatrix4(MP);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,h=new G,f=new G,d=new G,p=new G,_=this.isLineSegments?2:1,v=i.index,x=i.attributes.position;if(v!==null){const y=Math.max(0,o.start),w=Math.min(v.count,o.start+o.count);for(let E=y,I=w-1;E<I;E+=_){const O=v.getX(E),D=v.getX(E+1);if(h.fromBufferAttribute(x,O),f.fromBufferAttribute(x,D),rS.distanceSqToSegment(h,f,p,d)>l)continue;p.applyMatrix4(this.matrixWorld);const b=e.ray.origin.distanceTo(p);b<e.near||b>e.far||t.push({distance:b,point:d.clone().applyMatrix4(this.matrixWorld),index:E,face:null,faceIndex:null,object:this})}}else{const y=Math.max(0,o.start),w=Math.min(x.count,o.start+o.count);for(let E=y,I=w-1;E<I;E+=_){if(h.fromBufferAttribute(x,E),f.fromBufferAttribute(x,E+1),rS.distanceSqToSegment(h,f,p,d)>l)continue;p.applyMatrix4(this.matrixWorld);const D=e.ray.origin.distanceTo(p);D<e.near||D>e.far||t.push({distance:D,point:d.clone().applyMatrix4(this.matrixWorld),index:E,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const AP=new G,CP=new G;class To extends gl{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)AP.fromBufferAttribute(t,r),CP.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+AP.distanceTo(CP);e.setAttribute("lineDistance",new lt(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class bk extends gl{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class $T extends ir{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ye(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const RP=new Mt,Mw=new Ku,qg=new er,Xg=new G;class Lk extends ln{constructor(e=new Ht,t=new $T){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),qg.copy(i.boundingSphere),qg.applyMatrix4(r),qg.radius+=s,e.ray.intersectsSphere(qg)===!1)return;RP.copy(r).invert(),Mw.copy(e.ray).applyMatrix4(RP);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,h=i.index,d=i.attributes.position;if(h!==null){const p=Math.max(0,o.start),_=Math.min(h.count,o.start+o.count);for(let v=p,T=_;v<T;v++){const x=h.getX(v);Xg.fromBufferAttribute(d,x),IP(Xg,x,l,r,e,t,this)}}else{const p=Math.max(0,o.start),_=Math.min(d.count,o.start+o.count);for(let v=p,T=_;v<T;v++)Xg.fromBufferAttribute(d,v),IP(Xg,v,l,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function IP(n,e,t,i,r,s,o){const a=Mw.distanceSqToPoint(n);if(a<t){const l=new G;Mw.closestPointToPoint(n,l),l.applyMatrix4(i);const h=r.ray.origin.distanceTo(l);if(h<r.near||h>r.far)return;s.push({distance:h,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class YX extends Pn{constructor(e,t,i,r,s,o,a,l,h){super(e,t,i,r,s,o,a,l,h),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:On,this.magFilter=s!==void 0?s:On,this.generateMipmaps=!1;const f=this;function d(){f.needsUpdate=!0,e.requestVideoFrameCallback(d)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(d)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class $X extends Pn{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Zn,this.minFilter=Zn,this.generateMipmaps=!1,this.needsUpdate=!0}}class Ov extends Pn{constructor(e,t,i,r,s,o,a,l,h,f,d,p){super(null,o,a,l,h,f,r,s,d,p),this.isCompressedTexture=!0,this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class KX extends Ov{constructor(e,t,i,r,s,o){super(e,t,i,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=Zi}}class QX extends Ov{constructor(e,t,i){super(void 0,e[0].width,e[0].height,t,i,oa),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class JX extends Pn{constructor(e,t,i,r,s,o,a,l,h){super(e,t,i,r,s,o,a,l,h),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Ks{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const s=i.length;let o;t?o=t:o=e*i[s-1];let a=0,l=s-1,h;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),h=i[r]-o,h<0)a=r+1;else if(h>0)l=r-1;else{l=r;break}if(r=l,i[r]===o)return r/(s-1);const f=i[r],p=i[r+1]-f,_=(o-f)/p;return(r+_)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new ge:new G);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new G,r=[],s=[],o=[],a=new G,l=new Mt;for(let _=0;_<=e;_++){const v=_/e;r[_]=this.getTangentAt(v,new G)}s[0]=new G,o[0]=new G;let h=Number.MAX_VALUE;const f=Math.abs(r[0].x),d=Math.abs(r[0].y),p=Math.abs(r[0].z);f<=h&&(h=f,i.set(1,0,0)),d<=h&&(h=d,i.set(0,1,0)),p<=h&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let _=1;_<=e;_++){if(s[_]=s[_-1].clone(),o[_]=o[_-1].clone(),a.crossVectors(r[_-1],r[_]),a.length()>Number.EPSILON){a.normalize();const v=Math.acos(qn(r[_-1].dot(r[_]),-1,1));s[_].applyMatrix4(l.makeRotationAxis(a,v))}o[_].crossVectors(r[_],s[_])}if(t===!0){let _=Math.acos(qn(s[0].dot(s[e]),-1,1));_/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(_=-_);for(let v=1;v<=e;v++)s[v].applyMatrix4(l.makeRotationAxis(r[v],_*v)),o[v].crossVectors(r[v],s[v])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Uv extends Ks{constructor(e=0,t=0,i=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const i=t||new ge,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),h=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const f=Math.cos(this.aRotation),d=Math.sin(this.aRotation),p=l-this.aX,_=h-this.aY;l=p*f-_*d+this.aX,h=p*d+_*f+this.aY}return i.set(l,h)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Nk extends Uv{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function KT(){let n=0,e=0,t=0,i=0;function r(s,o,a,l){n=s,e=a,t=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,h){r(o,a,h*(a-s),h*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,h,f,d){let p=(o-s)/h-(a-s)/(h+f)+(a-o)/f,_=(a-o)/f-(l-o)/(f+d)+(l-a)/d;p*=f,_*=f,r(o,a,p,_)},calc:function(s){const o=s*s,a=o*s;return n+e*s+t*o+i*a}}}const Yg=new G,sS=new KT,oS=new KT,aS=new KT;class Dk extends Ks{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new G){const i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let h,f;this.closed||a>0?h=r[(a-1)%s]:(Yg.subVectors(r[0],r[1]).add(r[0]),h=Yg);const d=r[a%s],p=r[(a+1)%s];if(this.closed||a+2<s?f=r[(a+2)%s]:(Yg.subVectors(r[s-1],r[s-2]).add(r[s-1]),f=Yg),this.curveType==="centripetal"||this.curveType==="chordal"){const _=this.curveType==="chordal"?.5:.25;let v=Math.pow(h.distanceToSquared(d),_),T=Math.pow(d.distanceToSquared(p),_),x=Math.pow(p.distanceToSquared(f),_);T<1e-4&&(T=1),v<1e-4&&(v=T),x<1e-4&&(x=T),sS.initNonuniformCatmullRom(h.x,d.x,p.x,f.x,v,T,x),oS.initNonuniformCatmullRom(h.y,d.y,p.y,f.y,v,T,x),aS.initNonuniformCatmullRom(h.z,d.z,p.z,f.z,v,T,x)}else this.curveType==="catmullrom"&&(sS.initCatmullRom(h.x,d.x,p.x,f.x,this.tension),oS.initCatmullRom(h.y,d.y,p.y,f.y,this.tension),aS.initCatmullRom(h.z,d.z,p.z,f.z,this.tension));return i.set(sS.calc(l),oS.calc(l),aS.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new G().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function PP(n,e,t,i,r){const s=(i-e)*.5,o=(r-t)*.5,a=n*n,l=n*a;return(2*t-2*i+s+o)*l+(-3*t+3*i-2*s-o)*a+s*n+t}function ZX(n,e){const t=1-n;return t*t*e}function eY(n,e){return 2*(1-n)*n*e}function tY(n,e){return n*n*e}function Dd(n,e,t,i){return ZX(n,e)+eY(n,t)+tY(n,i)}function nY(n,e){const t=1-n;return t*t*t*e}function iY(n,e){const t=1-n;return 3*t*t*n*e}function rY(n,e){return 3*(1-n)*n*n*e}function sY(n,e){return n*n*n*e}function kd(n,e,t,i,r){return nY(n,e)+iY(n,t)+rY(n,i)+sY(n,r)}class QT extends Ks{constructor(e=new ge,t=new ge,i=new ge,r=new ge){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new ge){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(kd(e,r.x,s.x,o.x,a.x),kd(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class kk extends Ks{constructor(e=new G,t=new G,i=new G,r=new G){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new G){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(kd(e,r.x,s.x,o.x,a.x),kd(e,r.y,s.y,o.y,a.y),kd(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class JT extends Ks{constructor(e=new ge,t=new ge){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new ge){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ge){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Ok extends Ks{constructor(e=new G,t=new G){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new G){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new G){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class ZT extends Ks{constructor(e=new ge,t=new ge,i=new ge){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new ge){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(Dd(e,r.x,s.x,o.x),Dd(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class eM extends Ks{constructor(e=new G,t=new G,i=new G){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new G){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(Dd(e,r.x,s.x,o.x),Dd(e,r.y,s.y,o.y),Dd(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class tM extends Ks{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new ge){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],h=r[o],f=r[o>r.length-2?r.length-1:o+1],d=r[o>r.length-3?r.length-1:o+2];return i.set(PP(a,l.x,h.x,f.x,d.x),PP(a,l.y,h.y,f.y,d.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new ge().fromArray(r))}return this}}var Fy=Object.freeze({__proto__:null,ArcCurve:Nk,CatmullRomCurve3:Dk,CubicBezierCurve:QT,CubicBezierCurve3:kk,EllipseCurve:Uv,LineCurve:JT,LineCurve3:Ok,QuadraticBezierCurve:ZT,QuadraticBezierCurve3:eM,SplineCurve:tM});class Uk extends Ks{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Fy[i](t,e))}return this}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],l=a.getLength(),h=l===0?0:1-o/l;return a.getPointAt(h,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let h=0;h<l.length;h++){const f=l[h];i&&i.equals(f)||(t.push(f),i=f)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(new Fy[r.type]().fromJSON(r))}return this}}class Ep extends Uk{constructor(e){super(),this.type="Path",this.currentPoint=new ge,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new JT(this.currentPoint.clone(),new ge(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new ZT(this.currentPoint.clone(),new ge(e,t),new ge(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){const a=new QT(this.currentPoint.clone(),new ge(e,t),new ge(i,r),new ge(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new tM(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,a,l){const h=this.currentPoint.x,f=this.currentPoint.y;return this.absellipse(e+h,t+f,i,r,s,o,a,l),this}absellipse(e,t,i,r,s,o,a,l){const h=new Uv(e,t,i,r,s,o,a,l);if(this.curves.length>0){const d=h.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(h);const f=h.getPoint(1);return this.currentPoint.copy(f),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Zp extends Ht{constructor(e=[new ge(0,-.5),new ge(.5,0),new ge(0,.5)],t=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:r},t=Math.floor(t),r=qn(r,0,Math.PI*2);const s=[],o=[],a=[],l=[],h=[],f=1/t,d=new G,p=new ge,_=new G,v=new G,T=new G;let x=0,y=0;for(let w=0;w<=e.length-1;w++)switch(w){case 0:x=e[w+1].x-e[w].x,y=e[w+1].y-e[w].y,_.x=y*1,_.y=-x,_.z=y*0,T.copy(_),_.normalize(),l.push(_.x,_.y,_.z);break;case e.length-1:l.push(T.x,T.y,T.z);break;default:x=e[w+1].x-e[w].x,y=e[w+1].y-e[w].y,_.x=y*1,_.y=-x,_.z=y*0,v.copy(_),_.x+=T.x,_.y+=T.y,_.z+=T.z,_.normalize(),l.push(_.x,_.y,_.z),T.copy(v)}for(let w=0;w<=t;w++){const E=i+w*f*r,I=Math.sin(E),O=Math.cos(E);for(let D=0;D<=e.length-1;D++){d.x=e[D].x*I,d.y=e[D].y,d.z=e[D].x*O,o.push(d.x,d.y,d.z),p.x=w/t,p.y=D/(e.length-1),a.push(p.x,p.y);const R=l[3*D+0]*I,b=l[3*D+1],k=l[3*D+0]*O;h.push(R,b,k)}}for(let w=0;w<t;w++)for(let E=0;E<e.length-1;E++){const I=E+w*e.length,O=I,D=I+e.length,R=I+e.length+1,b=I+1;s.push(O,D,b),s.push(R,b,D)}this.setIndex(s),this.setAttribute("position",new lt(o,3)),this.setAttribute("uv",new lt(a,2)),this.setAttribute("normal",new lt(h,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Zp(e.points,e.segments,e.phiStart,e.phiLength)}}class Fv extends Zp{constructor(e=1,t=1,i=4,r=8){const s=new Ep;s.absarc(0,-t/2,e,Math.PI*1.5,0),s.absarc(0,t/2,e,0,Math.PI*.5),super(s.getPoints(i),r),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:i,radialSegments:r}}static fromJSON(e){return new Fv(e.radius,e.length,e.capSegments,e.radialSegments)}}class Vv extends Ht{constructor(e=1,t=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},t=Math.max(3,t);const s=[],o=[],a=[],l=[],h=new G,f=new ge;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let d=0,p=3;d<=t;d++,p+=3){const _=i+d/t*r;h.x=e*Math.cos(_),h.y=e*Math.sin(_),o.push(h.x,h.y,h.z),a.push(0,0,1),f.x=(o[p]/e+1)/2,f.y=(o[p+1]/e+1)/2,l.push(f.x,f.y)}for(let d=1;d<=t;d++)s.push(d,d+1,0);this.setIndex(s),this.setAttribute("position",new lt(o,3)),this.setAttribute("normal",new lt(a,3)),this.setAttribute("uv",new lt(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Vv(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class ff extends Ht{constructor(e=1,t=1,i=1,r=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const h=this;r=Math.floor(r),s=Math.floor(s);const f=[],d=[],p=[],_=[];let v=0;const T=[],x=i/2;let y=0;w(),o===!1&&(e>0&&E(!0),t>0&&E(!1)),this.setIndex(f),this.setAttribute("position",new lt(d,3)),this.setAttribute("normal",new lt(p,3)),this.setAttribute("uv",new lt(_,2));function w(){const I=new G,O=new G;let D=0;const R=(t-e)/i;for(let b=0;b<=s;b++){const k=[],M=b/s,P=M*(t-e)+e;for(let V=0;V<=r;V++){const F=V/r,Y=F*l+a,re=Math.sin(Y),se=Math.cos(Y);O.x=P*re,O.y=-M*i+x,O.z=P*se,d.push(O.x,O.y,O.z),I.set(re,R,se).normalize(),p.push(I.x,I.y,I.z),_.push(F,1-M),k.push(v++)}T.push(k)}for(let b=0;b<r;b++)for(let k=0;k<s;k++){const M=T[k][b],P=T[k+1][b],V=T[k+1][b+1],F=T[k][b+1];f.push(M,P,F),f.push(P,V,F),D+=6}h.addGroup(y,D,0),y+=D}function E(I){const O=v,D=new ge,R=new G;let b=0;const k=I===!0?e:t,M=I===!0?1:-1;for(let V=1;V<=r;V++)d.push(0,x*M,0),p.push(0,M,0),_.push(.5,.5),v++;const P=v;for(let V=0;V<=r;V++){const Y=V/r*l+a,re=Math.cos(Y),se=Math.sin(Y);R.x=k*se,R.y=x*M,R.z=k*re,d.push(R.x,R.y,R.z),p.push(0,M,0),D.x=re*.5+.5,D.y=se*.5*M+.5,_.push(D.x,D.y),v++}for(let V=0;V<r;V++){const F=O+V,Y=P+V;I===!0?f.push(Y,Y+1,F):f.push(Y+1,Y,F),b+=3}h.addGroup(y,b,I===!0?1:2),y+=b}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ff(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class zv extends ff{constructor(e=1,t=1,i=32,r=1,s=!1,o=0,a=Math.PI*2){super(0,e,t,i,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new zv(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Rl extends Ht{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const s=[],o=[];a(r),h(i),f(),this.setAttribute("position",new lt(s,3)),this.setAttribute("normal",new lt(s.slice(),3)),this.setAttribute("uv",new lt(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(w){const E=new G,I=new G,O=new G;for(let D=0;D<t.length;D+=3)_(t[D+0],E),_(t[D+1],I),_(t[D+2],O),l(E,I,O,w)}function l(w,E,I,O){const D=O+1,R=[];for(let b=0;b<=D;b++){R[b]=[];const k=w.clone().lerp(I,b/D),M=E.clone().lerp(I,b/D),P=D-b;for(let V=0;V<=P;V++)V===0&&b===D?R[b][V]=k:R[b][V]=k.clone().lerp(M,V/P)}for(let b=0;b<D;b++)for(let k=0;k<2*(D-b)-1;k++){const M=Math.floor(k/2);k%2===0?(p(R[b][M+1]),p(R[b+1][M]),p(R[b][M])):(p(R[b][M+1]),p(R[b+1][M+1]),p(R[b+1][M]))}}function h(w){const E=new G;for(let I=0;I<s.length;I+=3)E.x=s[I+0],E.y=s[I+1],E.z=s[I+2],E.normalize().multiplyScalar(w),s[I+0]=E.x,s[I+1]=E.y,s[I+2]=E.z}function f(){const w=new G;for(let E=0;E<s.length;E+=3){w.x=s[E+0],w.y=s[E+1],w.z=s[E+2];const I=x(w)/2/Math.PI+.5,O=y(w)/Math.PI+.5;o.push(I,1-O)}v(),d()}function d(){for(let w=0;w<o.length;w+=6){const E=o[w+0],I=o[w+2],O=o[w+4],D=Math.max(E,I,O),R=Math.min(E,I,O);D>.9&&R<.1&&(E<.2&&(o[w+0]+=1),I<.2&&(o[w+2]+=1),O<.2&&(o[w+4]+=1))}}function p(w){s.push(w.x,w.y,w.z)}function _(w,E){const I=w*3;E.x=e[I+0],E.y=e[I+1],E.z=e[I+2]}function v(){const w=new G,E=new G,I=new G,O=new G,D=new ge,R=new ge,b=new ge;for(let k=0,M=0;k<s.length;k+=9,M+=6){w.set(s[k+0],s[k+1],s[k+2]),E.set(s[k+3],s[k+4],s[k+5]),I.set(s[k+6],s[k+7],s[k+8]),D.set(o[M+0],o[M+1]),R.set(o[M+2],o[M+3]),b.set(o[M+4],o[M+5]),O.copy(w).add(E).add(I).divideScalar(3);const P=x(O);T(D,M+0,w,P),T(R,M+2,E,P),T(b,M+4,I,P)}}function T(w,E,I,O){O<0&&w.x===1&&(o[E]=w.x-1),I.x===0&&I.z===0&&(o[E]=O/2/Math.PI+.5)}function x(w){return Math.atan2(w.z,-w.x)}function y(w){return Math.atan2(-w.y,Math.sqrt(w.x*w.x+w.z*w.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Rl(e.vertices,e.indices,e.radius,e.details)}}class Bv extends Rl{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Bv(e.radius,e.detail)}}const $g=new G,Kg=new G,lS=new G,Qg=new Kr;class Fk extends Ht{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const r=Math.pow(10,4),s=Math.cos(Cu*t),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,h=[0,0,0],f=["a","b","c"],d=new Array(3),p={},_=[];for(let v=0;v<l;v+=3){o?(h[0]=o.getX(v),h[1]=o.getX(v+1),h[2]=o.getX(v+2)):(h[0]=v,h[1]=v+1,h[2]=v+2);const{a:T,b:x,c:y}=Qg;if(T.fromBufferAttribute(a,h[0]),x.fromBufferAttribute(a,h[1]),y.fromBufferAttribute(a,h[2]),Qg.getNormal(lS),d[0]=`${Math.round(T.x*r)},${Math.round(T.y*r)},${Math.round(T.z*r)}`,d[1]=`${Math.round(x.x*r)},${Math.round(x.y*r)},${Math.round(x.z*r)}`,d[2]=`${Math.round(y.x*r)},${Math.round(y.y*r)},${Math.round(y.z*r)}`,!(d[0]===d[1]||d[1]===d[2]||d[2]===d[0]))for(let w=0;w<3;w++){const E=(w+1)%3,I=d[w],O=d[E],D=Qg[f[w]],R=Qg[f[E]],b=`${I}_${O}`,k=`${O}_${I}`;k in p&&p[k]?(lS.dot(p[k].normal)<=s&&(_.push(D.x,D.y,D.z),_.push(R.x,R.y,R.z)),p[k]=null):b in p||(p[b]={index0:h[w],index1:h[E],normal:lS.clone()})}}for(const v in p)if(p[v]){const{index0:T,index1:x}=p[v];$g.fromBufferAttribute(a,T),Kg.fromBufferAttribute(a,x),_.push($g.x,$g.y,$g.z),_.push(Kg.x,Kg.y,Kg.z)}this.setAttribute("position",new lt(_,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class bu extends Ep{constructor(e){super(e),this.uuid=es(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(new Ep().fromJSON(r))}return this}}const oY={triangulate:function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=Vk(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,h,f,d,p,_;if(i&&(s=hY(n,e,s,t)),n.length>80*t){a=h=n[0],l=f=n[1];for(let v=t;v<r;v+=t)d=n[v],p=n[v+1],d<a&&(a=d),p<l&&(l=p),d>h&&(h=d),p>f&&(f=p);_=Math.max(h-a,f-l),_=_!==0?32767/_:0}return wp(s,o,t,a,l,_,0),o}};function Vk(n,e,t,i,r){let s,o;if(r===EY(n,e,t,i)>0)for(s=e;s<t;s+=i)o=bP(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=bP(s,n[s],n[s+1],o);return o&&Hv(o,o.next)&&(Mp(o),o=o.next),o}function ju(n,e){if(!n)return n;e||(e=n);let t=n,i;do if(i=!1,!t.steiner&&(Hv(t,t.next)||Un(t.prev,t,t.next)===0)){if(Mp(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function wp(n,e,t,i,r,s,o){if(!n)return;!o&&s&&gY(n,i,r,s);let a=n,l,h;for(;n.prev!==n.next;){if(l=n.prev,h=n.next,s?lY(n,i,r,s):aY(n)){e.push(l.i/t|0),e.push(n.i/t|0),e.push(h.i/t|0),Mp(n),n=h.next,a=h.next;continue}if(n=h,n===a){o?o===1?(n=uY(ju(n),e,t),wp(n,e,t,i,r,s,2)):o===2&&cY(n,e,t,i,r,s):wp(ju(n),e,t,i,r,s,1);break}}}function aY(n){const e=n.prev,t=n,i=n.next;if(Un(e,t,i)>=0)return!1;const r=e.x,s=t.x,o=i.x,a=e.y,l=t.y,h=i.y,f=r<s?r<o?r:o:s<o?s:o,d=a<l?a<h?a:h:l<h?l:h,p=r>s?r>o?r:o:s>o?s:o,_=a>l?a>h?a:h:l>h?l:h;let v=i.next;for(;v!==e;){if(v.x>=f&&v.x<=p&&v.y>=d&&v.y<=_&&gh(r,a,s,l,o,h,v.x,v.y)&&Un(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function lY(n,e,t,i){const r=n.prev,s=n,o=n.next;if(Un(r,s,o)>=0)return!1;const a=r.x,l=s.x,h=o.x,f=r.y,d=s.y,p=o.y,_=a<l?a<h?a:h:l<h?l:h,v=f<d?f<p?f:p:d<p?d:p,T=a>l?a>h?a:h:l>h?l:h,x=f>d?f>p?f:p:d>p?d:p,y=Aw(_,v,e,t,i),w=Aw(T,x,e,t,i);let E=n.prevZ,I=n.nextZ;for(;E&&E.z>=y&&I&&I.z<=w;){if(E.x>=_&&E.x<=T&&E.y>=v&&E.y<=x&&E!==r&&E!==o&&gh(a,f,l,d,h,p,E.x,E.y)&&Un(E.prev,E,E.next)>=0||(E=E.prevZ,I.x>=_&&I.x<=T&&I.y>=v&&I.y<=x&&I!==r&&I!==o&&gh(a,f,l,d,h,p,I.x,I.y)&&Un(I.prev,I,I.next)>=0))return!1;I=I.nextZ}for(;E&&E.z>=y;){if(E.x>=_&&E.x<=T&&E.y>=v&&E.y<=x&&E!==r&&E!==o&&gh(a,f,l,d,h,p,E.x,E.y)&&Un(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;I&&I.z<=w;){if(I.x>=_&&I.x<=T&&I.y>=v&&I.y<=x&&I!==r&&I!==o&&gh(a,f,l,d,h,p,I.x,I.y)&&Un(I.prev,I,I.next)>=0)return!1;I=I.nextZ}return!0}function uY(n,e,t){let i=n;do{const r=i.prev,s=i.next.next;!Hv(r,s)&&zk(r,i,i.next,s)&&Tp(r,s)&&Tp(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),Mp(i),Mp(i.next),i=n=s),i=i.next}while(i!==n);return ju(i)}function cY(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&vY(o,a)){let l=Bk(o,a);o=ju(o,o.next),l=ju(l,l.next),wp(o,e,t,i,r,s,0),wp(l,e,t,i,r,s,0);return}a=a.next}o=o.next}while(o!==n)}function hY(n,e,t,i){const r=[];let s,o,a,l,h;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,h=Vk(n,a,l,i,!1),h===h.next&&(h.steiner=!0),r.push(yY(h));for(r.sort(fY),s=0;s<r.length;s++)t=dY(r[s],t);return t}function fY(n,e){return n.x-e.x}function dY(n,e){const t=pY(n,e);if(!t)return e;const i=Bk(t,n);return ju(i,i.next),ju(t,t.next)}function pY(n,e){let t=e,i=-1/0,r;const s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const p=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(p<=s&&p>i&&(i=p,r=t.x<t.next.x?t:t.next,p===s))return r}t=t.next}while(t!==e);if(!r)return null;const a=r,l=r.x,h=r.y;let f=1/0,d;t=r;do s>=t.x&&t.x>=l&&s!==t.x&&gh(o<h?s:i,o,l,h,o<h?i:s,o,t.x,t.y)&&(d=Math.abs(o-t.y)/(s-t.x),Tp(t,n)&&(d<f||d===f&&(t.x>r.x||t.x===r.x&&mY(r,t)))&&(r=t,f=d)),t=t.next;while(t!==a);return r}function mY(n,e){return Un(n.prev,n,e.prev)<0&&Un(e.next,n,n.next)<0}function gY(n,e,t,i){let r=n;do r.z===0&&(r.z=Aw(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,_Y(r)}function _Y(n){let e,t,i,r,s,o,a,l,h=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<h&&(a++,i=i.nextZ,!!i);e++);for(l=h;a>0||l>0&&i;)a!==0&&(l===0||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,h*=2}while(o>1);return n}function Aw(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function yY(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function gh(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function vY(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!xY(n,e)&&(Tp(n,e)&&Tp(e,n)&&SY(n,e)&&(Un(n.prev,n,e.prev)||Un(n,e.prev,e))||Hv(n,e)&&Un(n.prev,n,n.next)>0&&Un(e.prev,e,e.next)>0)}function Un(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function Hv(n,e){return n.x===e.x&&n.y===e.y}function zk(n,e,t,i){const r=Zg(Un(n,e,t)),s=Zg(Un(n,e,i)),o=Zg(Un(t,i,n)),a=Zg(Un(t,i,e));return!!(r!==s&&o!==a||r===0&&Jg(n,t,e)||s===0&&Jg(n,i,e)||o===0&&Jg(t,n,i)||a===0&&Jg(t,e,i))}function Jg(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Zg(n){return n>0?1:n<0?-1:0}function xY(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&zk(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function Tp(n,e){return Un(n.prev,n,n.next)<0?Un(n,e,n.next)>=0&&Un(n,n.prev,e)>=0:Un(n,e,n.prev)<0||Un(n,n.next,e)<0}function SY(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function Bk(n,e){const t=new Cw(n.i,n.x,n.y),i=new Cw(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function bP(n,e,t,i){const r=new Cw(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Mp(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Cw(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function EY(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}class So{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return So.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];LP(e),NP(i,e);let o=e.length;t.forEach(LP);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,NP(i,t[l]);const a=oY.triangulate(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function LP(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function NP(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class Gv extends Ht{constructor(e=new bu([new ge(.5,.5),new ge(-.5,.5),new ge(-.5,-.5),new ge(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++){const h=e[a];o(h)}this.setAttribute("position",new lt(r,3)),this.setAttribute("uv",new lt(s,2)),this.computeVertexNormals();function o(a){const l=[],h=t.curveSegments!==void 0?t.curveSegments:12,f=t.steps!==void 0?t.steps:1,d=t.depth!==void 0?t.depth:1;let p=t.bevelEnabled!==void 0?t.bevelEnabled:!0,_=t.bevelThickness!==void 0?t.bevelThickness:.2,v=t.bevelSize!==void 0?t.bevelSize:_-.1,T=t.bevelOffset!==void 0?t.bevelOffset:0,x=t.bevelSegments!==void 0?t.bevelSegments:3;const y=t.extrudePath,w=t.UVGenerator!==void 0?t.UVGenerator:wY;let E,I=!1,O,D,R,b;y&&(E=y.getSpacedPoints(f),I=!0,p=!1,O=y.computeFrenetFrames(f,!1),D=new G,R=new G,b=new G),p||(x=0,_=0,v=0,T=0);const k=a.extractPoints(h);let M=k.shape;const P=k.holes;if(!So.isClockWise(M)){M=M.reverse();for(let X=0,Ce=P.length;X<Ce;X++){const me=P[X];So.isClockWise(me)&&(P[X]=me.reverse())}}const F=So.triangulateShape(M,P),Y=M;for(let X=0,Ce=P.length;X<Ce;X++){const me=P[X];M=M.concat(me)}function re(X,Ce,me){return Ce||console.error("THREE.ExtrudeGeometry: vec does not exist"),X.clone().addScaledVector(Ce,me)}const se=M.length,ye=F.length;function W(X,Ce,me){let Pe,ve,st;const Be=X.x-Ce.x,z=X.y-Ce.y,U=me.x-X.x,te=me.y-X.y,Ie=Be*Be+z*z,Ae=Be*te-z*U;if(Math.abs(Ae)>Number.EPSILON){const Ee=Math.sqrt(Ie),Ke=Math.sqrt(U*U+te*te),Ue=Ce.x-z/Ee,je=Ce.y+Be/Ee,ct=me.x-te/Ke,Rt=me.y+U/Ke,Re=((ct-Ue)*te-(Rt-je)*U)/(Be*te-z*U);Pe=Ue+Be*Re-X.x,ve=je+z*Re-X.y;const Gt=Pe*Pe+ve*ve;if(Gt<=2)return new ge(Pe,ve);st=Math.sqrt(Gt/2)}else{let Ee=!1;Be>Number.EPSILON?U>Number.EPSILON&&(Ee=!0):Be<-Number.EPSILON?U<-Number.EPSILON&&(Ee=!0):Math.sign(z)===Math.sign(te)&&(Ee=!0),Ee?(Pe=-z,ve=Be,st=Math.sqrt(Ie)):(Pe=Be,ve=z,st=Math.sqrt(Ie/2))}return new ge(Pe/st,ve/st)}const K=[];for(let X=0,Ce=Y.length,me=Ce-1,Pe=X+1;X<Ce;X++,me++,Pe++)me===Ce&&(me=0),Pe===Ce&&(Pe=0),K[X]=W(Y[X],Y[me],Y[Pe]);const Q=[];let ee,_e=K.concat();for(let X=0,Ce=P.length;X<Ce;X++){const me=P[X];ee=[];for(let Pe=0,ve=me.length,st=ve-1,Be=Pe+1;Pe<ve;Pe++,st++,Be++)st===ve&&(st=0),Be===ve&&(Be=0),ee[Pe]=W(me[Pe],me[st],me[Be]);Q.push(ee),_e=_e.concat(ee)}for(let X=0;X<x;X++){const Ce=X/x,me=_*Math.cos(Ce*Math.PI/2),Pe=v*Math.sin(Ce*Math.PI/2)+T;for(let ve=0,st=Y.length;ve<st;ve++){const Be=re(Y[ve],K[ve],Pe);ze(Be.x,Be.y,-me)}for(let ve=0,st=P.length;ve<st;ve++){const Be=P[ve];ee=Q[ve];for(let z=0,U=Be.length;z<U;z++){const te=re(Be[z],ee[z],Pe);ze(te.x,te.y,-me)}}}const Ne=v+T;for(let X=0;X<se;X++){const Ce=p?re(M[X],_e[X],Ne):M[X];I?(R.copy(O.normals[0]).multiplyScalar(Ce.x),D.copy(O.binormals[0]).multiplyScalar(Ce.y),b.copy(E[0]).add(R).add(D),ze(b.x,b.y,b.z)):ze(Ce.x,Ce.y,0)}for(let X=1;X<=f;X++)for(let Ce=0;Ce<se;Ce++){const me=p?re(M[Ce],_e[Ce],Ne):M[Ce];I?(R.copy(O.normals[X]).multiplyScalar(me.x),D.copy(O.binormals[X]).multiplyScalar(me.y),b.copy(E[X]).add(R).add(D),ze(b.x,b.y,b.z)):ze(me.x,me.y,d/f*X)}for(let X=x-1;X>=0;X--){const Ce=X/x,me=_*Math.cos(Ce*Math.PI/2),Pe=v*Math.sin(Ce*Math.PI/2)+T;for(let ve=0,st=Y.length;ve<st;ve++){const Be=re(Y[ve],K[ve],Pe);ze(Be.x,Be.y,d+me)}for(let ve=0,st=P.length;ve<st;ve++){const Be=P[ve];ee=Q[ve];for(let z=0,U=Be.length;z<U;z++){const te=re(Be[z],ee[z],Pe);I?ze(te.x,te.y+E[f-1].y,E[f-1].x+me):ze(te.x,te.y,d+me)}}}oe(),xe();function oe(){const X=r.length/3;if(p){let Ce=0,me=se*Ce;for(let Pe=0;Pe<ye;Pe++){const ve=F[Pe];at(ve[2]+me,ve[1]+me,ve[0]+me)}Ce=f+x*2,me=se*Ce;for(let Pe=0;Pe<ye;Pe++){const ve=F[Pe];at(ve[0]+me,ve[1]+me,ve[2]+me)}}else{for(let Ce=0;Ce<ye;Ce++){const me=F[Ce];at(me[2],me[1],me[0])}for(let Ce=0;Ce<ye;Ce++){const me=F[Ce];at(me[0]+se*f,me[1]+se*f,me[2]+se*f)}}i.addGroup(X,r.length/3-X,0)}function xe(){const X=r.length/3;let Ce=0;Le(Y,Ce),Ce+=Y.length;for(let me=0,Pe=P.length;me<Pe;me++){const ve=P[me];Le(ve,Ce),Ce+=ve.length}i.addGroup(X,r.length/3-X,1)}function Le(X,Ce){let me=X.length;for(;--me>=0;){const Pe=me;let ve=me-1;ve<0&&(ve=X.length-1);for(let st=0,Be=f+x*2;st<Be;st++){const z=se*st,U=se*(st+1),te=Ce+Pe+z,Ie=Ce+ve+z,Ae=Ce+ve+U,Ee=Ce+Pe+U;Ze(te,Ie,Ae,Ee)}}}function ze(X,Ce,me){l.push(X),l.push(Ce),l.push(me)}function at(X,Ce,me){St(X),St(Ce),St(me);const Pe=r.length/3,ve=w.generateTopUV(i,r,Pe-3,Pe-2,Pe-1);nt(ve[0]),nt(ve[1]),nt(ve[2])}function Ze(X,Ce,me,Pe){St(X),St(Ce),St(Pe),St(Ce),St(me),St(Pe);const ve=r.length/3,st=w.generateSideWallUV(i,r,ve-6,ve-3,ve-2,ve-1);nt(st[0]),nt(st[1]),nt(st[3]),nt(st[1]),nt(st[2]),nt(st[3])}function St(X){r.push(l[X*3+0]),r.push(l[X*3+1]),r.push(l[X*3+2])}function nt(X){s.push(X.x),s.push(X.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,i=this.parameters.options;return TY(t,i,e)}static fromJSON(e,t){const i=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=t[e.shapes[s]];i.push(a)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new Fy[r.type]().fromJSON(r)),new Gv(i,e.options)}}const wY={generateTopUV:function(n,e,t,i,r){const s=e[t*3],o=e[t*3+1],a=e[i*3],l=e[i*3+1],h=e[r*3],f=e[r*3+1];return[new ge(s,o),new ge(a,l),new ge(h,f)]},generateSideWallUV:function(n,e,t,i,r,s){const o=e[t*3],a=e[t*3+1],l=e[t*3+2],h=e[i*3],f=e[i*3+1],d=e[i*3+2],p=e[r*3],_=e[r*3+1],v=e[r*3+2],T=e[s*3],x=e[s*3+1],y=e[s*3+2];return Math.abs(a-f)<Math.abs(o-h)?[new ge(o,1-l),new ge(h,1-d),new ge(p,1-v),new ge(T,1-y)]:[new ge(a,1-l),new ge(f,1-d),new ge(_,1-v),new ge(x,1-y)]}};function TY(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++){const s=n[i];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class Wv extends Rl{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Wv(e.radius,e.detail)}}class em extends Rl{constructor(e=1,t=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new em(e.radius,e.detail)}}class jv extends Ht{constructor(e=.5,t=1,i=32,r=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:o},i=Math.max(3,i),r=Math.max(1,r);const a=[],l=[],h=[],f=[];let d=e;const p=(t-e)/r,_=new G,v=new ge;for(let T=0;T<=r;T++){for(let x=0;x<=i;x++){const y=s+x/i*o;_.x=d*Math.cos(y),_.y=d*Math.sin(y),l.push(_.x,_.y,_.z),h.push(0,0,1),v.x=(_.x/t+1)/2,v.y=(_.y/t+1)/2,f.push(v.x,v.y)}d+=p}for(let T=0;T<r;T++){const x=T*(i+1);for(let y=0;y<i;y++){const w=y+x,E=w,I=w+i+1,O=w+i+2,D=w+1;a.push(E,I,D),a.push(I,O,D)}}this.setIndex(a),this.setAttribute("position",new lt(l,3)),this.setAttribute("normal",new lt(h,3)),this.setAttribute("uv",new lt(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new jv(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class qv extends Ht{constructor(e=new bu([new ge(0,.5),new ge(-.5,-.5),new ge(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],r=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)h(e);else for(let f=0;f<e.length;f++)h(e[f]),this.addGroup(a,l,f),a+=l,l=0;this.setIndex(i),this.setAttribute("position",new lt(r,3)),this.setAttribute("normal",new lt(s,3)),this.setAttribute("uv",new lt(o,2));function h(f){const d=r.length/3,p=f.extractPoints(t);let _=p.shape;const v=p.holes;So.isClockWise(_)===!1&&(_=_.reverse());for(let x=0,y=v.length;x<y;x++){const w=v[x];So.isClockWise(w)===!0&&(v[x]=w.reverse())}const T=So.triangulateShape(_,v);for(let x=0,y=v.length;x<y;x++){const w=v[x];_=_.concat(w)}for(let x=0,y=_.length;x<y;x++){const w=_[x];r.push(w.x,w.y,0),s.push(0,0,1),o.push(w.x,w.y)}for(let x=0,y=T.length;x<y;x++){const w=T[x],E=w[0]+d,I=w[1]+d,O=w[2]+d;i.push(E,I,O),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return MY(t,e)}static fromJSON(e,t){const i=[];for(let r=0,s=e.shapes.length;r<s;r++){const o=t[e.shapes[r]];i.push(o)}return new qv(i,e.curveSegments)}}function MY(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const r=n[t];e.shapes.push(r.uuid)}else e.shapes.push(n.uuid);return e}class tm extends Ht{constructor(e=1,t=32,i=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let h=0;const f=[],d=new G,p=new G,_=[],v=[],T=[],x=[];for(let y=0;y<=i;y++){const w=[],E=y/i;let I=0;y===0&&o===0?I=.5/t:y===i&&l===Math.PI&&(I=-.5/t);for(let O=0;O<=t;O++){const D=O/t;d.x=-e*Math.cos(r+D*s)*Math.sin(o+E*a),d.y=e*Math.cos(o+E*a),d.z=e*Math.sin(r+D*s)*Math.sin(o+E*a),v.push(d.x,d.y,d.z),p.copy(d).normalize(),T.push(p.x,p.y,p.z),x.push(D+I,1-E),w.push(h++)}f.push(w)}for(let y=0;y<i;y++)for(let w=0;w<t;w++){const E=f[y][w+1],I=f[y][w],O=f[y+1][w],D=f[y+1][w+1];(y!==0||o>0)&&_.push(E,I,D),(y!==i-1||l<Math.PI)&&_.push(I,O,D)}this.setIndex(_),this.setAttribute("position",new lt(v,3)),this.setAttribute("normal",new lt(T,3)),this.setAttribute("uv",new lt(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new tm(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Xv extends Rl{constructor(e=1,t=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,r,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Xv(e.radius,e.detail)}}class Yv extends Ht{constructor(e=1,t=.4,i=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const o=[],a=[],l=[],h=[],f=new G,d=new G,p=new G;for(let _=0;_<=i;_++)for(let v=0;v<=r;v++){const T=v/r*s,x=_/i*Math.PI*2;d.x=(e+t*Math.cos(x))*Math.cos(T),d.y=(e+t*Math.cos(x))*Math.sin(T),d.z=t*Math.sin(x),a.push(d.x,d.y,d.z),f.x=e*Math.cos(T),f.y=e*Math.sin(T),p.subVectors(d,f).normalize(),l.push(p.x,p.y,p.z),h.push(v/r),h.push(_/i)}for(let _=1;_<=i;_++)for(let v=1;v<=r;v++){const T=(r+1)*_+v-1,x=(r+1)*(_-1)+v-1,y=(r+1)*(_-1)+v,w=(r+1)*_+v;o.push(T,x,w),o.push(x,y,w)}this.setIndex(o),this.setAttribute("position",new lt(a,3)),this.setAttribute("normal",new lt(l,3)),this.setAttribute("uv",new lt(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Yv(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class $v extends Ht{constructor(e=1,t=.4,i=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:r,p:s,q:o},i=Math.floor(i),r=Math.floor(r);const a=[],l=[],h=[],f=[],d=new G,p=new G,_=new G,v=new G,T=new G,x=new G,y=new G;for(let E=0;E<=i;++E){const I=E/i*s*Math.PI*2;w(I,s,o,e,_),w(I+.01,s,o,e,v),x.subVectors(v,_),y.addVectors(v,_),T.crossVectors(x,y),y.crossVectors(T,x),T.normalize(),y.normalize();for(let O=0;O<=r;++O){const D=O/r*Math.PI*2,R=-t*Math.cos(D),b=t*Math.sin(D);d.x=_.x+(R*y.x+b*T.x),d.y=_.y+(R*y.y+b*T.y),d.z=_.z+(R*y.z+b*T.z),l.push(d.x,d.y,d.z),p.subVectors(d,_).normalize(),h.push(p.x,p.y,p.z),f.push(E/i),f.push(O/r)}}for(let E=1;E<=i;E++)for(let I=1;I<=r;I++){const O=(r+1)*(E-1)+(I-1),D=(r+1)*E+(I-1),R=(r+1)*E+I,b=(r+1)*(E-1)+I;a.push(O,D,b),a.push(D,R,b)}this.setIndex(a),this.setAttribute("position",new lt(l,3)),this.setAttribute("normal",new lt(h,3)),this.setAttribute("uv",new lt(f,2));function w(E,I,O,D,R){const b=Math.cos(E),k=Math.sin(E),M=O/I*E,P=Math.cos(M);R.x=D*(2+P)*.5*b,R.y=D*(2+P)*k*.5,R.z=D*Math.sin(M)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $v(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Kv extends Ht{constructor(e=new eM(new G(-1,-1,0),new G(-1,1,0),new G(1,1,0)),t=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new G,l=new G,h=new ge;let f=new G;const d=[],p=[],_=[],v=[];T(),this.setIndex(v),this.setAttribute("position",new lt(d,3)),this.setAttribute("normal",new lt(p,3)),this.setAttribute("uv",new lt(_,2));function T(){for(let E=0;E<t;E++)x(E);x(s===!1?t:0),w(),y()}function x(E){f=e.getPointAt(E/t,f);const I=o.normals[E],O=o.binormals[E];for(let D=0;D<=r;D++){const R=D/r*Math.PI*2,b=Math.sin(R),k=-Math.cos(R);l.x=k*I.x+b*O.x,l.y=k*I.y+b*O.y,l.z=k*I.z+b*O.z,l.normalize(),p.push(l.x,l.y,l.z),a.x=f.x+i*l.x,a.y=f.y+i*l.y,a.z=f.z+i*l.z,d.push(a.x,a.y,a.z)}}function y(){for(let E=1;E<=t;E++)for(let I=1;I<=r;I++){const O=(r+1)*(E-1)+(I-1),D=(r+1)*E+(I-1),R=(r+1)*E+I,b=(r+1)*(E-1)+I;v.push(O,D,b),v.push(D,R,b)}}function w(){for(let E=0;E<=t;E++)for(let I=0;I<=r;I++)h.x=E/t,h.y=I/r,_.push(h.x,h.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Kv(new Fy[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class Hk extends Ht{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],i=new Set,r=new G,s=new G;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let h=0,f=l.length;h<f;++h){const d=l[h],p=d.start,_=d.count;for(let v=p,T=p+_;v<T;v+=3)for(let x=0;x<3;x++){const y=a.getX(v+x),w=a.getX(v+(x+1)%3);r.fromBufferAttribute(o,y),s.fromBufferAttribute(o,w),DP(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let h=0;h<3;h++){const f=3*a+h,d=3*a+(h+1)%3;r.fromBufferAttribute(o,f),s.fromBufferAttribute(o,d),DP(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new lt(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function DP(n,e,t){const i=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(i)===!0||t.has(r)===!0?!1:(t.add(i),t.add(r),!0)}var kP=Object.freeze({__proto__:null,BoxGeometry:Qu,CapsuleGeometry:Fv,CircleGeometry:Vv,ConeGeometry:zv,CylinderGeometry:ff,DodecahedronGeometry:Bv,EdgesGeometry:Fk,ExtrudeGeometry:Gv,IcosahedronGeometry:Wv,LatheGeometry:Zp,OctahedronGeometry:em,PlaneGeometry:cf,PolyhedronGeometry:Rl,RingGeometry:jv,ShapeGeometry:qv,SphereGeometry:tm,TetrahedronGeometry:Xv,TorusGeometry:Yv,TorusKnotGeometry:$v,TubeGeometry:Kv,WireframeGeometry:Hk});class Gk extends ir{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Ye(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class Wk extends ns{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class nM extends ir{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ye(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ye(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Al,this.normalScale=new ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class jk extends nM{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ge(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return qn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ye(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Ye(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ye(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class qk extends ir{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ye(16777215),this.specular=new Ye(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ye(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Al,this.normalScale=new ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Xp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Xk extends ir{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ye(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ye(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Al,this.normalScale=new ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class Yk extends ir{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Al,this.normalScale=new ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class iM extends ir{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ye(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ye(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Al,this.normalScale=new ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Xp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class $k extends ir{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ye(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Al,this.normalScale=new ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Kk extends Sr{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Su(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function Qk(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Jk(n){function e(r,s){return n[r]-n[s]}const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(e),i}function Rw(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=n[a+l]}return r}function rM(n,e,t,i){let r=1,s=n[0];for(;s!==void 0&&s[i]===void 0;)s=n[r++];if(s===void 0)return;let o=s[i];if(o!==void 0)if(Array.isArray(o))do o=s[i],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=n[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[i],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++];while(s!==void 0);else do o=s[i],o!==void 0&&(e.push(s.time),t.push(o)),s=n[r++];while(s!==void 0)}function AY(n,e,t,i,r=30){const s=n.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const h=s.tracks[l],f=h.getValueSize(),d=[],p=[];for(let _=0;_<h.times.length;++_){const v=h.times[_]*r;if(!(v<t||v>=i)){d.push(h.times[_]);for(let T=0;T<f;++T)p.push(h.values[_*f+T])}}d.length!==0&&(h.times=Su(d,h.times.constructor),h.values=Su(p,h.values.constructor),o.push(h))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function CY(n,e=0,t=n,i=30){i<=0&&(i=30);const r=t.tracks.length,s=e/i;for(let o=0;o<r;++o){const a=t.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const h=n.tracks.find(function(y){return y.name===a.name&&y.ValueTypeName===l});if(h===void 0)continue;let f=0;const d=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=d/3);let p=0;const _=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(p=_/3);const v=a.times.length-1;let T;if(s<=a.times[0]){const y=f,w=d-f;T=a.values.slice(y,w)}else if(s>=a.times[v]){const y=v*d+f,w=y+d-f;T=a.values.slice(y,w)}else{const y=a.createInterpolant(),w=f,E=d-f;y.evaluate(s),T=y.resultBuffer.slice(w,E)}l==="quaternion"&&new gi().fromArray(T).normalize().conjugate().toArray(T);const x=h.times.length;for(let y=0;y<x;++y){const w=y*_+p;if(l==="quaternion")gi.multiplyQuaternionsFlat(h.values,w,T,0,h.values,w);else{const E=_-p*2;for(let I=0;I<E;++I)h.values[w+I]-=T[I]}}}return n.blendMode=LT,n}const RY={convertArray:Su,isTypedArray:Qk,getKeyframeOrder:Jk,sortedArray:Rw,flattenJSON:rM,subclip:AY,makeClipAdditive:CY};class nm{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0;break n}break e}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Zk extends nm{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:yu,endingEnd:yu}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case vu:s=e,a=2*t-i;break;case mp:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(l===void 0)switch(this.getSettings_().endingEnd){case vu:o=e,l=2*i-t;break;case mp:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const h=(i-t)*.5,f=this.valueSize;this._weightPrev=h/(t-a),this._weightNext=h/(l-i),this._offsetPrev=s*f,this._offsetNext=o*f}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,h=l-a,f=this._offsetPrev,d=this._offsetNext,p=this._weightPrev,_=this._weightNext,v=(i-t)/(r-t),T=v*v,x=T*v,y=-p*x+2*p*T-p*v,w=(1+p)*x+(-1.5-2*p)*T+(-.5+p)*v+1,E=(-1-_)*x+(1.5+_)*T+.5*v,I=_*x-_*T;for(let O=0;O!==a;++O)s[O]=y*o[f+O]+w*o[h+O]+E*o[l+O]+I*o[d+O];return s}}class sM extends nm{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,h=l-a,f=(i-t)/(r-t),d=1-f;for(let p=0;p!==a;++p)s[p]=o[h+p]*d+o[l+p]*f;return s}}class eO extends nm{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Qs{constructor(e,t,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Su(t,this.TimeBufferType),this.values=Su(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Su(e.times,Array),values:Su(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new eO(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new sM(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Zk(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case dp:t=this.InterpolantFactoryMethodDiscrete;break;case pp:t=this.InterpolantFactoryMethodLinear;break;case V_:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return dp;case this.InterpolantFactoryMethodLinear:return pp;case this.InterpolantFactoryMethodSmooth:return V_}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;o!==-1&&i[o]>t;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(r!==void 0&&Qk(r))for(let a=0,l=r.length;a!==l;++a){const h=r[a];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,h),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===V_,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const h=e[a],f=e[a+1];if(h!==f&&(a!==1||h!==e[0]))if(r)l=!0;else{const d=a*i,p=d-i,_=d+i;for(let v=0;v!==i;++v){const T=t[d+v];if(T!==t[p+v]||T!==t[_+v]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const d=a*i,p=o*i;for(let _=0;_!==i;++_)t[p+_]=t[d+_]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,h=0;h!==i;++h)t[l+h]=t[a+h];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),i=this.constructor,r=new i(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Qs.prototype.TimeBufferType=Float32Array;Qs.prototype.ValueBufferType=Float32Array;Qs.prototype.DefaultInterpolation=pp;class Ju extends Qs{}Ju.prototype.ValueTypeName="bool";Ju.prototype.ValueBufferType=Array;Ju.prototype.DefaultInterpolation=dp;Ju.prototype.InterpolantFactoryMethodLinear=void 0;Ju.prototype.InterpolantFactoryMethodSmooth=void 0;class oM extends Qs{}oM.prototype.ValueTypeName="color";class Ap extends Qs{}Ap.prototype.ValueTypeName="number";class tO extends nm{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let h=e*a;for(let f=h+a;h!==f;h+=4)gi.slerpFlat(s,0,o,h-a,o,h,l);return s}}class df extends Qs{InterpolantFactoryMethodLinear(e){return new tO(this.times,this.values,this.getValueSize(),e)}}df.prototype.ValueTypeName="quaternion";df.prototype.DefaultInterpolation=pp;df.prototype.InterpolantFactoryMethodSmooth=void 0;class Zu extends Qs{}Zu.prototype.ValueTypeName="string";Zu.prototype.ValueBufferType=Array;Zu.prototype.DefaultInterpolation=dp;Zu.prototype.InterpolantFactoryMethodLinear=void 0;Zu.prototype.InterpolantFactoryMethodSmooth=void 0;class Cp extends Qs{}Cp.prototype.ValueTypeName="vector";class Rp{constructor(e,t=-1,i,r=Rv){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=es(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(PY(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(Qs.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],h=[];l.push((a+s-1)%s,a,(a+1)%s),h.push(0,1,0);const f=Jk(l);l=Rw(l,1,f),h=Rw(h,1,f),!r&&l[0]===0&&(l.push(s),h.push(h[0])),o.push(new Ap(".morphTargetInfluences["+t[a].name+"]",l,h).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const h=e[a],f=h.name.match(s);if(f&&f.length>1){const d=f[1];let p=r[d];p||(r[d]=p=[]),p.push(h)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(d,p,_,v,T){if(_.length!==0){const x=[],y=[];rM(_,x,y,v),x.length!==0&&T.push(new d(p,x,y))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const h=e.hierarchy||[];for(let d=0;d<h.length;d++){const p=h[d].keys;if(!(!p||p.length===0))if(p[0].morphTargets){const _={};let v;for(v=0;v<p.length;v++)if(p[v].morphTargets)for(let T=0;T<p[v].morphTargets.length;T++)_[p[v].morphTargets[T]]=-1;for(const T in _){const x=[],y=[];for(let w=0;w!==p[v].morphTargets.length;++w){const E=p[v];x.push(E.time),y.push(E.morphTarget===T?1:0)}r.push(new Ap(".morphTargetInfluence["+T+"]",x,y))}l=_.length*o}else{const _=".bones["+t[d].name+"]";i(Cp,_+".position",p,"pos",r),i(df,_+".quaternion",p,"rot",r),i(Cp,_+".scale",p,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){const e=this.tracks;let t=0;for(let i=0,r=e.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function IY(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ap;case"vector":case"vector2":case"vector3":case"vector4":return Cp;case"color":return oM;case"quaternion":return df;case"bool":case"boolean":return Ju;case"string":return Zu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function PY(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=IY(n.type);if(n.times===void 0){const t=[],i=[];rM(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Xo={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class aM{constructor(e,t,i){const r=this;let s=!1,o=0,a=0,l;const h=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(f){a++,s===!1&&r.onStart!==void 0&&r.onStart(f,o,a),s=!0},this.itemEnd=function(f){o++,r.onProgress!==void 0&&r.onProgress(f,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(f){r.onError!==void 0&&r.onError(f)},this.resolveURL=function(f){return l?l(f):f},this.setURLModifier=function(f){return l=f,this},this.addHandler=function(f,d){return h.push(f,d),this},this.removeHandler=function(f){const d=h.indexOf(f);return d!==-1&&h.splice(d,2),this},this.getHandler=function(f){for(let d=0,p=h.length;d<p;d+=2){const _=h[d],v=h[d+1];if(_.global&&(_.lastIndex=0),_.test(f))return v}return null}}}const nO=new aM;class kr{constructor(e){this.manager=e!==void 0?e:nO,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}kr.DEFAULT_MATERIAL_NAME="__DEFAULT";const Uo={};class bY extends Error{constructor(e,t){super(e),this.response=t}}class aa extends kr{constructor(e){super(e)}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Xo.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(Uo[e]!==void 0){Uo[e].push({onLoad:t,onProgress:i,onError:r});return}Uo[e]=[],Uo[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(h=>{if(h.status===200||h.status===0){if(h.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||h.body===void 0||h.body.getReader===void 0)return h;const f=Uo[e],d=h.body.getReader(),p=h.headers.get("Content-Length")||h.headers.get("X-File-Size"),_=p?parseInt(p):0,v=_!==0;let T=0;const x=new ReadableStream({start(y){w();function w(){d.read().then(({done:E,value:I})=>{if(E)y.close();else{T+=I.byteLength;const O=new ProgressEvent("progress",{lengthComputable:v,loaded:T,total:_});for(let D=0,R=f.length;D<R;D++){const b=f[D];b.onProgress&&b.onProgress(O)}y.enqueue(I),w()}})}}});return new Response(x)}else throw new bY(`fetch for "${h.url}" responded with ${h.status}: ${h.statusText}`,h)}).then(h=>{switch(l){case"arraybuffer":return h.arrayBuffer();case"blob":return h.blob();case"document":return h.text().then(f=>new DOMParser().parseFromString(f,a));case"json":return h.json();default:if(a===void 0)return h.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),p=d&&d[1]?d[1].toLowerCase():void 0,_=new TextDecoder(p);return h.arrayBuffer().then(v=>_.decode(v))}}}).then(h=>{Xo.add(e,h);const f=Uo[e];delete Uo[e];for(let d=0,p=f.length;d<p;d++){const _=f[d];_.onLoad&&_.onLoad(h)}}).catch(h=>{const f=Uo[e];if(f===void 0)throw this.manager.itemError(e),h;delete Uo[e];for(let d=0,p=f.length;d<p;d++){const _=f[d];_.onError&&_.onError(h)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class LY extends kr{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new aa(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const t=[];for(let i=0;i<e.length;i++){const r=Rp.parse(e[i]);t.push(r)}return t}}class NY extends kr{constructor(e){super(e)}load(e,t,i,r){const s=this,o=[],a=new Ov,l=new aa(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let h=0;function f(d){l.load(e[d],function(p){const _=s.parse(p,!0);o[d]={width:_.width,height:_.height,format:_.format,mipmaps:_.mipmaps},h+=1,h===6&&(_.mipmapCount===1&&(a.minFilter=On),a.image=o,a.format=_.format,a.needsUpdate=!0,t&&t(a))},i,r)}if(Array.isArray(e))for(let d=0,p=e.length;d<p;++d)f(d);else l.load(e,function(d){const p=s.parse(d,!0);if(p.isCubemap){const _=p.mipmaps.length/p.mipmapCount;for(let v=0;v<_;v++){o[v]={mipmaps:[]};for(let T=0;T<p.mipmapCount;T++)o[v].mipmaps.push(p.mipmaps[v*p.mipmapCount+T]),o[v].format=p.format,o[v].width=p.width,o[v].height=p.height}a.image=o}else a.image.width=p.width,a.image.height=p.height,a.mipmaps=p.mipmaps;p.mipmapCount===1&&(a.minFilter=On),a.format=p.format,a.needsUpdate=!0,t&&t(a)},i,r);return a}}class Ip extends kr{constructor(e){super(e)}load(e,t,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Xo.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Sp("img");function l(){f(),Xo.add(e,this),t&&t(this),s.manager.itemEnd(e)}function h(d){f(),r&&r(d),s.manager.itemError(e),s.manager.itemEnd(e)}function f(){a.removeEventListener("load",l,!1),a.removeEventListener("error",h,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",h,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class DY extends kr{constructor(e){super(e)}load(e,t,i,r){const s=new Qp;s.colorSpace=di;const o=new Ip(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(h){o.load(e[h],function(f){s.images[h]=f,a++,a===6&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let h=0;h<e.length;++h)l(h);return s}}class kY extends kr{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Pu,a=new aa(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){let h;try{h=s.parse(l)}catch(f){if(r!==void 0)r(f);else{console.error(f);return}}h.image!==void 0?o.image=h.image:h.data!==void 0&&(o.image.width=h.width,o.image.height=h.height,o.image.data=h.data),o.wrapS=h.wrapS!==void 0?h.wrapS:Zi,o.wrapT=h.wrapT!==void 0?h.wrapT:Zi,o.magFilter=h.magFilter!==void 0?h.magFilter:On,o.minFilter=h.minFilter!==void 0?h.minFilter:On,o.anisotropy=h.anisotropy!==void 0?h.anisotropy:1,h.colorSpace!==void 0?o.colorSpace=h.colorSpace:h.encoding!==void 0&&(o.encoding=h.encoding),h.flipY!==void 0&&(o.flipY=h.flipY),h.format!==void 0&&(o.format=h.format),h.type!==void 0&&(o.type=h.type),h.mipmaps!==void 0&&(o.mipmaps=h.mipmaps,o.minFilter=uo),h.mipmapCount===1&&(o.minFilter=On),h.generateMipmaps!==void 0&&(o.generateMipmaps=h.generateMipmaps),o.needsUpdate=!0,t&&t(o,h)},i,r),o}}class Qv extends kr{constructor(e){super(e)}load(e,t,i,r){const s=new Pn,o=new Ip(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},i,r),s}}class Il extends ln{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ye(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class iO extends Il{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(ln.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Ye(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const uS=new Mt,OP=new G,UP=new G;class lM{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ge(512,512),this.map=null,this.mapPass=null,this.matrix=new Mt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Jp,this._frameExtents=new ge(1,1),this._viewportCount=1,this._viewports=[new cn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;OP.setFromMatrixPosition(e.matrixWorld),t.position.copy(OP),UP.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(UP),t.updateMatrixWorld(),uS.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(uS),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(uS)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class OY extends lM{constructor(){super(new ti(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=qh*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class rO extends Il{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(ln.DEFAULT_UP),this.updateMatrix(),this.target=new ln,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new OY}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const FP=new Mt,ed=new G,cS=new G;class UY extends lM{constructor(){super(new ti(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ge(4,2),this._viewportCount=6,this._viewports=[new cn(2,1,1,1),new cn(0,1,1,1),new cn(3,1,1,1),new cn(1,1,1,1),new cn(3,0,1,1),new cn(1,0,1,1)],this._cubeDirections=[new G(1,0,0),new G(-1,0,0),new G(0,0,1),new G(0,0,-1),new G(0,1,0),new G(0,-1,0)],this._cubeUps=[new G(0,1,0),new G(0,1,0),new G(0,1,0),new G(0,1,0),new G(0,0,1),new G(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),ed.setFromMatrixPosition(e.matrixWorld),i.position.copy(ed),cS.copy(i.position),cS.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(cS),i.updateMatrixWorld(),r.makeTranslation(-ed.x,-ed.y,-ed.z),FP.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(FP)}}class sO extends Il{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new UY}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class FY extends lM{constructor(){super(new sl(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class oO extends Il{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ln.DEFAULT_UP),this.updateMatrix(),this.target=new ln,this.shadow=new FY}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class aO extends Il{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class lO extends Il{constructor(e,t,i=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class uO{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new G)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*i),t.addScaledVector(o[4],1.092548*(i*r)),t.addScaledVector(o[5],1.092548*(r*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(i*s)),t.addScaledVector(o[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*r),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*i),t.addScaledVector(o[4],2*.429043*i*r),t.addScaledVector(o[5],2*.429043*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*i*s),t.addScaledVector(o[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const i=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*i*s,t[8]=.546274*(i*i-r*r)}}class cO extends Il{constructor(e=new uO,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class Jv extends kr{constructor(e){super(e),this.textures={}}load(e,t,i,r){const s=this,o=new aa(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const t=this.textures;function i(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const r=Jv.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new Ye().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=i(o.value);break;case"c":r.uniforms[s].value=new Ye().setHex(o.value);break;case"v2":r.uniforms[s].value=new ge().fromArray(o.value);break;case"v3":r.uniforms[s].value=new G().fromArray(o.value);break;case"v4":r.uniforms[s].value=new cn().fromArray(o.value);break;case"m3":r.uniforms[s].value=new Bt().fromArray(o.value);break;case"m4":r.uniforms[s].value=new Mt().fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=i(e.map)),e.matcap!==void 0&&(r.matcap=i(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new ge().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=i(e.envMap)),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new ge().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=i(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=i(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const t={ShadowMaterial:Gk,SpriteMaterial:XT,RawShaderMaterial:Wk,ShaderMaterial:ns,PointsMaterial:$T,MeshPhysicalMaterial:jk,MeshStandardMaterial:nM,MeshPhongMaterial:qk,MeshToonMaterial:Xk,MeshNormalMaterial:Yk,MeshLambertMaterial:iM,MeshDepthMaterial:GT,MeshDistanceMaterial:WT,MeshBasicMaterial:Cl,MeshMatcapMaterial:$k,LineDashedMaterial:Kk,LineBasicMaterial:Sr,Material:ir};return new t[e]}}class Iw{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class hO extends Ht{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class fO extends kr{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new aa(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const t={},i={};function r(_,v){if(t[v]!==void 0)return t[v];const x=_.interleavedBuffers[v],y=s(_,x.buffer),w=fh(x.type,y),E=new Dv(w,x.stride);return E.uuid=x.uuid,t[v]=E,E}function s(_,v){if(i[v]!==void 0)return i[v];const x=_.arrayBuffers[v],y=new Uint32Array(x).buffer;return i[v]=y,y}const o=e.isInstancedBufferGeometry?new hO:new Ht,a=e.data.index;if(a!==void 0){const _=fh(a.type,a.array);o.setIndex(new mn(_,1))}const l=e.data.attributes;for(const _ in l){const v=l[_];let T;if(v.isInterleavedBufferAttribute){const x=r(e.data,v.data);T=new Wu(x,v.itemSize,v.offset,v.normalized)}else{const x=fh(v.type,v.array),y=v.isInstancedBufferAttribute?Yh:mn;T=new y(x,v.itemSize,v.normalized)}v.name!==void 0&&(T.name=v.name),v.usage!==void 0&&T.setUsage(v.usage),o.setAttribute(_,T)}const h=e.data.morphAttributes;if(h)for(const _ in h){const v=h[_],T=[];for(let x=0,y=v.length;x<y;x++){const w=v[x];let E;if(w.isInterleavedBufferAttribute){const I=r(e.data,w.data);E=new Wu(I,w.itemSize,w.offset,w.normalized)}else{const I=fh(w.type,w.array);E=new mn(I,w.itemSize,w.normalized)}w.name!==void 0&&(E.name=w.name),T.push(E)}o.morphAttributes[_]=T}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const d=e.data.groups||e.data.drawcalls||e.data.offsets;if(d!==void 0)for(let _=0,v=d.length;_!==v;++_){const T=d[_];o.addGroup(T.start,T.count,T.materialIndex)}const p=e.data.boundingSphere;if(p!==void 0){const _=new G;p.center!==void 0&&_.fromArray(p.center),o.boundingSphere=new er(_,p.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class VY extends kr{constructor(e){super(e)}load(e,t,i,r){const s=this,o=this.path===""?Iw.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new aa(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let h=null;try{h=JSON.parse(l)}catch(d){r!==void 0&&r(d),console.error("THREE:ObjectLoader: Can't parse "+e+".",d.message);return}const f=h.metadata;if(f===void 0||f.type===void 0||f.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(h,t)},i,r)}async loadAsync(e,t){const i=this,r=this.path===""?Iw.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new aa(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,t),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(a)}parse(e,t){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){t!==void 0&&t(h)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),h=this.parseObject(e.object,s,l,a,i),f=this.parseSkeletons(e.skeletons,h);if(this.bindSkeletons(h,f),t!==void 0){let d=!1;for(const p in o)if(o[p].data instanceof HTMLImageElement){d=!0;break}d===!1&&t(h)}return h}async parseAsync(e){const t=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,r,a,o,t),h=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,h),l}parseShapes(e){const t={};if(e!==void 0)for(let i=0,r=e.length;i<r;i++){const s=new bu().fromJSON(e[i]);t[s.uuid]=s}return t}parseSkeletons(e,t){const i={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new kv().fromJSON(e[s],r);i[a.uuid]=a}return i}parseGeometries(e,t){const i={};if(e!==void 0){const r=new fO;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(l);break;default:l.type in kP?a=kP[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.userData!==void 0&&(a.userData=l.userData),i[l.uuid]=a}}return i}parseMaterials(e,t){const i={},r={};if(e!==void 0){const s=new Jv;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){const l=e[o];i[l.uuid]===void 0&&(i[l.uuid]=s.parse(l)),r[l.uuid]=i[l.uuid]}}return r}parseAnimations(e){const t={};if(e!==void 0)for(let i=0;i<e.length;i++){const r=e[i],s=Rp.parse(r);t[s.uuid]=s}return t}parseImages(e,t){const i=this,r={};let s;function o(l){return i.manager.itemStart(l),s.load(l,function(){i.manager.itemEnd(l)},void 0,function(){i.manager.itemError(l),i.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const h=l,f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:i.resourcePath+h;return o(f)}else return l.data?{data:fh(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new aM(t);s=new Ip(l),s.setCrossOrigin(this.crossOrigin);for(let h=0,f=e.length;h<f;h++){const d=e[h],p=d.url;if(Array.isArray(p)){const _=[];for(let v=0,T=p.length;v<T;v++){const x=p[v],y=a(x);y!==null&&(y instanceof HTMLImageElement?_.push(y):_.push(new Pu(y.data,y.width,y.height)))}r[d.uuid]=new xu(_)}else{const _=a(d.url);r[d.uuid]=new xu(_)}}}return r}async parseImagesAsync(e){const t=this,i={};let r;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return await r.loadAsync(l)}else return o.data?{data:fh(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){r=new Ip(this.manager),r.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],h=l.url;if(Array.isArray(h)){const f=[];for(let d=0,p=h.length;d<p;d++){const _=h[d],v=await s(_);v!==null&&(v instanceof HTMLImageElement?f.push(v):f.push(new Pu(v.data,v.width,v.height)))}i[l.uuid]=new xu(f)}else{const f=await s(l.url);i[l.uuid]=new xu(f)}}}return i}parseTextures(e,t){function i(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=t[a.image],h=l.data;let f;Array.isArray(h)?(f=new Qp,h.length===6&&(f.needsUpdate=!0)):(h&&h.data?f=new Pu:f=new Pn,h&&(f.needsUpdate=!0)),f.source=l,f.uuid=a.uuid,a.name!==void 0&&(f.name=a.name),a.mapping!==void 0&&(f.mapping=i(a.mapping,zY)),a.channel!==void 0&&(f.channel=a.channel),a.offset!==void 0&&f.offset.fromArray(a.offset),a.repeat!==void 0&&f.repeat.fromArray(a.repeat),a.center!==void 0&&f.center.fromArray(a.center),a.rotation!==void 0&&(f.rotation=a.rotation),a.wrap!==void 0&&(f.wrapS=i(a.wrap[0],VP),f.wrapT=i(a.wrap[1],VP)),a.format!==void 0&&(f.format=a.format),a.internalFormat!==void 0&&(f.internalFormat=a.internalFormat),a.type!==void 0&&(f.type=a.type),a.colorSpace!==void 0&&(f.colorSpace=a.colorSpace),a.encoding!==void 0&&(f.encoding=a.encoding),a.minFilter!==void 0&&(f.minFilter=i(a.minFilter,zP)),a.magFilter!==void 0&&(f.magFilter=i(a.magFilter,zP)),a.anisotropy!==void 0&&(f.anisotropy=a.anisotropy),a.flipY!==void 0&&(f.flipY=a.flipY),a.generateMipmaps!==void 0&&(f.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(f.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(f.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(f.compareFunction=a.compareFunction),a.userData!==void 0&&(f.userData=a.userData),r[a.uuid]=f}return r}parseObject(e,t,i,r,s){let o;function a(p){return t[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",p),t[p]}function l(p){if(p!==void 0){if(Array.isArray(p)){const _=[];for(let v=0,T=p.length;v<T;v++){const x=p[v];i[x]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",x),_.push(i[x])}return _}return i[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",p),i[p]}}function h(p){return r[p]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",p),r[p]}let f,d;switch(e.type){case"Scene":o=new qT,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new Ye(e.background):o.background=h(e.background)),e.environment!==void 0&&(o.environment=h(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new Nv(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new Lv(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":o=new ti(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new sl(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new aO(e.color,e.intensity);break;case"DirectionalLight":o=new oO(e.color,e.intensity);break;case"PointLight":o=new sO(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new lO(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new rO(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new iO(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new cO().fromJSON(e);break;case"SkinnedMesh":f=a(e.geometry),d=l(e.material),o=new Rk(f,d),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":f=a(e.geometry),d=l(e.material),o=new ui(f,d);break;case"InstancedMesh":f=a(e.geometry),d=l(e.material);const p=e.count,_=e.instanceMatrix,v=e.instanceColor;o=new Ik(f,d,p),o.instanceMatrix=new Yh(new Float32Array(_.array),16),v!==void 0&&(o.instanceColor=new Yh(new Float32Array(v.array),v.itemSize));break;case"BatchedMesh":f=a(e.geometry),d=l(e.material),o=new Pk(e.maxGeometryCount,e.maxVertexCount,e.maxIndexCount,d),o.geometry=f,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(T=>{const x=new yr;x.min.fromArray(T.boxMin),x.max.fromArray(T.boxMax);const y=new er;return y.radius=T.sphereRadius,y.center.fromArray(T.sphereCenter),{boxInitialized:T.boxInitialized,box:x,sphereInitialized:T.sphereInitialized,sphere:y}}),o._maxGeometryCount=e.maxGeometryCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=h(e.matricesTexture.uuid);break;case"LOD":o=new Ck;break;case"Line":o=new gl(a(e.geometry),l(e.material));break;case"LineLoop":o=new bk(a(e.geometry),l(e.material));break;case"LineSegments":o=new To(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new Lk(a(e.geometry),l(e.material));break;case"Sprite":o=new Ak(l(e.material));break;case"Group":o=new mh;break;case"Bone":o=new YT;break;default:o=new ln}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const p=e.children;for(let _=0;_<p.length;_++)o.add(this.parseObject(p[_],t,i,r,s))}if(e.animations!==void 0){const p=e.animations;for(let _=0;_<p.length;_++){const v=p[_];o.animations.push(s[v])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const p=e.levels;for(let _=0;_<p.length;_++){const v=p[_],T=o.getObjectByProperty("uuid",v.object);T!==void 0&&o.addLevel(T,v.distance,v.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const r=t[i.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}}const zY={UVMapping:Av,CubeReflectionMapping:oa,CubeRefractionMapping:ml,EquirectangularReflectionMapping:up,EquirectangularRefractionMapping:cp,CubeUVReflectionMapping:uf},VP={RepeatWrapping:hp,ClampToEdgeWrapping:Zi,MirroredRepeatWrapping:fp},zP={NearestFilter:Zn,NearestMipmapNearestFilter:ky,NearestMipmapLinearFilter:hu,LinearFilter:On,LinearMipmapNearestFilter:Ld,LinearMipmapLinearFilter:uo};class BY extends kr{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Xo.get(e);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(h=>{t&&t(h),s.manager.itemEnd(e)}).catch(h=>{r&&r(h)});return}return setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o}const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader;const l=fetch(e,a).then(function(h){return h.blob()}).then(function(h){return createImageBitmap(h,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(h){return Xo.add(e,h),t&&t(h),s.manager.itemEnd(e),h}).catch(function(h){r&&r(h),Xo.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});Xo.add(e,l),s.manager.itemStart(e)}}let e_;class uM{static getContext(){return e_===void 0&&(e_=new(window.AudioContext||window.webkitAudioContext)),e_}static setContext(e){e_=e}}class HY extends kr{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new aa(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{const h=l.slice(0);uM.getContext().decodeAudioData(h,function(d){t(d)}).catch(a)}catch(h){a(h)}},i,r);function a(l){r?r(l):console.error(l),s.manager.itemError(e)}}}const BP=new Mt,HP=new Mt,Jl=new Mt;class GY{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ti,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ti,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Jl.copy(e.projectionMatrix);const r=t.eyeSep/2,s=r*t.near/t.focus,o=t.near*Math.tan(Cu*t.fov*.5)/t.zoom;let a,l;HP.elements[12]=-r,BP.elements[12]=r,a=-o*t.aspect+s,l=o*t.aspect+s,Jl.elements[0]=2*t.near/(l-a),Jl.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(Jl),a=-o*t.aspect-s,l=o*t.aspect-s,Jl.elements[0]=2*t.near/(l-a),Jl.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(Jl)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(HP),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(BP)}}class cM{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=GP(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=GP();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function GP(){return(typeof performance>"u"?Date:performance).now()}const Zl=new G,WP=new gi,WY=new G,eu=new G;class jY extends ln{constructor(){super(),this.type="AudioListener",this.context=uM.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new cM}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Zl,WP,WY),eu.set(0,0,-1).applyQuaternion(WP),t.positionX){const r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Zl.x,r),t.positionY.linearRampToValueAtTime(Zl.y,r),t.positionZ.linearRampToValueAtTime(Zl.z,r),t.forwardX.linearRampToValueAtTime(eu.x,r),t.forwardY.linearRampToValueAtTime(eu.y,r),t.forwardZ.linearRampToValueAtTime(eu.z,r),t.upX.linearRampToValueAtTime(i.x,r),t.upY.linearRampToValueAtTime(i.y,r),t.upZ.linearRampToValueAtTime(i.z,r)}else t.setPosition(Zl.x,Zl.y,Zl.z),t.setOrientation(eu.x,eu.y,eu.z,i.x,i.y,i.z)}}class dO extends ln{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const tu=new G,jP=new gi,qY=new G,nu=new G;class XY extends dO{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(tu,jP,qY),nu.set(0,0,1).applyQuaternion(jP);const t=this.panner;if(t.positionX){const i=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(tu.x,i),t.positionY.linearRampToValueAtTime(tu.y,i),t.positionZ.linearRampToValueAtTime(tu.z,i),t.orientationX.linearRampToValueAtTime(nu.x,i),t.orientationY.linearRampToValueAtTime(nu.y,i),t.orientationZ.linearRampToValueAtTime(nu.z,i)}else t.setPosition(tu.x,tu.y,tu.z),t.setOrientation(nu.x,nu.y,nu.z)}}class YY{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let i=0;i<t.length;i++)e+=t[i];return e/t.length}}class pO{constructor(e,t,i){this.binding=e,this.valueSize=i;let r,s,o;switch(t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)i[s+a]=i[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(i,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=t*this._origIndex;this._mixBufferRegion(i,r,l,1-s,t)}o>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let l=t,h=t+t;l!==h;++l)if(i[l]!==i[l+t]){a.setValue(i,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(t,r);for(let s=i,o=r;s!==o;++s)t[s]=t[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[i+o]}_slerp(e,t,i,r){gi.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,s){const o=this._workIndex*s;gi.multiplyQuaternionsFlat(e,o,e,t,e,i),gi.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,i,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[i+a]*r}}_lerpAdditive(e,t,i,r,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[i+o]*r}}}const hM="\\[\\]\\.:\\/",$Y=new RegExp("["+hM+"]","g"),fM="[^"+hM+"]",KY="[^"+hM.replace("\\.","")+"]",QY=/((?:WC+[\/:])*)/.source.replace("WC",fM),JY=/(WCOD+)?/.source.replace("WCOD",KY),ZY=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",fM),e$=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",fM),t$=new RegExp("^"+QY+JY+ZY+e$+"$"),n$=["material","materials","bones","map"];class i${constructor(e,t,i){const r=i||nn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}class nn{constructor(e,t,i){this.path=t,this.parsedPath=i||nn.parseTrackName(t),this.node=nn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new nn.Composite(e,t,i):new nn(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace($Y,"")}static parseTrackName(e){const t=t$.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=i.nodeName.substring(r+1);n$.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){const i=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const l=i(a.children);if(l)return l}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[t++]=i[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,i=t.objectName,r=t.propertyName;let s=t.propertyIndex;if(e||(e=nn.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let h=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let f=0;f<e.length;f++)if(e[f].name===h){h=f;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(h!==void 0){if(e[h]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[h]}}const o=e[r];if(o===void 0){const h=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}nn.Composite=i$;nn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};nn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};nn.prototype.GetterByBindingType=[nn.prototype._getValue_direct,nn.prototype._getValue_array,nn.prototype._getValue_arrayElement,nn.prototype._getValue_toArray];nn.prototype.SetterByBindingTypeAndVersioning=[[nn.prototype._setValue_direct,nn.prototype._setValue_direct_setNeedsUpdate,nn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[nn.prototype._setValue_array,nn.prototype._setValue_array_setNeedsUpdate,nn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[nn.prototype._setValue_arrayElement,nn.prototype._setValue_arrayElement_setNeedsUpdate,nn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[nn.prototype._setValue_fromArray,nn.prototype._setValue_fromArray_setNeedsUpdate,nn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class r${constructor(){this.isAnimationObjectGroup=!0,this.uuid=es(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,i=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,h=this.nCachedObjects_;for(let f=0,d=arguments.length;f!==d;++f){const p=arguments[f],_=p.uuid;let v=t[_];if(v===void 0){v=l++,t[_]=v,e.push(p);for(let T=0,x=o;T!==x;++T)s[T].push(new nn(p,i[T],r[T]))}else if(v<h){a=e[v];const T=--h,x=e[T];t[x.uuid]=v,e[v]=x,t[_]=T,e[T]=p;for(let y=0,w=o;y!==w;++y){const E=s[y],I=E[T];let O=E[v];E[v]=I,O===void 0&&(O=new nn(p,i[y],r[y])),E[T]=O}}else e[v]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=h}remove(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],h=l.uuid,f=t[h];if(f!==void 0&&f>=s){const d=s++,p=e[d];t[p.uuid]=f,e[f]=p,t[h]=d,e[d]=l;for(let _=0,v=r;_!==v;++_){const T=i[_],x=T[d],y=T[f];T[f]=x,T[d]=y}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const h=arguments[a],f=h.uuid,d=t[f];if(d!==void 0)if(delete t[f],d<s){const p=--s,_=e[p],v=--o,T=e[v];t[_.uuid]=d,e[d]=_,t[T.uuid]=p,e[p]=T,e.pop();for(let x=0,y=r;x!==y;++x){const w=i[x],E=w[p],I=w[v];w[d]=E,w[p]=I,w.pop()}}else{const p=--o,_=e[p];p>0&&(t[_.uuid]=d),e[d]=_,e.pop();for(let v=0,T=r;v!==T;++v){const x=i[v];x[d]=x[p],x.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const i=this._bindingsIndicesByPath;let r=i[e];const s=this._bindings;if(r!==void 0)return s[r];const o=this._paths,a=this._parsedPaths,l=this._objects,h=l.length,f=this.nCachedObjects_,d=new Array(h);r=s.length,i[e]=r,o.push(e),a.push(t),s.push(d);for(let p=f,_=l.length;p!==_;++p){const v=l[p];d[p]=new nn(v,e,t)}return d}unsubscribe_(e){const t=this._bindingsIndicesByPath,i=t[e];if(i!==void 0){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],h=e[a];t[h]=i,o[i]=l,o.pop(),s[i]=s[a],s.pop(),r[i]=r[a],r.pop()}}}class mO{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:yu,endingEnd:yu};for(let h=0;h!==o;++h){const f=s[h].createInterpolant(null);a[h]=f,f.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=K3,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const r=this._clip.duration,s=e._clip.duration,o=s/r,a=r/s;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,h=a.sampleValues;return l[0]=s,l[1]=s+i,h[0]=e/o,h[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*i;l<0||i===0?t=0:(this._startTime=null,t=i*l)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,h=this._propertyBindings;switch(this.blendMode){case LT:for(let f=0,d=l.length;f!==d;++f)l[f].evaluate(o),h[f].accumulateAdditive(a);break;case Rv:default:for(let f=0,d=l.length;f!==d;++f)l[f].evaluate(o),h[f].accumulate(r,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const o=i===Q3;if(e===0)return s===-1?r:o&&(s&1)===1?t-r:r;if(i===$3){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const h=e<0;this._setEndings(h,!h,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return t-r}return r}_setEndings(e,t,i){const r=this._interpolantSettings;i?(r.endingStart=vu,r.endingEnd=vu):(e?r.endingStart=this.zeroSlopeAtStart?vu:yu:r.endingStart=mp,t?r.endingEnd=this.zeroSlopeAtEnd?vu:yu:r.endingEnd=mp)}_scheduleFading(e,t,i){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=i,this}}const s$=new Float32Array(1);class o$ extends ha{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=i.uuid,h=this._bindingsByRootAndName;let f=h[l];f===void 0&&(f={},h[l]=f);for(let d=0;d!==s;++d){const p=r[d],_=p.name;let v=f[_];if(v!==void 0)++v.referenceCount,o[d]=v;else{if(v=o[d],v!==void 0){v._cacheIndex===null&&(++v.referenceCount,this._addInactiveBinding(v,l,_));continue}const T=t&&t._propertyBindings[d].binding.parsedPath;v=new pO(nn.create(i,_,T),p.ValueTypeName,p.getValueSize()),++v.referenceCount,this._addInactiveBinding(v,l,_),o[d]=v}a[d].resultBuffer=v.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,i){const r=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,h=l[l.length-1],f=e._byClipCacheIndex;h._byClipCacheIndex=f,l[f]=h,l.pop(),e._byClipCacheIndex=null;const d=a.actionByRoot,p=(e._localRoot||this._root).uuid;delete d[p],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_addInactiveBinding(e,t,i){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];o===void 0&&(o={},r[t]=o),o[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,o=this._bindingsByRootAndName,a=o[r],l=t[t.length-1],h=e._cacheIndex;l._cacheIndex=h,t[h]=l,t.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return i===void 0&&(i=new sM(new Float32Array(2),new Float32Array(2),1,s$),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=i,t[i]=s}clipAction(e,t,i){const r=t||this._root,s=r.uuid;let o=typeof e=="string"?Rp.findByName(r,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let h=null;if(i===void 0&&(o!==null?i=o.blendMode:i=Rv),l!==void 0){const d=l.actionByRoot[s];if(d!==void 0&&d.blendMode===i)return d;h=l.knownActions[0],o===null&&(o=h._clip)}if(o===null)return null;const f=new mO(this,o,t,i);return this._bindAction(f,h),this._addInactiveAction(f,a,s),f}existingAction(e,t){const i=t||this._root,r=i.uuid,s=typeof e=="string"?Rp.findByName(i,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let i=t-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const t=this._actions,i=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let h=0;h!==i;++h)t[h]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let h=0;h!==l;++h)a[h].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const h=o[a];this._deactivateAction(h);const f=h._cacheIndex,d=t[t.length-1];h._cacheIndex=null,h._byClipCacheIndex=null,d._cacheIndex=f,t[f]=d,t.pop(),this._removeInactiveBindingsForAction(h)}delete r[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const o in i){const a=i[o].actionByRoot,l=a[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const r=this._bindingsByRootAndName,s=r[t];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const i=this.existingAction(e,t);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class dM{constructor(e){this.value=e}clone(){return new dM(this.value.clone===void 0?this.value:this.value.clone())}}let a$=0;class l$ extends ha{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:a$++}),this.name="",this.usage=vp,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let i=0,r=t.length;i<r;i++){const s=Array.isArray(t[i])?t[i]:[t[i]];for(let o=0;o<s.length;o++)this.uniforms.push(s[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class u$ extends Dv{constructor(e,t,i=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class c${constructor(e,t,i,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=i,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class gO{constructor(e,t,i=0,r=1/0){this.ray=new Ku(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new Iu,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return Pw(e,this,i,t),i.sort(qP),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)Pw(e[r],this,i,t);return i.sort(qP),i}}function qP(n,e){return n.distance-e.distance}function Pw(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),i===!0){const r=n.children;for(let s=0,o=r.length;s<o;s++)Pw(r[s],e,t,!0)}}class Vy{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(qn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class h${constructor(e=1,t=0,i=0){return this.radius=e,this.theta=t,this.y=i,this}set(e,t,i){return this.radius=e,this.theta=t,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=t,this}clone(){return new this.constructor().copy(this)}}const XP=new ge;class f${constructor(e=new ge(1/0,1/0),t=new ge(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=XP.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,XP).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const YP=new G,t_=new G;class d${constructor(e=new G,t=new G){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){YP.subVectors(e,this.start),t_.subVectors(this.end,this.start);const i=t_.dot(t_);let s=t_.dot(YP)/i;return t&&(s=qn(s,0,1)),s}closestPointToPoint(e,t,i){const r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const $P=new G;class p$ extends ln{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const i=new Ht,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const h=o/l*Math.PI*2,f=a/l*Math.PI*2;r.push(Math.cos(h),Math.sin(h),1,Math.cos(f),Math.sin(f),1)}i.setAttribute("position",new lt(r,3));const s=new Sr({fog:!1,toneMapped:!1});this.cone=new To(i,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),$P.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt($P),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Ia=new G,n_=new Mt,hS=new Mt;class m$ extends To{constructor(e){const t=_O(e),i=new Ht,r=[],s=[],o=new Ye(0,0,1),a=new Ye(0,1,0);for(let h=0;h<t.length;h++){const f=t[h];f.parent&&f.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}i.setAttribute("position",new lt(r,3)),i.setAttribute("color",new lt(s,3));const l=new Sr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,i=this.geometry,r=i.getAttribute("position");hS.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(n_.multiplyMatrices(hS,a.matrixWorld),Ia.setFromMatrixPosition(n_),r.setXYZ(o,Ia.x,Ia.y,Ia.z),n_.multiplyMatrices(hS,a.parent.matrixWorld),Ia.setFromMatrixPosition(n_),r.setXYZ(o+1,Ia.x,Ia.y,Ia.z),o+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function _O(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,_O(n.children[t]));return e}class g$ extends ui{constructor(e,t,i){const r=new tm(t,4,2),s=new Cl({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const _$=new G,KP=new Ye,QP=new Ye;class y$ extends ln{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const r=new em(t);r.rotateY(Math.PI*.5),this.material=new Cl({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(s.count*3);r.setAttribute("color",new mn(o,3)),this.add(new ui(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");KP.copy(this.light.color),QP.copy(this.light.groundColor);for(let i=0,r=t.count;i<r;i++){const s=i<r/2?KP:QP;t.setXYZ(i,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(_$.setFromMatrixPosition(this.light.matrixWorld).negate())}}class v$ extends To{constructor(e=10,t=10,i=4473924,r=8947848){i=new Ye(i),r=new Ye(r);const s=t/2,o=e/t,a=e/2,l=[],h=[];for(let p=0,_=0,v=-a;p<=t;p++,v+=o){l.push(-a,0,v,a,0,v),l.push(v,0,-a,v,0,a);const T=p===s?i:r;T.toArray(h,_),_+=3,T.toArray(h,_),_+=3,T.toArray(h,_),_+=3,T.toArray(h,_),_+=3}const f=new Ht;f.setAttribute("position",new lt(l,3)),f.setAttribute("color",new lt(h,3));const d=new Sr({vertexColors:!0,toneMapped:!1});super(f,d),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class x$ extends To{constructor(e=10,t=16,i=8,r=64,s=4473924,o=8947848){s=new Ye(s),o=new Ye(o);const a=[],l=[];if(t>1)for(let d=0;d<t;d++){const p=d/t*(Math.PI*2),_=Math.sin(p)*e,v=Math.cos(p)*e;a.push(0,0,0),a.push(_,0,v);const T=d&1?s:o;l.push(T.r,T.g,T.b),l.push(T.r,T.g,T.b)}for(let d=0;d<i;d++){const p=d&1?s:o,_=e-e/i*d;for(let v=0;v<r;v++){let T=v/r*(Math.PI*2),x=Math.sin(T)*_,y=Math.cos(T)*_;a.push(x,0,y),l.push(p.r,p.g,p.b),T=(v+1)/r*(Math.PI*2),x=Math.sin(T)*_,y=Math.cos(T)*_,a.push(x,0,y),l.push(p.r,p.g,p.b)}}const h=new Ht;h.setAttribute("position",new lt(a,3)),h.setAttribute("color",new lt(l,3));const f=new Sr({vertexColors:!0,toneMapped:!1});super(h,f),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const JP=new G,i_=new G,ZP=new G;class S$ extends ln{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new Ht;r.setAttribute("position",new lt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new Sr({fog:!1,toneMapped:!1});this.lightPlane=new gl(r,s),this.add(this.lightPlane),r=new Ht,r.setAttribute("position",new lt([0,0,0,0,0,1],3)),this.targetLine=new gl(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),JP.setFromMatrixPosition(this.light.matrixWorld),i_.setFromMatrixPosition(this.light.target.matrixWorld),ZP.subVectors(i_,JP),this.lightPlane.lookAt(i_),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(i_),this.targetLine.scale.z=ZP.length()}}const r_=new G,Wn=new Kp;class E$ extends To{constructor(e){const t=new Ht,i=new Sr({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(v,T){l(v),l(T)}function l(v){r.push(0,0,0),s.push(0,0,0),o[v]===void 0&&(o[v]=[]),o[v].push(r.length/3-1)}t.setAttribute("position",new lt(r,3)),t.setAttribute("color",new lt(s,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const h=new Ye(16755200),f=new Ye(16711680),d=new Ye(43775),p=new Ye(16777215),_=new Ye(3355443);this.setColors(h,f,d,p,_)}setColors(e,t,i,r,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,i.r,i.g,i.b),a.setXYZ(33,i.r,i.g,i.b),a.setXYZ(34,i.r,i.g,i.b),a.setXYZ(35,i.r,i.g,i.b),a.setXYZ(36,i.r,i.g,i.b),a.setXYZ(37,i.r,i.g,i.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,i=1,r=1;Wn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Qn("c",t,e,Wn,0,0,-1),Qn("t",t,e,Wn,0,0,1),Qn("n1",t,e,Wn,-i,-r,-1),Qn("n2",t,e,Wn,i,-r,-1),Qn("n3",t,e,Wn,-i,r,-1),Qn("n4",t,e,Wn,i,r,-1),Qn("f1",t,e,Wn,-i,-r,1),Qn("f2",t,e,Wn,i,-r,1),Qn("f3",t,e,Wn,-i,r,1),Qn("f4",t,e,Wn,i,r,1),Qn("u1",t,e,Wn,i*.7,r*1.1,-1),Qn("u2",t,e,Wn,-i*.7,r*1.1,-1),Qn("u3",t,e,Wn,0,r*2,-1),Qn("cf1",t,e,Wn,-i,0,1),Qn("cf2",t,e,Wn,i,0,1),Qn("cf3",t,e,Wn,0,-r,1),Qn("cf4",t,e,Wn,0,r,1),Qn("cn1",t,e,Wn,-i,0,-1),Qn("cn2",t,e,Wn,i,0,-1),Qn("cn3",t,e,Wn,0,-r,-1),Qn("cn4",t,e,Wn,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Qn(n,e,t,i,r,s,o){r_.set(r,s,o).unproject(i);const a=e[n];if(a!==void 0){const l=t.getAttribute("position");for(let h=0,f=a.length;h<f;h++)l.setXYZ(a[h],r_.x,r_.y,r_.z)}}const s_=new yr;class w$ extends To{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),s=new Ht;s.setIndex(new mn(i,1)),s.setAttribute("position",new mn(r,3)),super(s,new Sr({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&s_.setFromObject(this.object),s_.isEmpty())return;const t=s_.min,i=s_.max,r=this.geometry.attributes.position,s=r.array;s[0]=i.x,s[1]=i.y,s[2]=i.z,s[3]=t.x,s[4]=i.y,s[5]=i.z,s[6]=t.x,s[7]=t.y,s[8]=i.z,s[9]=i.x,s[10]=t.y,s[11]=i.z,s[12]=i.x,s[13]=i.y,s[14]=t.z,s[15]=t.x,s[16]=i.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=i.x,s[22]=t.y,s[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class T$ extends To{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Ht;s.setIndex(new mn(i,1)),s.setAttribute("position",new lt(r,3)),super(s,new Sr({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class M$ extends gl{constructor(e,t=1,i=16776960){const r=i,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new Ht;o.setAttribute("position",new lt(s,3)),o.computeBoundingSphere(),super(o,new Sr({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new Ht;l.setAttribute("position",new lt(a,3)),l.computeBoundingSphere(),this.add(new ui(l,new Cl({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const eb=new G;let o_,fS;class A$ extends ln{constructor(e=new G(0,0,1),t=new G(0,0,0),i=1,r=16776960,s=i*.2,o=s*.2){super(),this.type="ArrowHelper",o_===void 0&&(o_=new Ht,o_.setAttribute("position",new lt([0,0,0,0,1,0],3)),fS=new ff(0,.5,1,5,1),fS.translate(0,-.5,0)),this.position.copy(t),this.line=new gl(o_,new Sr({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ui(fS,new Cl({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{eb.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(eb,t)}}setLength(e,t=e*.2,i=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class C$ extends To{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Ht;r.setAttribute("position",new lt(t,3)),r.setAttribute("color",new lt(i,3));const s=new Sr({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,t,i){const r=new Ye,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class R${constructor(){this.type="ShapePath",this.color=new Ye,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Ep,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,s,o){return this.currentPath.bezierCurveTo(e,t,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(y){const w=[];for(let E=0,I=y.length;E<I;E++){const O=y[E],D=new bu;D.curves=O.curves,w.push(D)}return w}function i(y,w){const E=w.length;let I=!1;for(let O=E-1,D=0;D<E;O=D++){let R=w[O],b=w[D],k=b.x-R.x,M=b.y-R.y;if(Math.abs(M)>Number.EPSILON){if(M<0&&(R=w[D],k=-k,b=w[O],M=-M),y.y<R.y||y.y>b.y)continue;if(y.y===R.y){if(y.x===R.x)return!0}else{const P=M*(y.x-R.x)-k*(y.y-R.y);if(P===0)return!0;if(P<0)continue;I=!I}}else{if(y.y!==R.y)continue;if(b.x<=y.x&&y.x<=R.x||R.x<=y.x&&y.x<=b.x)return!0}}return I}const r=So.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const h=[];if(s.length===1)return a=s[0],l=new bu,l.curves=a.curves,h.push(l),h;let f=!r(s[0].getPoints());f=e?!f:f;const d=[],p=[];let _=[],v=0,T;p[v]=void 0,_[v]=[];for(let y=0,w=s.length;y<w;y++)a=s[y],T=a.getPoints(),o=r(T),o=e?!o:o,o?(!f&&p[v]&&v++,p[v]={s:new bu,p:T},p[v].s.curves=a.curves,f&&v++,_[v]=[]):_[v].push({h:a,p:T[0]});if(!p[0])return t(s);if(p.length>1){let y=!1,w=0;for(let E=0,I=p.length;E<I;E++)d[E]=[];for(let E=0,I=p.length;E<I;E++){const O=_[E];for(let D=0;D<O.length;D++){const R=O[D];let b=!0;for(let k=0;k<p.length;k++)i(R.p,p[k].p)&&(E!==k&&w++,b?(b=!1,d[k].push(R)):y=!0);b&&d[E].push(R)}}w>0&&y===!1&&(_=d)}let x;for(let y=0,w=p.length;y<w;y++){l=p[y].s,h.push(l),x=_[y];for(let E=0,I=x.length;E<I;E++)l.holes.push(x[E].h)}return h}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:lf}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=lf);const I$=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:TT,AddEquation:Fa,AddOperation:D3,AdditiveAnimationBlendMode:LT,AdditiveBlending:Ly,AgXToneMapping:V3,AlphaFormat:G3,AlwaysCompare:ak,AlwaysDepth:C3,AlwaysStencilFunc:vw,AmbientLight:aO,AnimationAction:mO,AnimationClip:Rp,AnimationLoader:LY,AnimationMixer:o$,AnimationObjectGroup:r$,AnimationUtils:RY,ArcCurve:Nk,ArrayCamera:wk,ArrowHelper:A$,AttachedBindMode:XE,Audio:dO,AudioAnalyser:YY,AudioContext:uM,AudioListener:jY,AudioLoader:HY,AxesHelper:C$,BackSide:_r,BasicDepthPacking:J3,BasicShadowMap:u3,BatchedMesh:Pk,Bone:YT,BooleanKeyframeTrack:Ju,Box2:f$,Box3:yr,Box3Helper:T$,BoxGeometry:Qu,BoxHelper:w$,BufferAttribute:mn,BufferGeometry:Ht,BufferGeometryLoader:fO,ByteType:B3,Cache:Xo,Camera:Kp,CameraHelper:E$,CanvasTexture:JX,CapsuleGeometry:Fv,CatmullRomCurve3:Dk,CineonToneMapping:U3,CircleGeometry:Vv,ClampToEdgeWrapping:Zi,Clock:cM,Color:Ye,ColorKeyframeTrack:oM,ColorManagement:dn,CompressedArrayTexture:KX,CompressedCubeTexture:QX,CompressedTexture:Ov,CompressedTextureLoader:NY,ConeGeometry:zv,ConstantAlphaFactor:T3,ConstantColorFactor:E3,CubeCamera:pk,CubeReflectionMapping:oa,CubeRefractionMapping:ml,CubeTexture:Qp,CubeTextureLoader:DY,CubeUVReflectionMapping:uf,CubicBezierCurve:QT,CubicBezierCurve3:kk,CubicInterpolant:Zk,CullFaceBack:HE,CullFaceFront:l3,CullFaceFrontBack:V9,CullFaceNone:a3,Curve:Ks,CurvePath:Uk,CustomBlending:c3,CustomToneMapping:F3,CylinderGeometry:ff,Cylindrical:h$,Data3DTexture:FT,DataArrayTexture:Pv,DataTexture:Pu,DataTextureLoader:kY,DataUtils:q8,DecrementStencilOp:K9,DecrementWrapStencilOp:J9,DefaultLoadingManager:nO,DepthFormat:il,DepthStencilFormat:Gu,DepthTexture:HT,DetachedBindMode:z3,DirectionalLight:oO,DirectionalLightHelper:S$,DiscreteInterpolant:eO,DisplayP3ColorSpace:Iv,DodecahedronGeometry:Bv,DoubleSide:lo,DstAlphaFactor:_3,DstColorFactor:v3,DynamicCopyUsage:f8,DynamicDrawUsage:xw,DynamicReadUsage:u8,EdgesGeometry:Fk,EllipseCurve:Uv,EqualCompare:ik,EqualDepth:I3,EqualStencilFunc:n8,EquirectangularReflectionMapping:up,EquirectangularRefractionMapping:cp,Euler:$p,EventDispatcher:ha,ExtrudeGeometry:Gv,FileLoader:aa,Float16BufferAttribute:J8,Float32BufferAttribute:lt,Float64BufferAttribute:Z8,FloatType:Ss,Fog:Nv,FogExp2:Lv,FramebufferTexture:$X,FrontSide:sa,Frustum:Jp,GLBufferAttribute:c$,GLSL1:p8,GLSL3:Sw,GreaterCompare:rk,GreaterDepth:b3,GreaterEqualCompare:ok,GreaterEqualDepth:P3,GreaterEqualStencilFunc:o8,GreaterStencilFunc:r8,GridHelper:v$,Group:mh,HalfFloatType:jh,HemisphereLight:iO,HemisphereLightHelper:y$,IcosahedronGeometry:Wv,ImageBitmapLoader:BY,ImageLoader:Ip,ImageUtils:UT,IncrementStencilOp:$9,IncrementWrapStencilOp:Q9,InstancedBufferAttribute:Yh,InstancedBufferGeometry:hO,InstancedInterleavedBuffer:u$,InstancedMesh:Ik,Int16BufferAttribute:K8,Int32BufferAttribute:Q8,Int8BufferAttribute:X8,IntType:MT,InterleavedBuffer:Dv,InterleavedBufferAttribute:Wu,Interpolant:nm,InterpolateDiscrete:dp,InterpolateLinear:pp,InterpolateSmooth:V_,InvertStencilOp:Z9,KeepStencilOp:lu,KeyframeTrack:Qs,LOD:Ck,LatheGeometry:Zp,Layers:Iu,LessCompare:nk,LessDepth:R3,LessEqualCompare:DT,LessEqualDepth:lp,LessEqualStencilFunc:i8,LessStencilFunc:t8,Light:Il,LightProbe:cO,Line:gl,Line3:d$,LineBasicMaterial:Sr,LineCurve:JT,LineCurve3:Ok,LineDashedMaterial:Kk,LineLoop:bk,LineSegments:To,LinearDisplayP3ColorSpace:Yp,LinearEncoding:NT,LinearFilter:On,LinearInterpolant:sM,LinearMipMapLinearFilter:G9,LinearMipMapNearestFilter:H9,LinearMipmapLinearFilter:uo,LinearMipmapNearestFilter:Ld,LinearSRGBColorSpace:wo,LinearToneMapping:k3,LinearTransfer:gp,Loader:kr,LoaderUtils:Iw,LoadingManager:aM,LoopOnce:$3,LoopPingPong:Q3,LoopRepeat:K3,LuminanceAlphaFormat:j3,LuminanceFormat:W3,MOUSE:ou,Material:ir,MaterialLoader:Jv,MathUtils:OT,Matrix3:Bt,Matrix4:Mt,MaxEquation:qE,Mesh:ui,MeshBasicMaterial:Cl,MeshDepthMaterial:GT,MeshDistanceMaterial:WT,MeshLambertMaterial:iM,MeshMatcapMaterial:$k,MeshNormalMaterial:Yk,MeshPhongMaterial:qk,MeshPhysicalMaterial:jk,MeshStandardMaterial:nM,MeshToonMaterial:Xk,MinEquation:jE,MirroredRepeatWrapping:fp,MixOperation:N3,MultiplyBlending:WE,MultiplyOperation:Xp,NearestFilter:Zn,NearestMipMapLinearFilter:B9,NearestMipMapNearestFilter:z9,NearestMipmapLinearFilter:hu,NearestMipmapNearestFilter:ky,NeverCompare:tk,NeverDepth:A3,NeverStencilFunc:e8,NoBlending:Ko,NoColorSpace:$r,NoToneMapping:vo,NormalAnimationBlendMode:Rv,NormalBlending:Au,NotEqualCompare:sk,NotEqualDepth:L3,NotEqualStencilFunc:s8,NumberKeyframeTrack:Ap,Object3D:ln,ObjectLoader:VY,ObjectSpaceNormalMap:ek,OctahedronGeometry:em,OneFactor:p3,OneMinusConstantAlphaFactor:M3,OneMinusConstantColorFactor:w3,OneMinusDstAlphaFactor:y3,OneMinusDstColorFactor:x3,OneMinusSrcAlphaFactor:Dy,OneMinusSrcColorFactor:g3,OrthographicCamera:sl,P3Primaries:yp,PCFShadowMap:Mv,PCFSoftShadowMap:bd,PMREMGenerator:ww,Path:Ep,PerspectiveCamera:ti,Plane:zo,PlaneGeometry:cf,PlaneHelper:M$,PointLight:sO,PointLightHelper:g$,Points:Lk,PointsMaterial:$T,PolarGridHelper:x$,PolyhedronGeometry:Rl,PositionalAudio:XY,PropertyBinding:nn,PropertyMixer:pO,QuadraticBezierCurve:ZT,QuadraticBezierCurve3:eM,Quaternion:gi,QuaternionKeyframeTrack:df,QuaternionLinearInterpolant:tO,RED_GREEN_RGTC2_Format:_w,RED_RGTC1_Format:Y3,REVISION:lf,RGBADepthPacking:Z3,RGBAFormat:pr,RGBAIntegerFormat:PT,RGBA_ASTC_10x10_Format:hw,RGBA_ASTC_10x5_Format:lw,RGBA_ASTC_10x6_Format:uw,RGBA_ASTC_10x8_Format:cw,RGBA_ASTC_12x10_Format:fw,RGBA_ASTC_12x12_Format:dw,RGBA_ASTC_4x4_Format:ew,RGBA_ASTC_5x4_Format:tw,RGBA_ASTC_5x5_Format:nw,RGBA_ASTC_6x5_Format:iw,RGBA_ASTC_6x6_Format:rw,RGBA_ASTC_8x5_Format:sw,RGBA_ASTC_8x6_Format:ow,RGBA_ASTC_8x8_Format:aw,RGBA_BPTC_Format:F_,RGBA_ETC2_EAC_Format:ZE,RGBA_PVRTC_2BPPV1_Format:QE,RGBA_PVRTC_4BPPV1_Format:KE,RGBA_S3TC_DXT1_Format:k_,RGBA_S3TC_DXT3_Format:O_,RGBA_S3TC_DXT5_Format:U_,RGB_BPTC_SIGNED_Format:pw,RGB_BPTC_UNSIGNED_Format:mw,RGB_ETC1_Format:bT,RGB_ETC2_Format:JE,RGB_PVRTC_2BPPV1_Format:$E,RGB_PVRTC_4BPPV1_Format:YE,RGB_S3TC_DXT1_Format:D_,RGFormat:X3,RGIntegerFormat:IT,RawShaderMaterial:Wk,Ray:Ku,Raycaster:gO,Rec709Primaries:_p,RectAreaLight:lO,RedFormat:q3,RedIntegerFormat:RT,ReinhardToneMapping:O3,RenderTarget:ck,RepeatWrapping:hp,ReplaceStencilOp:Y9,ReverseSubtractEquation:f3,RingGeometry:jv,SIGNED_RED_GREEN_RGTC2_Format:yw,SIGNED_RED_RGTC1_Format:gw,SRGBColorSpace:di,SRGBTransfer:yn,Scene:qT,ShaderChunk:Vt,ShaderLib:Hs,ShaderMaterial:ns,ShadowMaterial:Gk,Shape:bu,ShapeGeometry:qv,ShapePath:R$,ShapeUtils:So,ShortType:H3,Skeleton:kv,SkeletonHelper:m$,SkinnedMesh:Rk,Source:xu,Sphere:er,SphereGeometry:tm,Spherical:Vy,SphericalHarmonics3:uO,SplineCurve:tM,SpotLight:rO,SpotLightHelper:p$,Sprite:Ak,SpriteMaterial:XT,SrcAlphaFactor:Ny,SrcAlphaSaturateFactor:S3,SrcColorFactor:m3,StaticCopyUsage:h8,StaticDrawUsage:vp,StaticReadUsage:l8,StereoCamera:GY,StreamCopyUsage:d8,StreamDrawUsage:a8,StreamReadUsage:c8,StringKeyframeTrack:Zu,SubtractEquation:h3,SubtractiveBlending:GE,TOUCH:au,TangentSpaceNormalMap:Al,TetrahedronGeometry:Xv,Texture:Pn,TextureLoader:Qv,TorusGeometry:Yv,TorusKnotGeometry:$v,Triangle:Kr,TriangleFanDrawMode:q9,TriangleStripDrawMode:j9,TrianglesDrawMode:W9,TubeGeometry:Kv,UVMapping:Av,Uint16BufferAttribute:VT,Uint32BufferAttribute:zT,Uint8BufferAttribute:Y8,Uint8ClampedBufferAttribute:$8,Uniform:dM,UniformsGroup:l$,UniformsLib:Fe,UniformsUtils:dk,UnsignedByteType:xo,UnsignedInt248Type:nl,UnsignedIntType:qo,UnsignedShort4444Type:AT,UnsignedShort5551Type:CT,UnsignedShortType:Cv,VSMShadowMap:Fs,Vector2:ge,Vector3:G,Vector4:cn,VectorKeyframeTrack:Cp,VideoTexture:YX,WebGL1Renderer:Tk,WebGL3DRenderTarget:D8,WebGLArrayRenderTarget:N8,WebGLCoordinateSystem:co,WebGLCubeRenderTarget:mk,WebGLMultipleRenderTargets:k8,WebGLRenderTarget:$s,WebGLRenderer:jT,WebGLUtils:Ek,WebGPUCoordinateSystem:xp,WireframeGeometry:Hk,WrapAroundEnding:mp,ZeroCurvatureEnding:yu,ZeroFactor:d3,ZeroSlopeEnding:vu,ZeroStencilOp:X9,_SRGBAFormat:Oy,createCanvasElement:uk,sRGBEncoding:rl},Symbol.toStringTag,{value:"Module"}));var yO={exports:{}},ec={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */ec.ConcurrentRoot=1;ec.ContinuousEventPriority=4;ec.DefaultEventPriority=16;ec.DiscreteEventPriority=1;ec.IdleEventPriority=536870912;ec.LegacyRoot=0;yO.exports=ec;var _h=yO.exports;function P$(n){let e;const t=new Set,i=(h,f)=>{const d=typeof h=="function"?h(e):h;if(d!==e){const p=e;e=f?d:Object.assign({},e,d),t.forEach(_=>_(e,p))}},r=()=>e,s=(h,f=r,d=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let p=f(e);function _(){const v=f(e);if(!d(p,v)){const T=p;h(p=v,T)}}return t.add(_),()=>t.delete(_)},l={setState:i,getState:r,subscribe:(h,f,d)=>f||d?s(h,f,d):(t.add(h),()=>t.delete(h)),destroy:()=>t.clear()};return e=n(i,r,l),l}const b$=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),tb=b$?pe.useEffect:pe.useLayoutEffect;function L$(n){const e=typeof n=="function"?P$(n):n,t=(i=e.getState,r=Object.is)=>{const[,s]=pe.useReducer(x=>x+1,0),o=e.getState(),a=pe.useRef(o),l=pe.useRef(i),h=pe.useRef(r),f=pe.useRef(!1),d=pe.useRef();d.current===void 0&&(d.current=i(o));let p,_=!1;(a.current!==o||l.current!==i||h.current!==r||f.current)&&(p=i(o),_=!r(d.current,p)),tb(()=>{_&&(d.current=p),a.current=o,l.current=i,h.current=r,f.current=!1});const v=pe.useRef(o);tb(()=>{const x=()=>{try{const w=e.getState(),E=l.current(w);h.current(d.current,E)||(a.current=w,d.current=E,s())}catch{f.current=!0,s()}},y=e.subscribe(x);return e.getState()!==v.current&&x(),y},[]);const T=_?p:d.current;return pe.useDebugValue(T),T};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const i=[t,e];return{next(){const r=i.length<=0;return{value:i.shift(),done:r}}}},t}const N$=n=>typeof n=="object"&&typeof n.then=="function",Eu=[];function vO(n,e,t=(i,r)=>i===r){if(n===e)return!0;if(!n||!e)return!1;const i=n.length;if(e.length!==i)return!1;for(let r=0;r<i;r++)if(!t(n[r],e[r]))return!1;return!0}function xO(n,e=null,t=!1,i={}){e===null&&(e=[n]);for(const s of Eu)if(vO(e,s.keys,s.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return i.lifespan&&i.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,i.lifespan)),s.response;if(!t)throw s.promise}const r={keys:e,equal:i.equal,remove:()=>{const s=Eu.indexOf(r);s!==-1&&Eu.splice(s,1)},promise:(N$(n)?n:n(...e)).then(s=>{r.response=s,i.lifespan&&i.lifespan>0&&(r.timeout=setTimeout(r.remove,i.lifespan))}).catch(s=>r.error=s)};if(Eu.push(r),!t)throw r.promise}const D$=(n,e,t)=>xO(n,e,!1,t),k$=(n,e,t)=>void xO(n,e,!0,t),O$=n=>{if(n===void 0||n.length===0)Eu.splice(0,Eu.length);else{const e=Eu.find(t=>vO(n,t.keys,t.equal));e&&e.remove()}};var SO={exports:{}},EO={exports:{}},wO={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(W,K){var Q=W.length;W.push(K);e:for(;0<Q;){var ee=Q-1>>>1,_e=W[ee];if(0<r(_e,K))W[ee]=K,W[Q]=_e,Q=ee;else break e}}function t(W){return W.length===0?null:W[0]}function i(W){if(W.length===0)return null;var K=W[0],Q=W.pop();if(Q!==K){W[0]=Q;e:for(var ee=0,_e=W.length,Ne=_e>>>1;ee<Ne;){var oe=2*(ee+1)-1,xe=W[oe],Le=oe+1,ze=W[Le];if(0>r(xe,Q))Le<_e&&0>r(ze,xe)?(W[ee]=ze,W[Le]=Q,ee=Le):(W[ee]=xe,W[oe]=Q,ee=oe);else if(Le<_e&&0>r(ze,Q))W[ee]=ze,W[Le]=Q,ee=Le;else break e}}return K}function r(W,K){var Q=W.sortIndex-K.sortIndex;return Q!==0?Q:W.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],h=[],f=1,d=null,p=3,_=!1,v=!1,T=!1,x=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(W){for(var K=t(h);K!==null;){if(K.callback===null)i(h);else if(K.startTime<=W)i(h),K.sortIndex=K.expirationTime,e(l,K);else break;K=t(h)}}function I(W){if(T=!1,E(W),!v)if(t(l)!==null)v=!0,se(O);else{var K=t(h);K!==null&&ye(I,K.startTime-W)}}function O(W,K){v=!1,T&&(T=!1,y(b),b=-1),_=!0;var Q=p;try{for(E(K),d=t(l);d!==null&&(!(d.expirationTime>K)||W&&!P());){var ee=d.callback;if(typeof ee=="function"){d.callback=null,p=d.priorityLevel;var _e=ee(d.expirationTime<=K);K=n.unstable_now(),typeof _e=="function"?d.callback=_e:d===t(l)&&i(l),E(K)}else i(l);d=t(l)}if(d!==null)var Ne=!0;else{var oe=t(h);oe!==null&&ye(I,oe.startTime-K),Ne=!1}return Ne}finally{d=null,p=Q,_=!1}}var D=!1,R=null,b=-1,k=5,M=-1;function P(){return!(n.unstable_now()-M<k)}function V(){if(R!==null){var W=n.unstable_now();M=W;var K=!0;try{K=R(!0,W)}finally{K?F():(D=!1,R=null)}}else D=!1}var F;if(typeof w=="function")F=function(){w(V)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,re=Y.port2;Y.port1.onmessage=V,F=function(){re.postMessage(null)}}else F=function(){x(V,0)};function se(W){R=W,D||(D=!0,F())}function ye(W,K){b=x(function(){W(n.unstable_now())},K)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(W){W.callback=null},n.unstable_continueExecution=function(){v||_||(v=!0,se(O))},n.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<W?Math.floor(1e3/W):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(W){switch(p){case 1:case 2:case 3:var K=3;break;default:K=p}var Q=p;p=K;try{return W()}finally{p=Q}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(W,K){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Q=p;p=W;try{return K()}finally{p=Q}},n.unstable_scheduleCallback=function(W,K,Q){var ee=n.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?ee+Q:ee):Q=ee,W){case 1:var _e=-1;break;case 2:_e=250;break;case 5:_e=1073741823;break;case 4:_e=1e4;break;default:_e=5e3}return _e=Q+_e,W={id:f++,callback:K,priorityLevel:W,startTime:Q,expirationTime:_e,sortIndex:-1},Q>ee?(W.sortIndex=Q,e(h,W),t(l)===null&&W===t(h)&&(T?(y(b),b=-1):T=!0,ye(I,Q-ee))):(W.sortIndex=_e,e(l,W),v||_||(v=!0,se(O))),W},n.unstable_shouldYield=P,n.unstable_wrapCallback=function(W){var K=p;return function(){var Q=p;p=K;try{return W.apply(this,arguments)}finally{p=Q}}}})(wO);EO.exports=wO;var bw=EO.exports;/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U$=function(e){var t={},i=pe,r=bw,s=Object.assign;function o(u){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+u,g=1;g<arguments.length;g++)c+="&args[]="+encodeURIComponent(arguments[g]);return"Minified React error #"+u+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),h=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),v=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),y=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),I=Symbol.for("react.offscreen"),O=Symbol.iterator;function D(u){return u===null||typeof u!="object"?null:(u=O&&u[O]||u["@@iterator"],typeof u=="function"?u:null)}function R(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case f:return"Fragment";case h:return"Portal";case p:return"Profiler";case d:return"StrictMode";case x:return"Suspense";case y:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case v:return(u.displayName||"Context")+".Consumer";case _:return(u._context.displayName||"Context")+".Provider";case T:var c=u.render;return u=u.displayName,u||(u=c.displayName||c.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case w:return c=u.displayName||null,c!==null?c:R(u.type)||"Memo";case E:c=u._payload,u=u._init;try{return R(u(c))}catch{}}return null}function b(u){var c=u.type;switch(u.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=c.render,u=u.displayName||u.name||"",c.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return R(c);case 8:return c===d?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function k(u){var c=u,g=u;if(u.alternate)for(;c.return;)c=c.return;else{u=c;do c=u,c.flags&4098&&(g=c.return),u=c.return;while(u)}return c.tag===3?g:null}function M(u){if(k(u)!==u)throw Error(o(188))}function P(u){var c=u.alternate;if(!c){if(c=k(u),c===null)throw Error(o(188));return c!==u?null:u}for(var g=u,S=c;;){var A=g.return;if(A===null)break;var L=A.alternate;if(L===null){if(S=A.return,S!==null){g=S;continue}break}if(A.child===L.child){for(L=A.child;L;){if(L===g)return M(A),u;if(L===S)return M(A),c;L=L.sibling}throw Error(o(188))}if(g.return!==S.return)g=A,S=L;else{for(var j=!1,J=A.child;J;){if(J===g){j=!0,g=A,S=L;break}if(J===S){j=!0,S=A,g=L;break}J=J.sibling}if(!j){for(J=L.child;J;){if(J===g){j=!0,g=L,S=A;break}if(J===S){j=!0,S=L,g=A;break}J=J.sibling}if(!j)throw Error(o(189))}}if(g.alternate!==S)throw Error(o(190))}if(g.tag!==3)throw Error(o(188));return g.stateNode.current===g?u:c}function V(u){return u=P(u),u!==null?F(u):null}function F(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var c=F(u);if(c!==null)return c;u=u.sibling}return null}function Y(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){if(u.tag!==4){var c=Y(u);if(c!==null)return c}u=u.sibling}return null}var re=Array.isArray,se=e.getPublicInstance,ye=e.getRootHostContext,W=e.getChildHostContext,K=e.prepareForCommit,Q=e.resetAfterCommit,ee=e.createInstance,_e=e.appendInitialChild,Ne=e.finalizeInitialChildren,oe=e.prepareUpdate,xe=e.shouldSetTextContent,Le=e.createTextInstance,ze=e.scheduleTimeout,at=e.cancelTimeout,Ze=e.noTimeout,St=e.isPrimaryRenderer,nt=e.supportsMutation,X=e.supportsPersistence,Ce=e.supportsHydration,me=e.getInstanceFromNode,Pe=e.preparePortalMount,ve=e.getCurrentEventPriority,st=e.detachDeletedInstance,Be=e.supportsMicrotasks,z=e.scheduleMicrotask,U=e.supportsTestSelectors,te=e.findFiberRoot,Ie=e.getBoundingRect,Ae=e.getTextContent,Ee=e.isHiddenSubtree,Ke=e.matchAccessibilityRole,Ue=e.setFocusIfFocusable,je=e.setupIntersectionObserver,ct=e.appendChild,Rt=e.appendChildToContainer,Re=e.commitTextUpdate,Gt=e.commitMount,Nt=e.commitUpdate,gt=e.insertBefore,ut=e.insertInContainerBefore,$e=e.removeChild,$=e.removeChildFromContainer,we=e.resetTextContent,Ve=e.hideInstance,Ge=e.hideTextInstance,mt=e.unhideInstance,q=e.unhideTextInstance,Me=e.clearContainer,De=e.cloneInstance,Qe=e.createContainerChildSet,Je=e.appendChildToContainerChildSet,kt=e.finalizeContainerChildren,jt=e.replaceContainerChildren,en=e.cloneHiddenInstance,bn=e.cloneHiddenTextInstance,Kt=e.canHydrateInstance,Bn=e.canHydrateTextInstance,rr=e.canHydrateSuspenseInstance,fa=e.isSuspenseInstancePending,Mo=e.isSuspenseInstanceFallback,ss=e.registerSuspenseInstanceRetry,Js=e.getNextHydratableSibling,sr=e.getFirstHydratableChild,Pl=e.getFirstHydratableChildWithinContainer,bl=e.getFirstHydratableChildWithinSuspenseInstance,Ll=e.hydrateInstance,Nl=e.hydrateTextInstance,tc=e.hydrateSuspenseInstance,H=e.getNextHydratableInstanceAfterSuspenseInstance,ne=e.commitHydratedContainer,ce=e.commitHydratedSuspenseInstance,he=e.clearSuspenseBoundary,le=e.clearSuspenseBoundaryFromContainer,We=e.shouldDeleteUnhydratedTailInstances,ot=e.didNotMatchHydratedContainerTextInstance,ht=e.didNotMatchHydratedTextInstance,_t;function It(u){if(_t===void 0)try{throw Error()}catch(g){var c=g.stack.trim().match(/\n( *(at )?)/);_t=c&&c[1]||""}return`
`+_t+u}var Et=!1;function At(u,c){if(!u||Et)return"";Et=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(Oe){var S=Oe}Reflect.construct(u,[],c)}else{try{c.call()}catch(Oe){S=Oe}u.call(c.prototype)}else{try{throw Error()}catch(Oe){S=Oe}u()}}catch(Oe){if(Oe&&S&&typeof Oe.stack=="string"){for(var A=Oe.stack.split(`
`),L=S.stack.split(`
`),j=A.length-1,J=L.length-1;1<=j&&0<=J&&A[j]!==L[J];)J--;for(;1<=j&&0<=J;j--,J--)if(A[j]!==L[J]){if(j!==1||J!==1)do if(j--,J--,0>J||A[j]!==L[J]){var de=`
`+A[j].replace(" at new "," at ");return u.displayName&&de.includes("<anonymous>")&&(de=de.replace("<anonymous>",u.displayName)),de}while(1<=j&&0<=J);break}}}finally{Et=!1,Error.prepareStackTrace=g}return(u=u?u.displayName||u.name:"")?It(u):""}var _n=Object.prototype.hasOwnProperty,Yn=[],fn=-1;function $n(u){return{current:u}}function yt(u){0>fn||(u.current=Yn[fn],Yn[fn]=null,fn--)}function et(u,c){fn++,Yn[fn]=u.current,u.current=c}var Er={},Ct=$n(Er),tn=$n(!1),ki=Er;function vi(u,c){var g=u.type.contextTypes;if(!g)return Er;var S=u.stateNode;if(S&&S.__reactInternalMemoizedUnmaskedChildContext===c)return S.__reactInternalMemoizedMaskedChildContext;var A={},L;for(L in g)A[L]=c[L];return S&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=c,u.__reactInternalMemoizedMaskedChildContext=A),A}function Hn(u){return u=u.childContextTypes,u!=null}function Pt(){yt(tn),yt(Ct)}function or(u,c,g){if(Ct.current!==Er)throw Error(o(168));et(Ct,c),et(tn,g)}function os(u,c,g){var S=u.stateNode;if(c=c.childContextTypes,typeof S.getChildContext!="function")return g;S=S.getChildContext();for(var A in S)if(!(A in c))throw Error(o(108,b(u)||"Unknown",A));return s({},g,S)}function Ln(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||Er,ki=Ct.current,et(Ct,u),et(tn,tn.current),!0}function da(u,c,g){var S=u.stateNode;if(!S)throw Error(o(169));g?(u=os(u,c,ki),S.__reactInternalMemoizedMergedChildContext=u,yt(tn),yt(Ct),et(Ct,u)):yt(tn),et(tn,g)}var Oi=Math.clz32?Math.clz32:e0,nc=Math.log,Zv=Math.LN2;function e0(u){return u>>>=0,u===0?32:31-(nc(u)/Zv|0)|0}var ic=64,Zs=4194304;function Or(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function Dl(u,c){var g=u.pendingLanes;if(g===0)return 0;var S=0,A=u.suspendedLanes,L=u.pingedLanes,j=g&268435455;if(j!==0){var J=j&~A;J!==0?S=Or(J):(L&=j,L!==0&&(S=Or(L)))}else j=g&~A,j!==0?S=Or(j):L!==0&&(S=Or(L));if(S===0)return 0;if(c!==0&&c!==S&&!(c&A)&&(A=S&-S,L=c&-c,A>=L||A===16&&(L&4194240)!==0))return c;if(S&4&&(S|=g&16),c=u.entangledLanes,c!==0)for(u=u.entanglements,c&=S;0<c;)g=31-Oi(c),A=1<<g,S|=u[g],c&=~A;return S}function om(u,c){switch(u){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function am(u,c){for(var g=u.suspendedLanes,S=u.pingedLanes,A=u.expirationTimes,L=u.pendingLanes;0<L;){var j=31-Oi(L),J=1<<j,de=A[j];de===-1?(!(J&g)||J&S)&&(A[j]=om(J,c)):de<=c&&(u.expiredLanes|=J),L&=~J}}function rc(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function sc(u){for(var c=[],g=0;31>g;g++)c.push(u);return c}function as(u,c,g){u.pendingLanes|=c,c!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,c=31-Oi(c),u[c]=g}function t0(u,c){var g=u.pendingLanes&~c;u.pendingLanes=c,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=c,u.mutableReadLanes&=c,u.entangledLanes&=c,c=u.entanglements;var S=u.eventTimes;for(u=u.expirationTimes;0<g;){var A=31-Oi(g),L=1<<A;c[A]=0,S[A]=-1,u[A]=-1,g&=~L}}function pf(u,c){var g=u.entangledLanes|=c;for(u=u.entanglements;g;){var S=31-Oi(g),A=1<<S;A&c|u[S]&c&&(u[S]|=c),g&=~A}}var Qt=0;function Is(u){return u&=-u,1<u?4<u?u&268435455?16:536870912:4:1}var mf=r.unstable_scheduleCallback,oc=r.unstable_cancelCallback,ac=r.unstable_shouldYield,lm=r.unstable_requestPaint,Mn=r.unstable_now,Ao=r.unstable_ImmediatePriority,um=r.unstable_UserBlockingPriority,kl=r.unstable_NormalPriority,An=r.unstable_IdlePriority,lc=null,ls=null;function cm(u){if(ls&&typeof ls.onCommitFiberRoot=="function")try{ls.onCommitFiberRoot(lc,u,void 0,(u.current.flags&128)===128)}catch{}}function hm(u,c){return u===c&&(u!==0||1/u===1/c)||u!==u&&c!==c}var Ur=typeof Object.is=="function"?Object.is:hm,wr=null,Fr=!1,uc=!1;function fm(u){wr===null?wr=[u]:wr.push(u)}function Ol(u){Fr=!0,fm(u)}function Vr(){if(!uc&&wr!==null){uc=!0;var u=0,c=Qt;try{var g=wr;for(Qt=1;u<g.length;u++){var S=g[u];do S=S(!0);while(S!==null)}wr=null,Fr=!1}catch(A){throw wr!==null&&(wr=wr.slice(u+1)),mf(Ao,Vr),A}finally{Qt=c,uc=!1}}return null}var gf=a.ReactCurrentBatchConfig;function Co(u,c){if(Ur(u,c))return!0;if(typeof u!="object"||u===null||typeof c!="object"||c===null)return!1;var g=Object.keys(u),S=Object.keys(c);if(g.length!==S.length)return!1;for(S=0;S<g.length;S++){var A=g[S];if(!_n.call(c,A)||!Ur(u[A],c[A]))return!1}return!0}function dm(u){switch(u.tag){case 5:return It(u.type);case 16:return It("Lazy");case 13:return It("Suspense");case 19:return It("SuspenseList");case 0:case 2:case 15:return u=At(u.type,!1),u;case 11:return u=At(u.type.render,!1),u;case 1:return u=At(u.type,!0),u;default:return""}}function Ui(u,c){if(u&&u.defaultProps){c=s({},c),u=u.defaultProps;for(var g in u)c[g]===void 0&&(c[g]=u[g]);return c}return c}var cc=$n(null),Ul=null,us=null,hc=null;function fc(){hc=us=Ul=null}function dc(u,c,g){St?(et(cc,c._currentValue),c._currentValue=g):(et(cc,c._currentValue2),c._currentValue2=g)}function Fl(u){var c=cc.current;yt(cc),St?u._currentValue=c:u._currentValue2=c}function pc(u,c,g){for(;u!==null;){var S=u.alternate;if((u.childLanes&c)!==c?(u.childLanes|=c,S!==null&&(S.childLanes|=c)):S!==null&&(S.childLanes&c)!==c&&(S.childLanes|=c),u===g)break;u=u.return}}function Ps(u,c){Ul=u,hc=us=null,u=u.dependencies,u!==null&&u.firstContext!==null&&(u.lanes&c&&(Gr=!0),u.firstContext=null)}function ar(u){var c=St?u._currentValue:u._currentValue2;if(hc!==u)if(u={context:u,memoizedValue:c,next:null},us===null){if(Ul===null)throw Error(o(308));us=u,Ul.dependencies={lanes:0,firstContext:u}}else us=us.next=u;return c}var zr=null,Fi=!1;function mc(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _f(u,c){u=u.updateQueue,c.updateQueue===u&&(c.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function cs(u,c){return{eventTime:u,lane:c,tag:0,payload:null,callback:null,next:null}}function bs(u,c){var g=u.updateQueue;g!==null&&(g=g.shared,ni!==null&&u.mode&1&&!(Wt&2)?(u=g.interleaved,u===null?(c.next=c,zr===null?zr=[g]:zr.push(g)):(c.next=u.next,u.next=c),g.interleaved=c):(u=g.pending,u===null?c.next=c:(c.next=u.next,u.next=c),g.pending=c))}function Ro(u,c,g){if(c=c.updateQueue,c!==null&&(c=c.shared,(g&4194240)!==0)){var S=c.lanes;S&=u.pendingLanes,g|=S,c.lanes=g,pf(u,g)}}function Vi(u,c){var g=u.updateQueue,S=u.alternate;if(S!==null&&(S=S.updateQueue,g===S)){var A=null,L=null;if(g=g.firstBaseUpdate,g!==null){do{var j={eventTime:g.eventTime,lane:g.lane,tag:g.tag,payload:g.payload,callback:g.callback,next:null};L===null?A=L=j:L=L.next=j,g=g.next}while(g!==null);L===null?A=L=c:L=L.next=c}else A=L=c;g={baseState:S.baseState,firstBaseUpdate:A,lastBaseUpdate:L,shared:S.shared,effects:S.effects},u.updateQueue=g;return}u=g.lastBaseUpdate,u===null?g.firstBaseUpdate=c:u.next=c,g.lastBaseUpdate=c}function Vl(u,c,g,S){var A=u.updateQueue;Fi=!1;var L=A.firstBaseUpdate,j=A.lastBaseUpdate,J=A.shared.pending;if(J!==null){A.shared.pending=null;var de=J,Oe=de.next;de.next=null,j===null?L=Oe:j.next=Oe,j=de;var rt=u.alternate;rt!==null&&(rt=rt.updateQueue,J=rt.lastBaseUpdate,J!==j&&(J===null?rt.firstBaseUpdate=Oe:J.next=Oe,rt.lastBaseUpdate=de))}if(L!==null){var Ot=A.baseState;j=0,rt=Oe=de=null,J=L;do{var vt=J.lane,gn=J.eventTime;if((S&vt)===vt){rt!==null&&(rt=rt.next={eventTime:gn,lane:0,tag:J.tag,payload:J.payload,callback:J.callback,next:null});e:{var dt=u,Gi=J;switch(vt=c,gn=g,Gi.tag){case 1:if(dt=Gi.payload,typeof dt=="function"){Ot=dt.call(gn,Ot,vt);break e}Ot=dt;break e;case 3:dt.flags=dt.flags&-65537|128;case 0:if(dt=Gi.payload,vt=typeof dt=="function"?dt.call(gn,Ot,vt):dt,vt==null)break e;Ot=s({},Ot,vt);break e;case 2:Fi=!0}}J.callback!==null&&J.lane!==0&&(u.flags|=64,vt=A.effects,vt===null?A.effects=[J]:vt.push(J))}else gn={eventTime:gn,lane:vt,tag:J.tag,payload:J.payload,callback:J.callback,next:null},rt===null?(Oe=rt=gn,de=Ot):rt=rt.next=gn,j|=vt;if(J=J.next,J===null){if(J=A.shared.pending,J===null)break;vt=J,J=vt.next,vt.next=null,A.lastBaseUpdate=vt,A.shared.pending=null}}while(!0);if(rt===null&&(de=Ot),A.baseState=de,A.firstBaseUpdate=Oe,A.lastBaseUpdate=rt,c=A.shared.interleaved,c!==null){A=c;do j|=A.lane,A=A.next;while(A!==c)}else L===null&&(A.shared.lanes=0);wc|=j,u.lanes=j,u.memoizedState=Ot}}function yf(u,c,g){if(u=c.effects,c.effects=null,u!==null)for(c=0;c<u.length;c++){var S=u[c],A=S.callback;if(A!==null){if(S.callback=null,S=g,typeof A!="function")throw Error(o(191,A));A.call(S)}}}var Io=new i.Component().refs;function m(u,c,g,S){c=u.memoizedState,g=g(S,c),g=g==null?c:s({},c,g),u.memoizedState=g,u.lanes===0&&(u.updateQueue.baseState=g)}var C={isMounted:function(u){return(u=u._reactInternals)?k(u)===u:!1},enqueueSetState:function(u,c,g){u=u._reactInternals;var S=cr(),A=ga(u),L=cs(S,A);L.payload=c,g!=null&&(L.callback=g),bs(u,L),c=ps(u,A,S),c!==null&&Ro(c,u,A)},enqueueReplaceState:function(u,c,g){u=u._reactInternals;var S=cr(),A=ga(u),L=cs(S,A);L.tag=1,L.payload=c,g!=null&&(L.callback=g),bs(u,L),c=ps(u,A,S),c!==null&&Ro(c,u,A)},enqueueForceUpdate:function(u,c){u=u._reactInternals;var g=cr(),S=ga(u),A=cs(g,S);A.tag=2,c!=null&&(A.callback=c),bs(u,A),c=ps(u,S,g),c!==null&&Ro(c,u,S)}};function N(u,c,g,S,A,L,j){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(S,L,j):c.prototype&&c.prototype.isPureReactComponent?!Co(g,S)||!Co(A,L):!0}function B(u,c,g){var S=!1,A=Er,L=c.contextType;return typeof L=="object"&&L!==null?L=ar(L):(A=Hn(c)?ki:Ct.current,S=c.contextTypes,L=(S=S!=null)?vi(u,A):Er),c=new c(g,L),u.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=C,u.stateNode=c,c._reactInternals=u,S&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=A,u.__reactInternalMemoizedMaskedChildContext=L),c}function ie(u,c,g,S){u=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(g,S),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(g,S),c.state!==u&&C.enqueueReplaceState(c,c.state,null)}function ue(u,c,g,S){var A=u.stateNode;A.props=g,A.state=u.memoizedState,A.refs=Io,mc(u);var L=c.contextType;typeof L=="object"&&L!==null?A.context=ar(L):(L=Hn(c)?ki:Ct.current,A.context=vi(u,L)),A.state=u.memoizedState,L=c.getDerivedStateFromProps,typeof L=="function"&&(m(u,c,L,g),A.state=u.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(c=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),c!==A.state&&C.enqueueReplaceState(A,A.state,null),Vl(u,g,A,S),A.state=u.memoizedState),typeof A.componentDidMount=="function"&&(u.flags|=4194308)}var ke=[],bt=0,Cn=null,sn=0,un=[],Nn=0,lr=null,xi=1,Si="";function hs(u,c){ke[bt++]=sn,ke[bt++]=Cn,Cn=u,sn=c}function gc(u,c,g){un[Nn++]=xi,un[Nn++]=Si,un[Nn++]=lr,lr=u;var S=xi;u=Si;var A=32-Oi(S)-1;S&=~(1<<A),g+=1;var L=32-Oi(c)+A;if(30<L){var j=A-A%5;L=(S&(1<<j)-1).toString(32),S>>=j,A-=j,xi=1<<32-Oi(c)+A|g<<A|S,Si=L+u}else xi=1<<L|g<<A|S,Si=u}function n0(u){u.return!==null&&(hs(u,1),gc(u,1,0))}function i0(u){for(;u===Cn;)Cn=ke[--bt],ke[bt]=null,sn=ke[--bt],ke[bt]=null;for(;u===lr;)lr=un[--Nn],un[Nn]=null,Si=un[--Nn],un[Nn]=null,xi=un[--Nn],un[Nn]=null}var Br=null,Hr=null,Rn=!1,vf=!1,Ls=null;function vM(u,c){var g=ms(5,null,null,0);g.elementType="DELETED",g.stateNode=c,g.return=u,c=u.deletions,c===null?(u.deletions=[g],u.flags|=16):c.push(g)}function xM(u,c){switch(u.tag){case 5:return c=Kt(c,u.type,u.pendingProps),c!==null?(u.stateNode=c,Br=u,Hr=sr(c),!0):!1;case 6:return c=Bn(c,u.pendingProps),c!==null?(u.stateNode=c,Br=u,Hr=null,!0):!1;case 13:if(c=rr(c),c!==null){var g=lr!==null?{id:xi,overflow:Si}:null;return u.memoizedState={dehydrated:c,treeContext:g,retryLane:1073741824},g=ms(18,null,null,0),g.stateNode=c,g.return=u,u.child=g,Br=u,Hr=null,!0}return!1;default:return!1}}function r0(u){return(u.mode&1)!==0&&(u.flags&128)===0}function s0(u){if(Rn){var c=Hr;if(c){var g=c;if(!xM(u,c)){if(r0(u))throw Error(o(418));c=Js(g);var S=Br;c&&xM(u,c)?vM(S,g):(u.flags=u.flags&-4097|2,Rn=!1,Br=u)}}else{if(r0(u))throw Error(o(418));u.flags=u.flags&-4097|2,Rn=!1,Br=u}}}function SM(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;Br=u}function xf(u){if(!Ce||u!==Br)return!1;if(!Rn)return SM(u),Rn=!0,!1;if(u.tag!==3&&(u.tag!==5||We(u.type)&&!xe(u.type,u.memoizedProps))){var c=Hr;if(c){if(r0(u)){for(u=Hr;u;)u=Js(u);throw Error(o(418))}for(;c;)vM(u,c),c=Js(c)}}if(SM(u),u.tag===13){if(!Ce)throw Error(o(316));if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(o(317));Hr=H(u)}else Hr=Br?Js(u.stateNode):null;return!0}function _c(){Ce&&(Hr=Br=null,vf=Rn=!1)}function o0(u){Ls===null?Ls=[u]:Ls.push(u)}function Sf(u,c,g){if(u=g.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(g._owner){if(g=g._owner,g){if(g.tag!==1)throw Error(o(309));var S=g.stateNode}if(!S)throw Error(o(147,u));var A=S,L=""+u;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===L?c.ref:(c=function(j){var J=A.refs;J===Io&&(J=A.refs={}),j===null?delete J[L]:J[L]=j},c._stringRef=L,c)}if(typeof u!="string")throw Error(o(284));if(!g._owner)throw Error(o(290,u))}return u}function pm(u,c){throw u=Object.prototype.toString.call(c),Error(o(31,u==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":u))}function EM(u){var c=u._init;return c(u._payload)}function wM(u){function c(ae,Z){if(u){var fe=ae.deletions;fe===null?(ae.deletions=[Z],ae.flags|=16):fe.push(Z)}}function g(ae,Z){if(!u)return null;for(;Z!==null;)c(ae,Z),Z=Z.sibling;return null}function S(ae,Z){for(ae=new Map;Z!==null;)Z.key!==null?ae.set(Z.key,Z):ae.set(Z.index,Z),Z=Z.sibling;return ae}function A(ae,Z){return ae=ya(ae,Z),ae.index=0,ae.sibling=null,ae}function L(ae,Z,fe){return ae.index=fe,u?(fe=ae.alternate,fe!==null?(fe=fe.index,fe<Z?(ae.flags|=2,Z):fe):(ae.flags|=2,Z)):(ae.flags|=1048576,Z)}function j(ae){return u&&ae.alternate===null&&(ae.flags|=2),ae}function J(ae,Z,fe,qe){return Z===null||Z.tag!==6?(Z=G0(fe,ae.mode,qe),Z.return=ae,Z):(Z=A(Z,fe),Z.return=ae,Z)}function de(ae,Z,fe,qe){var ft=fe.type;return ft===f?rt(ae,Z,fe.props.children,qe,fe.key):Z!==null&&(Z.elementType===ft||typeof ft=="object"&&ft!==null&&ft.$$typeof===E&&EM(ft)===Z.type)?(qe=A(Z,fe.props),qe.ref=Sf(ae,Z,fe),qe.return=ae,qe):(qe=jm(fe.type,fe.key,fe.props,null,ae.mode,qe),qe.ref=Sf(ae,Z,fe),qe.return=ae,qe)}function Oe(ae,Z,fe,qe){return Z===null||Z.tag!==4||Z.stateNode.containerInfo!==fe.containerInfo||Z.stateNode.implementation!==fe.implementation?(Z=W0(fe,ae.mode,qe),Z.return=ae,Z):(Z=A(Z,fe.children||[]),Z.return=ae,Z)}function rt(ae,Z,fe,qe,ft){return Z===null||Z.tag!==7?(Z=ql(fe,ae.mode,qe,ft),Z.return=ae,Z):(Z=A(Z,fe),Z.return=ae,Z)}function Ot(ae,Z,fe){if(typeof Z=="string"&&Z!==""||typeof Z=="number")return Z=G0(""+Z,ae.mode,fe),Z.return=ae,Z;if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case l:return fe=jm(Z.type,Z.key,Z.props,null,ae.mode,fe),fe.ref=Sf(ae,null,Z),fe.return=ae,fe;case h:return Z=W0(Z,ae.mode,fe),Z.return=ae,Z;case E:var qe=Z._init;return Ot(ae,qe(Z._payload),fe)}if(re(Z)||D(Z))return Z=ql(Z,ae.mode,fe,null),Z.return=ae,Z;pm(ae,Z)}return null}function vt(ae,Z,fe,qe){var ft=Z!==null?Z.key:null;if(typeof fe=="string"&&fe!==""||typeof fe=="number")return ft!==null?null:J(ae,Z,""+fe,qe);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case l:return fe.key===ft?de(ae,Z,fe,qe):null;case h:return fe.key===ft?Oe(ae,Z,fe,qe):null;case E:return ft=fe._init,vt(ae,Z,ft(fe._payload),qe)}if(re(fe)||D(fe))return ft!==null?null:rt(ae,Z,fe,qe,null);pm(ae,fe)}return null}function gn(ae,Z,fe,qe,ft){if(typeof qe=="string"&&qe!==""||typeof qe=="number")return ae=ae.get(fe)||null,J(Z,ae,""+qe,ft);if(typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case l:return ae=ae.get(qe.key===null?fe:qe.key)||null,de(Z,ae,qe,ft);case h:return ae=ae.get(qe.key===null?fe:qe.key)||null,Oe(Z,ae,qe,ft);case E:var zt=qe._init;return gn(ae,Z,fe,zt(qe._payload),ft)}if(re(qe)||D(qe))return ae=ae.get(fe)||null,rt(Z,ae,qe,ft,null);pm(Z,qe)}return null}function dt(ae,Z,fe,qe){for(var ft=null,zt=null,Ut=Z,on=Z=0,wi=null;Ut!==null&&on<fe.length;on++){Ut.index>on?(wi=Ut,Ut=null):wi=Ut.sibling;var an=vt(ae,Ut,fe[on],qe);if(an===null){Ut===null&&(Ut=wi);break}u&&Ut&&an.alternate===null&&c(ae,Ut),Z=L(an,Z,on),zt===null?ft=an:zt.sibling=an,zt=an,Ut=wi}if(on===fe.length)return g(ae,Ut),Rn&&hs(ae,on),ft;if(Ut===null){for(;on<fe.length;on++)Ut=Ot(ae,fe[on],qe),Ut!==null&&(Z=L(Ut,Z,on),zt===null?ft=Ut:zt.sibling=Ut,zt=Ut);return Rn&&hs(ae,on),ft}for(Ut=S(ae,Ut);on<fe.length;on++)wi=gn(Ut,ae,on,fe[on],qe),wi!==null&&(u&&wi.alternate!==null&&Ut.delete(wi.key===null?on:wi.key),Z=L(wi,Z,on),zt===null?ft=wi:zt.sibling=wi,zt=wi);return u&&Ut.forEach(function(va){return c(ae,va)}),Rn&&hs(ae,on),ft}function Gi(ae,Z,fe,qe){var ft=D(fe);if(typeof ft!="function")throw Error(o(150));if(fe=ft.call(fe),fe==null)throw Error(o(151));for(var zt=ft=null,Ut=Z,on=Z=0,wi=null,an=fe.next();Ut!==null&&!an.done;on++,an=fe.next()){Ut.index>on?(wi=Ut,Ut=null):wi=Ut.sibling;var va=vt(ae,Ut,an.value,qe);if(va===null){Ut===null&&(Ut=wi);break}u&&Ut&&va.alternate===null&&c(ae,Ut),Z=L(va,Z,on),zt===null?ft=va:zt.sibling=va,zt=va,Ut=wi}if(an.done)return g(ae,Ut),Rn&&hs(ae,on),ft;if(Ut===null){for(;!an.done;on++,an=fe.next())an=Ot(ae,an.value,qe),an!==null&&(Z=L(an,Z,on),zt===null?ft=an:zt.sibling=an,zt=an);return Rn&&hs(ae,on),ft}for(Ut=S(ae,Ut);!an.done;on++,an=fe.next())an=gn(Ut,ae,on,an.value,qe),an!==null&&(u&&an.alternate!==null&&Ut.delete(an.key===null?on:an.key),Z=L(an,Z,on),zt===null?ft=an:zt.sibling=an,zt=an);return u&&Ut.forEach(function(xU){return c(ae,xU)}),Rn&&hs(ae,on),ft}function gs(ae,Z,fe,qe){if(typeof fe=="object"&&fe!==null&&fe.type===f&&fe.key===null&&(fe=fe.props.children),typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case l:e:{for(var ft=fe.key,zt=Z;zt!==null;){if(zt.key===ft){if(ft=fe.type,ft===f){if(zt.tag===7){g(ae,zt.sibling),Z=A(zt,fe.props.children),Z.return=ae,ae=Z;break e}}else if(zt.elementType===ft||typeof ft=="object"&&ft!==null&&ft.$$typeof===E&&EM(ft)===zt.type){g(ae,zt.sibling),Z=A(zt,fe.props),Z.ref=Sf(ae,zt,fe),Z.return=ae,ae=Z;break e}g(ae,zt);break}else c(ae,zt);zt=zt.sibling}fe.type===f?(Z=ql(fe.props.children,ae.mode,qe,fe.key),Z.return=ae,ae=Z):(qe=jm(fe.type,fe.key,fe.props,null,ae.mode,qe),qe.ref=Sf(ae,Z,fe),qe.return=ae,ae=qe)}return j(ae);case h:e:{for(zt=fe.key;Z!==null;){if(Z.key===zt)if(Z.tag===4&&Z.stateNode.containerInfo===fe.containerInfo&&Z.stateNode.implementation===fe.implementation){g(ae,Z.sibling),Z=A(Z,fe.children||[]),Z.return=ae,ae=Z;break e}else{g(ae,Z);break}else c(ae,Z);Z=Z.sibling}Z=W0(fe,ae.mode,qe),Z.return=ae,ae=Z}return j(ae);case E:return zt=fe._init,gs(ae,Z,zt(fe._payload),qe)}if(re(fe))return dt(ae,Z,fe,qe);if(D(fe))return Gi(ae,Z,fe,qe);pm(ae,fe)}return typeof fe=="string"&&fe!==""||typeof fe=="number"?(fe=""+fe,Z!==null&&Z.tag===6?(g(ae,Z.sibling),Z=A(Z,fe),Z.return=ae,ae=Z):(g(ae,Z),Z=G0(fe,ae.mode,qe),Z.return=ae,ae=Z),j(ae)):g(ae,Z)}return gs}var yc=wM(!0),TM=wM(!1),Ef={},fs=$n(Ef),wf=$n(Ef),vc=$n(Ef);function eo(u){if(u===Ef)throw Error(o(174));return u}function a0(u,c){et(vc,c),et(wf,u),et(fs,Ef),u=ye(c),yt(fs),et(fs,u)}function xc(){yt(fs),yt(wf),yt(vc)}function MM(u){var c=eo(vc.current),g=eo(fs.current);c=W(g,u.type,c),g!==c&&(et(wf,u),et(fs,c))}function l0(u){wf.current===u&&(yt(fs),yt(wf))}var Dn=$n(0);function mm(u){for(var c=u;c!==null;){if(c.tag===13){var g=c.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||fa(g)||Mo(g)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if(c.flags&128)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===u)break;for(;c.sibling===null;){if(c.return===null||c.return===u)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var u0=[];function c0(){for(var u=0;u<u0.length;u++){var c=u0[u];St?c._workInProgressVersionPrimary=null:c._workInProgressVersionSecondary=null}u0.length=0}var gm=a.ReactCurrentDispatcher,ds=a.ReactCurrentBatchConfig,Sc=0,Gn=null,zi=null,Ei=null,_m=!1,Tf=!1,Mf=0,jO=0;function Bi(){throw Error(o(321))}function h0(u,c){if(c===null)return!1;for(var g=0;g<c.length&&g<u.length;g++)if(!Ur(u[g],c[g]))return!1;return!0}function f0(u,c,g,S,A,L){if(Sc=L,Gn=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,gm.current=u===null||u.memoizedState===null?$O:KO,u=g(S,A),Tf){L=0;do{if(Tf=!1,Mf=0,25<=L)throw Error(o(301));L+=1,Ei=zi=null,c.updateQueue=null,gm.current=QO,u=g(S,A)}while(Tf)}if(gm.current=Em,c=zi!==null&&zi.next!==null,Sc=0,Ei=zi=Gn=null,_m=!1,c)throw Error(o(300));return u}function d0(){var u=Mf!==0;return Mf=0,u}function Po(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ei===null?Gn.memoizedState=Ei=u:Ei=Ei.next=u,Ei}function to(){if(zi===null){var u=Gn.alternate;u=u!==null?u.memoizedState:null}else u=zi.next;var c=Ei===null?Gn.memoizedState:Ei.next;if(c!==null)Ei=c,zi=u;else{if(u===null)throw Error(o(310));zi=u,u={memoizedState:zi.memoizedState,baseState:zi.baseState,baseQueue:zi.baseQueue,queue:zi.queue,next:null},Ei===null?Gn.memoizedState=Ei=u:Ei=Ei.next=u}return Ei}function zl(u,c){return typeof c=="function"?c(u):c}function ym(u){var c=to(),g=c.queue;if(g===null)throw Error(o(311));g.lastRenderedReducer=u;var S=zi,A=S.baseQueue,L=g.pending;if(L!==null){if(A!==null){var j=A.next;A.next=L.next,L.next=j}S.baseQueue=A=L,g.pending=null}if(A!==null){L=A.next,S=S.baseState;var J=j=null,de=null,Oe=L;do{var rt=Oe.lane;if((Sc&rt)===rt)de!==null&&(de=de.next={lane:0,action:Oe.action,hasEagerState:Oe.hasEagerState,eagerState:Oe.eagerState,next:null}),S=Oe.hasEagerState?Oe.eagerState:u(S,Oe.action);else{var Ot={lane:rt,action:Oe.action,hasEagerState:Oe.hasEagerState,eagerState:Oe.eagerState,next:null};de===null?(J=de=Ot,j=S):de=de.next=Ot,Gn.lanes|=rt,wc|=rt}Oe=Oe.next}while(Oe!==null&&Oe!==L);de===null?j=S:de.next=J,Ur(S,c.memoizedState)||(Gr=!0),c.memoizedState=S,c.baseState=j,c.baseQueue=de,g.lastRenderedState=S}if(u=g.interleaved,u!==null){A=u;do L=A.lane,Gn.lanes|=L,wc|=L,A=A.next;while(A!==u)}else A===null&&(g.lanes=0);return[c.memoizedState,g.dispatch]}function vm(u){var c=to(),g=c.queue;if(g===null)throw Error(o(311));g.lastRenderedReducer=u;var S=g.dispatch,A=g.pending,L=c.memoizedState;if(A!==null){g.pending=null;var j=A=A.next;do L=u(L,j.action),j=j.next;while(j!==A);Ur(L,c.memoizedState)||(Gr=!0),c.memoizedState=L,c.baseQueue===null&&(c.baseState=L),g.lastRenderedState=L}return[L,S]}function AM(){}function CM(u,c){var g=Gn,S=to(),A=c(),L=!Ur(S.memoizedState,A);if(L&&(S.memoizedState=A,Gr=!0),S=S.queue,Cf(PM.bind(null,g,S,u),[u]),S.getSnapshot!==c||L||Ei!==null&&Ei.memoizedState.tag&1){if(g.flags|=2048,Af(9,IM.bind(null,g,S,A,c),void 0,null),ni===null)throw Error(o(349));Sc&30||RM(g,c,A)}return A}function RM(u,c,g){u.flags|=16384,u={getSnapshot:c,value:g},c=Gn.updateQueue,c===null?(c={lastEffect:null,stores:null},Gn.updateQueue=c,c.stores=[u]):(g=c.stores,g===null?c.stores=[u]:g.push(u))}function IM(u,c,g,S){c.value=g,c.getSnapshot=S,bM(c)&&ps(u,1,-1)}function PM(u,c,g){return g(function(){bM(c)&&ps(u,1,-1)})}function bM(u){var c=u.getSnapshot;u=u.value;try{var g=c();return!Ur(u,g)}catch{return!0}}function p0(u){var c=Po();return typeof u=="function"&&(u=u()),c.memoizedState=c.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zl,lastRenderedState:u},c.queue=u,u=u.dispatch=YO.bind(null,Gn,u),[c.memoizedState,u]}function Af(u,c,g,S){return u={tag:u,create:c,destroy:g,deps:S,next:null},c=Gn.updateQueue,c===null?(c={lastEffect:null,stores:null},Gn.updateQueue=c,c.lastEffect=u.next=u):(g=c.lastEffect,g===null?c.lastEffect=u.next=u:(S=g.next,g.next=u,u.next=S,c.lastEffect=u)),u}function LM(){return to().memoizedState}function xm(u,c,g,S){var A=Po();Gn.flags|=u,A.memoizedState=Af(1|c,g,void 0,S===void 0?null:S)}function Sm(u,c,g,S){var A=to();S=S===void 0?null:S;var L=void 0;if(zi!==null){var j=zi.memoizedState;if(L=j.destroy,S!==null&&h0(S,j.deps)){A.memoizedState=Af(c,g,L,S);return}}Gn.flags|=u,A.memoizedState=Af(1|c,g,L,S)}function m0(u,c){return xm(8390656,8,u,c)}function Cf(u,c){return Sm(2048,8,u,c)}function NM(u,c){return Sm(4,2,u,c)}function DM(u,c){return Sm(4,4,u,c)}function kM(u,c){if(typeof c=="function")return u=u(),c(u),function(){c(null)};if(c!=null)return u=u(),c.current=u,function(){c.current=null}}function OM(u,c,g){return g=g!=null?g.concat([u]):null,Sm(4,4,kM.bind(null,c,u),g)}function g0(){}function UM(u,c){var g=to();c=c===void 0?null:c;var S=g.memoizedState;return S!==null&&c!==null&&h0(c,S[1])?S[0]:(g.memoizedState=[u,c],u)}function FM(u,c){var g=to();c=c===void 0?null:c;var S=g.memoizedState;return S!==null&&c!==null&&h0(c,S[1])?S[0]:(u=u(),g.memoizedState=[u,c],u)}function qO(u,c){var g=Qt;Qt=g!==0&&4>g?g:4,u(!0);var S=ds.transition;ds.transition={};try{u(!1),c()}finally{Qt=g,ds.transition=S}}function VM(){return to().memoizedState}function XO(u,c,g){var S=ga(u);g={lane:S,action:g,hasEagerState:!1,eagerState:null,next:null},zM(u)?BM(c,g):(HM(u,c,g),g=cr(),u=ps(u,S,g),u!==null&&GM(u,c,S))}function YO(u,c,g){var S=ga(u),A={lane:S,action:g,hasEagerState:!1,eagerState:null,next:null};if(zM(u))BM(c,A);else{HM(u,c,A);var L=u.alternate;if(u.lanes===0&&(L===null||L.lanes===0)&&(L=c.lastRenderedReducer,L!==null))try{var j=c.lastRenderedState,J=L(j,g);if(A.hasEagerState=!0,A.eagerState=J,Ur(J,j))return}catch{}finally{}g=cr(),u=ps(u,S,g),u!==null&&GM(u,c,S)}}function zM(u){var c=u.alternate;return u===Gn||c!==null&&c===Gn}function BM(u,c){Tf=_m=!0;var g=u.pending;g===null?c.next=c:(c.next=g.next,g.next=c),u.pending=c}function HM(u,c,g){ni!==null&&u.mode&1&&!(Wt&2)?(u=c.interleaved,u===null?(g.next=g,zr===null?zr=[c]:zr.push(c)):(g.next=u.next,u.next=g),c.interleaved=g):(u=c.pending,u===null?g.next=g:(g.next=u.next,u.next=g),c.pending=g)}function GM(u,c,g){if(g&4194240){var S=c.lanes;S&=u.pendingLanes,g|=S,c.lanes=g,pf(u,g)}}var Em={readContext:ar,useCallback:Bi,useContext:Bi,useEffect:Bi,useImperativeHandle:Bi,useInsertionEffect:Bi,useLayoutEffect:Bi,useMemo:Bi,useReducer:Bi,useRef:Bi,useState:Bi,useDebugValue:Bi,useDeferredValue:Bi,useTransition:Bi,useMutableSource:Bi,useSyncExternalStore:Bi,useId:Bi,unstable_isNewReconciler:!1},$O={readContext:ar,useCallback:function(u,c){return Po().memoizedState=[u,c===void 0?null:c],u},useContext:ar,useEffect:m0,useImperativeHandle:function(u,c,g){return g=g!=null?g.concat([u]):null,xm(4194308,4,kM.bind(null,c,u),g)},useLayoutEffect:function(u,c){return xm(4194308,4,u,c)},useInsertionEffect:function(u,c){return xm(4,2,u,c)},useMemo:function(u,c){var g=Po();return c=c===void 0?null:c,u=u(),g.memoizedState=[u,c],u},useReducer:function(u,c,g){var S=Po();return c=g!==void 0?g(c):c,S.memoizedState=S.baseState=c,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:c},S.queue=u,u=u.dispatch=XO.bind(null,Gn,u),[S.memoizedState,u]},useRef:function(u){var c=Po();return u={current:u},c.memoizedState=u},useState:p0,useDebugValue:g0,useDeferredValue:function(u){var c=p0(u),g=c[0],S=c[1];return m0(function(){var A=ds.transition;ds.transition={};try{S(u)}finally{ds.transition=A}},[u]),g},useTransition:function(){var u=p0(!1),c=u[0];return u=qO.bind(null,u[1]),Po().memoizedState=u,[c,u]},useMutableSource:function(){},useSyncExternalStore:function(u,c,g){var S=Gn,A=Po();if(Rn){if(g===void 0)throw Error(o(407));g=g()}else{if(g=c(),ni===null)throw Error(o(349));Sc&30||RM(S,c,g)}A.memoizedState=g;var L={value:g,getSnapshot:c};return A.queue=L,m0(PM.bind(null,S,L,u),[u]),S.flags|=2048,Af(9,IM.bind(null,S,L,g,c),void 0,null),g},useId:function(){var u=Po(),c=ni.identifierPrefix;if(Rn){var g=Si,S=xi;g=(S&~(1<<32-Oi(S)-1)).toString(32)+g,c=":"+c+"R"+g,g=Mf++,0<g&&(c+="H"+g.toString(32)),c+=":"}else g=jO++,c=":"+c+"r"+g.toString(32)+":";return u.memoizedState=c},unstable_isNewReconciler:!1},KO={readContext:ar,useCallback:UM,useContext:ar,useEffect:Cf,useImperativeHandle:OM,useInsertionEffect:NM,useLayoutEffect:DM,useMemo:FM,useReducer:ym,useRef:LM,useState:function(){return ym(zl)},useDebugValue:g0,useDeferredValue:function(u){var c=ym(zl),g=c[0],S=c[1];return Cf(function(){var A=ds.transition;ds.transition={};try{S(u)}finally{ds.transition=A}},[u]),g},useTransition:function(){var u=ym(zl)[0],c=to().memoizedState;return[u,c]},useMutableSource:AM,useSyncExternalStore:CM,useId:VM,unstable_isNewReconciler:!1},QO={readContext:ar,useCallback:UM,useContext:ar,useEffect:Cf,useImperativeHandle:OM,useInsertionEffect:NM,useLayoutEffect:DM,useMemo:FM,useReducer:vm,useRef:LM,useState:function(){return vm(zl)},useDebugValue:g0,useDeferredValue:function(u){var c=vm(zl),g=c[0],S=c[1];return Cf(function(){var A=ds.transition;ds.transition={};try{S(u)}finally{ds.transition=A}},[u]),g},useTransition:function(){var u=vm(zl)[0],c=to().memoizedState;return[u,c]},useMutableSource:AM,useSyncExternalStore:CM,useId:VM,unstable_isNewReconciler:!1};function _0(u,c){try{var g="",S=c;do g+=dm(S),S=S.return;while(S);var A=g}catch(L){A=`
Error generating stack: `+L.message+`
`+L.stack}return{value:u,source:c,stack:A}}function y0(u,c){try{console.error(c.value)}catch(g){setTimeout(function(){throw g})}}var JO=typeof WeakMap=="function"?WeakMap:Map;function WM(u,c,g){g=cs(-1,g),g.tag=3,g.payload={element:null};var S=c.value;return g.callback=function(){Fm||(Fm=!0,O0=S),y0(u,c)},g}function jM(u,c,g){g=cs(-1,g),g.tag=3;var S=u.type.getDerivedStateFromError;if(typeof S=="function"){var A=c.value;g.payload=function(){return S(A)},g.callback=function(){y0(u,c)}}var L=u.stateNode;return L!==null&&typeof L.componentDidCatch=="function"&&(g.callback=function(){y0(u,c),typeof S!="function"&&(pa===null?pa=new Set([this]):pa.add(this));var j=c.stack;this.componentDidCatch(c.value,{componentStack:j!==null?j:""})}),g}function qM(u,c,g){var S=u.pingCache;if(S===null){S=u.pingCache=new JO;var A=new Set;S.set(c,A)}else A=S.get(c),A===void 0&&(A=new Set,S.set(c,A));A.has(g)||(A.add(g),u=fU.bind(null,u,c,g),c.then(u,u))}function XM(u){do{var c;if((c=u.tag===13)&&(c=u.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return u;u=u.return}while(u!==null);return null}function YM(u,c,g,S,A){return u.mode&1?(u.flags|=65536,u.lanes=A,u):(u===c?u.flags|=65536:(u.flags|=128,g.flags|=131072,g.flags&=-52805,g.tag===1&&(g.alternate===null?g.tag=17:(c=cs(-1,1),c.tag=2,bs(g,c))),g.lanes|=1),u)}function no(u){u.flags|=4}function $M(u,c){if(u!==null&&u.child===c.child)return!0;if(c.flags&16)return!1;for(u=c.child;u!==null;){if(u.flags&12854||u.subtreeFlags&12854)return!1;u=u.sibling}return!0}var Rf,If,wm,Tm;if(nt)Rf=function(u,c){for(var g=c.child;g!==null;){if(g.tag===5||g.tag===6)_e(u,g.stateNode);else if(g.tag!==4&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===c)break;for(;g.sibling===null;){if(g.return===null||g.return===c)return;g=g.return}g.sibling.return=g.return,g=g.sibling}},If=function(){},wm=function(u,c,g,S,A){if(u=u.memoizedProps,u!==S){var L=c.stateNode,j=eo(fs.current);g=oe(L,g,u,S,A,j),(c.updateQueue=g)&&no(c)}},Tm=function(u,c,g,S){g!==S&&no(c)};else if(X){Rf=function(u,c,g,S){for(var A=c.child;A!==null;){if(A.tag===5){var L=A.stateNode;g&&S&&(L=en(L,A.type,A.memoizedProps,A)),_e(u,L)}else if(A.tag===6)L=A.stateNode,g&&S&&(L=bn(L,A.memoizedProps,A)),_e(u,L);else if(A.tag!==4){if(A.tag===22&&A.memoizedState!==null)L=A.child,L!==null&&(L.return=A),Rf(u,A,!0,!0);else if(A.child!==null){A.child.return=A,A=A.child;continue}}if(A===c)break;for(;A.sibling===null;){if(A.return===null||A.return===c)return;A=A.return}A.sibling.return=A.return,A=A.sibling}};var KM=function(u,c,g,S){for(var A=c.child;A!==null;){if(A.tag===5){var L=A.stateNode;g&&S&&(L=en(L,A.type,A.memoizedProps,A)),Je(u,L)}else if(A.tag===6)L=A.stateNode,g&&S&&(L=bn(L,A.memoizedProps,A)),Je(u,L);else if(A.tag!==4){if(A.tag===22&&A.memoizedState!==null)L=A.child,L!==null&&(L.return=A),KM(u,A,!0,!0);else if(A.child!==null){A.child.return=A,A=A.child;continue}}if(A===c)break;for(;A.sibling===null;){if(A.return===null||A.return===c)return;A=A.return}A.sibling.return=A.return,A=A.sibling}};If=function(u,c){var g=c.stateNode;if(!$M(u,c)){u=g.containerInfo;var S=Qe(u);KM(S,c,!1,!1),g.pendingChildren=S,no(c),kt(u,S)}},wm=function(u,c,g,S,A){var L=u.stateNode,j=u.memoizedProps;if((u=$M(u,c))&&j===S)c.stateNode=L;else{var J=c.stateNode,de=eo(fs.current),Oe=null;j!==S&&(Oe=oe(J,g,j,S,A,de)),u&&Oe===null?c.stateNode=L:(L=De(L,Oe,g,j,S,c,u,J),Ne(L,g,S,A,de)&&no(c),c.stateNode=L,u?no(c):Rf(L,c,!1,!1))}},Tm=function(u,c,g,S){g!==S?(u=eo(vc.current),g=eo(fs.current),c.stateNode=Le(S,u,g,c),no(c)):c.stateNode=u.stateNode}}else If=function(){},wm=function(){},Tm=function(){};function Pf(u,c){if(!Rn)switch(u.tailMode){case"hidden":c=u.tail;for(var g=null;c!==null;)c.alternate!==null&&(g=c),c=c.sibling;g===null?u.tail=null:g.sibling=null;break;case"collapsed":g=u.tail;for(var S=null;g!==null;)g.alternate!==null&&(S=g),g=g.sibling;S===null?c||u.tail===null?u.tail=null:u.tail.sibling=null:S.sibling=null}}function Hi(u){var c=u.alternate!==null&&u.alternate.child===u.child,g=0,S=0;if(c)for(var A=u.child;A!==null;)g|=A.lanes|A.childLanes,S|=A.subtreeFlags&14680064,S|=A.flags&14680064,A.return=u,A=A.sibling;else for(A=u.child;A!==null;)g|=A.lanes|A.childLanes,S|=A.subtreeFlags,S|=A.flags,A.return=u,A=A.sibling;return u.subtreeFlags|=S,u.childLanes=g,c}function ZO(u,c,g){var S=c.pendingProps;switch(i0(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hi(c),null;case 1:return Hn(c.type)&&Pt(),Hi(c),null;case 3:return S=c.stateNode,xc(),yt(tn),yt(Ct),c0(),S.pendingContext&&(S.context=S.pendingContext,S.pendingContext=null),(u===null||u.child===null)&&(xf(c)?no(c):u===null||u.memoizedState.isDehydrated&&!(c.flags&256)||(c.flags|=1024,Ls!==null&&(V0(Ls),Ls=null))),If(u,c),Hi(c),null;case 5:l0(c),g=eo(vc.current);var A=c.type;if(u!==null&&c.stateNode!=null)wm(u,c,A,S,g),u.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!S){if(c.stateNode===null)throw Error(o(166));return Hi(c),null}if(u=eo(fs.current),xf(c)){if(!Ce)throw Error(o(175));u=Ll(c.stateNode,c.type,c.memoizedProps,g,u,c,!vf),c.updateQueue=u,u!==null&&no(c)}else{var L=ee(A,S,g,u,c);Rf(L,c,!1,!1),c.stateNode=L,Ne(L,A,S,g,u)&&no(c)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return Hi(c),null;case 6:if(u&&c.stateNode!=null)Tm(u,c,u.memoizedProps,S);else{if(typeof S!="string"&&c.stateNode===null)throw Error(o(166));if(u=eo(vc.current),g=eo(fs.current),xf(c)){if(!Ce)throw Error(o(176));if(u=c.stateNode,S=c.memoizedProps,(g=Nl(u,S,c,!vf))&&(A=Br,A!==null))switch(L=(A.mode&1)!==0,A.tag){case 3:ot(A.stateNode.containerInfo,u,S,L);break;case 5:ht(A.type,A.memoizedProps,A.stateNode,u,S,L)}g&&no(c)}else c.stateNode=Le(S,u,g,c)}return Hi(c),null;case 13:if(yt(Dn),S=c.memoizedState,Rn&&Hr!==null&&c.mode&1&&!(c.flags&128)){for(u=Hr;u;)u=Js(u);return _c(),c.flags|=98560,c}if(S!==null&&S.dehydrated!==null){if(S=xf(c),u===null){if(!S)throw Error(o(318));if(!Ce)throw Error(o(344));if(u=c.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(o(317));tc(u,c)}else _c(),!(c.flags&128)&&(c.memoizedState=null),c.flags|=4;return Hi(c),null}return Ls!==null&&(V0(Ls),Ls=null),c.flags&128?(c.lanes=g,c):(S=S!==null,g=!1,u===null?xf(c):g=u.memoizedState!==null,S&&!g&&(c.child.flags|=8192,c.mode&1&&(u===null||Dn.current&1?hi===0&&(hi=3):B0())),c.updateQueue!==null&&(c.flags|=4),Hi(c),null);case 4:return xc(),If(u,c),u===null&&Pe(c.stateNode.containerInfo),Hi(c),null;case 10:return Fl(c.type._context),Hi(c),null;case 17:return Hn(c.type)&&Pt(),Hi(c),null;case 19:if(yt(Dn),A=c.memoizedState,A===null)return Hi(c),null;if(S=(c.flags&128)!==0,L=A.rendering,L===null)if(S)Pf(A,!1);else{if(hi!==0||u!==null&&u.flags&128)for(u=c.child;u!==null;){if(L=mm(u),L!==null){for(c.flags|=128,Pf(A,!1),u=L.updateQueue,u!==null&&(c.updateQueue=u,c.flags|=4),c.subtreeFlags=0,u=g,S=c.child;S!==null;)g=S,A=u,g.flags&=14680066,L=g.alternate,L===null?(g.childLanes=0,g.lanes=A,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=L.childLanes,g.lanes=L.lanes,g.child=L.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=L.memoizedProps,g.memoizedState=L.memoizedState,g.updateQueue=L.updateQueue,g.type=L.type,A=L.dependencies,g.dependencies=A===null?null:{lanes:A.lanes,firstContext:A.firstContext}),S=S.sibling;return et(Dn,Dn.current&1|2),c.child}u=u.sibling}A.tail!==null&&Mn()>k0&&(c.flags|=128,S=!0,Pf(A,!1),c.lanes=4194304)}else{if(!S)if(u=mm(L),u!==null){if(c.flags|=128,S=!0,u=u.updateQueue,u!==null&&(c.updateQueue=u,c.flags|=4),Pf(A,!0),A.tail===null&&A.tailMode==="hidden"&&!L.alternate&&!Rn)return Hi(c),null}else 2*Mn()-A.renderingStartTime>k0&&g!==1073741824&&(c.flags|=128,S=!0,Pf(A,!1),c.lanes=4194304);A.isBackwards?(L.sibling=c.child,c.child=L):(u=A.last,u!==null?u.sibling=L:c.child=L,A.last=L)}return A.tail!==null?(c=A.tail,A.rendering=c,A.tail=c.sibling,A.renderingStartTime=Mn(),c.sibling=null,u=Dn.current,et(Dn,S?u&1|2:u&1),c):(Hi(c),null);case 22:case 23:return z0(),S=c.memoizedState!==null,u!==null&&u.memoizedState!==null!==S&&(c.flags|=8192),S&&c.mode&1?Wr&1073741824&&(Hi(c),nt&&c.subtreeFlags&6&&(c.flags|=8192)):Hi(c),null;case 24:return null;case 25:return null}throw Error(o(156,c.tag))}var eU=a.ReactCurrentOwner,Gr=!1;function ur(u,c,g,S){c.child=u===null?TM(c,null,g,S):yc(c,u.child,g,S)}function QM(u,c,g,S,A){g=g.render;var L=c.ref;return Ps(c,A),S=f0(u,c,g,S,L,A),g=d0(),u!==null&&!Gr?(c.updateQueue=u.updateQueue,c.flags&=-2053,u.lanes&=~A,bo(u,c,A)):(Rn&&g&&n0(c),c.flags|=1,ur(u,c,S,A),c.child)}function JM(u,c,g,S,A){if(u===null){var L=g.type;return typeof L=="function"&&!H0(L)&&L.defaultProps===void 0&&g.compare===null&&g.defaultProps===void 0?(c.tag=15,c.type=L,ZM(u,c,L,S,A)):(u=jm(g.type,null,S,c,c.mode,A),u.ref=c.ref,u.return=c,c.child=u)}if(L=u.child,!(u.lanes&A)){var j=L.memoizedProps;if(g=g.compare,g=g!==null?g:Co,g(j,S)&&u.ref===c.ref)return bo(u,c,A)}return c.flags|=1,u=ya(L,S),u.ref=c.ref,u.return=c,c.child=u}function ZM(u,c,g,S,A){if(u!==null&&Co(u.memoizedProps,S)&&u.ref===c.ref)if(Gr=!1,(u.lanes&A)!==0)u.flags&131072&&(Gr=!0);else return c.lanes=u.lanes,bo(u,c,A);return v0(u,c,g,S,A)}function eA(u,c,g){var S=c.pendingProps,A=S.children,L=u!==null?u.memoizedState:null;if(S.mode==="hidden")if(!(c.mode&1))c.memoizedState={baseLanes:0,cachePool:null},et(Ec,Wr),Wr|=g;else if(g&1073741824)c.memoizedState={baseLanes:0,cachePool:null},S=L!==null?L.baseLanes:g,et(Ec,Wr),Wr|=S;else return u=L!==null?L.baseLanes|g:g,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:u,cachePool:null},c.updateQueue=null,et(Ec,Wr),Wr|=u,null;else L!==null?(S=L.baseLanes|g,c.memoizedState=null):S=g,et(Ec,Wr),Wr|=S;return ur(u,c,A,g),c.child}function tA(u,c){var g=c.ref;(u===null&&g!==null||u!==null&&u.ref!==g)&&(c.flags|=512,c.flags|=2097152)}function v0(u,c,g,S,A){var L=Hn(g)?ki:Ct.current;return L=vi(c,L),Ps(c,A),g=f0(u,c,g,S,L,A),S=d0(),u!==null&&!Gr?(c.updateQueue=u.updateQueue,c.flags&=-2053,u.lanes&=~A,bo(u,c,A)):(Rn&&S&&n0(c),c.flags|=1,ur(u,c,g,A),c.child)}function nA(u,c,g,S,A){if(Hn(g)){var L=!0;Ln(c)}else L=!1;if(Ps(c,A),c.stateNode===null)u!==null&&(u.alternate=null,c.alternate=null,c.flags|=2),B(c,g,S),ue(c,g,S,A),S=!0;else if(u===null){var j=c.stateNode,J=c.memoizedProps;j.props=J;var de=j.context,Oe=g.contextType;typeof Oe=="object"&&Oe!==null?Oe=ar(Oe):(Oe=Hn(g)?ki:Ct.current,Oe=vi(c,Oe));var rt=g.getDerivedStateFromProps,Ot=typeof rt=="function"||typeof j.getSnapshotBeforeUpdate=="function";Ot||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(J!==S||de!==Oe)&&ie(c,j,S,Oe),Fi=!1;var vt=c.memoizedState;j.state=vt,Vl(c,S,j,A),de=c.memoizedState,J!==S||vt!==de||tn.current||Fi?(typeof rt=="function"&&(m(c,g,rt,S),de=c.memoizedState),(J=Fi||N(c,g,J,S,vt,de,Oe))?(Ot||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount()),typeof j.componentDidMount=="function"&&(c.flags|=4194308)):(typeof j.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=S,c.memoizedState=de),j.props=S,j.state=de,j.context=Oe,S=J):(typeof j.componentDidMount=="function"&&(c.flags|=4194308),S=!1)}else{j=c.stateNode,_f(u,c),J=c.memoizedProps,Oe=c.type===c.elementType?J:Ui(c.type,J),j.props=Oe,Ot=c.pendingProps,vt=j.context,de=g.contextType,typeof de=="object"&&de!==null?de=ar(de):(de=Hn(g)?ki:Ct.current,de=vi(c,de));var gn=g.getDerivedStateFromProps;(rt=typeof gn=="function"||typeof j.getSnapshotBeforeUpdate=="function")||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(J!==Ot||vt!==de)&&ie(c,j,S,de),Fi=!1,vt=c.memoizedState,j.state=vt,Vl(c,S,j,A);var dt=c.memoizedState;J!==Ot||vt!==dt||tn.current||Fi?(typeof gn=="function"&&(m(c,g,gn,S),dt=c.memoizedState),(Oe=Fi||N(c,g,Oe,S,vt,dt,de)||!1)?(rt||typeof j.UNSAFE_componentWillUpdate!="function"&&typeof j.componentWillUpdate!="function"||(typeof j.componentWillUpdate=="function"&&j.componentWillUpdate(S,dt,de),typeof j.UNSAFE_componentWillUpdate=="function"&&j.UNSAFE_componentWillUpdate(S,dt,de)),typeof j.componentDidUpdate=="function"&&(c.flags|=4),typeof j.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof j.componentDidUpdate!="function"||J===u.memoizedProps&&vt===u.memoizedState||(c.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||J===u.memoizedProps&&vt===u.memoizedState||(c.flags|=1024),c.memoizedProps=S,c.memoizedState=dt),j.props=S,j.state=dt,j.context=de,S=Oe):(typeof j.componentDidUpdate!="function"||J===u.memoizedProps&&vt===u.memoizedState||(c.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||J===u.memoizedProps&&vt===u.memoizedState||(c.flags|=1024),S=!1)}return x0(u,c,g,S,L,A)}function x0(u,c,g,S,A,L){tA(u,c);var j=(c.flags&128)!==0;if(!S&&!j)return A&&da(c,g,!1),bo(u,c,L);S=c.stateNode,eU.current=c;var J=j&&typeof g.getDerivedStateFromError!="function"?null:S.render();return c.flags|=1,u!==null&&j?(c.child=yc(c,u.child,null,L),c.child=yc(c,null,J,L)):ur(u,c,J,L),c.memoizedState=S.state,A&&da(c,g,!0),c.child}function iA(u){var c=u.stateNode;c.pendingContext?or(u,c.pendingContext,c.pendingContext!==c.context):c.context&&or(u,c.context,!1),a0(u,c.containerInfo)}function rA(u,c,g,S,A){return _c(),o0(A),c.flags|=256,ur(u,c,g,S),c.child}var Mm={dehydrated:null,treeContext:null,retryLane:0};function Am(u){return{baseLanes:u,cachePool:null}}function sA(u,c,g){var S=c.pendingProps,A=Dn.current,L=!1,j=(c.flags&128)!==0,J;if((J=j)||(J=u!==null&&u.memoizedState===null?!1:(A&2)!==0),J?(L=!0,c.flags&=-129):(u===null||u.memoizedState!==null)&&(A|=1),et(Dn,A&1),u===null)return s0(c),u=c.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?(c.mode&1?Mo(u)?c.lanes=8:c.lanes=1073741824:c.lanes=1,null):(A=S.children,u=S.fallback,L?(S=c.mode,L=c.child,A={mode:"hidden",children:A},!(S&1)&&L!==null?(L.childLanes=0,L.pendingProps=A):L=qm(A,S,0,null),u=ql(u,S,g,null),L.return=c,u.return=c,L.sibling=u,c.child=L,c.child.memoizedState=Am(g),c.memoizedState=Mm,u):S0(c,A));if(A=u.memoizedState,A!==null){if(J=A.dehydrated,J!==null){if(j)return c.flags&256?(c.flags&=-257,Cm(u,c,g,Error(o(422)))):c.memoizedState!==null?(c.child=u.child,c.flags|=128,null):(L=S.fallback,A=c.mode,S=qm({mode:"visible",children:S.children},A,0,null),L=ql(L,A,g,null),L.flags|=2,S.return=c,L.return=c,S.sibling=L,c.child=S,c.mode&1&&yc(c,u.child,null,g),c.child.memoizedState=Am(g),c.memoizedState=Mm,L);if(!(c.mode&1))c=Cm(u,c,g,null);else if(Mo(J))c=Cm(u,c,g,Error(o(419)));else if(S=(g&u.childLanes)!==0,Gr||S){if(S=ni,S!==null){switch(g&-g){case 4:L=2;break;case 16:L=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:L=32;break;case 536870912:L=268435456;break;default:L=0}S=L&(S.suspendedLanes|g)?0:L,S!==0&&S!==A.retryLane&&(A.retryLane=S,ps(u,S,-1))}B0(),c=Cm(u,c,g,Error(o(421)))}else fa(J)?(c.flags|=128,c.child=u.child,c=dU.bind(null,u),ss(J,c),c=null):(g=A.treeContext,Ce&&(Hr=bl(J),Br=c,Rn=!0,Ls=null,vf=!1,g!==null&&(un[Nn++]=xi,un[Nn++]=Si,un[Nn++]=lr,xi=g.id,Si=g.overflow,lr=c)),c=S0(c,c.pendingProps.children),c.flags|=4096);return c}return L?(S=aA(u,c,S.children,S.fallback,g),L=c.child,A=u.child.memoizedState,L.memoizedState=A===null?Am(g):{baseLanes:A.baseLanes|g,cachePool:null},L.childLanes=u.childLanes&~g,c.memoizedState=Mm,S):(g=oA(u,c,S.children,g),c.memoizedState=null,g)}return L?(S=aA(u,c,S.children,S.fallback,g),L=c.child,A=u.child.memoizedState,L.memoizedState=A===null?Am(g):{baseLanes:A.baseLanes|g,cachePool:null},L.childLanes=u.childLanes&~g,c.memoizedState=Mm,S):(g=oA(u,c,S.children,g),c.memoizedState=null,g)}function S0(u,c){return c=qm({mode:"visible",children:c},u.mode,0,null),c.return=u,u.child=c}function oA(u,c,g,S){var A=u.child;return u=A.sibling,g=ya(A,{mode:"visible",children:g}),!(c.mode&1)&&(g.lanes=S),g.return=c,g.sibling=null,u!==null&&(S=c.deletions,S===null?(c.deletions=[u],c.flags|=16):S.push(u)),c.child=g}function aA(u,c,g,S,A){var L=c.mode;u=u.child;var j=u.sibling,J={mode:"hidden",children:g};return!(L&1)&&c.child!==u?(g=c.child,g.childLanes=0,g.pendingProps=J,c.deletions=null):(g=ya(u,J),g.subtreeFlags=u.subtreeFlags&14680064),j!==null?S=ya(j,S):(S=ql(S,L,A,null),S.flags|=2),S.return=c,g.return=c,g.sibling=S,c.child=g,S}function Cm(u,c,g,S){return S!==null&&o0(S),yc(c,u.child,null,g),u=S0(c,c.pendingProps.children),u.flags|=2,c.memoizedState=null,u}function lA(u,c,g){u.lanes|=c;var S=u.alternate;S!==null&&(S.lanes|=c),pc(u.return,c,g)}function E0(u,c,g,S,A){var L=u.memoizedState;L===null?u.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:S,tail:g,tailMode:A}:(L.isBackwards=c,L.rendering=null,L.renderingStartTime=0,L.last=S,L.tail=g,L.tailMode=A)}function uA(u,c,g){var S=c.pendingProps,A=S.revealOrder,L=S.tail;if(ur(u,c,S.children,g),S=Dn.current,S&2)S=S&1|2,c.flags|=128;else{if(u!==null&&u.flags&128)e:for(u=c.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&lA(u,g,c);else if(u.tag===19)lA(u,g,c);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===c)break e;for(;u.sibling===null;){if(u.return===null||u.return===c)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}S&=1}if(et(Dn,S),!(c.mode&1))c.memoizedState=null;else switch(A){case"forwards":for(g=c.child,A=null;g!==null;)u=g.alternate,u!==null&&mm(u)===null&&(A=g),g=g.sibling;g=A,g===null?(A=c.child,c.child=null):(A=g.sibling,g.sibling=null),E0(c,!1,A,g,L);break;case"backwards":for(g=null,A=c.child,c.child=null;A!==null;){if(u=A.alternate,u!==null&&mm(u)===null){c.child=A;break}u=A.sibling,A.sibling=g,g=A,A=u}E0(c,!0,g,null,L);break;case"together":E0(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function bo(u,c,g){if(u!==null&&(c.dependencies=u.dependencies),wc|=c.lanes,!(g&c.childLanes))return null;if(u!==null&&c.child!==u.child)throw Error(o(153));if(c.child!==null){for(u=c.child,g=ya(u,u.pendingProps),c.child=g,g.return=c;u.sibling!==null;)u=u.sibling,g=g.sibling=ya(u,u.pendingProps),g.return=c;g.sibling=null}return c.child}function tU(u,c,g){switch(c.tag){case 3:iA(c),_c();break;case 5:MM(c);break;case 1:Hn(c.type)&&Ln(c);break;case 4:a0(c,c.stateNode.containerInfo);break;case 10:dc(c,c.type._context,c.memoizedProps.value);break;case 13:var S=c.memoizedState;if(S!==null)return S.dehydrated!==null?(et(Dn,Dn.current&1),c.flags|=128,null):g&c.child.childLanes?sA(u,c,g):(et(Dn,Dn.current&1),u=bo(u,c,g),u!==null?u.sibling:null);et(Dn,Dn.current&1);break;case 19:if(S=(g&c.childLanes)!==0,u.flags&128){if(S)return uA(u,c,g);c.flags|=128}var A=c.memoizedState;if(A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),et(Dn,Dn.current),S)break;return null;case 22:case 23:return c.lanes=0,eA(u,c,g)}return bo(u,c,g)}function nU(u,c){switch(i0(c),c.tag){case 1:return Hn(c.type)&&Pt(),u=c.flags,u&65536?(c.flags=u&-65537|128,c):null;case 3:return xc(),yt(tn),yt(Ct),c0(),u=c.flags,u&65536&&!(u&128)?(c.flags=u&-65537|128,c):null;case 5:return l0(c),null;case 13:if(yt(Dn),u=c.memoizedState,u!==null&&u.dehydrated!==null){if(c.alternate===null)throw Error(o(340));_c()}return u=c.flags,u&65536?(c.flags=u&-65537|128,c):null;case 19:return yt(Dn),null;case 4:return xc(),null;case 10:return Fl(c.type._context),null;case 22:case 23:return z0(),null;case 24:return null;default:return null}}var Rm=!1,Bl=!1,iU=typeof WeakSet=="function"?WeakSet:Set,He=null;function Im(u,c){var g=u.ref;if(g!==null)if(typeof g=="function")try{g(null)}catch(S){Ar(u,c,S)}else g.current=null}function w0(u,c,g){try{g()}catch(S){Ar(u,c,S)}}var cA=!1;function rU(u,c){for(K(u.containerInfo),He=c;He!==null;)if(u=He,c=u.child,(u.subtreeFlags&1028)!==0&&c!==null)c.return=u,He=c;else for(;He!==null;){u=He;try{var g=u.alternate;if(u.flags&1024)switch(u.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var S=g.memoizedProps,A=g.memoizedState,L=u.stateNode,j=L.getSnapshotBeforeUpdate(u.elementType===u.type?S:Ui(u.type,S),A);L.__reactInternalSnapshotBeforeUpdate=j}break;case 3:nt&&Me(u.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(J){Ar(u,u.return,J)}if(c=u.sibling,c!==null){c.return=u.return,He=c;break}He=u.return}return g=cA,cA=!1,g}function Hl(u,c,g){var S=c.updateQueue;if(S=S!==null?S.lastEffect:null,S!==null){var A=S=S.next;do{if((A.tag&u)===u){var L=A.destroy;A.destroy=void 0,L!==void 0&&w0(c,g,L)}A=A.next}while(A!==S)}}function bf(u,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var g=c=c.next;do{if((g.tag&u)===u){var S=g.create;g.destroy=S()}g=g.next}while(g!==c)}}function T0(u){var c=u.ref;if(c!==null){var g=u.stateNode;switch(u.tag){case 5:u=se(g);break;default:u=g}typeof c=="function"?c(u):c.current=u}}function hA(u,c,g){if(ls&&typeof ls.onCommitFiberUnmount=="function")try{ls.onCommitFiberUnmount(lc,c)}catch{}switch(c.tag){case 0:case 11:case 14:case 15:if(u=c.updateQueue,u!==null&&(u=u.lastEffect,u!==null)){var S=u=u.next;do{var A=S,L=A.destroy;A=A.tag,L!==void 0&&(A&2||A&4)&&w0(c,g,L),S=S.next}while(S!==u)}break;case 1:if(Im(c,g),u=c.stateNode,typeof u.componentWillUnmount=="function")try{u.props=c.memoizedProps,u.state=c.memoizedState,u.componentWillUnmount()}catch(j){Ar(c,g,j)}break;case 5:Im(c,g);break;case 4:nt?_A(u,c,g):X&&X&&(c=c.stateNode.containerInfo,g=Qe(c),jt(c,g))}}function fA(u,c,g){for(var S=c;;)if(hA(u,S,g),S.child===null||nt&&S.tag===4){if(S===c)break;for(;S.sibling===null;){if(S.return===null||S.return===c)return;S=S.return}S.sibling.return=S.return,S=S.sibling}else S.child.return=S,S=S.child}function dA(u){var c=u.alternate;c!==null&&(u.alternate=null,dA(c)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(c=u.stateNode,c!==null&&st(c)),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function pA(u){return u.tag===5||u.tag===3||u.tag===4}function mA(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||pA(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function gA(u){if(nt){e:{for(var c=u.return;c!==null;){if(pA(c))break e;c=c.return}throw Error(o(160))}var g=c;switch(g.tag){case 5:c=g.stateNode,g.flags&32&&(we(c),g.flags&=-33),g=mA(u),A0(u,g,c);break;case 3:case 4:c=g.stateNode.containerInfo,g=mA(u),M0(u,g,c);break;default:throw Error(o(161))}}}function M0(u,c,g){var S=u.tag;if(S===5||S===6)u=u.stateNode,c?ut(g,u,c):Rt(g,u);else if(S!==4&&(u=u.child,u!==null))for(M0(u,c,g),u=u.sibling;u!==null;)M0(u,c,g),u=u.sibling}function A0(u,c,g){var S=u.tag;if(S===5||S===6)u=u.stateNode,c?gt(g,u,c):ct(g,u);else if(S!==4&&(u=u.child,u!==null))for(A0(u,c,g),u=u.sibling;u!==null;)A0(u,c,g),u=u.sibling}function _A(u,c,g){for(var S=c,A=!1,L,j;;){if(!A){A=S.return;e:for(;;){if(A===null)throw Error(o(160));switch(L=A.stateNode,A.tag){case 5:j=!1;break e;case 3:L=L.containerInfo,j=!0;break e;case 4:L=L.containerInfo,j=!0;break e}A=A.return}A=!0}if(S.tag===5||S.tag===6)fA(u,S,g),j?$(L,S.stateNode):$e(L,S.stateNode);else if(S.tag===18)j?le(L,S.stateNode):he(L,S.stateNode);else if(S.tag===4){if(S.child!==null){L=S.stateNode.containerInfo,j=!0,S.child.return=S,S=S.child;continue}}else if(hA(u,S,g),S.child!==null){S.child.return=S,S=S.child;continue}if(S===c)break;for(;S.sibling===null;){if(S.return===null||S.return===c)return;S=S.return,S.tag===4&&(A=!1)}S.sibling.return=S.return,S=S.sibling}}function C0(u,c){if(nt){switch(c.tag){case 0:case 11:case 14:case 15:Hl(3,c,c.return),bf(3,c),Hl(5,c,c.return);return;case 1:return;case 5:var g=c.stateNode;if(g!=null){var S=c.memoizedProps;u=u!==null?u.memoizedProps:S;var A=c.type,L=c.updateQueue;c.updateQueue=null,L!==null&&Nt(g,L,A,u,S,c)}return;case 6:if(c.stateNode===null)throw Error(o(162));g=c.memoizedProps,Re(c.stateNode,u!==null?u.memoizedProps:g,g);return;case 3:Ce&&u!==null&&u.memoizedState.isDehydrated&&ne(c.stateNode.containerInfo);return;case 12:return;case 13:Pm(c);return;case 19:Pm(c);return;case 17:return}throw Error(o(163))}switch(c.tag){case 0:case 11:case 14:case 15:Hl(3,c,c.return),bf(3,c),Hl(5,c,c.return);return;case 12:return;case 13:Pm(c);return;case 19:Pm(c);return;case 3:Ce&&u!==null&&u.memoizedState.isDehydrated&&ne(c.stateNode.containerInfo);break;case 22:case 23:return}e:if(X){switch(c.tag){case 1:case 5:case 6:break e;case 3:case 4:c=c.stateNode,jt(c.containerInfo,c.pendingChildren);break e}throw Error(o(163))}}function Pm(u){var c=u.updateQueue;if(c!==null){u.updateQueue=null;var g=u.stateNode;g===null&&(g=u.stateNode=new iU),c.forEach(function(S){var A=pU.bind(null,u,S);g.has(S)||(g.add(S),S.then(A,A))})}}function sU(u,c){for(He=c;He!==null;){c=He;var g=c.deletions;if(g!==null)for(var S=0;S<g.length;S++){var A=g[S];try{var L=u;nt?_A(L,A,c):fA(L,A,c);var j=A.alternate;j!==null&&(j.return=null),A.return=null}catch(ft){Ar(A,c,ft)}}if(g=c.child,c.subtreeFlags&12854&&g!==null)g.return=c,He=g;else for(;He!==null;){c=He;try{var J=c.flags;if(J&32&&nt&&we(c.stateNode),J&512){var de=c.alternate;if(de!==null){var Oe=de.ref;Oe!==null&&(typeof Oe=="function"?Oe(null):Oe.current=null)}}if(J&8192)switch(c.tag){case 13:if(c.memoizedState!==null){var rt=c.alternate;(rt===null||rt.memoizedState===null)&&(D0=Mn())}break;case 22:var Ot=c.memoizedState!==null,vt=c.alternate,gn=vt!==null&&vt.memoizedState!==null;if(g=c,nt){e:if(S=g,A=Ot,L=null,nt)for(var dt=S;;){if(dt.tag===5){if(L===null){L=dt;var Gi=dt.stateNode;A?Ve(Gi):mt(dt.stateNode,dt.memoizedProps)}}else if(dt.tag===6){if(L===null){var gs=dt.stateNode;A?Ge(gs):q(gs,dt.memoizedProps)}}else if((dt.tag!==22&&dt.tag!==23||dt.memoizedState===null||dt===S)&&dt.child!==null){dt.child.return=dt,dt=dt.child;continue}if(dt===S)break;for(;dt.sibling===null;){if(dt.return===null||dt.return===S)break e;L===dt&&(L=null),dt=dt.return}L===dt&&(L=null),dt.sibling.return=dt.return,dt=dt.sibling}}if(Ot&&!gn&&g.mode&1){He=g;for(var ae=g.child;ae!==null;){for(g=He=ae;He!==null;){S=He;var Z=S.child;switch(S.tag){case 0:case 11:case 14:case 15:Hl(4,S,S.return);break;case 1:Im(S,S.return);var fe=S.stateNode;if(typeof fe.componentWillUnmount=="function"){var qe=S.return;try{fe.props=S.memoizedProps,fe.state=S.memoizedState,fe.componentWillUnmount()}catch(ft){Ar(S,qe,ft)}}break;case 5:Im(S,S.return);break;case 22:if(S.memoizedState!==null){xA(g);continue}}Z!==null?(Z.return=S,He=Z):xA(g)}ae=ae.sibling}}}switch(J&4102){case 2:gA(c),c.flags&=-3;break;case 6:gA(c),c.flags&=-3,C0(c.alternate,c);break;case 4096:c.flags&=-4097;break;case 4100:c.flags&=-4097,C0(c.alternate,c);break;case 4:C0(c.alternate,c)}}catch(ft){Ar(c,c.return,ft)}if(g=c.sibling,g!==null){g.return=c.return,He=g;break}He=c.return}}}function oU(u,c,g){He=u,yA(u)}function yA(u,c,g){for(var S=(u.mode&1)!==0;He!==null;){var A=He,L=A.child;if(A.tag===22&&S){var j=A.memoizedState!==null||Rm;if(!j){var J=A.alternate,de=J!==null&&J.memoizedState!==null||Bl;J=Rm;var Oe=Bl;if(Rm=j,(Bl=de)&&!Oe)for(He=A;He!==null;)j=He,de=j.child,j.tag===22&&j.memoizedState!==null?SA(A):de!==null?(de.return=j,He=de):SA(A);for(;L!==null;)He=L,yA(L),L=L.sibling;He=A,Rm=J,Bl=Oe}vA(u)}else A.subtreeFlags&8772&&L!==null?(L.return=A,He=L):vA(u)}}function vA(u){for(;He!==null;){var c=He;if(c.flags&8772){var g=c.alternate;try{if(c.flags&8772)switch(c.tag){case 0:case 11:case 15:Bl||bf(5,c);break;case 1:var S=c.stateNode;if(c.flags&4&&!Bl)if(g===null)S.componentDidMount();else{var A=c.elementType===c.type?g.memoizedProps:Ui(c.type,g.memoizedProps);S.componentDidUpdate(A,g.memoizedState,S.__reactInternalSnapshotBeforeUpdate)}var L=c.updateQueue;L!==null&&yf(c,L,S);break;case 3:var j=c.updateQueue;if(j!==null){if(g=null,c.child!==null)switch(c.child.tag){case 5:g=se(c.child.stateNode);break;case 1:g=c.child.stateNode}yf(c,j,g)}break;case 5:var J=c.stateNode;g===null&&c.flags&4&&Gt(J,c.type,c.memoizedProps,c);break;case 6:break;case 4:break;case 12:break;case 13:if(Ce&&c.memoizedState===null){var de=c.alternate;if(de!==null){var Oe=de.memoizedState;if(Oe!==null){var rt=Oe.dehydrated;rt!==null&&ce(rt)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}Bl||c.flags&512&&T0(c)}catch(Ot){Ar(c,c.return,Ot)}}if(c===u){He=null;break}if(g=c.sibling,g!==null){g.return=c.return,He=g;break}He=c.return}}function xA(u){for(;He!==null;){var c=He;if(c===u){He=null;break}var g=c.sibling;if(g!==null){g.return=c.return,He=g;break}He=c.return}}function SA(u){for(;He!==null;){var c=He;try{switch(c.tag){case 0:case 11:case 15:var g=c.return;try{bf(4,c)}catch(de){Ar(c,g,de)}break;case 1:var S=c.stateNode;if(typeof S.componentDidMount=="function"){var A=c.return;try{S.componentDidMount()}catch(de){Ar(c,A,de)}}var L=c.return;try{T0(c)}catch(de){Ar(c,L,de)}break;case 5:var j=c.return;try{T0(c)}catch(de){Ar(c,j,de)}}}catch(de){Ar(c,c.return,de)}if(c===u){He=null;break}var J=c.sibling;if(J!==null){J.return=c.return,He=J;break}He=c.return}}var bm=0,Lm=1,Nm=2,Dm=3,km=4;if(typeof Symbol=="function"&&Symbol.for){var Lf=Symbol.for;bm=Lf("selector.component"),Lm=Lf("selector.has_pseudo_class"),Nm=Lf("selector.role"),Dm=Lf("selector.test_id"),km=Lf("selector.text")}function R0(u){var c=me(u);if(c!=null){if(typeof c.memoizedProps["data-testname"]!="string")throw Error(o(364));return c}if(u=te(u),u===null)throw Error(o(362));return u.stateNode.current}function I0(u,c){switch(c.$$typeof){case bm:if(u.type===c.value)return!0;break;case Lm:e:{c=c.value,u=[u,0];for(var g=0;g<u.length;){var S=u[g++],A=u[g++],L=c[A];if(S.tag!==5||!Ee(S)){for(;L!=null&&I0(S,L);)A++,L=c[A];if(A===c.length){c=!0;break e}else for(S=S.child;S!==null;)u.push(S,A),S=S.sibling}}c=!1}return c;case Nm:if(u.tag===5&&Ke(u.stateNode,c.value))return!0;break;case km:if((u.tag===5||u.tag===6)&&(u=Ae(u),u!==null&&0<=u.indexOf(c.value)))return!0;break;case Dm:if(u.tag===5&&(u=u.memoizedProps["data-testname"],typeof u=="string"&&u.toLowerCase()===c.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function P0(u){switch(u.$$typeof){case bm:return"<"+(R(u.value)||"Unknown")+">";case Lm:return":has("+(P0(u)||"")+")";case Nm:return'[role="'+u.value+'"]';case km:return'"'+u.value+'"';case Dm:return'[data-testname="'+u.value+'"]';default:throw Error(o(365))}}function EA(u,c){var g=[];u=[u,0];for(var S=0;S<u.length;){var A=u[S++],L=u[S++],j=c[L];if(A.tag!==5||!Ee(A)){for(;j!=null&&I0(A,j);)L++,j=c[L];if(L===c.length)g.push(A);else for(A=A.child;A!==null;)u.push(A,L),A=A.sibling}}return g}function b0(u,c){if(!U)throw Error(o(363));u=R0(u),u=EA(u,c),c=[],u=Array.from(u);for(var g=0;g<u.length;){var S=u[g++];if(S.tag===5)Ee(S)||c.push(S.stateNode);else for(S=S.child;S!==null;)u.push(S),S=S.sibling}return c}var aU=Math.ceil,Om=a.ReactCurrentDispatcher,L0=a.ReactCurrentOwner,Kn=a.ReactCurrentBatchConfig,Wt=0,ni=null,ii=null,Ri=0,Wr=0,Ec=$n(0),hi=0,Nf=null,wc=0,Um=0,N0=0,Df=null,Tr=null,D0=0,k0=1/0;function Tc(){k0=Mn()+500}var Fm=!1,O0=null,pa=null,Vm=!1,ma=null,zm=0,kf=0,U0=null,Bm=-1,Hm=0;function cr(){return Wt&6?Mn():Bm!==-1?Bm:Bm=Mn()}function ga(u){return u.mode&1?Wt&2&&Ri!==0?Ri&-Ri:gf.transition!==null?(Hm===0&&(u=ic,ic<<=1,!(ic&4194240)&&(ic=64),Hm=u),Hm):(u=Qt,u!==0?u:ve()):1}function ps(u,c,g){if(50<kf)throw kf=0,U0=null,Error(o(185));var S=Gm(u,c);return S===null?null:(as(S,c,g),(!(Wt&2)||S!==ni)&&(S===ni&&(!(Wt&2)&&(Um|=c),hi===4&&_a(S,Ri)),Mr(S,g),c===1&&Wt===0&&!(u.mode&1)&&(Tc(),Fr&&Vr())),S)}function Gm(u,c){u.lanes|=c;var g=u.alternate;for(g!==null&&(g.lanes|=c),g=u,u=u.return;u!==null;)u.childLanes|=c,g=u.alternate,g!==null&&(g.childLanes|=c),g=u,u=u.return;return g.tag===3?g.stateNode:null}function Mr(u,c){var g=u.callbackNode;am(u,c);var S=Dl(u,u===ni?Ri:0);if(S===0)g!==null&&oc(g),u.callbackNode=null,u.callbackPriority=0;else if(c=S&-S,u.callbackPriority!==c){if(g!=null&&oc(g),c===1)u.tag===0?Ol(TA.bind(null,u)):fm(TA.bind(null,u)),Be?z(function(){Wt===0&&Vr()}):mf(Ao,Vr),g=null;else{switch(Is(S)){case 1:g=Ao;break;case 4:g=um;break;case 16:g=kl;break;case 536870912:g=An;break;default:g=kl}g=NA(g,wA.bind(null,u))}u.callbackPriority=c,u.callbackNode=g}}function wA(u,c){if(Bm=-1,Hm=0,Wt&6)throw Error(o(327));var g=u.callbackNode;if(jl()&&u.callbackNode!==g)return null;var S=Dl(u,u===ni?Ri:0);if(S===0)return null;if(S&30||S&u.expiredLanes||c)c=Wm(u,S);else{c=S;var A=Wt;Wt|=2;var L=CA();(ni!==u||Ri!==c)&&(Tc(),Gl(u,c));do try{cU();break}catch(J){AA(u,J)}while(!0);fc(),Om.current=L,Wt=A,ii!==null?c=0:(ni=null,Ri=0,c=hi)}if(c!==0){if(c===2&&(A=rc(u),A!==0&&(S=A,c=F0(u,A))),c===1)throw g=Nf,Gl(u,0),_a(u,S),Mr(u,Mn()),g;if(c===6)_a(u,S);else{if(A=u.current.alternate,!(S&30)&&!lU(A)&&(c=Wm(u,S),c===2&&(L=rc(u),L!==0&&(S=L,c=F0(u,L))),c===1))throw g=Nf,Gl(u,0),_a(u,S),Mr(u,Mn()),g;switch(u.finishedWork=A,u.finishedLanes=S,c){case 0:case 1:throw Error(o(345));case 2:Wl(u,Tr);break;case 3:if(_a(u,S),(S&130023424)===S&&(c=D0+500-Mn(),10<c)){if(Dl(u,0)!==0)break;if(A=u.suspendedLanes,(A&S)!==S){cr(),u.pingedLanes|=u.suspendedLanes&A;break}u.timeoutHandle=ze(Wl.bind(null,u,Tr),c);break}Wl(u,Tr);break;case 4:if(_a(u,S),(S&4194240)===S)break;for(c=u.eventTimes,A=-1;0<S;){var j=31-Oi(S);L=1<<j,j=c[j],j>A&&(A=j),S&=~L}if(S=A,S=Mn()-S,S=(120>S?120:480>S?480:1080>S?1080:1920>S?1920:3e3>S?3e3:4320>S?4320:1960*aU(S/1960))-S,10<S){u.timeoutHandle=ze(Wl.bind(null,u,Tr),S);break}Wl(u,Tr);break;case 5:Wl(u,Tr);break;default:throw Error(o(329))}}}return Mr(u,Mn()),u.callbackNode===g?wA.bind(null,u):null}function F0(u,c){var g=Df;return u.current.memoizedState.isDehydrated&&(Gl(u,c).flags|=256),u=Wm(u,c),u!==2&&(c=Tr,Tr=g,c!==null&&V0(c)),u}function V0(u){Tr===null?Tr=u:Tr.push.apply(Tr,u)}function lU(u){for(var c=u;;){if(c.flags&16384){var g=c.updateQueue;if(g!==null&&(g=g.stores,g!==null))for(var S=0;S<g.length;S++){var A=g[S],L=A.getSnapshot;A=A.value;try{if(!Ur(L(),A))return!1}catch{return!1}}}if(g=c.child,c.subtreeFlags&16384&&g!==null)g.return=c,c=g;else{if(c===u)break;for(;c.sibling===null;){if(c.return===null||c.return===u)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function _a(u,c){for(c&=~N0,c&=~Um,u.suspendedLanes|=c,u.pingedLanes&=~c,u=u.expirationTimes;0<c;){var g=31-Oi(c),S=1<<g;u[g]=-1,c&=~S}}function TA(u){if(Wt&6)throw Error(o(327));jl();var c=Dl(u,0);if(!(c&1))return Mr(u,Mn()),null;var g=Wm(u,c);if(u.tag!==0&&g===2){var S=rc(u);S!==0&&(c=S,g=F0(u,S))}if(g===1)throw g=Nf,Gl(u,0),_a(u,c),Mr(u,Mn()),g;if(g===6)throw Error(o(345));return u.finishedWork=u.current.alternate,u.finishedLanes=c,Wl(u,Tr),Mr(u,Mn()),null}function MA(u){ma!==null&&ma.tag===0&&!(Wt&6)&&jl();var c=Wt;Wt|=1;var g=Kn.transition,S=Qt;try{if(Kn.transition=null,Qt=1,u)return u()}finally{Qt=S,Kn.transition=g,Wt=c,!(Wt&6)&&Vr()}}function z0(){Wr=Ec.current,yt(Ec)}function Gl(u,c){u.finishedWork=null,u.finishedLanes=0;var g=u.timeoutHandle;if(g!==Ze&&(u.timeoutHandle=Ze,at(g)),ii!==null)for(g=ii.return;g!==null;){var S=g;switch(i0(S),S.tag){case 1:S=S.type.childContextTypes,S!=null&&Pt();break;case 3:xc(),yt(tn),yt(Ct),c0();break;case 5:l0(S);break;case 4:xc();break;case 13:yt(Dn);break;case 19:yt(Dn);break;case 10:Fl(S.type._context);break;case 22:case 23:z0()}g=g.return}if(ni=u,ii=u=ya(u.current,null),Ri=Wr=c,hi=0,Nf=null,N0=Um=wc=0,Tr=Df=null,zr!==null){for(c=0;c<zr.length;c++)if(g=zr[c],S=g.interleaved,S!==null){g.interleaved=null;var A=S.next,L=g.pending;if(L!==null){var j=L.next;L.next=A,S.next=j}g.pending=S}zr=null}return u}function AA(u,c){do{var g=ii;try{if(fc(),gm.current=Em,_m){for(var S=Gn.memoizedState;S!==null;){var A=S.queue;A!==null&&(A.pending=null),S=S.next}_m=!1}if(Sc=0,Ei=zi=Gn=null,Tf=!1,Mf=0,L0.current=null,g===null||g.return===null){hi=1,Nf=c,ii=null;break}e:{var L=u,j=g.return,J=g,de=c;if(c=Ri,J.flags|=32768,de!==null&&typeof de=="object"&&typeof de.then=="function"){var Oe=de,rt=J,Ot=rt.tag;if(!(rt.mode&1)&&(Ot===0||Ot===11||Ot===15)){var vt=rt.alternate;vt?(rt.updateQueue=vt.updateQueue,rt.memoizedState=vt.memoizedState,rt.lanes=vt.lanes):(rt.updateQueue=null,rt.memoizedState=null)}var gn=XM(j);if(gn!==null){gn.flags&=-257,YM(gn,j,J,L,c),gn.mode&1&&qM(L,Oe,c),c=gn,de=Oe;var dt=c.updateQueue;if(dt===null){var Gi=new Set;Gi.add(de),c.updateQueue=Gi}else dt.add(de);break e}else{if(!(c&1)){qM(L,Oe,c),B0();break e}de=Error(o(426))}}else if(Rn&&J.mode&1){var gs=XM(j);if(gs!==null){!(gs.flags&65536)&&(gs.flags|=256),YM(gs,j,J,L,c),o0(de);break e}}L=de,hi!==4&&(hi=2),Df===null?Df=[L]:Df.push(L),de=_0(de,J),J=j;do{switch(J.tag){case 3:J.flags|=65536,c&=-c,J.lanes|=c;var ae=WM(J,de,c);Vi(J,ae);break e;case 1:L=de;var Z=J.type,fe=J.stateNode;if(!(J.flags&128)&&(typeof Z.getDerivedStateFromError=="function"||fe!==null&&typeof fe.componentDidCatch=="function"&&(pa===null||!pa.has(fe)))){J.flags|=65536,c&=-c,J.lanes|=c;var qe=jM(J,L,c);Vi(J,qe);break e}}J=J.return}while(J!==null)}IA(g)}catch(ft){c=ft,ii===g&&g!==null&&(ii=g=g.return);continue}break}while(!0)}function CA(){var u=Om.current;return Om.current=Em,u===null?Em:u}function B0(){(hi===0||hi===3||hi===2)&&(hi=4),ni===null||!(wc&268435455)&&!(Um&268435455)||_a(ni,Ri)}function Wm(u,c){var g=Wt;Wt|=2;var S=CA();ni===u&&Ri===c||Gl(u,c);do try{uU();break}catch(A){AA(u,A)}while(!0);if(fc(),Wt=g,Om.current=S,ii!==null)throw Error(o(261));return ni=null,Ri=0,hi}function uU(){for(;ii!==null;)RA(ii)}function cU(){for(;ii!==null&&!ac();)RA(ii)}function RA(u){var c=LA(u.alternate,u,Wr);u.memoizedProps=u.pendingProps,c===null?IA(u):ii=c,L0.current=null}function IA(u){var c=u;do{var g=c.alternate;if(u=c.return,c.flags&32768){if(g=nU(g,c),g!==null){g.flags&=32767,ii=g;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{hi=6,ii=null;return}}else if(g=ZO(g,c,Wr),g!==null){ii=g;return}if(c=c.sibling,c!==null){ii=c;return}ii=c=u}while(c!==null);hi===0&&(hi=5)}function Wl(u,c){var g=Qt,S=Kn.transition;try{Kn.transition=null,Qt=1,hU(u,c,g)}finally{Kn.transition=S,Qt=g}return null}function hU(u,c,g){do jl();while(ma!==null);if(Wt&6)throw Error(o(327));var S=u.finishedWork,A=u.finishedLanes;if(S===null)return null;if(u.finishedWork=null,u.finishedLanes=0,S===u.current)throw Error(o(177));u.callbackNode=null,u.callbackPriority=0;var L=S.lanes|S.childLanes;if(t0(u,L),u===ni&&(ii=ni=null,Ri=0),!(S.subtreeFlags&2064)&&!(S.flags&2064)||Vm||(Vm=!0,NA(kl,function(){return jl(),null})),L=(S.flags&15990)!==0,S.subtreeFlags&15990||L){L=Kn.transition,Kn.transition=null;var j=Qt;Qt=1;var J=Wt;Wt|=4,L0.current=null,rU(u,S),sU(u,S),Q(u.containerInfo),u.current=S,oU(S),lm(),Wt=J,Qt=j,Kn.transition=L}else u.current=S;if(Vm&&(Vm=!1,ma=u,zm=A),L=u.pendingLanes,L===0&&(pa=null),cm(S.stateNode),Mr(u,Mn()),c!==null)for(g=u.onRecoverableError,S=0;S<c.length;S++)g(c[S]);if(Fm)throw Fm=!1,u=O0,O0=null,u;return zm&1&&u.tag!==0&&jl(),L=u.pendingLanes,L&1?u===U0?kf++:(kf=0,U0=u):kf=0,Vr(),null}function jl(){if(ma!==null){var u=Is(zm),c=Kn.transition,g=Qt;try{if(Kn.transition=null,Qt=16>u?16:u,ma===null)var S=!1;else{if(u=ma,ma=null,zm=0,Wt&6)throw Error(o(331));var A=Wt;for(Wt|=4,He=u.current;He!==null;){var L=He,j=L.child;if(He.flags&16){var J=L.deletions;if(J!==null){for(var de=0;de<J.length;de++){var Oe=J[de];for(He=Oe;He!==null;){var rt=He;switch(rt.tag){case 0:case 11:case 15:Hl(8,rt,L)}var Ot=rt.child;if(Ot!==null)Ot.return=rt,He=Ot;else for(;He!==null;){rt=He;var vt=rt.sibling,gn=rt.return;if(dA(rt),rt===Oe){He=null;break}if(vt!==null){vt.return=gn,He=vt;break}He=gn}}}var dt=L.alternate;if(dt!==null){var Gi=dt.child;if(Gi!==null){dt.child=null;do{var gs=Gi.sibling;Gi.sibling=null,Gi=gs}while(Gi!==null)}}He=L}}if(L.subtreeFlags&2064&&j!==null)j.return=L,He=j;else e:for(;He!==null;){if(L=He,L.flags&2048)switch(L.tag){case 0:case 11:case 15:Hl(9,L,L.return)}var ae=L.sibling;if(ae!==null){ae.return=L.return,He=ae;break e}He=L.return}}var Z=u.current;for(He=Z;He!==null;){j=He;var fe=j.child;if(j.subtreeFlags&2064&&fe!==null)fe.return=j,He=fe;else e:for(j=Z;He!==null;){if(J=He,J.flags&2048)try{switch(J.tag){case 0:case 11:case 15:bf(9,J)}}catch(ft){Ar(J,J.return,ft)}if(J===j){He=null;break e}var qe=J.sibling;if(qe!==null){qe.return=J.return,He=qe;break e}He=J.return}}if(Wt=A,Vr(),ls&&typeof ls.onPostCommitFiberRoot=="function")try{ls.onPostCommitFiberRoot(lc,u)}catch{}S=!0}return S}finally{Qt=g,Kn.transition=c}}return!1}function PA(u,c,g){c=_0(g,c),c=WM(u,c,1),bs(u,c),c=cr(),u=Gm(u,1),u!==null&&(as(u,1,c),Mr(u,c))}function Ar(u,c,g){if(u.tag===3)PA(u,u,g);else for(;c!==null;){if(c.tag===3){PA(c,u,g);break}else if(c.tag===1){var S=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof S.componentDidCatch=="function"&&(pa===null||!pa.has(S))){u=_0(g,u),u=jM(c,u,1),bs(c,u),u=cr(),c=Gm(c,1),c!==null&&(as(c,1,u),Mr(c,u));break}}c=c.return}}function fU(u,c,g){var S=u.pingCache;S!==null&&S.delete(c),c=cr(),u.pingedLanes|=u.suspendedLanes&g,ni===u&&(Ri&g)===g&&(hi===4||hi===3&&(Ri&130023424)===Ri&&500>Mn()-D0?Gl(u,0):N0|=g),Mr(u,c)}function bA(u,c){c===0&&(u.mode&1?(c=Zs,Zs<<=1,!(Zs&130023424)&&(Zs=4194304)):c=1);var g=cr();u=Gm(u,c),u!==null&&(as(u,c,g),Mr(u,g))}function dU(u){var c=u.memoizedState,g=0;c!==null&&(g=c.retryLane),bA(u,g)}function pU(u,c){var g=0;switch(u.tag){case 13:var S=u.stateNode,A=u.memoizedState;A!==null&&(g=A.retryLane);break;case 19:S=u.stateNode;break;default:throw Error(o(314))}S!==null&&S.delete(c),bA(u,g)}var LA;LA=function(u,c,g){if(u!==null)if(u.memoizedProps!==c.pendingProps||tn.current)Gr=!0;else{if(!(u.lanes&g)&&!(c.flags&128))return Gr=!1,tU(u,c,g);Gr=!!(u.flags&131072)}else Gr=!1,Rn&&c.flags&1048576&&gc(c,sn,c.index);switch(c.lanes=0,c.tag){case 2:var S=c.type;u!==null&&(u.alternate=null,c.alternate=null,c.flags|=2),u=c.pendingProps;var A=vi(c,Ct.current);Ps(c,g),A=f0(null,c,S,u,A,g);var L=d0();return c.flags|=1,typeof A=="object"&&A!==null&&typeof A.render=="function"&&A.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Hn(S)?(L=!0,Ln(c)):L=!1,c.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,mc(c),A.updater=C,c.stateNode=A,A._reactInternals=c,ue(c,S,u,g),c=x0(null,c,S,!0,L,g)):(c.tag=0,Rn&&L&&n0(c),ur(null,c,A,g),c=c.child),c;case 16:S=c.elementType;e:{switch(u!==null&&(u.alternate=null,c.alternate=null,c.flags|=2),u=c.pendingProps,A=S._init,S=A(S._payload),c.type=S,A=c.tag=gU(S),u=Ui(S,u),A){case 0:c=v0(null,c,S,u,g);break e;case 1:c=nA(null,c,S,u,g);break e;case 11:c=QM(null,c,S,u,g);break e;case 14:c=JM(null,c,S,Ui(S.type,u),g);break e}throw Error(o(306,S,""))}return c;case 0:return S=c.type,A=c.pendingProps,A=c.elementType===S?A:Ui(S,A),v0(u,c,S,A,g);case 1:return S=c.type,A=c.pendingProps,A=c.elementType===S?A:Ui(S,A),nA(u,c,S,A,g);case 3:e:{if(iA(c),u===null)throw Error(o(387));S=c.pendingProps,L=c.memoizedState,A=L.element,_f(u,c),Vl(c,S,null,g);var j=c.memoizedState;if(S=j.element,Ce&&L.isDehydrated)if(L={element:S,isDehydrated:!1,cache:j.cache,transitions:j.transitions},c.updateQueue.baseState=L,c.memoizedState=L,c.flags&256){A=Error(o(423)),c=rA(u,c,S,g,A);break e}else if(S!==A){A=Error(o(424)),c=rA(u,c,S,g,A);break e}else for(Ce&&(Hr=Pl(c.stateNode.containerInfo),Br=c,Rn=!0,Ls=null,vf=!1),g=TM(c,null,S,g),c.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling;else{if(_c(),S===A){c=bo(u,c,g);break e}ur(u,c,S,g)}c=c.child}return c;case 5:return MM(c),u===null&&s0(c),S=c.type,A=c.pendingProps,L=u!==null?u.memoizedProps:null,j=A.children,xe(S,A)?j=null:L!==null&&xe(S,L)&&(c.flags|=32),tA(u,c),ur(u,c,j,g),c.child;case 6:return u===null&&s0(c),null;case 13:return sA(u,c,g);case 4:return a0(c,c.stateNode.containerInfo),S=c.pendingProps,u===null?c.child=yc(c,null,S,g):ur(u,c,S,g),c.child;case 11:return S=c.type,A=c.pendingProps,A=c.elementType===S?A:Ui(S,A),QM(u,c,S,A,g);case 7:return ur(u,c,c.pendingProps,g),c.child;case 8:return ur(u,c,c.pendingProps.children,g),c.child;case 12:return ur(u,c,c.pendingProps.children,g),c.child;case 10:e:{if(S=c.type._context,A=c.pendingProps,L=c.memoizedProps,j=A.value,dc(c,S,j),L!==null)if(Ur(L.value,j)){if(L.children===A.children&&!tn.current){c=bo(u,c,g);break e}}else for(L=c.child,L!==null&&(L.return=c);L!==null;){var J=L.dependencies;if(J!==null){j=L.child;for(var de=J.firstContext;de!==null;){if(de.context===S){if(L.tag===1){de=cs(-1,g&-g),de.tag=2;var Oe=L.updateQueue;if(Oe!==null){Oe=Oe.shared;var rt=Oe.pending;rt===null?de.next=de:(de.next=rt.next,rt.next=de),Oe.pending=de}}L.lanes|=g,de=L.alternate,de!==null&&(de.lanes|=g),pc(L.return,g,c),J.lanes|=g;break}de=de.next}}else if(L.tag===10)j=L.type===c.type?null:L.child;else if(L.tag===18){if(j=L.return,j===null)throw Error(o(341));j.lanes|=g,J=j.alternate,J!==null&&(J.lanes|=g),pc(j,g,c),j=L.sibling}else j=L.child;if(j!==null)j.return=L;else for(j=L;j!==null;){if(j===c){j=null;break}if(L=j.sibling,L!==null){L.return=j.return,j=L;break}j=j.return}L=j}ur(u,c,A.children,g),c=c.child}return c;case 9:return A=c.type,S=c.pendingProps.children,Ps(c,g),A=ar(A),S=S(A),c.flags|=1,ur(u,c,S,g),c.child;case 14:return S=c.type,A=Ui(S,c.pendingProps),A=Ui(S.type,A),JM(u,c,S,A,g);case 15:return ZM(u,c,c.type,c.pendingProps,g);case 17:return S=c.type,A=c.pendingProps,A=c.elementType===S?A:Ui(S,A),u!==null&&(u.alternate=null,c.alternate=null,c.flags|=2),c.tag=1,Hn(S)?(u=!0,Ln(c)):u=!1,Ps(c,g),B(c,S,A),ue(c,S,A,g),x0(null,c,S,!0,u,g);case 19:return uA(u,c,g);case 22:return eA(u,c,g)}throw Error(o(156,c.tag))};function NA(u,c){return mf(u,c)}function mU(u,c,g,S){this.tag=u,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ms(u,c,g,S){return new mU(u,c,g,S)}function H0(u){return u=u.prototype,!(!u||!u.isReactComponent)}function gU(u){if(typeof u=="function")return H0(u)?1:0;if(u!=null){if(u=u.$$typeof,u===T)return 11;if(u===w)return 14}return 2}function ya(u,c){var g=u.alternate;return g===null?(g=ms(u.tag,c,u.key,u.mode),g.elementType=u.elementType,g.type=u.type,g.stateNode=u.stateNode,g.alternate=u,u.alternate=g):(g.pendingProps=c,g.type=u.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=u.flags&14680064,g.childLanes=u.childLanes,g.lanes=u.lanes,g.child=u.child,g.memoizedProps=u.memoizedProps,g.memoizedState=u.memoizedState,g.updateQueue=u.updateQueue,c=u.dependencies,g.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},g.sibling=u.sibling,g.index=u.index,g.ref=u.ref,g}function jm(u,c,g,S,A,L){var j=2;if(S=u,typeof u=="function")H0(u)&&(j=1);else if(typeof u=="string")j=5;else e:switch(u){case f:return ql(g.children,A,L,c);case d:j=8,A|=8;break;case p:return u=ms(12,g,c,A|2),u.elementType=p,u.lanes=L,u;case x:return u=ms(13,g,c,A),u.elementType=x,u.lanes=L,u;case y:return u=ms(19,g,c,A),u.elementType=y,u.lanes=L,u;case I:return qm(g,A,L,c);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case _:j=10;break e;case v:j=9;break e;case T:j=11;break e;case w:j=14;break e;case E:j=16,S=null;break e}throw Error(o(130,u==null?u:typeof u,""))}return c=ms(j,g,c,A),c.elementType=u,c.type=S,c.lanes=L,c}function ql(u,c,g,S){return u=ms(7,u,S,c),u.lanes=g,u}function qm(u,c,g,S){return u=ms(22,u,S,c),u.elementType=I,u.lanes=g,u.stateNode={},u}function G0(u,c,g){return u=ms(6,u,null,c),u.lanes=g,u}function W0(u,c,g){return c=ms(4,u.children!==null?u.children:[],u.key,c),c.lanes=g,c.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},c}function _U(u,c,g,S,A){this.tag=c,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ze,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=sc(0),this.expirationTimes=sc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=sc(0),this.identifierPrefix=S,this.onRecoverableError=A,Ce&&(this.mutableSourceEagerHydrationData=null)}function DA(u,c,g,S,A,L,j,J,de){return u=new _U(u,c,g,J,de),c===1?(c=1,L===!0&&(c|=8)):c=0,L=ms(3,null,null,c),u.current=L,L.stateNode=u,L.memoizedState={element:S,isDehydrated:g,cache:null,transitions:null},mc(L),u}function kA(u){if(!u)return Er;u=u._reactInternals;e:{if(k(u)!==u||u.tag!==1)throw Error(o(170));var c=u;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Hn(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(o(171))}if(u.tag===1){var g=u.type;if(Hn(g))return os(u,g,c)}return c}function OA(u){var c=u._reactInternals;if(c===void 0)throw typeof u.render=="function"?Error(o(188)):(u=Object.keys(u).join(","),Error(o(268,u)));return u=V(c),u===null?null:u.stateNode}function UA(u,c){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var g=u.retryLane;u.retryLane=g!==0&&g<c?g:c}}function j0(u,c){UA(u,c),(u=u.alternate)&&UA(u,c)}function yU(u){return u=V(u),u===null?null:u.stateNode}function vU(){return null}return t.attemptContinuousHydration=function(u){if(u.tag===13){var c=cr();ps(u,134217728,c),j0(u,134217728)}},t.attemptHydrationAtCurrentPriority=function(u){if(u.tag===13){var c=cr(),g=ga(u);ps(u,g,c),j0(u,g)}},t.attemptSynchronousHydration=function(u){switch(u.tag){case 3:var c=u.stateNode;if(c.current.memoizedState.isDehydrated){var g=Or(c.pendingLanes);g!==0&&(pf(c,g|1),Mr(c,Mn()),!(Wt&6)&&(Tc(),Vr()))}break;case 13:var S=cr();MA(function(){return ps(u,1,S)}),j0(u,1)}},t.batchedUpdates=function(u,c){var g=Wt;Wt|=1;try{return u(c)}finally{Wt=g,Wt===0&&(Tc(),Fr&&Vr())}},t.createComponentSelector=function(u){return{$$typeof:bm,value:u}},t.createContainer=function(u,c,g,S,A,L,j){return DA(u,c,!1,null,g,S,A,L,j)},t.createHasPseudoClassSelector=function(u){return{$$typeof:Lm,value:u}},t.createHydrationContainer=function(u,c,g,S,A,L,j,J,de){return u=DA(g,S,!0,u,A,L,j,J,de),u.context=kA(null),g=u.current,S=cr(),A=ga(g),L=cs(S,A),L.callback=c??null,bs(g,L),u.current.lanes=A,as(u,A,S),Mr(u,S),u},t.createPortal=function(u,c,g){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:h,key:S==null?null:""+S,children:u,containerInfo:c,implementation:g}},t.createRoleSelector=function(u){return{$$typeof:Nm,value:u}},t.createTestNameSelector=function(u){return{$$typeof:Dm,value:u}},t.createTextSelector=function(u){return{$$typeof:km,value:u}},t.deferredUpdates=function(u){var c=Qt,g=Kn.transition;try{return Kn.transition=null,Qt=16,u()}finally{Qt=c,Kn.transition=g}},t.discreteUpdates=function(u,c,g,S,A){var L=Qt,j=Kn.transition;try{return Kn.transition=null,Qt=1,u(c,g,S,A)}finally{Qt=L,Kn.transition=j,Wt===0&&Tc()}},t.findAllNodes=b0,t.findBoundingRects=function(u,c){if(!U)throw Error(o(363));c=b0(u,c),u=[];for(var g=0;g<c.length;g++)u.push(Ie(c[g]));for(c=u.length-1;0<c;c--){g=u[c];for(var S=g.x,A=S+g.width,L=g.y,j=L+g.height,J=c-1;0<=J;J--)if(c!==J){var de=u[J],Oe=de.x,rt=Oe+de.width,Ot=de.y,vt=Ot+de.height;if(S>=Oe&&L>=Ot&&A<=rt&&j<=vt){u.splice(c,1);break}else if(S!==Oe||g.width!==de.width||vt<L||Ot>j){if(!(L!==Ot||g.height!==de.height||rt<S||Oe>A)){Oe>S&&(de.width+=Oe-S,de.x=S),rt<A&&(de.width=A-Oe),u.splice(c,1);break}}else{Ot>L&&(de.height+=Ot-L,de.y=L),vt<j&&(de.height=j-Ot),u.splice(c,1);break}}}return u},t.findHostInstance=OA,t.findHostInstanceWithNoPortals=function(u){return u=P(u),u=u!==null?Y(u):null,u===null?null:u.stateNode},t.findHostInstanceWithWarning=function(u){return OA(u)},t.flushControlled=function(u){var c=Wt;Wt|=1;var g=Kn.transition,S=Qt;try{Kn.transition=null,Qt=1,u()}finally{Qt=S,Kn.transition=g,Wt=c,Wt===0&&(Tc(),Vr())}},t.flushPassiveEffects=jl,t.flushSync=MA,t.focusWithin=function(u,c){if(!U)throw Error(o(363));for(u=R0(u),c=EA(u,c),c=Array.from(c),u=0;u<c.length;){var g=c[u++];if(!Ee(g)){if(g.tag===5&&Ue(g.stateNode))return!0;for(g=g.child;g!==null;)c.push(g),g=g.sibling}}return!1},t.getCurrentUpdatePriority=function(){return Qt},t.getFindAllNodesFailureDescription=function(u,c){if(!U)throw Error(o(363));var g=0,S=[];u=[R0(u),0];for(var A=0;A<u.length;){var L=u[A++],j=u[A++],J=c[j];if((L.tag!==5||!Ee(L))&&(I0(L,J)&&(S.push(P0(J)),j++,j>g&&(g=j)),j<c.length))for(L=L.child;L!==null;)u.push(L,j),L=L.sibling}if(g<c.length){for(u=[];g<c.length;g++)u.push(P0(c[g]));return`findAllNodes was able to match part of the selector:
  `+(S.join(" > ")+`

No matching component was found for:
  `)+u.join(" > ")}return null},t.getPublicRootInstance=function(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return se(u.child.stateNode);default:return u.child.stateNode}},t.injectIntoDevTools=function(u){if(u={bundleType:u.bundleType,version:u.version,rendererPackageName:u.rendererPackageName,rendererConfig:u.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:yU,findFiberByHostInstance:u.findFiberByHostInstance||vU,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")u=!1;else{var c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(c.isDisabled||!c.supportsFiber)u=!0;else{try{lc=c.inject(u),ls=c}catch{}u=!!c.checkDCE}}return u},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(u,c,g,S){if(!U)throw Error(o(363));u=b0(u,c);var A=je(u,g,S).disconnect;return{disconnect:function(){A()}}},t.registerMutableSourceForHydration=function(u,c){var g=c._getVersion;g=g(c._source),u.mutableSourceEagerHydrationData==null?u.mutableSourceEagerHydrationData=[c,g]:u.mutableSourceEagerHydrationData.push(c,g)},t.runWithPriority=function(u,c){var g=Qt;try{return Qt=u,c()}finally{Qt=g}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(u,c,g,S){var A=c.current,L=cr(),j=ga(A);return g=kA(g),c.context===null?c.context=g:c.pendingContext=g,c=cs(L,j),c.payload={element:u},S=S===void 0?null:S,S!==null&&(c.callback=S),bs(A,c),u=ps(A,j,L),u!==null&&Ro(u,A,j),j},t};SO.exports=U$;var F$=SO.exports;const V$=SU(F$),pM={},mM=n=>void Object.assign(pM,n);function z$(n,e){function t(f,{args:d=[],attach:p,..._},v){let T=`${f[0].toUpperCase()}${f.slice(1)}`,x;if(f==="primitive"){if(_.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const y=_.object;x=Jc(y,{type:f,root:v,attach:p,primitive:!0})}else{const y=pM[T];if(!y)throw new Error(`R3F: ${T} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(d))throw new Error("R3F: The args prop must be an array!");x=Jc(new y(...d),{type:f,root:v,attach:p,memoizedProps:{args:d}})}return x.__r3f.attach===void 0&&(x.isBufferGeometry?x.__r3f.attach="geometry":x.isMaterial&&(x.__r3f.attach="material")),T!=="inject"&&mS(x,_),x}function i(f,d){let p=!1;if(d){var _,v;(_=d.__r3f)!=null&&_.attach?pS(f,d,d.__r3f.attach):d.isObject3D&&f.isObject3D&&(f.add(d),p=!0),p||(v=f.__r3f)==null||v.objects.push(d),d.__r3f||Jc(d,{}),d.__r3f.parent=f,Nw(d),Zc(d)}}function r(f,d,p){let _=!1;if(d){var v,T;if((v=d.__r3f)!=null&&v.attach)pS(f,d,d.__r3f.attach);else if(d.isObject3D&&f.isObject3D){d.parent=f,d.dispatchEvent({type:"added"}),f.dispatchEvent({type:"childadded",child:d});const x=f.children.filter(w=>w!==d),y=x.indexOf(p);f.children=[...x.slice(0,y),d,...x.slice(y)],_=!0}_||(T=f.__r3f)==null||T.objects.push(d),d.__r3f||Jc(d,{}),d.__r3f.parent=f,Nw(d),Zc(d)}}function s(f,d,p=!1){f&&[...f].forEach(_=>o(d,_,p))}function o(f,d,p){if(d){var _,v,T;if(d.__r3f&&(d.__r3f.parent=null),(_=f.__r3f)!=null&&_.objects&&(f.__r3f.objects=f.__r3f.objects.filter(I=>I!==d)),(v=d.__r3f)!=null&&v.attach)ob(f,d,d.__r3f.attach);else if(d.isObject3D&&f.isObject3D){var x;f.remove(d),(x=d.__r3f)!=null&&x.root&&Y$(B_(d),d)}const w=(T=d.__r3f)==null?void 0:T.primitive,E=!w&&(p===void 0?d.dispose!==null:p);if(!w){var y;s((y=d.__r3f)==null?void 0:y.objects,d,E),s(d.children,d,E)}if(delete d.__r3f,E&&d.dispose&&d.type!=="Scene"){const I=()=>{try{d.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?bw.unstable_scheduleCallback(bw.unstable_IdlePriority,I):I()}Zc(f)}}function a(f,d,p,_){var v;const T=(v=f.__r3f)==null?void 0:v.parent;if(!T)return;const x=t(d,p,f.__r3f.root);if(f.children){for(const y of f.children)y.__r3f&&i(x,y);f.children=f.children.filter(y=>!y.__r3f)}f.__r3f.objects.forEach(y=>i(x,y)),f.__r3f.objects=[],f.__r3f.autoRemovedBeforeAppend||o(T,f),x.parent&&(x.__r3f.autoRemovedBeforeAppend=!0),i(T,x),x.raycast&&x.__r3f.eventCount&&B_(x).getState().internal.interaction.push(x),[_,_.alternate].forEach(y=>{y!==null&&(y.stateNode=x,y.ref&&(typeof y.ref=="function"?y.ref(x):y.ref.current=x))})}const l=()=>{};return{reconciler:V$({createInstance:t,removeChild:o,appendChild:i,appendInitialChild:i,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(f,d)=>{if(!d)return;const p=f.getState().scene;p.__r3f&&(p.__r3f.root=f,i(p,d))},removeChildFromContainer:(f,d)=>{d&&o(f.getState().scene,d)},insertInContainerBefore:(f,d,p)=>{if(!d||!p)return;const _=f.getState().scene;_.__r3f&&r(_,d,p)},getRootHostContext:()=>null,getChildHostContext:f=>f,finalizeInitialChildren(f){var d;return!!((d=f==null?void 0:f.__r3f)!=null?d:{}).handlers},prepareUpdate(f,d,p,_){var v;if(((v=f==null?void 0:f.__r3f)!=null?v:{}).primitive&&_.object&&_.object!==f)return[!0];{const{args:x=[],children:y,...w}=_,{args:E=[],children:I,...O}=p;if(!Array.isArray(x))throw new Error("R3F: the args prop must be an array!");if(x.some((R,b)=>R!==E[b]))return[!0];const D=PO(f,w,O,!0);return D.changes.length?[!1,D]:null}},commitUpdate(f,[d,p],_,v,T,x){d?a(f,_,T,x):mS(f,p)},commitMount(f,d,p,_){var v;const T=(v=f.__r3f)!=null?v:{};f.raycast&&T.handlers&&T.eventCount&&B_(f).getState().internal.interaction.push(f)},getPublicInstance:f=>f,prepareForCommit:()=>null,preparePortalMount:f=>Jc(f.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(f){var d;const{attach:p,parent:_}=(d=f.__r3f)!=null?d:{};p&&_&&ob(_,f,p),f.isObject3D&&(f.visible=!1),Zc(f)},unhideInstance(f,d){var p;const{attach:_,parent:v}=(p=f.__r3f)!=null?p:{};_&&v&&pS(v,f,_),(f.isObject3D&&d.visible==null||d.visible)&&(f.visible=!0),Zc(f)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():_h.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&vn.fun(performance.now)?performance.now:vn.fun(Date.now)?Date.now:()=>0,scheduleTimeout:vn.fun(setTimeout)?setTimeout:void 0,cancelTimeout:vn.fun(clearTimeout)?clearTimeout:void 0}),applyProps:mS}}var nb,ib;const dS=n=>"colorSpace"in n||"outputColorSpace"in n,TO=()=>{var n;return(n=pM.ColorManagement)!=null?n:null},MO=n=>n&&n.isOrthographicCamera,B$=n=>n&&n.hasOwnProperty("current"),im=typeof window<"u"&&((nb=window.document)!=null&&nb.createElement||((ib=window.navigator)==null?void 0:ib.product)==="ReactNative")?pe.useLayoutEffect:pe.useEffect;function AO(n){const e=pe.useRef(n);return im(()=>void(e.current=n),[n]),e}function H$({set:n}){return im(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}class CO extends pe.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}CO.getDerivedStateFromError=()=>({error:!0});const RO="__default",rb=new Map,G$=n=>n&&!!n.memoized&&!!n.changes;function IO(n){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],t),n[1]):n}const td=n=>{var e;return(e=n.__r3f)==null?void 0:e.root.getState()};function B_(n){let e=n.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const vn={obj:n=>n===Object(n)&&!vn.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,arr:n=>Array.isArray(n),equ(n,e,{arrays:t="shallow",objects:i="reference",strict:r=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(vn.str(n)||vn.num(n)||vn.boo(n))return n===e;const s=vn.obj(n);if(s&&i==="reference")return n===e;const o=vn.arr(n);if(o&&t==="reference")return n===e;if((o||s)&&n===e)return!0;let a;for(a in n)if(!(a in e))return!1;if(s&&t==="shallow"&&i==="shallow"){for(a in r?e:n)if(!vn.equ(n[a],e[a],{strict:r,objects:"reference"}))return!1}else for(a in r?e:n)if(n[a]!==e[a])return!1;if(vn.und(a)){if(o&&n.length===0&&e.length===0||s&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function W$(n){const e={nodes:{},materials:{}};return n&&n.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material)}),e}function j$(n){n.dispose&&n.type!=="Scene"&&n.dispose();for(const e in n)e.dispose==null||e.dispose(),delete n[e]}function Jc(n,e){const t=n;return t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},n}function Lw(n,e){let t=n;if(e.includes("-")){const i=e.split("-"),r=i.pop();return t=i.reduce((s,o)=>s[o],n),{target:t,key:r}}else return{target:t,key:e}}const sb=/-\d+$/;function pS(n,e,t){if(vn.str(t)){if(sb.test(t)){const s=t.replace(sb,""),{target:o,key:a}=Lw(n,s);Array.isArray(o[a])||(o[a]=[])}const{target:i,key:r}=Lw(n,t);e.__r3f.previousAttach=i[r],i[r]=e}else e.__r3f.previousAttach=t(n,e)}function ob(n,e,t){var i,r;if(vn.str(t)){const{target:s,key:o}=Lw(n,t),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(i=e.__r3f)==null||i.previousAttach==null||i.previousAttach(n,e);(r=e.__r3f)==null||delete r.previousAttach}function PO(n,{children:e,key:t,ref:i,...r},{children:s,key:o,ref:a,...l}={},h=!1){const f=n.__r3f,d=Object.entries(r),p=[];if(h){const v=Object.keys(l);for(let T=0;T<v.length;T++)r.hasOwnProperty(v[T])||d.unshift([v[T],RO+"remove"])}d.forEach(([v,T])=>{var x;if((x=n.__r3f)!=null&&x.primitive&&v==="object"||vn.equ(T,l[v]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(v))return p.push([v,T,!0,[]]);let y=[];v.includes("-")&&(y=v.split("-")),p.push([v,T,!1,y]);for(const w in r){const E=r[w];w.startsWith(`${v}-`)&&p.push([w,E,!1,w.split("-")])}});const _={...r};return f!=null&&f.memoizedProps&&f!=null&&f.memoizedProps.args&&(_.args=f.memoizedProps.args),f!=null&&f.memoizedProps&&f!=null&&f.memoizedProps.attach&&(_.attach=f.memoizedProps.attach),{memoized:_,changes:p}}function mS(n,e){var t;const i=n.__r3f,r=i==null?void 0:i.root,s=r==null||r.getState==null?void 0:r.getState(),{memoized:o,changes:a}=G$(e)?e:PO(n,e),l=i==null?void 0:i.eventCount;n.__r3f&&(n.__r3f.memoizedProps=o);for(let p=0;p<a.length;p++){let[_,v,T,x]=a[p];if(dS(n)){const I="srgb",O="srgb-linear";_==="encoding"?(_="colorSpace",v=v===3001?I:O):_==="outputEncoding"&&(_="outputColorSpace",v=v===3001?I:O)}let y=n,w=y[_];if(x.length&&(w=x.reduce((E,I)=>E[I],n),!(w&&w.set))){const[E,...I]=x.reverse();y=I.reverse().reduce((O,D)=>O[D],n),_=E}if(v===RO+"remove")if(y.constructor){let E=rb.get(y.constructor);E||(E=new y.constructor,rb.set(y.constructor,E)),v=E[_]}else v=0;if(T&&i)v?i.handlers[_]=v:delete i.handlers[_],i.eventCount=Object.keys(i.handlers).length;else if(w&&w.set&&(w.copy||w instanceof Iu)){if(Array.isArray(v))w.fromArray?w.fromArray(v):w.set(...v);else if(w.copy&&v&&v.constructor&&w.constructor===v.constructor)w.copy(v);else if(v!==void 0){var h;const E=(h=w)==null?void 0:h.isColor;!E&&w.setScalar?w.setScalar(v):w instanceof Iu&&v instanceof Iu?w.mask=v.mask:w.set(v),!TO()&&s&&!s.linear&&E&&w.convertSRGBToLinear()}}else{var f;if(y[_]=v,(f=y[_])!=null&&f.isTexture&&y[_].format===pr&&y[_].type===xo&&s){const E=y[_];dS(E)&&dS(s.gl)?E.colorSpace=s.gl.outputColorSpace:E.encoding=s.gl.outputEncoding}}Zc(n)}if(i&&i.parent&&n.raycast&&l!==i.eventCount){const p=B_(n).getState().internal,_=p.interaction.indexOf(n);_>-1&&p.interaction.splice(_,1),i.eventCount&&p.interaction.push(n)}return!(a.length===1&&a[0][0]==="onUpdate")&&a.length&&(t=n.__r3f)!=null&&t.parent&&Nw(n),n}function Zc(n){var e,t;const i=(e=n.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();i&&i.internal.frames===0&&i.invalidate()}function Nw(n){n.onUpdate==null||n.onUpdate(n)}function q$(n,e){n.manual||(MO(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix(),n.updateMatrixWorld())}function a_(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function X$(){var n;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return _h.DefaultEventPriority;switch((n=e.event)==null?void 0:n.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return _h.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return _h.ContinuousEventPriority;default:return _h.DefaultEventPriority}}function bO(n,e,t,i){const r=t.get(e);r&&(t.delete(e),t.size===0&&(n.delete(i),r.target.releasePointerCapture(i)))}function Y$(n,e){const{internal:t}=n.getState();t.interaction=t.interaction.filter(i=>i!==e),t.initialHits=t.initialHits.filter(i=>i!==e),t.hovered.forEach((i,r)=>{(i.eventObject===e||i.object===e)&&t.hovered.delete(r)}),t.capturedMap.forEach((i,r)=>{bO(t.capturedMap,e,i,r)})}function $$(n){function e(l){const{internal:h}=n.getState(),f=l.offsetX-h.initialClick[0],d=l.offsetY-h.initialClick[1];return Math.round(Math.sqrt(f*f+d*d))}function t(l){return l.filter(h=>["Move","Over","Enter","Out","Leave"].some(f=>{var d;return(d=h.__r3f)==null?void 0:d.handlers["onPointer"+f]}))}function i(l,h){const f=n.getState(),d=new Set,p=[],_=h?h(f.internal.interaction):f.internal.interaction;for(let y=0;y<_.length;y++){const w=td(_[y]);w&&(w.raycaster.camera=void 0)}f.previousRoot||f.events.compute==null||f.events.compute(l,f);function v(y){const w=td(y);if(!w||!w.events.enabled||w.raycaster.camera===null)return[];if(w.raycaster.camera===void 0){var E;w.events.compute==null||w.events.compute(l,w,(E=w.previousRoot)==null?void 0:E.getState()),w.raycaster.camera===void 0&&(w.raycaster.camera=null)}return w.raycaster.camera?w.raycaster.intersectObject(y,!0):[]}let T=_.flatMap(v).sort((y,w)=>{const E=td(y.object),I=td(w.object);return!E||!I?y.distance-w.distance:I.events.priority-E.events.priority||y.distance-w.distance}).filter(y=>{const w=a_(y);return d.has(w)?!1:(d.add(w),!0)});f.events.filter&&(T=f.events.filter(T,f));for(const y of T){let w=y.object;for(;w;){var x;(x=w.__r3f)!=null&&x.eventCount&&p.push({...y,eventObject:w}),w=w.parent}}if("pointerId"in l&&f.internal.capturedMap.has(l.pointerId))for(let y of f.internal.capturedMap.get(l.pointerId).values())d.has(a_(y.intersection))||p.push(y.intersection);return p}function r(l,h,f,d){const p=n.getState();if(l.length){const _={stopped:!1};for(const v of l){const T=td(v.object)||p,{raycaster:x,pointer:y,camera:w,internal:E}=T,I=new G(y.x,y.y,0).unproject(w),O=M=>{var P,V;return(P=(V=E.capturedMap.get(M))==null?void 0:V.has(v.eventObject))!=null?P:!1},D=M=>{const P={intersection:v,target:h.target};E.capturedMap.has(M)?E.capturedMap.get(M).set(v.eventObject,P):E.capturedMap.set(M,new Map([[v.eventObject,P]])),h.target.setPointerCapture(M)},R=M=>{const P=E.capturedMap.get(M);P&&bO(E.capturedMap,v.eventObject,P,M)};let b={};for(let M in h){let P=h[M];typeof P!="function"&&(b[M]=P)}let k={...v,...b,pointer:y,intersections:l,stopped:_.stopped,delta:f,unprojectedPoint:I,ray:x.ray,camera:w,stopPropagation(){const M="pointerId"in h&&E.capturedMap.get(h.pointerId);if((!M||M.has(v.eventObject))&&(k.stopped=_.stopped=!0,E.hovered.size&&Array.from(E.hovered.values()).find(P=>P.eventObject===v.eventObject))){const P=l.slice(0,l.indexOf(v));s([...P,v])}},target:{hasPointerCapture:O,setPointerCapture:D,releasePointerCapture:R},currentTarget:{hasPointerCapture:O,setPointerCapture:D,releasePointerCapture:R},nativeEvent:h};if(d(k),_.stopped===!0)break}}return l}function s(l){const{internal:h}=n.getState();for(const f of h.hovered.values())if(!l.length||!l.find(d=>d.object===f.object&&d.index===f.index&&d.instanceId===f.instanceId)){const p=f.eventObject.__r3f,_=p==null?void 0:p.handlers;if(h.hovered.delete(a_(f)),p!=null&&p.eventCount){const v={...f,intersections:l};_.onPointerOut==null||_.onPointerOut(v),_.onPointerLeave==null||_.onPointerLeave(v)}}}function o(l,h){for(let f=0;f<h.length;f++){const d=h[f].__r3f;d==null||d.handlers.onPointerMissed==null||d.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return h=>{const{internal:f}=n.getState();"pointerId"in h&&f.capturedMap.has(h.pointerId)&&requestAnimationFrame(()=>{f.capturedMap.has(h.pointerId)&&(f.capturedMap.delete(h.pointerId),s([]))})}}return function(f){const{onPointerMissed:d,internal:p}=n.getState();p.lastEvent.current=f;const _=l==="onPointerMove",v=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",x=i(f,_?t:void 0),y=v?e(f):0;l==="onPointerDown"&&(p.initialClick=[f.offsetX,f.offsetY],p.initialHits=x.map(E=>E.eventObject)),v&&!x.length&&y<=2&&(o(f,p.interaction),d&&d(f)),_&&s(x);function w(E){const I=E.eventObject,O=I.__r3f,D=O==null?void 0:O.handlers;if(O!=null&&O.eventCount)if(_){if(D.onPointerOver||D.onPointerEnter||D.onPointerOut||D.onPointerLeave){const R=a_(E),b=p.hovered.get(R);b?b.stopped&&E.stopPropagation():(p.hovered.set(R,E),D.onPointerOver==null||D.onPointerOver(E),D.onPointerEnter==null||D.onPointerEnter(E))}D.onPointerMove==null||D.onPointerMove(E)}else{const R=D[l];R?(!v||p.initialHits.includes(I))&&(o(f,p.interaction.filter(b=>!p.initialHits.includes(b))),R(E)):v&&p.initialHits.includes(I)&&o(f,p.interaction.filter(b=>!p.initialHits.includes(b)))}}r(x,f,y,w)}}return{handlePointer:a}}const LO=n=>!!(n!=null&&n.render),NO=pe.createContext(null),K$=(n,e)=>{const t=L$((a,l)=>{const h=new G,f=new G,d=new G;function p(y=l().camera,w=f,E=l().size){const{width:I,height:O,top:D,left:R}=E,b=I/O;w.isVector3?d.copy(w):d.set(...w);const k=y.getWorldPosition(h).distanceTo(d);if(MO(y))return{width:I/y.zoom,height:O/y.zoom,top:D,left:R,factor:1,distance:k,aspect:b};{const M=y.fov*Math.PI/180,P=2*Math.tan(M/2)*k,V=P*(I/O);return{width:V,height:P,top:D,left:R,factor:I/V,distance:k,aspect:b}}}let _;const v=y=>a(w=>({performance:{...w.performance,current:y}})),T=new ge;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(y=1)=>n(l(),y),advance:(y,w)=>e(y,w,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new cM,pointer:T,mouse:T,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const y=l();_&&clearTimeout(_),y.performance.current!==y.performance.min&&v(y.performance.min),_=setTimeout(()=>v(l().performance.max),y.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:p},setEvents:y=>a(w=>({...w,events:{...w.events,...y}})),setSize:(y,w,E,I,O)=>{const D=l().camera,R={width:y,height:w,top:I||0,left:O||0,updateStyle:E};a(b=>({size:R,viewport:{...b.viewport,...p(D,f,R)}}))},setDpr:y=>a(w=>{const E=IO(y);return{viewport:{...w.viewport,dpr:E,initialDpr:w.viewport.initialDpr||E}}}),setFrameloop:(y="always")=>{const w=l().clock;w.stop(),w.elapsedTime=0,y!=="never"&&(w.start(),w.elapsedTime=0),a(()=>({frameloop:y}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:pe.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(y,w,E)=>{const I=l().internal;return I.priority=I.priority+(w>0?1:0),I.subscribers.push({ref:y,priority:w,store:E}),I.subscribers=I.subscribers.sort((O,D)=>O.priority-D.priority),()=>{const O=l().internal;O!=null&&O.subscribers&&(O.priority=O.priority-(w>0?1:0),O.subscribers=O.subscribers.filter(D=>D.ref!==y))}}}}}),i=t.getState();let r=i.size,s=i.viewport.dpr,o=i.camera;return t.subscribe(()=>{const{camera:a,size:l,viewport:h,gl:f,set:d}=t.getState();if(l.width!==r.width||l.height!==r.height||h.dpr!==s){var p;r=l,s=h.dpr,q$(a,l),f.setPixelRatio(h.dpr);const _=(p=l.updateStyle)!=null?p:typeof HTMLCanvasElement<"u"&&f.domElement instanceof HTMLCanvasElement;f.setSize(l.width,l.height,_)}a!==o&&(o=a,d(_=>({viewport:{..._.viewport,..._.viewport.getCurrentViewport(a)}})))}),t.subscribe(a=>n(a)),t};let l_,Q$=new Set,J$=new Set,Z$=new Set;function gS(n,e){if(n.size)for(const{callback:t}of n.values())t(e)}function nd(n,e){switch(n){case"before":return gS(Q$,e);case"after":return gS(J$,e);case"tail":return gS(Z$,e)}}let _S,yS;function vS(n,e,t){let i=e.clock.getDelta();for(e.frameloop==="never"&&typeof n=="number"&&(i=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),_S=e.internal.subscribers,l_=0;l_<_S.length;l_++)yS=_S[l_],yS.ref.current(yS.store.getState(),i,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function eK(n){let e=!1,t=!1,i,r,s;function o(h){r=requestAnimationFrame(o),e=!0,i=0,nd("before",h),t=!0;for(const d of n.values()){var f;s=d.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((f=s.gl.xr)!=null&&f.isPresenting)&&(i+=vS(h,s))}if(t=!1,nd("after",h),i===0)return nd("tail",h),e=!1,cancelAnimationFrame(r)}function a(h,f=1){var d;if(!h)return n.forEach(p=>a(p.store.getState(),f));(d=h.gl.xr)!=null&&d.isPresenting||!h.internal.active||h.frameloop==="never"||(f>1?h.internal.frames=Math.min(60,h.internal.frames+f):t?h.internal.frames=2:h.internal.frames=1,e||(e=!0,requestAnimationFrame(o)))}function l(h,f=!0,d,p){if(f&&nd("before",h),d)vS(h,d,p);else for(const _ of n.values())vS(h,_.store.getState());f&&nd("after",h)}return{loop:o,invalidate:a,advance:l}}function DO(){const n=pe.useContext(NO);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function so(n=t=>t,e){return DO()(n,e)}function rm(n,e=0){const t=DO(),i=t.getState().internal.subscribe,r=AO(n);return im(()=>i(r,e,t),[e,i,t]),null}const ab=new WeakMap;function kO(n,e){return function(t,...i){let r=ab.get(t);return r||(r=new t,ab.set(t,r)),n&&n(r),Promise.all(i.map(s=>new Promise((o,a)=>r.load(s,l=>{l.scene&&Object.assign(l,W$(l.scene)),o(l)},e,l=>a(new Error(`Could not load ${s}: ${l==null?void 0:l.message}`))))))}}function sm(n,e,t,i){const r=Array.isArray(e)?e:[e],s=D$(kO(t,i),[n,...r],{equal:vn.equ});return Array.isArray(e)?s:s[0]}sm.preload=function(n,e,t){const i=Array.isArray(e)?e:[e];return k$(kO(t),[n,...i])};sm.clear=function(n,e){const t=Array.isArray(e)?e:[e];return O$([n,...t])};const $h=new Map,{invalidate:lb,advance:ub}=eK($h),{reconciler:zy,applyProps:cu}=z$($h,X$),Xc={objects:"shallow",strict:!1},tK=(n,e)=>{const t=typeof n=="function"?n(e):n;return LO(t)?t:new jT({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...n})};function nK(n,e){const t=typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement;if(e){const{width:i,height:r,top:s,left:o,updateStyle:a=t}=e;return{width:i,height:r,top:s,left:o,updateStyle:a}}else if(typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:i,height:r,top:s,left:o}=n.parentElement.getBoundingClientRect();return{width:i,height:r,top:s,left:o,updateStyle:t}}else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0,updateStyle:t};return{width:0,height:0,top:0,left:0}}function iK(n){const e=$h.get(n),t=e==null?void 0:e.fiber,i=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=i||K$(lb,ub),o=t||zy.createContainer(s,_h.ConcurrentRoot,null,!1,null,"",r,null);e||$h.set(n,{fiber:o,store:s});let a,l=!1,h;return{configure(f={}){let{gl:d,size:p,scene:_,events:v,onCreated:T,shadows:x=!1,linear:y=!1,flat:w=!1,legacy:E=!1,orthographic:I=!1,frameloop:O="always",dpr:D=[1,2],performance:R,raycaster:b,camera:k,onPointerMissed:M}=f,P=s.getState(),V=P.gl;P.gl||P.set({gl:V=tK(d,n)});let F=P.raycaster;F||P.set({raycaster:F=new gO});const{params:Y,...re}=b||{};if(vn.equ(re,F,Xc)||cu(F,{...re}),vn.equ(Y,F.params,Xc)||cu(F,{params:{...F.params,...Y}}),!P.camera||P.camera===h&&!vn.equ(h,k,Xc)){h=k;const Q=k instanceof Kp,ee=Q?k:I?new sl(0,0,0,0,.1,1e3):new ti(75,0,.1,1e3);Q||(ee.position.z=5,k&&(cu(ee,k),("aspect"in k||"left"in k||"right"in k||"bottom"in k||"top"in k)&&(ee.manual=!0,ee.updateProjectionMatrix())),!P.camera&&!(k!=null&&k.rotation)&&ee.lookAt(0,0,0)),P.set({camera:ee}),F.camera=ee}if(!P.scene){let Q;_!=null&&_.isScene?Q=_:(Q=new qT,_&&cu(Q,_)),P.set({scene:Jc(Q)})}if(!P.xr){var se;const Q=(Ne,oe)=>{const xe=s.getState();xe.frameloop!=="never"&&ub(Ne,!0,xe,oe)},ee=()=>{const Ne=s.getState();Ne.gl.xr.enabled=Ne.gl.xr.isPresenting,Ne.gl.xr.setAnimationLoop(Ne.gl.xr.isPresenting?Q:null),Ne.gl.xr.isPresenting||lb(Ne)},_e={connect(){const Ne=s.getState().gl;Ne.xr.addEventListener("sessionstart",ee),Ne.xr.addEventListener("sessionend",ee)},disconnect(){const Ne=s.getState().gl;Ne.xr.removeEventListener("sessionstart",ee),Ne.xr.removeEventListener("sessionend",ee)}};typeof((se=V.xr)==null?void 0:se.addEventListener)=="function"&&_e.connect(),P.set({xr:_e})}if(V.shadowMap){const Q=V.shadowMap.enabled,ee=V.shadowMap.type;if(V.shadowMap.enabled=!!x,vn.boo(x))V.shadowMap.type=bd;else if(vn.str(x)){var ye;const _e={basic:u3,percentage:Mv,soft:bd,variance:Fs};V.shadowMap.type=(ye=_e[x])!=null?ye:bd}else vn.obj(x)&&Object.assign(V.shadowMap,x);(Q!==V.shadowMap.enabled||ee!==V.shadowMap.type)&&(V.shadowMap.needsUpdate=!0)}const W=TO();W&&("enabled"in W?W.enabled=!E:"legacyMode"in W&&(W.legacyMode=E)),l||cu(V,{outputEncoding:y?3e3:3001,toneMapping:w?vo:TT}),P.legacy!==E&&P.set(()=>({legacy:E})),P.linear!==y&&P.set(()=>({linear:y})),P.flat!==w&&P.set(()=>({flat:w})),d&&!vn.fun(d)&&!LO(d)&&!vn.equ(d,V,Xc)&&cu(V,d),v&&!P.events.handlers&&P.set({events:v(s)});const K=nK(n,p);return vn.equ(K,P.size,Xc)||P.setSize(K.width,K.height,K.updateStyle,K.top,K.left),D&&P.viewport.dpr!==IO(D)&&P.setDpr(D),P.frameloop!==O&&P.setFrameloop(O),P.onPointerMissed||P.set({onPointerMissed:M}),R&&!vn.equ(R,P.performance,Xc)&&P.set(Q=>({performance:{...Q.performance,...R}})),a=T,l=!0,this},render(f){return l||this.configure(),zy.updateContainer(Vs.jsx(rK,{store:s,children:f,onCreated:a,rootElement:n}),o,null,()=>{}),s},unmount(){OO(n)}}}function rK({store:n,children:e,onCreated:t,rootElement:i}){return im(()=>{const r=n.getState();r.set(s=>({internal:{...s.internal,active:!0}})),t&&t(r),n.getState().events.connected||r.events.connect==null||r.events.connect(i)},[]),Vs.jsx(NO.Provider,{value:n,children:e})}function OO(n,e){const t=$h.get(n),i=t==null?void 0:t.fiber;if(i){const r=t==null?void 0:t.store.getState();r&&(r.internal.active=!1),zy.updateContainer(null,i,null,()=>{r&&setTimeout(()=>{try{var s,o,a,l;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=r.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=r.gl)!=null&&l.xr&&r.xr.disconnect(),j$(r),$h.delete(n)}catch{}},500)})}}zy.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:pe.version});const xS={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function sK(n){const{handlePointer:e}=$$(n);return{priority:1,enabled:!0,compute(t,i,r){i.pointer.set(t.offsetX/i.size.width*2-1,-(t.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(xS).reduce((t,i)=>({...t,[i]:e(i)}),{}),update:()=>{var t;const{events:i,internal:r}=n.getState();(t=r.lastEvent)!=null&&t.current&&i.handlers&&i.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{var i;const{set:r,events:s}=n.getState();s.disconnect==null||s.disconnect(),r(o=>({events:{...o.events,connected:t}})),Object.entries((i=s.handlers)!=null?i:[]).forEach(([o,a])=>{const[l,h]=xS[o];t.addEventListener(l,a,{passive:h})})},disconnect:()=>{const{set:t,events:i}=n.getState();if(i.connected){var r;Object.entries((r=i.handlers)!=null?r:[]).forEach(([s,o])=>{if(i&&i.connected instanceof HTMLElement){const[a]=xS[s];i.connected.removeEventListener(a,o)}}),t(s=>({events:{...s.events,connected:void 0}}))}}}}function cb(n,e){let t;return(...i)=>{window.clearTimeout(t),t=window.setTimeout(()=>n(...i),e)}}function oK({debounce:n,scroll:e,polyfill:t,offsetSize:i}={debounce:0,scroll:!1,offsetSize:!1}){const r=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,o]=pe.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),a=pe.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),l=n?typeof n=="number"?n:n.scroll:null,h=n?typeof n=="number"?n:n.resize:null,f=pe.useRef(!1);pe.useEffect(()=>(f.current=!0,()=>void(f.current=!1)));const[d,p,_]=pe.useMemo(()=>{const y=()=>{if(!a.current.element)return;const{left:w,top:E,width:I,height:O,bottom:D,right:R,x:b,y:k}=a.current.element.getBoundingClientRect(),M={left:w,top:E,width:I,height:O,bottom:D,right:R,x:b,y:k};a.current.element instanceof HTMLElement&&i&&(M.height=a.current.element.offsetHeight,M.width=a.current.element.offsetWidth),Object.freeze(M),f.current&&!cK(a.current.lastBounds,M)&&o(a.current.lastBounds=M)};return[y,h?cb(y,h):y,l?cb(y,l):y]},[o,i,l,h]);function v(){a.current.scrollContainers&&(a.current.scrollContainers.forEach(y=>y.removeEventListener("scroll",_,!0)),a.current.scrollContainers=null),a.current.resizeObserver&&(a.current.resizeObserver.disconnect(),a.current.resizeObserver=null),a.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",a.current.orientationHandler))}function T(){a.current.element&&(a.current.resizeObserver=new r(_),a.current.resizeObserver.observe(a.current.element),e&&a.current.scrollContainers&&a.current.scrollContainers.forEach(y=>y.addEventListener("scroll",_,{capture:!0,passive:!0})),a.current.orientationHandler=()=>{_()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",a.current.orientationHandler))}const x=y=>{!y||y===a.current.element||(v(),a.current.element=y,a.current.scrollContainers=UO(y),T())};return lK(_,!!e),aK(p),pe.useEffect(()=>{v(),T()},[e,_,p]),pe.useEffect(()=>v,[]),[x,s,d]}function aK(n){pe.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function lK(n,e){pe.useEffect(()=>{if(e){const t=n;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[n,e])}function UO(n){const e=[];if(!n||n===document.body)return e;const{overflow:t,overflowX:i,overflowY:r}=window.getComputedStyle(n);return[t,i,r].some(s=>s==="auto"||s==="scroll")&&e.push(n),[...e,...UO(n.parentElement)]}const uK=["x","y","top","bottom","left","right","width","height"],cK=(n,e)=>uK.every(t=>n[t]===e[t]);var hK=Object.defineProperty,fK=Object.defineProperties,dK=Object.getOwnPropertyDescriptors,hb=Object.getOwnPropertySymbols,pK=Object.prototype.hasOwnProperty,mK=Object.prototype.propertyIsEnumerable,fb=(n,e,t)=>e in n?hK(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,db=(n,e)=>{for(var t in e||(e={}))pK.call(e,t)&&fb(n,t,e[t]);if(hb)for(var t of hb(e))mK.call(e,t)&&fb(n,t,e[t]);return n},gK=(n,e)=>fK(n,dK(e)),pb,mb;typeof window<"u"&&((pb=window.document)!=null&&pb.createElement||((mb=window.navigator)==null?void 0:mb.product)==="ReactNative")?pe.useLayoutEffect:pe.useEffect;function FO(n,e,t){if(!n)return;if(t(n)===!0)return n;let i=n.child;for(;i;){const r=FO(i,e,t);if(r)return r;i=i.sibling}}function VO(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const gb=console.error;console.error=function(){const n=[...arguments].join("");if(n!=null&&n.startsWith("Warning:")&&n.includes("useContext")){console.error=gb;return}return gb.apply(this,arguments)};const gM=VO(pe.createContext(null));class zO extends pe.Component{render(){return pe.createElement(gM.Provider,{value:this._reactInternals},this.props.children)}}function _K(){const n=pe.useContext(gM);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=pe.useId();return pe.useMemo(()=>{for(const i of[n,n==null?void 0:n.alternate]){if(!i)continue;const r=FO(i,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(r)return r}},[n,e])}function yK(){const n=_K(),[e]=pe.useState(()=>new Map);e.clear();let t=n;for(;t;){if(t.type&&typeof t.type=="object"){const r=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;r&&r!==gM&&!e.has(r)&&e.set(r,pe.useContext(VO(r)))}t=t.return}return e}function vK(){const n=yK();return pe.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>i=>pe.createElement(e,null,pe.createElement(t.Provider,gK(db({},i),{value:n.get(t)}))),e=>pe.createElement(zO,db({},e))),[n])}const xK=pe.forwardRef(function({children:e,fallback:t,resize:i,style:r,gl:s,events:o=sK,eventSource:a,eventPrefix:l,shadows:h,linear:f,flat:d,legacy:p,orthographic:_,frameloop:v,dpr:T,performance:x,raycaster:y,camera:w,scene:E,onPointerMissed:I,onCreated:O,...D},R){pe.useMemo(()=>mM(I$),[]);const b=vK(),[k,M]=oK({scroll:!0,debounce:{scroll:50,resize:0},...i}),P=pe.useRef(null),V=pe.useRef(null);pe.useImperativeHandle(R,()=>P.current);const F=AO(I),[Y,re]=pe.useState(!1),[se,ye]=pe.useState(!1);if(Y)throw Y;if(se)throw se;const W=pe.useRef(null);im(()=>{const Q=P.current;M.width>0&&M.height>0&&Q&&(W.current||(W.current=iK(Q)),W.current.configure({gl:s,events:o,shadows:h,linear:f,flat:d,legacy:p,orthographic:_,frameloop:v,dpr:T,performance:x,raycaster:y,camera:w,scene:E,size:M,onPointerMissed:(...ee)=>F.current==null?void 0:F.current(...ee),onCreated:ee=>{ee.events.connect==null||ee.events.connect(a?B$(a)?a.current:a:V.current),l&&ee.setEvents({compute:(_e,Ne)=>{const oe=_e[l+"X"],xe=_e[l+"Y"];Ne.pointer.set(oe/Ne.size.width*2-1,-(xe/Ne.size.height)*2+1),Ne.raycaster.setFromCamera(Ne.pointer,Ne.camera)}}),O==null||O(ee)}}),W.current.render(Vs.jsx(b,{children:Vs.jsx(CO,{set:ye,children:Vs.jsx(pe.Suspense,{fallback:Vs.jsx(H$,{set:re}),children:e??null})})})))}),pe.useEffect(()=>{const Q=P.current;if(Q)return()=>OO(Q)},[]);const K=a?"none":"auto";return Vs.jsx("div",{ref:V,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:K,...r},...D,children:Vs.jsx("div",{ref:k,style:{width:"100%",height:"100%"},children:Vs.jsx("canvas",{ref:P,style:{display:"block"},children:t})})})}),FQ=pe.forwardRef(function(e,t){return Vs.jsx(zO,{children:Vs.jsx(xK,{...e,ref:t})})});function _l(){return _l=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},_l.apply(null,arguments)}var SK=Object.defineProperty,EK=(n,e,t)=>e in n?SK(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,wK=(n,e,t)=>(EK(n,e+"",t),t);class TK{constructor(){wK(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}var MK=Object.defineProperty,AK=(n,e,t)=>e in n?MK(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,xt=(n,e,t)=>(AK(n,typeof e!="symbol"?e+"":e,t),t);const u_=new Ku,_b=new zo,CK=Math.cos(70*(Math.PI/180)),yb=(n,e)=>(n%e+e)%e;let RK=class extends TK{constructor(e,t){super(),xt(this,"object"),xt(this,"domElement"),xt(this,"enabled",!0),xt(this,"target",new G),xt(this,"minDistance",0),xt(this,"maxDistance",1/0),xt(this,"minZoom",0),xt(this,"maxZoom",1/0),xt(this,"minPolarAngle",0),xt(this,"maxPolarAngle",Math.PI),xt(this,"minAzimuthAngle",-1/0),xt(this,"maxAzimuthAngle",1/0),xt(this,"enableDamping",!1),xt(this,"dampingFactor",.05),xt(this,"enableZoom",!0),xt(this,"zoomSpeed",1),xt(this,"enableRotate",!0),xt(this,"rotateSpeed",1),xt(this,"enablePan",!0),xt(this,"panSpeed",1),xt(this,"screenSpacePanning",!0),xt(this,"keyPanSpeed",7),xt(this,"zoomToCursor",!1),xt(this,"autoRotate",!1),xt(this,"autoRotateSpeed",2),xt(this,"reverseOrbit",!1),xt(this,"reverseHorizontalOrbit",!1),xt(this,"reverseVerticalOrbit",!1),xt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),xt(this,"mouseButtons",{LEFT:ou.ROTATE,MIDDLE:ou.DOLLY,RIGHT:ou.PAN}),xt(this,"touches",{ONE:au.ROTATE,TWO:au.DOLLY_PAN}),xt(this,"target0"),xt(this,"position0"),xt(this,"zoom0"),xt(this,"_domElementKeyEvents",null),xt(this,"getPolarAngle"),xt(this,"getAzimuthalAngle"),xt(this,"setPolarAngle"),xt(this,"setAzimuthalAngle"),xt(this,"getDistance"),xt(this,"getZoomScale"),xt(this,"listenToKeyEvents"),xt(this,"stopListenToKeyEvents"),xt(this,"saveState"),xt(this,"reset"),xt(this,"update"),xt(this,"connect"),xt(this,"dispose"),xt(this,"dollyIn"),xt(this,"dollyOut"),xt(this,"getScale"),xt(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>f.phi,this.getAzimuthalAngle=()=>f.theta,this.setPolarAngle=$=>{let we=yb($,2*Math.PI),Ve=f.phi;Ve<0&&(Ve+=2*Math.PI),we<0&&(we+=2*Math.PI);let Ge=Math.abs(we-Ve);2*Math.PI-Ge<Ge&&(we<Ve?we+=2*Math.PI:Ve+=2*Math.PI),d.phi=we-Ve,i.update()},this.setAzimuthalAngle=$=>{let we=yb($,2*Math.PI),Ve=f.theta;Ve<0&&(Ve+=2*Math.PI),we<0&&(we+=2*Math.PI);let Ge=Math.abs(we-Ve);2*Math.PI-Ge<Ge&&(we<Ve?we+=2*Math.PI:Ve+=2*Math.PI),d.theta=we-Ve,i.update()},this.getDistance=()=>i.object.position.distanceTo(i.target),this.listenToKeyEvents=$=>{$.addEventListener("keydown",ct),this._domElementKeyEvents=$},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",ct),this._domElementKeyEvents=null},this.saveState=()=>{i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=()=>{i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(r),i.update(),l=a.NONE},this.update=(()=>{const $=new G,we=new G(0,1,0),Ve=new gi().setFromUnitVectors(e.up,we),Ge=Ve.clone().invert(),mt=new G,q=new gi,Me=2*Math.PI;return function(){const Qe=i.object.position;Ve.setFromUnitVectors(e.up,we),Ge.copy(Ve).invert(),$.copy(Qe).sub(i.target),$.applyQuaternion(Ve),f.setFromVector3($),i.autoRotate&&l===a.NONE&&Y(V()),i.enableDamping?(f.theta+=d.theta*i.dampingFactor,f.phi+=d.phi*i.dampingFactor):(f.theta+=d.theta,f.phi+=d.phi);let Je=i.minAzimuthAngle,kt=i.maxAzimuthAngle;isFinite(Je)&&isFinite(kt)&&(Je<-Math.PI?Je+=Me:Je>Math.PI&&(Je-=Me),kt<-Math.PI?kt+=Me:kt>Math.PI&&(kt-=Me),Je<=kt?f.theta=Math.max(Je,Math.min(kt,f.theta)):f.theta=f.theta>(Je+kt)/2?Math.max(Je,f.theta):Math.min(kt,f.theta)),f.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,f.phi)),f.makeSafe(),i.enableDamping===!0?i.target.addScaledVector(_,i.dampingFactor):i.target.add(_),i.zoomToCursor&&k||i.object.isOrthographicCamera?f.radius=Ne(f.radius):f.radius=Ne(f.radius*p),$.setFromSpherical(f),$.applyQuaternion(Ge),Qe.copy(i.target).add($),i.object.matrixAutoUpdate||i.object.updateMatrix(),i.object.lookAt(i.target),i.enableDamping===!0?(d.theta*=1-i.dampingFactor,d.phi*=1-i.dampingFactor,_.multiplyScalar(1-i.dampingFactor)):(d.set(0,0,0),_.set(0,0,0));let jt=!1;if(i.zoomToCursor&&k){let en=null;if(i.object instanceof ti&&i.object.isPerspectiveCamera){const bn=$.length();en=Ne(bn*p);const Kt=bn-en;i.object.position.addScaledVector(R,Kt),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const bn=new G(b.x,b.y,0);bn.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/p)),i.object.updateProjectionMatrix(),jt=!0;const Kt=new G(b.x,b.y,0);Kt.unproject(i.object),i.object.position.sub(Kt).add(bn),i.object.updateMatrixWorld(),en=$.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;en!==null&&(i.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(en).add(i.object.position):(u_.origin.copy(i.object.position),u_.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(u_.direction))<CK?e.lookAt(i.target):(_b.setFromNormalAndCoplanarPoint(i.object.up,i.target),u_.intersectPlane(_b,i.target))))}else i.object instanceof sl&&i.object.isOrthographicCamera&&(jt=p!==1,jt&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/p)),i.object.updateProjectionMatrix()));return p=1,k=!1,jt||mt.distanceToSquared(i.object.position)>h||8*(1-q.dot(i.object.quaternion))>h?(i.dispatchEvent(r),mt.copy(i.object.position),q.copy(i.object.quaternion),jt=!1,!0):!1}})(),this.connect=$=>{i.domElement=$,i.domElement.style.touchAction="none",i.domElement.addEventListener("contextmenu",Gt),i.domElement.addEventListener("pointerdown",Ie),i.domElement.addEventListener("pointercancel",Ee),i.domElement.addEventListener("wheel",je)},this.dispose=()=>{var $,we,Ve,Ge,mt,q;i.domElement&&(i.domElement.style.touchAction="auto"),($=i.domElement)==null||$.removeEventListener("contextmenu",Gt),(we=i.domElement)==null||we.removeEventListener("pointerdown",Ie),(Ve=i.domElement)==null||Ve.removeEventListener("pointercancel",Ee),(Ge=i.domElement)==null||Ge.removeEventListener("wheel",je),(mt=i.domElement)==null||mt.ownerDocument.removeEventListener("pointermove",Ae),(q=i.domElement)==null||q.ownerDocument.removeEventListener("pointerup",Ee),i._domElementKeyEvents!==null&&i._domElementKeyEvents.removeEventListener("keydown",ct)};const i=this,r={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const h=1e-6,f=new Vy,d=new Vy;let p=1;const _=new G,v=new ge,T=new ge,x=new ge,y=new ge,w=new ge,E=new ge,I=new ge,O=new ge,D=new ge,R=new G,b=new ge;let k=!1;const M=[],P={};function V(){return 2*Math.PI/60/60*i.autoRotateSpeed}function F(){return Math.pow(.95,i.zoomSpeed)}function Y($){i.reverseOrbit||i.reverseHorizontalOrbit?d.theta+=$:d.theta-=$}function re($){i.reverseOrbit||i.reverseVerticalOrbit?d.phi+=$:d.phi-=$}const se=(()=>{const $=new G;return function(Ve,Ge){$.setFromMatrixColumn(Ge,0),$.multiplyScalar(-Ve),_.add($)}})(),ye=(()=>{const $=new G;return function(Ve,Ge){i.screenSpacePanning===!0?$.setFromMatrixColumn(Ge,1):($.setFromMatrixColumn(Ge,0),$.crossVectors(i.object.up,$)),$.multiplyScalar(Ve),_.add($)}})(),W=(()=>{const $=new G;return function(Ve,Ge){const mt=i.domElement;if(mt&&i.object instanceof ti&&i.object.isPerspectiveCamera){const q=i.object.position;$.copy(q).sub(i.target);let Me=$.length();Me*=Math.tan(i.object.fov/2*Math.PI/180),se(2*Ve*Me/mt.clientHeight,i.object.matrix),ye(2*Ge*Me/mt.clientHeight,i.object.matrix)}else mt&&i.object instanceof sl&&i.object.isOrthographicCamera?(se(Ve*(i.object.right-i.object.left)/i.object.zoom/mt.clientWidth,i.object.matrix),ye(Ge*(i.object.top-i.object.bottom)/i.object.zoom/mt.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}})();function K($){i.object instanceof ti&&i.object.isPerspectiveCamera||i.object instanceof sl&&i.object.isOrthographicCamera?p=$:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function Q($){K(p/$)}function ee($){K(p*$)}function _e($){if(!i.zoomToCursor||!i.domElement)return;k=!0;const we=i.domElement.getBoundingClientRect(),Ve=$.clientX-we.left,Ge=$.clientY-we.top,mt=we.width,q=we.height;b.x=Ve/mt*2-1,b.y=-(Ge/q)*2+1,R.set(b.x,b.y,1).unproject(i.object).sub(i.object.position).normalize()}function Ne($){return Math.max(i.minDistance,Math.min(i.maxDistance,$))}function oe($){v.set($.clientX,$.clientY)}function xe($){_e($),I.set($.clientX,$.clientY)}function Le($){y.set($.clientX,$.clientY)}function ze($){T.set($.clientX,$.clientY),x.subVectors(T,v).multiplyScalar(i.rotateSpeed);const we=i.domElement;we&&(Y(2*Math.PI*x.x/we.clientHeight),re(2*Math.PI*x.y/we.clientHeight)),v.copy(T),i.update()}function at($){O.set($.clientX,$.clientY),D.subVectors(O,I),D.y>0?Q(F()):D.y<0&&ee(F()),I.copy(O),i.update()}function Ze($){w.set($.clientX,$.clientY),E.subVectors(w,y).multiplyScalar(i.panSpeed),W(E.x,E.y),y.copy(w),i.update()}function St($){_e($),$.deltaY<0?ee(F()):$.deltaY>0&&Q(F()),i.update()}function nt($){let we=!1;switch($.code){case i.keys.UP:W(0,i.keyPanSpeed),we=!0;break;case i.keys.BOTTOM:W(0,-i.keyPanSpeed),we=!0;break;case i.keys.LEFT:W(i.keyPanSpeed,0),we=!0;break;case i.keys.RIGHT:W(-i.keyPanSpeed,0),we=!0;break}we&&($.preventDefault(),i.update())}function X(){if(M.length==1)v.set(M[0].pageX,M[0].pageY);else{const $=.5*(M[0].pageX+M[1].pageX),we=.5*(M[0].pageY+M[1].pageY);v.set($,we)}}function Ce(){if(M.length==1)y.set(M[0].pageX,M[0].pageY);else{const $=.5*(M[0].pageX+M[1].pageX),we=.5*(M[0].pageY+M[1].pageY);y.set($,we)}}function me(){const $=M[0].pageX-M[1].pageX,we=M[0].pageY-M[1].pageY,Ve=Math.sqrt($*$+we*we);I.set(0,Ve)}function Pe(){i.enableZoom&&me(),i.enablePan&&Ce()}function ve(){i.enableZoom&&me(),i.enableRotate&&X()}function st($){if(M.length==1)T.set($.pageX,$.pageY);else{const Ve=$e($),Ge=.5*($.pageX+Ve.x),mt=.5*($.pageY+Ve.y);T.set(Ge,mt)}x.subVectors(T,v).multiplyScalar(i.rotateSpeed);const we=i.domElement;we&&(Y(2*Math.PI*x.x/we.clientHeight),re(2*Math.PI*x.y/we.clientHeight)),v.copy(T)}function Be($){if(M.length==1)w.set($.pageX,$.pageY);else{const we=$e($),Ve=.5*($.pageX+we.x),Ge=.5*($.pageY+we.y);w.set(Ve,Ge)}E.subVectors(w,y).multiplyScalar(i.panSpeed),W(E.x,E.y),y.copy(w)}function z($){const we=$e($),Ve=$.pageX-we.x,Ge=$.pageY-we.y,mt=Math.sqrt(Ve*Ve+Ge*Ge);O.set(0,mt),D.set(0,Math.pow(O.y/I.y,i.zoomSpeed)),Q(D.y),I.copy(O)}function U($){i.enableZoom&&z($),i.enablePan&&Be($)}function te($){i.enableZoom&&z($),i.enableRotate&&st($)}function Ie($){var we,Ve;i.enabled!==!1&&(M.length===0&&((we=i.domElement)==null||we.ownerDocument.addEventListener("pointermove",Ae),(Ve=i.domElement)==null||Ve.ownerDocument.addEventListener("pointerup",Ee)),Nt($),$.pointerType==="touch"?Rt($):Ke($))}function Ae($){i.enabled!==!1&&($.pointerType==="touch"?Re($):Ue($))}function Ee($){var we,Ve,Ge;gt($),M.length===0&&((we=i.domElement)==null||we.releasePointerCapture($.pointerId),(Ve=i.domElement)==null||Ve.ownerDocument.removeEventListener("pointermove",Ae),(Ge=i.domElement)==null||Ge.ownerDocument.removeEventListener("pointerup",Ee)),i.dispatchEvent(o),l=a.NONE}function Ke($){let we;switch($.button){case 0:we=i.mouseButtons.LEFT;break;case 1:we=i.mouseButtons.MIDDLE;break;case 2:we=i.mouseButtons.RIGHT;break;default:we=-1}switch(we){case ou.DOLLY:if(i.enableZoom===!1)return;xe($),l=a.DOLLY;break;case ou.ROTATE:if($.ctrlKey||$.metaKey||$.shiftKey){if(i.enablePan===!1)return;Le($),l=a.PAN}else{if(i.enableRotate===!1)return;oe($),l=a.ROTATE}break;case ou.PAN:if($.ctrlKey||$.metaKey||$.shiftKey){if(i.enableRotate===!1)return;oe($),l=a.ROTATE}else{if(i.enablePan===!1)return;Le($),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&i.dispatchEvent(s)}function Ue($){if(i.enabled!==!1)switch(l){case a.ROTATE:if(i.enableRotate===!1)return;ze($);break;case a.DOLLY:if(i.enableZoom===!1)return;at($);break;case a.PAN:if(i.enablePan===!1)return;Ze($);break}}function je($){i.enabled===!1||i.enableZoom===!1||l!==a.NONE&&l!==a.ROTATE||($.preventDefault(),i.dispatchEvent(s),St($),i.dispatchEvent(o))}function ct($){i.enabled===!1||i.enablePan===!1||nt($)}function Rt($){switch(ut($),M.length){case 1:switch(i.touches.ONE){case au.ROTATE:if(i.enableRotate===!1)return;X(),l=a.TOUCH_ROTATE;break;case au.PAN:if(i.enablePan===!1)return;Ce(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(i.touches.TWO){case au.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;Pe(),l=a.TOUCH_DOLLY_PAN;break;case au.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;ve(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&i.dispatchEvent(s)}function Re($){switch(ut($),l){case a.TOUCH_ROTATE:if(i.enableRotate===!1)return;st($),i.update();break;case a.TOUCH_PAN:if(i.enablePan===!1)return;Be($),i.update();break;case a.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;U($),i.update();break;case a.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;te($),i.update();break;default:l=a.NONE}}function Gt($){i.enabled!==!1&&$.preventDefault()}function Nt($){M.push($)}function gt($){delete P[$.pointerId];for(let we=0;we<M.length;we++)if(M[we].pointerId==$.pointerId){M.splice(we,1);return}}function ut($){let we=P[$.pointerId];we===void 0&&(we=new ge,P[$.pointerId]=we),we.set($.pageX,$.pageY)}function $e($){const we=$.pointerId===M[0].pointerId?M[1]:M[0];return P[we.pointerId]}this.dollyIn=($=F())=>{ee($),i.update()},this.dollyOut=($=F())=>{Q($),i.update()},this.getScale=()=>p,this.setScale=$=>{K($),i.update()},this.getZoomScale=()=>F(),t!==void 0&&this.connect(t),this.update()}};const SS=n=>n===Object(n)&&!Array.isArray(n)&&typeof n!="function";function _M(n,e){const t=so(s=>s.gl),i=sm(Qv,SS(n)?Object.values(n):n);return pe.useLayoutEffect(()=>{e==null||e(i)},[e]),pe.useEffect(()=>{if("initTexture"in t){let s=[];Array.isArray(i)?s=i:i instanceof Pn?s=[i]:SS(i)&&(s=Object.values(i)),s.forEach(o=>{o instanceof Pn&&t.initTexture(o)})}},[t,i]),pe.useMemo(()=>{if(SS(n)){const s={};let o=0;for(const a in n)s[a]=i[o++];return s}else return i},[n,i])}_M.preload=n=>sm.preload(Qv,n);_M.clear=n=>sm.clear(Qv,n);const IK=()=>parseInt(lf.replace(/\D+/g,"")),BO=IK(),zQ=pe.forwardRef(({makeDefault:n,camera:e,regress:t,domElement:i,enableDamping:r=!0,keyEvents:s=!1,onChange:o,onStart:a,onEnd:l,...h},f)=>{const d=so(D=>D.invalidate),p=so(D=>D.camera),_=so(D=>D.gl),v=so(D=>D.events),T=so(D=>D.setEvents),x=so(D=>D.set),y=so(D=>D.get),w=so(D=>D.performance),E=e||p,I=i||v.connected||_.domElement,O=pe.useMemo(()=>new RK(E),[E]);return rm(()=>{O.enabled&&O.update()},-1),pe.useEffect(()=>(s&&O.connect(s===!0?I:s),O.connect(I),()=>void O.dispose()),[s,I,t,O,d]),pe.useEffect(()=>{const D=k=>{d(),t&&w.regress(),o&&o(k)},R=k=>{a&&a(k)},b=k=>{l&&l(k)};return O.addEventListener("change",D),O.addEventListener("start",R),O.addEventListener("end",b),()=>{O.removeEventListener("start",R),O.removeEventListener("end",b),O.removeEventListener("change",D)}},[o,a,l,O,d,T]),pe.useEffect(()=>{if(n){const D=y().controls;return x({controls:O}),()=>x({controls:D})}},[n,O]),pe.createElement("primitive",_l({ref:f,object:O,enableDamping:r},h))}),ES=(n,e)=>{"updateRanges"in n?n.updateRanges[0]=e:n.updateRange=e},BQ=pe.forwardRef(({children:n,enabled:e=!0,speed:t=1,rotationIntensity:i=1,floatIntensity:r=1,floatingRange:s=[-.1,.1],autoInvalidate:o=!1,...a},l)=>{const h=pe.useRef(null);pe.useImperativeHandle(l,()=>h.current,[]);const f=pe.useRef(Math.random()*1e4);return rm(d=>{var p,_;if(!e||t===0)return;o&&d.invalidate();const v=f.current+d.clock.elapsedTime;h.current.rotation.x=Math.cos(v/4*t)/8*i,h.current.rotation.y=Math.sin(v/4*t)/8*i,h.current.rotation.z=Math.sin(v/4*t)/20*i;let T=Math.sin(v/4*t)/10;T=OT.mapLinear(T,-.1,.1,(p=s==null?void 0:s[0])!==null&&p!==void 0?p:-.1,(_=s==null?void 0:s[1])!==null&&_!==void 0?_:.1),h.current.position.y=T*r,h.current.updateMatrix()}),pe.createElement("group",a,pe.createElement("group",{ref:h,matrixAutoUpdate:!1},n))});class PK extends ns{constructor(){super({uniforms:{time:{value:0},fade:{value:1}},vertexShader:`
      uniform float time;
      attribute float size;
      varying vec3 vColor;
      void main() {
        vColor = color;
        vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);
        gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(time + 100.0));
        gl_Position = projectionMatrix * mvPosition;
      }`,fragmentShader:`
      uniform sampler2D pointTexture;
      uniform float fade;
      varying vec3 vColor;
      void main() {
        float opacity = 1.0;
        if (fade == 1.0) {
          float d = distance(gl_PointCoord, vec2(0.5, 0.5));
          opacity = 1.0 / (1.0 + exp(16.0 * (d - 0.25)));
        }
        gl_FragColor = vec4(vColor, opacity);

        #include <tonemapping_fragment>
	      #include <${BO>=154?"colorspace_fragment":"encodings_fragment"}>
      }`})}}const bK=n=>new G().setFromSpherical(new Vy(n,Math.acos(1-Math.random()*2),Math.random()*2*Math.PI)),HQ=pe.forwardRef(({radius:n=100,depth:e=50,count:t=5e3,saturation:i=0,factor:r=4,fade:s=!1,speed:o=1},a)=>{const l=pe.useRef(),[h,f,d]=pe.useMemo(()=>{const _=[],v=[],T=Array.from({length:t},()=>(.5+.5*Math.random())*r),x=new Ye;let y=n+e;const w=e/t;for(let E=0;E<t;E++)y-=w*Math.random(),_.push(...bK(y).toArray()),x.setHSL(E/t,i,.9),v.push(x.r,x.g,x.b);return[new Float32Array(_),new Float32Array(v),new Float32Array(T)]},[t,e,r,n,i]);rm(_=>l.current&&(l.current.uniforms.time.value=_.clock.elapsedTime*o));const[p]=pe.useState(()=>new PK);return pe.createElement("points",{ref:a},pe.createElement("bufferGeometry",null,pe.createElement("bufferAttribute",{attach:"attributes-position",args:[h,3]}),pe.createElement("bufferAttribute",{attach:"attributes-color",args:[f,3]}),pe.createElement("bufferAttribute",{attach:"attributes-size",args:[d,1]})),pe.createElement("primitive",{ref:l,object:p,attach:"material",blending:Ly,"uniforms-fade-value":s,depthWrite:!1,transparent:!0,vertexColors:!0}))}),LK="https://rawcdn.githack.com/pmndrs/drei-assets/9225a9f1fbd449d9411125c2f419b843d0308c9f/cloud.png",vb=new Mt,c_=new G,h_=new gi,xb=new G,Sb=new gi,id=new G,yM=pe.createContext(null),NK=pe.forwardRef(({children:n,material:e=iM,texture:t=LK,range:i,limit:r=200,frustumCulled:s,...o},a)=>{var l,h;const f=pe.useMemo(()=>class extends e{constructor(){super();const b=parseInt(lf.replace(/\D+/g,""))>=154?"opaque_fragment":"output_fragment";this.onBeforeCompile=k=>{k.vertexShader=`attribute float cloudOpacity;
               varying float vOpacity;
              `+k.vertexShader.replace("#include <fog_vertex>",`#include <fog_vertex>
                 vOpacity = cloudOpacity;
                `),k.fragmentShader=`varying float vOpacity;
              `+k.fragmentShader.replace(`#include <${b}>`,`#include <${b}>
                 gl_FragColor = vec4(outgoingLight, diffuseColor.a * vOpacity);
                `)}}},[e]);mM({CloudMaterial:f});const d=pe.useRef(null),p=pe.useRef([]),_=pe.useMemo(()=>new Float32Array(Array.from({length:r},()=>1)),[r]),v=pe.useMemo(()=>new Float32Array(Array.from({length:r},()=>[1,1,1]).flat()),[r]),T=_M(t);let x=0,y=0,w;const E=new gi,I=new G(0,0,1),O=new G;rm((b,k)=>{for(x=b.clock.elapsedTime,vb.copy(d.current.matrixWorld).invert(),b.camera.matrixWorld.decompose(xb,Sb,id),y=0;y<p.current.length;y++)w=p.current[y],w.ref.current.matrixWorld.decompose(c_,h_,id),c_.add(O.copy(w.position).applyQuaternion(h_).multiply(id)),h_.copy(Sb).multiply(E.setFromAxisAngle(I,w.rotation+=k*w.rotationFactor)),id.multiplyScalar(w.volume+(1+Math.sin(x*w.density*w.speed))/2*w.growth),w.matrix.compose(c_,h_,id).premultiply(vb),w.dist=c_.distanceTo(xb);for(p.current.sort((M,P)=>P.dist-M.dist),y=0;y<p.current.length;y++)w=p.current[y],_[y]=w.opacity*(w.dist<w.fade-1?w.dist/w.fade:1),d.current.setMatrixAt(y,w.matrix),d.current.setColorAt(y,w.color);d.current.geometry.attributes.cloudOpacity.needsUpdate=!0,d.current.instanceMatrix.needsUpdate=!0,d.current.instanceColor&&(d.current.instanceColor.needsUpdate=!0)}),pe.useLayoutEffect(()=>{const b=Math.min(r,i!==void 0?i:r,p.current.length);d.current.count=b,ES(d.current.instanceMatrix,{offset:0,count:b*16}),d.current.instanceColor&&ES(d.current.instanceColor,{offset:0,count:b*3}),ES(d.current.geometry.attributes.cloudOpacity,{offset:0,count:b})});let D=[(l=T.image.width)!==null&&l!==void 0?l:1,(h=T.image.height)!==null&&h!==void 0?h:1];const R=Math.max(D[0],D[1]);return D=[D[0]/R,D[1]/R],pe.createElement("group",_l({ref:a},o),pe.createElement(yM.Provider,{value:p},n,pe.createElement("instancedMesh",{matrixAutoUpdate:!1,ref:d,args:[null,null,r],frustumCulled:s},pe.createElement("instancedBufferAttribute",{usage:xw,attach:"instanceColor",args:[v,3]}),pe.createElement("planeGeometry",{args:[...D]},pe.createElement("instancedBufferAttribute",{usage:xw,attach:"attributes-cloudOpacity",args:[_,1]})),pe.createElement("cloudMaterial",{key:e.name,map:T,transparent:!0,depthWrite:!1}))))}),Eb=pe.forwardRef(({opacity:n=1,speed:e=0,bounds:t=[5,1,1],segments:i=20,color:r="#ffffff",fade:s=10,volume:o=6,smallestVolume:a=.25,distribute:l=null,growth:h=4,concentrate:f="inside",seed:d=Math.random(),...p},_)=>{function v(){const E=Math.sin(d++)*1e4;return E-Math.floor(E)}const T=pe.useContext(yM),x=pe.useRef(null),y=pe.useId(),w=pe.useMemo(()=>[...new Array(i)].map((E,I)=>({segments:i,bounds:new G(1,1,1),position:new G,uuid:y,index:I,ref:x,dist:0,matrix:new Mt,color:new Ye,rotation:I*(Math.PI/i)})),[i,y]);return pe.useLayoutEffect(()=>{w.forEach((E,I)=>{cu(E,{volume:o,color:r,speed:e,growth:h,opacity:n,fade:s,bounds:t,density:Math.max(.5,v()),rotationFactor:Math.max(.2,.5*v())*e});const O=l==null?void 0:l(E,I);if(O||i>1){var D;E.position.copy(E.bounds).multiply((D=O==null?void 0:O.point)!==null&&D!==void 0?D:{x:v()*2-1,y:v()*2-1,z:v()*2-1})}const R=Math.abs(E.position.x),b=Math.abs(E.position.y),k=Math.abs(E.position.z),M=Math.max(R,b,k);E.length=1,R===M&&(E.length-=R/E.bounds.x),b===M&&(E.length-=b/E.bounds.y),k===M&&(E.length-=k/E.bounds.z),E.volume=((O==null?void 0:O.volume)!==void 0?O.volume:Math.max(Math.max(0,a),f==="random"?v():f==="inside"?E.length:1-E.length))*o})},[f,t,s,r,n,h,o,d,i,e]),pe.useLayoutEffect(()=>{const E=w;return T.current=[...T.current,...E],()=>{T.current=T.current.filter(I=>I.uuid!==y)}},[w]),pe.useImperativeHandle(_,()=>x.current,[]),pe.createElement("group",_l({ref:x},p))}),GQ=pe.forwardRef((n,e)=>pe.useContext(yM)?pe.createElement(Eb,_l({ref:e},n)):pe.createElement(NK,null,pe.createElement(Eb,_l({ref:e},n))));class DK extends ns{constructor(){super({uniforms:{time:{value:0},pixelRatio:{value:1}},vertexShader:`
        uniform float pixelRatio;
        uniform float time;
        attribute float size;  
        attribute float speed;  
        attribute float opacity;
        attribute vec3 noise;
        attribute vec3 color;
        varying vec3 vColor;
        varying float vOpacity;

        void main() {
          vec4 modelPosition = modelMatrix * vec4(position, 1.0);
          modelPosition.y += sin(time * speed + modelPosition.x * noise.x * 100.0) * 0.2;
          modelPosition.z += cos(time * speed + modelPosition.x * noise.y * 100.0) * 0.2;
          modelPosition.x += cos(time * speed + modelPosition.x * noise.z * 100.0) * 0.2;
          vec4 viewPosition = viewMatrix * modelPosition;
          vec4 projectionPostion = projectionMatrix * viewPosition;
          gl_Position = projectionPostion;
          gl_PointSize = size * 25. * pixelRatio;
          gl_PointSize *= (1.0 / - viewPosition.z);
          vColor = color;
          vOpacity = opacity;
        }
      `,fragmentShader:`
        varying vec3 vColor;
        varying float vOpacity;
        void main() {
          float distanceToCenter = distance(gl_PointCoord, vec2(0.5));
          float strength = 0.05 / distanceToCenter - 0.1;
          gl_FragColor = vec4(vColor, strength * vOpacity);
          #include <tonemapping_fragment>
          #include <${BO>=154?"colorspace_fragment":"encodings_fragment"}>
        }
      `})}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}get pixelRatio(){return this.uniforms.pixelRatio.value}set pixelRatio(e){this.uniforms.pixelRatio.value=e}}const HO=n=>n&&n.constructor===Float32Array,kK=n=>[n.r,n.g,n.b],GO=n=>n instanceof ge||n instanceof G||n instanceof cn,WO=n=>Array.isArray(n)?n:GO(n)?n.toArray():[n,n,n];function rd(n,e,t){return pe.useMemo(()=>{if(e!==void 0){if(HO(e))return e;if(e instanceof Ye){const i=Array.from({length:n*3},()=>kK(e)).flat();return Float32Array.from(i)}else if(GO(e)||Array.isArray(e)){const i=Array.from({length:n*3},()=>WO(e)).flat();return Float32Array.from(i)}return Float32Array.from({length:n},()=>e)}return Float32Array.from({length:n},t)},[e])}const WQ=pe.forwardRef(({noise:n=1,count:e=100,speed:t=1,opacity:i=1,scale:r=1,size:s,color:o,children:a,...l},h)=>{pe.useMemo(()=>mM({SparklesImplMaterial:DK}),[]);const f=pe.useRef(null),d=so(E=>E.viewport.dpr),p=WO(r),_=pe.useMemo(()=>Float32Array.from(Array.from({length:e},()=>p.map(OT.randFloatSpread)).flat()),[e,...p]),v=rd(e,s,Math.random),T=rd(e,i),x=rd(e,t),y=rd(e*3,n),w=rd(o===void 0?e*3:e,HO(o)?o:new Ye(o),()=>1);return rm(E=>{f.current&&f.current.material&&(f.current.material.time=E.clock.elapsedTime)}),pe.useImperativeHandle(h,()=>f.current,[]),pe.createElement("points",_l({key:`particle-${e}-${JSON.stringify(r)}`},l,{ref:f}),pe.createElement("bufferGeometry",null,pe.createElement("bufferAttribute",{attach:"attributes-position",args:[_,3]}),pe.createElement("bufferAttribute",{attach:"attributes-size",args:[v,1]}),pe.createElement("bufferAttribute",{attach:"attributes-opacity",args:[T,1]}),pe.createElement("bufferAttribute",{attach:"attributes-speed",args:[x,1]}),pe.createElement("bufferAttribute",{attach:"attributes-color",args:[w,3]}),pe.createElement("bufferAttribute",{attach:"attributes-noise",args:[y,3]})),a||pe.createElement("sparklesImplMaterial",{transparent:!0,pixelRatio:d,depthWrite:!1}))});export{XK as $,nQ as A,oQ as B,dQ as C,sQ as D,lQ as E,BQ as F,uQ as G,pQ as H,yQ as I,cQ as J,iQ as K,LQ as L,SQ as M,eQ as N,zQ as O,EQ as P,AQ as Q,RQ as R,PQ as S,DQ as T,kQ as U,BG as V,ZK as W,OQ as X,tQ as Y,Ez as Z,GK as _,IQ as a,zK as a0,KK as a1,NQ as a2,BK as a3,xQ as a4,vQ as a5,HK as a6,ka as a7,JK as a8,QK as a9,Y4 as aa,TQ as b,CQ as c,FQ as d,HQ as e,WQ as f,GQ as g,aQ as h,rQ as i,Vs as j,MQ as k,bQ as l,UK as m,VK as n,mQ as o,gQ as p,wQ as q,pe as r,FK as s,fQ as t,rm as u,_Q as v,hQ as w,YK as x,$K as y,qK as z};
